<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|0dd7dc42d03956313aca16d8e37bcc4f73bb0fe2|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"e459c923c86391\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-584"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-584] Decouple Filter from BitSet - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-584] Decouple Filter from BitSet - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loadingâ€¦
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-584">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-584" href="/jira/browse/LUCENE-584" id="key-val" rel="12343720">LUCENE-584</a></li>
                </ol>
                <h1 id="summary-val">Decouple Filter from BitSet</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-584"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-584/LUCENE-584.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-584/LUCENE-584.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-584/LUCENE-584.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-584/LUCENE-584.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/minor.svg" title="Minor - Minor loss of function, or other problem where easy workaround is present." width="16"> Minor </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="2.1 ">2.1</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+2.9" title="2.9 Last release (barring major bugs) before migrating to 3.0 and JDK 1.5">2.9</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22core%2Fsearch%22" title="core/search issues with search code">core/search</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12343720-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <div class="code panel" style="border-width: 1px;">
                   <div class="codeContent panelContent"> 
                    <pre class="code-java"><span class="code-keyword">package</span> org.apache.lucene.search;

<span class="code-keyword">public</span> <span class="code-keyword">abstract</span> <span class="code-keyword">class </span>Filter <span class="code-keyword">implements</span> java.io.Serializable 
{
  <span class="code-keyword">public</span> <span class="code-keyword">abstract</span> AbstractBitSet bits(IndexReader reader) <span class="code-keyword">throws</span> IOException;
}

<span class="code-keyword">public</span> <span class="code-keyword">interface</span> AbstractBitSet 
{
  <span class="code-keyword">public</span> <span class="code-object">boolean</span> get(<span class="code-object">int</span> index);
}

</pre> 
                   </div>
                  </div> 
                  <p>It would be useful if the method =Filter.bits()= returned an abstract interface, instead of =java.util.BitSet=.</p> 
                  <p>Use case: there is a very large index, and, depending on the user's privileges, only a small portion of the index is actually visible.<br> Sparsely populated =java.util.BitSet=s are not efficient and waste lots of memory. It would be desirable to have an alternative BitSet implementation with smaller memory footprint.</p> 
                  <p>Though it <em>is</em> possibly to derive classes from =java.util.BitSet=, it was obviously not designed for that purpose.<br> That's why I propose to use an interface instead. The default implementation could still delegate to =java.util.BitSet=.</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-584?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-584?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-584?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-584?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12355127" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12355127/bench-diff.txt" draggable="true" data-downloadurl="text/plain:bench-diff.txt:https://issues.apache.org/jira/secure/attachment/12355127/bench-diff.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12355127/bench-diff.txt" title="Latest  08/Apr/07 03:59 - Doron Cohen" draggable="true" data-downloadurl="text/plain:bench-diff.txt:https://issues.apache.org/jira/secure/attachment/12355127/bench-diff.txt">bench-diff.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2007-04-08T03:59:13.943Z">08/Apr/07 03:59</time>
                   </dd>
                   <dd class="attachment-size">
                    8 kB
                   </dd>
                   <dd class="attachment-author">
                    Doron Cohen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12355042" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12355042/bench-diff.txt" draggable="true" data-downloadurl="text/plain:bench-diff.txt:https://issues.apache.org/jira/secure/attachment/12355042/bench-diff.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12355042/bench-diff.txt" title=" 05/Apr/07 21:33 - Otis Gospodnetic" draggable="true" data-downloadurl="text/plain:bench-diff.txt:https://issues.apache.org/jira/secure/attachment/12355042/bench-diff.txt">bench-diff.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2007-04-05T21:33:18.651Z">05/Apr/07 21:33</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Otis Gospodnetic
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374632" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374632/CHANGES.txt.patch" draggable="true" data-downloadurl="text/x-diff:CHANGES.txt.patch:https://issues.apache.org/jira/secure/attachment/12374632/CHANGES.txt.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374632/CHANGES.txt.patch" title="Latest  03/Feb/08 08:57 - Paul Elschot" draggable="true" data-downloadurl="text/x-diff:CHANGES.txt.patch:https://issues.apache.org/jira/secure/attachment/12374632/CHANGES.txt.patch">CHANGES.txt.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-03T08:57:06.253Z">03/Feb/08 08:57</time>
                   </dd>
                   <dd class="attachment-size">
                    0.7 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12372978" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12372978/ContribQueries20080111.patch" draggable="true" data-downloadurl="text/x-patch:ContribQueries20080111.patch:https://issues.apache.org/jira/secure/attachment/12372978/ContribQueries20080111.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12372978/ContribQueries20080111.patch" title="Latest  11/Jan/08 14:06 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:ContribQueries20080111.patch:https://issues.apache.org/jira/secure/attachment/12372978/ContribQueries20080111.patch">ContribQueries20080111.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-11T14:06:23.956Z">11/Jan/08 14:06</time>
                   </dd>
                   <dd class="attachment-size">
                    2 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12370398" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12370398/lucene-584.patch" draggable="true" data-downloadurl="text/x-patch:lucene-584.patch:https://issues.apache.org/jira/secure/attachment/12370398/lucene-584.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12370398/lucene-584.patch" title="Latest  28/Nov/07 09:25 - Michael Busch" draggable="true" data-downloadurl="text/x-patch:lucene-584.patch:https://issues.apache.org/jira/secure/attachment/12370398/lucene-584.patch">lucene-584.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2007-11-28T09:25:07.174Z">28/Nov/07 09:25</time>
                   </dd>
                   <dd class="attachment-size">
                    34 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael Busch
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12370809" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12370809/lucene-584-take2.patch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take2.patch:https://issues.apache.org/jira/secure/attachment/12370809/lucene-584-take2.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12370809/lucene-584-take2.patch" title="Latest  03/Dec/07 05:53 - Michael Busch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take2.patch:https://issues.apache.org/jira/secure/attachment/12370809/lucene-584-take2.patch">lucene-584-take2.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2007-12-03T05:53:33.918Z">03/Dec/07 05:53</time>
                   </dd>
                   <dd class="attachment-size">
                    52 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael Busch
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12372886" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12372886/lucene-584-take3-part1.patch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take3-part1.patch:https://issues.apache.org/jira/secure/attachment/12372886/lucene-584-take3-part1.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12372886/lucene-584-take3-part1.patch" title="Latest  10/Jan/08 08:04 - Michael Busch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take3-part1.patch:https://issues.apache.org/jira/secure/attachment/12372886/lucene-584-take3-part1.patch">lucene-584-take3-part1.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-10T08:04:46.217Z">10/Jan/08 08:04</time>
                   </dd>
                   <dd class="attachment-size">
                    37 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael Busch
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12372887" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12372887/lucene-584-take3-part2.patch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take3-part2.patch:https://issues.apache.org/jira/secure/attachment/12372887/lucene-584-take3-part2.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12372887/lucene-584-take3-part2.patch" title="Latest  10/Jan/08 08:04 - Michael Busch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take3-part2.patch:https://issues.apache.org/jira/secure/attachment/12372887/lucene-584-take3-part2.patch">lucene-584-take3-part2.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-10T08:04:46.755Z">10/Jan/08 08:04</time>
                   </dd>
                   <dd class="attachment-size">
                    77 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael Busch
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12372964" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12372964/lucene-584-take4-part1.patch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take4-part1.patch:https://issues.apache.org/jira/secure/attachment/12372964/lucene-584-take4-part1.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12372964/lucene-584-take4-part1.patch" title="Latest  11/Jan/08 08:58 - Michael Busch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take4-part1.patch:https://issues.apache.org/jira/secure/attachment/12372964/lucene-584-take4-part1.patch">lucene-584-take4-part1.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-11T08:58:06.607Z">11/Jan/08 08:58</time>
                   </dd>
                   <dd class="attachment-size">
                    39 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael Busch
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12372965" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12372965/lucene-584-take4-part2.patch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take4-part2.patch:https://issues.apache.org/jira/secure/attachment/12372965/lucene-584-take4-part2.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12372965/lucene-584-take4-part2.patch" title="Latest  11/Jan/08 08:58 - Michael Busch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take4-part2.patch:https://issues.apache.org/jira/secure/attachment/12372965/lucene-584-take4-part2.patch">lucene-584-take4-part2.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-11T08:58:06.711Z">11/Jan/08 08:58</time>
                   </dd>
                   <dd class="attachment-size">
                    77 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael Busch
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374524" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374524/lucene-584-take5-part1.patch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take5-part1.patch:https://issues.apache.org/jira/secure/attachment/12374524/lucene-584-take5-part1.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374524/lucene-584-take5-part1.patch" title="Latest  01/Feb/08 03:54 - Michael Busch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take5-part1.patch:https://issues.apache.org/jira/secure/attachment/12374524/lucene-584-take5-part1.patch">lucene-584-take5-part1.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-01T03:54:24.605Z">01/Feb/08 03:54</time>
                   </dd>
                   <dd class="attachment-size">
                    47 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael Busch
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374525" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374525/lucene-584-take5-part2.patch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take5-part2.patch:https://issues.apache.org/jira/secure/attachment/12374525/lucene-584-take5-part2.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374525/lucene-584-take5-part2.patch" title="Latest  01/Feb/08 03:54 - Michael Busch" draggable="true" data-downloadurl="text/x-patch:lucene-584-take5-part2.patch:https://issues.apache.org/jira/secure/attachment/12374525/lucene-584-take5-part2.patch">lucene-584-take5-part2.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-01T03:54:24.781Z">01/Feb/08 03:54</time>
                   </dd>
                   <dd class="attachment-size">
                    76 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael Busch
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12365212" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12365212/Matcher-20070905-2default.patch" draggable="true" data-downloadurl="text/x-patch:Matcher-20070905-2default.patch:https://issues.apache.org/jira/secure/attachment/12365212/Matcher-20070905-2default.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12365212/Matcher-20070905-2default.patch" title="Latest  05/Sep/07 21:27 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:Matcher-20070905-2default.patch:https://issues.apache.org/jira/secure/attachment/12365212/Matcher-20070905-2default.patch">Matcher-20070905-2default.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2007-09-05T21:27:49.790Z">05/Sep/07 21:27</time>
                   </dd>
                   <dd class="attachment-size">
                    75 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12365213" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12365213/Matcher-20070905-3core.patch" draggable="true" data-downloadurl="text/x-patch:Matcher-20070905-3core.patch:https://issues.apache.org/jira/secure/attachment/12365213/Matcher-20070905-3core.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12365213/Matcher-20070905-3core.patch" title="Latest  05/Sep/07 21:27 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:Matcher-20070905-3core.patch:https://issues.apache.org/jira/secure/attachment/12365213/Matcher-20070905-3core.patch">Matcher-20070905-3core.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2007-09-05T21:27:49.809Z">05/Sep/07 21:27</time>
                   </dd>
                   <dd class="attachment-size">
                    18 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12370084" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12370084/Matcher-20071122-1ground.patch" draggable="true" data-downloadurl="text/x-patch:Matcher-20071122-1ground.patch:https://issues.apache.org/jira/secure/attachment/12370084/Matcher-20071122-1ground.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12370084/Matcher-20071122-1ground.patch" title="Latest  22/Nov/07 18:33 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:Matcher-20071122-1ground.patch:https://issues.apache.org/jira/secure/attachment/12370084/Matcher-20071122-1ground.patch">Matcher-20071122-1ground.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2007-11-22T18:33:37.730Z">22/Nov/07 18:33</time>
                   </dd>
                   <dd class="attachment-size">
                    32 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12340162" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12340162/Some%20Matchers.zip" draggable="true" data-downloadurl="application/zip:Some Matchers.zip:https://issues.apache.org/jira/secure/attachment/12340162/Some%20Matchers.zip"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-zip" title="Zip Archive"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12340162/Some%20Matchers.zip" title="Latest  04/Sep/06 21:02 - Eks Dev" draggable="true" data-downloadurl="application/zip:Some Matchers.zip:https://issues.apache.org/jira/secure/attachment/12340162/Some%20Matchers.zip">Some Matchers.zip</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-09-04T21:02:22.000Z">04/Sep/06 21:02</time>
                   </dd>
                   <dd class="attachment-size">
                    9 kB
                   </dd>
                   <dd class="attachment-author">
                    Eks Dev
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12373008" data-issue-id="12343720" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12373008/Test20080111.patch" draggable="true" data-downloadurl="text/x-patch:Test20080111.patch:https://issues.apache.org/jira/secure/attachment/12373008/Test20080111.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12373008/Test20080111.patch" title="Latest  11/Jan/08 20:48 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:Test20080111.patch:https://issues.apache.org/jira/secure/attachment/12373008/Test20080111.patch">Test20080111.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-11T20:48:26.392Z">11/Jan/08 20:48</time>
                   </dd>
                   <dd class="attachment-size">
                    6 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="relates to">
                   relates to
                  </dt> 
                  <dd id="internal-12314478_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="LUCENE-328: Some utilities for a compact sparse filter"> <a href="/jira/browse/LUCENE-328" data-issue-key="LUCENE-328" class="issue-link link-title resolution">LUCENE-328</a> <span class="link-summary">Some utilities for a compact sparse filter</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/minor.svg" width="16" height="16" title="Minor - Minor loss of function, or other problem where easy workaround is present." alt="Minor - Minor loss of function, or other problem where easy workaround is present."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Resolved</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.</span>">Resolved</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_markrmiller@gmail.com" rel="markrmiller@gmail.com" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Mark Miller&quot;,&quot;emailAddress&quot;:&quot;markrmiller@gmail.com&quot;,&quot;username&quot;:&quot;markrmiller@gmail.com&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="markrmiller@gmail.com"></span></span> Mark Miller </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_nightrider" rel="nightrider" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Peter SchÃ¤fer&quot;,&quot;emailAddress&quot;:&quot;peter.schaefer@healy-hudson.com&quot;,&quot;username&quot;:&quot;nightrider&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="nightrider"></span></span> Peter SchÃ¤fer </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">11</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">4</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="31/May/06 18:47"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2006-05-31T18:47:02+0000">31/May/06 18:47</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="25/Sep/09 16:23"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2009-09-25T16:23:05+0000">25/Sep/09 16:23</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="22/Aug/09 21:18"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2009-08-22T21:18:04+0000">22/Aug/09 21:18</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-584?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-584?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12414046\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12414046&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12414046\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12414046_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12414046_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/06 19:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-05-31T19:48:34+0000\'\u003e31\\/May\\/06 19:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePeter, \u003c\\/p\u003e\\n\\n\u003cp\u003ethere is some advanced things you are probably interested in.\u003c\\/p\u003e\\n\\n\u003cp\u003esee:\u003cbr\\/\u003e\\n\\\"some utilities for a compact sparse filter\\\" \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-328\\\" title=\\\"Some utilities for a compact sparse filter\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-328\\\"\u003e\u003cdel\u003eLUCENE-328\u003c\\/del\u003e\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso interesting:\u003cbr\\/\u003e\\n\u003ca href=\\\"#SOLR-15\\\"\u003eSOLR-15\u003c\\/a\u003e OpenBitSet - ASF JIRA\u003c\\/p\u003e\\n\\n\u003cp\u003ecomplete solr solution for Filters is one cool thing! a bit awkward bridge to lucene due to BitSet in Filter, but this is due to be resolved... \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12414046_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12414046_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/06 19:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-05-31T19:48:34+0000\'\u003e31\\/May\\/06 19:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Peter,  \\n\\n there is some advanced things you are probably interested in. \\n\\n see: \\n\\\"some utilities for a compact sparse filter\\\"   LUCENE-328   \\n\\n Also interesting: \\n SOLR-15  OpenBitSet - ASF JIRA \\n\\n complete solr solution for Filters is one cool thing! a bit awkward bridge to lucene due to BitSet in Filter, but this is due to be resolved...               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12414224\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12414224&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12414224\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nightrider\\\" id=\\\"commentauthor_12414224_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nightrider\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nightrider\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Peter Sch\\u00E4fer\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12414224_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Jun\\/06 19:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-01T19:11:35+0000\'\u003e01\\/Jun\\/06 19:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ethanks, this looks interesting.\u003c\\/p\u003e\\n\\n\u003cp\u003eRegards,\u003cbr\\/\u003e\\nPeter\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nightrider\\\" id=\\\"commentauthor_12414224_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nightrider\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nightrider\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Peter Sch\\u00E4fer\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12414224_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Jun\\/06 19:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-01T19:11:35+0000\'\u003e01\\/Jun\\/06 19:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    thanks, this looks interesting. \\n\\n Regards, \\nPeter              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417896\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417896&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417896\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417896_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417896_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:42:23+0000\'\u003e27\\/Jun\\/06 04:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs the title of this issue is as accurate as it gets, I\'m attaching a  series of patches and additions here  that make Scorer a subclass of Matcher, while Matcher takes the current role of the BitSet in Filter.\u003cbr\\/\u003e\\nAll patches against trunk revision 417299.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417896_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417896_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:42:23+0000\'\u003e27\\/Jun\\/06 04:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As the title of this issue is as accurate as it gets, I\'m attaching a  series of patches and additions here  that make Scorer a subclass of Matcher, while Matcher takes the current role of the BitSet in Filter. \\nAll patches against trunk revision 417299.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417898\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417898&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417898\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417898_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417898_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:47:19+0000\'\u003e27\\/Jun\\/06 04:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ejavadocs of HitCollector.java to use \'matching\' instead of \'non-zero score\'.\u003cbr\\/\u003e\\nThis is actually independent of the Matcher\\/Scorer change.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417898_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417898_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:47:19+0000\'\u003e27\\/Jun\\/06 04:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    javadocs of HitCollector.java to use \'matching\' instead of \'non-zero score\'. \\nThis is actually independent of the Matcher\\/Scorer change.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417900\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417900&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417900\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417900_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417900_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:49:40+0000\'\u003e27\\/Jun\\/06 04:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ejavadocs of Searcher.java to use \'matching\' instead of \'non-zero score\',\u003cbr\\/\u003e\\nand to describe the Filter effect more accurately.\u003cbr\\/\u003e\\nThis is independent of the Matcher\\/Scorer change.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417900_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417900_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:49:40+0000\'\u003e27\\/Jun\\/06 04:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    javadocs of Searcher.java to use \'matching\' instead of \'non-zero score\', \\nand to describe the Filter effect more accurately. \\nThis is independent of the Matcher\\/Scorer change.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417902\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417902&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417902\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417902_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417902_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:52:04+0000\'\u003e27\\/Jun\\/06 04:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMatchCollector.java with collect(int) method for org.apache.lucene.search.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417902_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417902_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:52:04+0000\'\u003e27\\/Jun\\/06 04:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    MatchCollector.java with collect(int) method for org.apache.lucene.search.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417904\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417904&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417904\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417904_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417904_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:53:49+0000\'\u003e27\\/Jun\\/06 04:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMatcher.java, including a match(MatchCollector) method, for org.apache.lucene.search.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417904_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417904_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:53:49+0000\'\u003e27\\/Jun\\/06 04:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Matcher.java, including a match(MatchCollector) method, for org.apache.lucene.search.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417905\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417905&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417905\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417905_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417905_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:55:06+0000\'\u003e27\\/Jun\\/06 04:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003epatch to Scorer.java to subclass Matcher.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417905_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417905_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:55:06+0000\'\u003e27\\/Jun\\/06 04:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    patch to Scorer.java to subclass Matcher.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417907\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417907&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417907\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417907_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417907_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:58:23+0000\'\u003e27\\/Jun\\/06 04:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003epatch to Filter to add getMatcher() and to deprecate getBits() in favour of getMatcher().\u003cbr\\/\u003e\\nIncludes commented test code to test IndexSearcher using BitsMatcher.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417907_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417907_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 04:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T04:58:23+0000\'\u003e27\\/Jun\\/06 04:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    patch to Filter to add getMatcher() and to deprecate getBits() in favour of getMatcher(). \\nIncludes commented test code to test IndexSearcher using BitsMatcher.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417909\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417909&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417909\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417909_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417909_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:00:26+0000\'\u003e27\\/Jun\\/06 05:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch to IndexSearcher.java to prefer getMatcher() over getBits() on Filter.\u003cbr\\/\u003e\\nAlso add method IndexSearcher.match(Query, MatchCollector).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417909_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417909_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:00:26+0000\'\u003e27\\/Jun\\/06 05:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch to IndexSearcher.java to prefer getMatcher() over getBits() on Filter. \\nAlso add method IndexSearcher.match(Query, MatchCollector).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417910\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417910&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417910\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417910_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417910_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:02:44+0000\'\u003e27\\/Jun\\/06 05:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eA Matcher constructed from a BitSet for org.apache.lucene.util.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417910_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417910_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:02:44+0000\'\u003e27\\/Jun\\/06 05:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    A Matcher constructed from a BitSet for org.apache.lucene.util.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417912\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417912&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417912\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417912_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417912_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:05:25+0000\'\u003e27\\/Jun\\/06 05:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSortedVIntList.java for org.apache.lucene.util superseding the one in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-328\\\" title=\\\"Some utilities for a compact sparse filter\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-328\\\"\u003e\u003cdel\u003eLUCENE-328\u003c\\/del\u003e\u003c\\/a\u003e. Has a getMatcher() method.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417912_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417912_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:05:25+0000\'\u003e27\\/Jun\\/06 05:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    SortedVIntList.java for org.apache.lucene.util superseding the one in   LUCENE-328  . Has a getMatcher() method.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417913\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417913&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417913\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417913_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417913_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:07:18+0000\'\u003e27\\/Jun\\/06 05:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eTestSortedVIntList.java, superseding the one in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-328\\\" title=\\\"Some utilities for a compact sparse filter\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-328\\\"\u003e\u003cdel\u003eLUCENE-328\u003c\\/del\u003e\u003c\\/a\u003e testing the Matcher provided by a SortedVIntList.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417913_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417913_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:07:18+0000\'\u003e27\\/Jun\\/06 05:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    TestSortedVIntList.java, superseding the one in   LUCENE-328   testing the Matcher provided by a SortedVIntList.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417914\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417914&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417914\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417914_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417914_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:09:06+0000\'\u003e27\\/Jun\\/06 05:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-328\\\" title=\\\"Some utilities for a compact sparse filter\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-328\\\"\u003e\u003cdel\u003eLUCENE-328\u003c\\/del\u003e\u003c\\/a\u003e is superseded by this issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417914_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417914_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:09:06+0000\'\u003e27\\/Jun\\/06 05:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                      LUCENE-328   is superseded by this issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12417917\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12417917&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12417917\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417917_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417917_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:22:26+0000\'\u003e27\\/Jun\\/06 05:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI hope I got all the attachments right, please holler in case something does not patch or compile cleanly.\u003c\\/p\u003e\\n\\n\u003cp\u003eSome questions\\/remarks:\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eWhen IndexSearcher gets a BitSet from a Filter, it will not use skipTo() on the Scorer\u003cbr\\/\u003e\\nof the Query being filtered.\u003cbr\\/\u003e\\nThis still allows to use the 1.4 BooleanScorer until Filter.getBits() is removed.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eOk. not to add match() method(s) to Searcher\\/Searchable ?\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eBitSetIterator of \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-15\\\" title=\\\"OpenBitSet\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-15\\\"\u003e\u003cdel\u003eSOLR-15\u003c\\/del\u003e\u003c\\/a\u003e could implement a Matcher, and perhaps to be added to org.apache.lucene.util ?\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eMatcher as superclass of Scorer opens possibility to add BooleanQuery.add(Filter) method.\u003cbr\\/\u003e\\nThis also needs the addition of required Matchers to ConjunctionScorer and the addition of prohibited Matchers at ReqExclScorer\\/DisjunctionScorer.\u003cbr\\/\u003e\\nDoing this filtering in ConjunctionScorer\\/ReqExclScorer will probably reduce the number of method calls for filtering.\u003cbr\\/\u003e\\nOnce such an addition is done to BooleanQuery, the filtering methods in IndexSearcher could be deprecated in favour of BooleanQuery.add(Filter).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eRegards,\u003cbr\\/\u003e\\nPaul Elschot\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12417917_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12417917_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/06 05:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-27T05:22:26+0000\'\u003e27\\/Jun\\/06 05:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I hope I got all the attachments right, please holler in case something does not patch or compile cleanly. \\n\\n Some questions\\/remarks: \\n\\n \\n\\t When IndexSearcher gets a BitSet from a Filter, it will not use skipTo() on the Scorer \\nof the Query being filtered. \\nThis still allows to use the 1.4 BooleanScorer until Filter.getBits() is removed. \\n \\n\\n\\n \\n\\t Ok. not to add match() method(s) to Searcher\\/Searchable ? \\n \\n\\n\\n \\n\\t BitSetIterator of   SOLR-15   could implement a Matcher, and perhaps to be added to org.apache.lucene.util ? \\n \\n\\n\\n \\n\\t Matcher as superclass of Scorer opens possibility to add BooleanQuery.add(Filter) method. \\nThis also needs the addition of required Matchers to ConjunctionScorer and the addition of prohibited Matchers at ReqExclScorer\\/DisjunctionScorer. \\nDoing this filtering in ConjunctionScorer\\/ReqExclScorer will probably reduce the number of method calls for filtering. \\nOnce such an addition is done to BooleanQuery, the filtering methods in IndexSearcher could be deprecated in favour of BooleanQuery.add(Filter). \\n \\n\\n\\n Regards, \\nPaul Elschot              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12418141\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12418141&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12418141\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12418141_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418141_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/06 05:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-28T05:46:59+0000\'\u003e28\\/Jun\\/06 05:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'ve started to improve the javadocs of almost all code posted here, so it\'s probably not worthwhile to commit this as it is now.\u003cbr\\/\u003e\\nI don\'t expect changes to the java code in the short term.\u003c\\/p\u003e\\n\\n\u003cp\u003eRegards,\u003cbr\\/\u003e\\nPaul Elschot\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12418141_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418141_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/06 05:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-28T05:46:59+0000\'\u003e28\\/Jun\\/06 05:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'ve started to improve the javadocs of almost all code posted here, so it\'s probably not worthwhile to commit this as it is now. \\nI don\'t expect changes to the java code in the short term. \\n\\n Regards, \\nPaul Elschot \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12418177\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12418177&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12418177\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12418177_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418177_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/06 12:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-28T12:47:30+0000\'\u003e28\\/Jun\\/06 12:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAny toughts on adding OpenBitSet from solr here? \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12418177_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418177_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/06 12:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-28T12:47:30+0000\'\u003e28\\/Jun\\/06 12:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Any toughts on adding OpenBitSet from solr here?               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12418185\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12418185&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12418185\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12418185_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418185_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/06 14:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-28T14:19:18+0000\'\u003e28\\/Jun\\/06 14:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatches against trunk revision 417683, current.\u003cbr\\/\u003e\\nCompared to previous patches\\/files, there are only javadoc updates,\u003cbr\\/\u003e\\nand the javadocs of Searchable are also patched.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12418185_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418185_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/06 14:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-28T14:19:18+0000\'\u003e28\\/Jun\\/06 14:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patches against trunk revision 417683, current. \\nCompared to previous patches\\/files, there are only javadoc updates, \\nand the javadocs of Searchable are also patched. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12418318\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12418318&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12418318\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12418318_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418318_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/06 04:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-29T04:08:02+0000\'\u003e29\\/Jun\\/06 04:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAdded some javadocs to BitsMatcher.\u003cbr\\/\u003e\\nAdded Matcher constructor to SortedVIntList, and extended the test for this.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12418318_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418318_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/06 04:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-06-29T04:08:02+0000\'\u003e29\\/Jun\\/06 04:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Added some javadocs to BitsMatcher. \\nAdded Matcher constructor to SortedVIntList, and extended the test for this.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12418842\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12418842&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12418842\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12418842_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418842_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jul\\/06 17:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-02T17:53:39+0000\'\u003e02\\/Jul\\/06 17:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePerhaps the BitsMatcher class is better implemented as a static method in a new class MatcherUtils.createMatcher(BitSet).\u003cbr\\/\u003e\\nSimilar methods could be added for OpenBitSet, SortedVIntList, int[] and whatever data structure comes around for implementing Filter.getMatcher(IndexReader).\u003cbr\\/\u003e\\nWhen Matcher is a superclass of Scorer, TermScorer already implements a Matcher for TermDocs.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12418842_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12418842_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jul\\/06 17:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-02T17:53:39+0000\'\u003e02\\/Jul\\/06 17:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Perhaps the BitsMatcher class is better implemented as a static method in a new class MatcherUtils.createMatcher(BitSet). \\nSimilar methods could be added for OpenBitSet, SortedVIntList, int[] and whatever data structure comes around for implementing Filter.getMatcher(IndexReader). \\nWhen Matcher is a superclass of Scorer, TermScorer already implements a Matcher for TermDocs.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12431664\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12431664&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12431664\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12431664_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431664_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 19:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T19:31:00+0000\'\u003e30\\/Aug\\/06 19:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs requested on java-dev, Matcher20060830.patch is the whole thing as a single patch, relative to srv\\/java\\/org\\/apache\\/lucene in the trunk, revision 438598 of 30 August 2006.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis does not contain the FIXME the earlier posted Filter-20060628.patch .\u003cbr\\/\u003e\\nThis FIXME code can be used to test that IndexSearcher works correctly with a BitsMatcher filter instead of with the current BitSet filter.\u003c\\/p\u003e\\n\\n\u003cp\u003eRegards,\u003cbr\\/\u003e\\nPaul Elschot\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12431664_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431664_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 19:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T19:31:00+0000\'\u003e30\\/Aug\\/06 19:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As requested on java-dev, Matcher20060830.patch is the whole thing as a single patch, relative to srv\\/java\\/org\\/apache\\/lucene in the trunk, revision 438598 of 30 August 2006. \\n\\n This does not contain the FIXME the earlier posted Filter-20060628.patch . \\nThis FIXME code can be used to test that IndexSearcher works correctly with a BitsMatcher filter instead of with the current BitSet filter. \\n\\n Regards, \\nPaul Elschot              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12431684\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12431684&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12431684\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12431684_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431684_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 20:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T20:47:37+0000\'\u003e30\\/Aug\\/06 20:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Paul,\u003cbr\\/\u003e\\nI like the Matcher\\/Scorer relation.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt looks like no Filters currently return a matcher, so the current patch just lays the groundwork, right?\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen some filters do start to return a matcher, it looks like support for the 1.4 BooleanScorer needs to be removed, or a check done in IndexSearcher.search() to disable skipping on the scorer if it\'s in use.\u003c\\/p\u003e\\n\\n\u003cp\u003eI wonder what the performance impact is... for a dense search with a dense bitset filter, it looks like quite a bit of overhead is added (two calls in order to get the next doc, use of nextSetBit() instead of get(), checking \\\"exhausted\\\" each time and checking for -1 to set exhausted).  I suppose one can always drop back to using a HitCollector for special cases though.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12431684_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431684_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 20:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T20:47:37+0000\'\u003e30\\/Aug\\/06 20:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Paul, \\nI like the Matcher\\/Scorer relation. \\n\\n It looks like no Filters currently return a matcher, so the current patch just lays the groundwork, right? \\n\\n When some filters do start to return a matcher, it looks like support for the 1.4 BooleanScorer needs to be removed, or a check done in IndexSearcher.search() to disable skipping on the scorer if it\'s in use. \\n\\n I wonder what the performance impact is... for a dense search with a dense bitset filter, it looks like quite a bit of overhead is added (two calls in order to get the next doc, use of nextSetBit() instead of get(), checking \\\"exhausted\\\" each time and checking for -1 to set exhausted).  I suppose one can always drop back to using a HitCollector for special cases though.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12431685\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12431685&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12431685\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12431685_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431685_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 20:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T20:52:05+0000\'\u003e30\\/Aug\\/06 20:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMatcher20060830b.patch corrects 2 mistakes in Matcher20060830.patch:\u003cbr\\/\u003e\\nSearchable.java was present twice, and TestSortedVIntList was not present.\u003cbr\\/\u003e\\nThanks eks for pointing out the mistake.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis patch was generated from the trunk directory.\u003c\\/p\u003e\\n\\n\u003cp\u003eRegards,\u003cbr\\/\u003e\\nPaul Elschot\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12431685_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431685_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 20:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T20:52:05+0000\'\u003e30\\/Aug\\/06 20:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Matcher20060830b.patch corrects 2 mistakes in Matcher20060830.patch: \\nSearchable.java was present twice, and TestSortedVIntList was not present. \\nThanks eks for pointing out the mistake. \\n\\n This patch was generated from the trunk directory. \\n\\n Regards, \\nPaul Elschot              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12431696\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12431696&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12431696\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12431696_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431696_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T21:18:03+0000\'\u003e30\\/Aug\\/06 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYonik, as to you questions:\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; It looks like no Filters currently return a matcher, so the current patch just lays the groundwork, right?\u003c\\/p\u003e\\n\\n\u003cp\u003eRight. Only the previous Filter-20060628.patch contains some commented FIXME code to actually introduce a BitsMatcher in each case where a BitSet is used.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt;When some filters do start to return a matcher, it looks like support for the 1.4 BooleanScorer needs\u003cbr\\/\u003e\\n&gt; to be removed, or a check done in IndexSearcher.search() to disable skipping on the scorer if it\'s in use.\u003c\\/p\u003e\\n\\n\u003cp\u003eIirc the patch still supports the 1.4 BooleanScorer when a BitSet is returned by Filter. I\'d have to have a look at the patched IndexSearcher to be sure though.\u003cbr\\/\u003e\\nA BitSet is randomly addressable, so it can work to filter the 1.4 BooleanScorer which can score documents out of order.  This case can be deprecated completely by also deprecating the possibility to use the 1.4 boolean scorer, but that is not in the patch. The patch only deprecates the Filter.bits() method.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e&gt; I wonder what the performance impact is... for a dense search with a dense bitset\u003cbr\\/\u003e\\n&gt; filter, it looks like quite a bit of overhead is added (two calls in order to get the next \u003cbr\\/\u003e\\n&gt; doc, use of nextSetBit() instead of get(), checking \\\"exhausted\\\" each time and \u003cbr\\/\u003e\\n&gt; checking for -1 to set exhausted). I suppose one can always drop back to using\u003cbr\\/\u003e\\n&gt; a HitCollector for special cases though.\u003c\\/p\u003e\\n\\n\u003cp\u003eBitsMatcher could also work without the \\\"exhausted\\\" flag, but then an infinite loop\u003cbr\\/\u003e\\nmight occur when trying to continue after the first time next() or skipTo() returned false.\u003cbr\\/\u003e\\nContinuing after false was returned in these cases is a bug, however an infinite loop\u003cbr\\/\u003e\\ncan be difficult to debug. I\'d rather be on the safe side of that with the exhausted flag and wait for an actual profile to show the performance problem.\u003c\\/p\u003e\\n\\n\u003cp\u003eRegards,\u003cbr\\/\u003e\\nPaul Elschot\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12431696_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431696_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T21:18:03+0000\'\u003e30\\/Aug\\/06 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Yonik, as to you questions: \\n\\n &gt; It looks like no Filters currently return a matcher, so the current patch just lays the groundwork, right? \\n\\n Right. Only the previous Filter-20060628.patch contains some commented FIXME code to actually introduce a BitsMatcher in each case where a BitSet is used. \\n\\n &gt;When some filters do start to return a matcher, it looks like support for the 1.4 BooleanScorer needs \\n&gt; to be removed, or a check done in IndexSearcher.search() to disable skipping on the scorer if it\'s in use. \\n\\n Iirc the patch still supports the 1.4 BooleanScorer when a BitSet is returned by Filter. I\'d have to have a look at the patched IndexSearcher to be sure though. \\nA BitSet is randomly addressable, so it can work to filter the 1.4 BooleanScorer which can score documents out of order.  This case can be deprecated completely by also deprecating the possibility to use the 1.4 boolean scorer, but that is not in the patch. The patch only deprecates the Filter.bits() method. \\n\\n\\n &gt; I wonder what the performance impact is... for a dense search with a dense bitset \\n&gt; filter, it looks like quite a bit of overhead is added (two calls in order to get the next  \\n&gt; doc, use of nextSetBit() instead of get(), checking \\\"exhausted\\\" each time and  \\n&gt; checking for -1 to set exhausted). I suppose one can always drop back to using \\n&gt; a HitCollector for special cases though. \\n\\n BitsMatcher could also work without the \\\"exhausted\\\" flag, but then an infinite loop \\nmight occur when trying to continue after the first time next() or skipTo() returned false. \\nContinuing after false was returned in these cases is a bug, however an infinite loop \\ncan be difficult to debug. I\'d rather be on the safe side of that with the exhausted flag and wait for an actual profile to show the performance problem. \\n\\n Regards, \\nPaul Elschot              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12431702\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12431702&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12431702\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12431702_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431702_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 21:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T21:26:10+0000\'\u003e30\\/Aug\\/06 21:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eusing the latest Matcher20060830.patch \u003c\\/p\u003e\\n\\n\u003cp\u003eant said \\\"BUILD SUCCESSFUL\\\" \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/wink.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eI will see how it works on some real life cases using our 50Mio collection and report back what our standard app level tests  have to say (we have standardized collection \\/requsts\\/hits so bad things should pop -up quickly). Need a day or two for this.\u003c\\/p\u003e\\n\\n\u003cp\u003ethanks for this work. \u003cbr\\/\u003e\\ne. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12431702_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12431702_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/06 21:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-08-30T21:26:10+0000\'\u003e30\\/Aug\\/06 21:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    using the latest Matcher20060830.patch  \\n\\n ant said \\\"BUILD SUCCESSFUL\\\"   \\n\\n I will see how it works on some real life cases using our 50Mio collection and report back what our standard app level tests  have to say (we have standardized collection \\/requsts\\/hits so bad things should pop -up quickly). Need a day or two for this. \\n\\n thanks for this work.  \\ne.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12432378\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12432378&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12432378\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12432378_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12432378_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Sep\\/06 20:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-03T20:35:02+0000\'\u003e03\\/Sep\\/06 20:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Paul,\u003cbr\\/\u003e\\nfor me, this patch did not cause any incompatibility issues. All our tests passed without noticing any difference to the previous trunk version. No performance changes as well ( we use HitCollector only, so Yoniks comment does not apply here).\u003cbr\\/\u003e\\nTests are application level, and make index hot (6hrs searches with test batch of requests with known responses), 50Mio not artificial docs, real requests...\u003c\\/p\u003e\\n\\n\u003cp\u003eEarly this week we will try to implement our first Matchers and see how they behave\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12432378_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12432378_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Sep\\/06 20:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-03T20:35:02+0000\'\u003e03\\/Sep\\/06 20:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Paul, \\nfor me, this patch did not cause any incompatibility issues. All our tests passed without noticing any difference to the previous trunk version. No performance changes as well ( we use HitCollector only, so Yoniks comment does not apply here). \\nTests are application level, and make index hot (6hrs searches with test batch of requests with known responses), 50Mio not artificial docs, real requests... \\n\\n Early this week we will try to implement our first Matchers and see how they behave \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12432435\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12432435&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12432435\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12432435_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12432435_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Sep\\/06 06:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-04T06:46:42+0000\'\u003e04\\/Sep\\/06 06:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; No performance changes as well.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt\'s good to hear that. As mentioned earlier, this is groundwork only.\u003cbr\\/\u003e\\nOnce an actual Matcher is used I expect some some performance differences to show up.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhich comment of Yonik related to HitCollector do you mean?\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; Early this week we will try to implement our first Matchers and see how they behave \u003c\\/p\u003e\\n\\n\u003cp\u003eBitsMatcher and SortedVIntList could start that.\u003cbr\\/\u003e\\nAlso I\'d like to see one on Solr\'s OpenBitSet...\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12432435_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12432435_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Sep\\/06 06:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-04T06:46:42+0000\'\u003e04\\/Sep\\/06 06:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; No performance changes as well. \\n\\n It\'s good to hear that. As mentioned earlier, this is groundwork only. \\nOnce an actual Matcher is used I expect some some performance differences to show up. \\n\\n Which comment of Yonik related to HitCollector do you mean? \\n\\n &gt; Early this week we will try to implement our first Matchers and see how they behave  \\n\\n BitsMatcher and SortedVIntList could start that. \\nAlso I\'d like to see one on Solr\'s OpenBitSet... \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12432497\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12432497&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12432497\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12432497_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12432497_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Sep\\/06 11:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-04T11:41:44+0000\'\u003e04\\/Sep\\/06 11:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePaul,\u003cbr\\/\u003e\\nWhat is exact semantics of skipTo(int) in Matcher?\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eis it OK to skip back and forth before I reach end?\u003cbr\\/\u003e\\ne.g.: skipTo(0); skipTo(333); skipTo(0); \u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eonce I reach end, skipTo(int) does nothing (BitsMatcher, exhausted). It is impossible to reposition Matcher after that\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eIs this intended behavior, \\\"skip forward until you reach end, and then, you are at the end \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\\\" ? \u003c\\/p\u003e\\n\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12432497_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12432497_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Sep\\/06 11:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-04T11:41:44+0000\'\u003e04\\/Sep\\/06 11:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Paul, \\nWhat is exact semantics of skipTo(int) in Matcher? \\n\\n \\n\\t is it OK to skip back and forth before I reach end? \\ne.g.: skipTo(0); skipTo(333); skipTo(0);  \\n \\n\\n\\n \\n\\t once I reach end, skipTo(int) does nothing (BitsMatcher, exhausted). It is impossible to reposition Matcher after that \\n \\n\\n\\n Is this intended behavior, \\\"skip forward until you reach end, and then, you are at the end  \\\" ?  \\n\\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12432547\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12432547&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12432547\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12432547_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12432547_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Sep\\/06 21:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-04T21:02:22+0000\'\u003e04\\/Sep\\/06 21:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere are some Matcher implementations,\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eOpenBitsMatcher- the same as the code Paul wrote for BitsMatcher, with replaced OpenBitSet instead\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e-DenseOpenBitsMatcher  - Using solr BitSetIterator (for skipTo() to work, one method in BitSetIterator should become public)\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso attached one simple  test (just basic fuctionality) that also contains one dummy relative performance  test \u003c\\/p\u003e\\n\\n\u003cp\u003ePerf. test simply iterates over different Matcher implementations  and measures ellapsed time (not including Matcher creation, pure forward scan to the end) for different set bit densities.\u003c\\/p\u003e\\n\\n\u003cp\u003eimho, this code is not sufficiantly tested nor commented, needs an hour or two.  \u003c\\/p\u003e\\n\\n\u003cp\u003eAs expected, Yonik made this ButSetIterator really fast. What was surprise for me was OpenBitSet nextSetBit() comparing bad to the BitSet  (or I made some dummy mistake somewhere?)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12432547_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12432547_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Sep\\/06 21:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-04T21:02:22+0000\'\u003e04\\/Sep\\/06 21:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here are some Matcher implementations, \\n\\n \\n\\t OpenBitsMatcher- the same as the code Paul wrote for BitsMatcher, with replaced OpenBitSet instead \\n \\n\\n\\n -DenseOpenBitsMatcher  - Using solr BitSetIterator (for skipTo() to work, one method in BitSetIterator should become public) \\n\\n Also attached one simple  test (just basic fuctionality) that also contains one dummy relative performance  test  \\n\\n Perf. test simply iterates over different Matcher implementations  and measures ellapsed time (not including Matcher creation, pure forward scan to the end) for different set bit densities. \\n\\n imho, this code is not sufficiantly tested nor commented, needs an hour or two.   \\n\\n As expected, Yonik made this ButSetIterator really fast. What was surprise for me was OpenBitSet nextSetBit() comparing bad to the BitSet  (or I made some dummy mistake somewhere?)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12434637\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12434637&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12434637\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12434637_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434637_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Sep\\/06 10:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-14T10:12:15+0000\'\u003e14\\/Sep\\/06 10:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePaul,\u003cbr\\/\u003e\\nWhat is next now, we did on our app enough experiments and are now sure that this patch causes no incompatibilities. \u003cbr\\/\u003e\\nWe also tried to replace our filters with OpenBitSet and VInt matchers and results there are more than good, our app showed crazy  30% speed-up!!! Hard to identify where from exactly, but I suspect VInt matcher in case of not too dense BitVectors increased our Filter Cache utilization significantly.\u003c\\/p\u003e\\n\\n\u003cp\u003eI would propose to commit this patch before we go further with something that would actually utilize Matcher. Just to avoid creating monster patch on patch ... \u003c\\/p\u003e\\n\\n\u003cp\u003eThis is ground work, and now using Matcher will be pure poetry, I see a lot of places we could see beter life by using use Matchers, ConstantScoringQuery, PreffixFilter, ChainedFilter (becomes obsolete now)... actually replace all uses of BitSet with OpenBitSet (or a bit smarter with SortedIntList. VInt...)...\u003cbr\\/\u003e\\nThan question here, do we create dependancy to Solr from Lucene, or we \\\"migrate\\\" OpenBitSet to Lucene (as this dependancy allready exists) or we copy-paste and have two OpenBitSets, Yonik? As far as I am concerned, makes no real diference.\u003c\\/p\u003e\\n\\n\u003cp\u003eDo you, or someone else see now things to be done before commiting this? \u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12434637_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434637_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Sep\\/06 10:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-14T10:12:15+0000\'\u003e14\\/Sep\\/06 10:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Paul, \\nWhat is next now, we did on our app enough experiments and are now sure that this patch causes no incompatibilities.  \\nWe also tried to replace our filters with OpenBitSet and VInt matchers and results there are more than good, our app showed crazy  30% speed-up!!! Hard to identify where from exactly, but I suspect VInt matcher in case of not too dense BitVectors increased our Filter Cache utilization significantly. \\n\\n I would propose to commit this patch before we go further with something that would actually utilize Matcher. Just to avoid creating monster patch on patch ...  \\n\\n This is ground work, and now using Matcher will be pure poetry, I see a lot of places we could see beter life by using use Matchers, ConstantScoringQuery, PreffixFilter, ChainedFilter (becomes obsolete now)... actually replace all uses of BitSet with OpenBitSet (or a bit smarter with SortedIntList. VInt...)... \\nThan question here, do we create dependancy to Solr from Lucene, or we \\\"migrate\\\" OpenBitSet to Lucene (as this dependancy allready exists) or we copy-paste and have two OpenBitSets, Yonik? As far as I am concerned, makes no real diference. \\n\\n Do you, or someone else see now things to be done before commiting this?  \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12434763\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12434763&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12434763\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12434763_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434763_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Sep\\/06 18:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-14T18:40:42+0000\'\u003e14\\/Sep\\/06 18:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; Do you, or someone else see now things to be done before commiting this?\u003c\\/p\u003e\\n\\n\u003cp\u003eYes. In the steps listed here:\u003cbr\\/\u003e\\n\u003ca href=\\\"http:\\/\\/wiki.apache.org\\/jakarta-lucene\\/HowToContribute\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/wiki.apache.org\\/jakarta-lucene\\/HowToContribute\u003c\\/a\u003e\u003cbr\\/\u003e\\nthe next step is to be patient.\u003cbr\\/\u003e\\nWether being patient is something that can be done\u003cbr\\/\u003e\\nis open question...\u003c\\/p\u003e\\n\\n\u003cp\u003ePaul Elschot.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12434763_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434763_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Sep\\/06 18:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-14T18:40:42+0000\'\u003e14\\/Sep\\/06 18:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; Do you, or someone else see now things to be done before commiting this? \\n\\n Yes. In the steps listed here: \\n http:\\/\\/wiki.apache.org\\/jakarta-lucene\\/HowToContribute  \\nthe next step is to be patient. \\nWether being patient is something that can be done \\nis open question... \\n\\n Paul Elschot. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12434901\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12434901&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12434901\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12434901_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434901_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Sep\\/06 07:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-15T07:04:21+0000\'\u003e15\\/Sep\\/06 07:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIn the inheritance from Matcher to Scorer there is an asymmetry\u003cbr\\/\u003e\\nin this patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eMatcher provides a default implementation for Matcher.explain()\u003cbr\\/\u003e\\nbut Scorer does not, and this might lead to unexpected surprises\u003cbr\\/\u003e\\nfor future Scorers when the current Matcher.explain() is used.\u003cbr\\/\u003e\\nOne could add an abstract Scorer.explain() to catch these, or\u003cbr\\/\u003e\\nprovide a default implementation for Scorer.explain().\u003c\\/p\u003e\\n\\n\u003cp\u003eWith matcher implementations quite a few other implementation\u003cbr\\/\u003e\\ndecisions need to be taken. \u003cbr\\/\u003e\\nAlso any place in the current code where a Scorer is used, but none\u003cbr\\/\u003e\\nof the Scorer.score() methods, is a candidate for a change from\u003cbr\\/\u003e\\nScorer to Matcher.\u003cbr\\/\u003e\\nThis will be mostly the current filtering implementations,\u003cbr\\/\u003e\\nbut ConstantScoringQuery is another nice example.\u003c\\/p\u003e\\n\\n\u003cp\u003eRegards,\u003cbr\\/\u003e\\nPaul Elschot\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12434901_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434901_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Sep\\/06 07:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-15T07:04:21+0000\'\u003e15\\/Sep\\/06 07:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    In the inheritance from Matcher to Scorer there is an asymmetry \\nin this patch. \\n\\n Matcher provides a default implementation for Matcher.explain() \\nbut Scorer does not, and this might lead to unexpected surprises \\nfor future Scorers when the current Matcher.explain() is used. \\nOne could add an abstract Scorer.explain() to catch these, or \\nprovide a default implementation for Scorer.explain(). \\n\\n With matcher implementations quite a few other implementation \\ndecisions need to be taken.  \\nAlso any place in the current code where a Scorer is used, but none \\nof the Scorer.score() methods, is a candidate for a change from \\nScorer to Matcher. \\nThis will be mostly the current filtering implementations, \\nbut ConstantScoringQuery is another nice example. \\n\\n Regards, \\nPaul Elschot              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12437242\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12437242&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12437242\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12437242_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12437242_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Sep\\/06 19:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-24T19:27:00+0000\'\u003e24\\/Sep\\/06 19:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI wrote:\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; One could add an abstract Scorer.explain() to catch these, or\u003cbr\\/\u003e\\n&gt; provide a default implementation for Scorer.explain().\u003c\\/p\u003e\\n\\n\u003cp\u003eby mistake. The good news is that the patch leaves the \u003cbr\\/\u003e\\nthe existing abstract Scorer.explain() method unaffected.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12437242_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12437242_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Sep\\/06 19:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-24T19:27:00+0000\'\u003e24\\/Sep\\/06 19:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I wrote: \\n\\n &gt; One could add an abstract Scorer.explain() to catch these, or \\n&gt; provide a default implementation for Scorer.explain(). \\n\\n by mistake. The good news is that the patch leaves the  \\nthe existing abstract Scorer.explain() method unaffected.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446365\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12446365&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446365\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12446365_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446365_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 20:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T20:01:24+0000\'\u003e01\\/Nov\\/06 20:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCorrected javadoc refs to use IndexInput and IndexOutput.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12446365_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446365_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 20:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T20:01:24+0000\'\u003e01\\/Nov\\/06 20:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Corrected javadoc refs to use IndexInput and IndexOutput.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12450715\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12450715&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12450715\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12450715_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12450715_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Nov\\/06 12:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-17T12:26:19+0000\'\u003e17\\/Nov\\/06 12:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have just resolved some minor local conflicts on the updated copyrights of four java  files.\u003cbr\\/\u003e\\nPlease holler when a fresh  patch is needed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12450715_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12450715_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Nov\\/06 12:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-17T12:26:19+0000\'\u003e17\\/Nov\\/06 12:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have just resolved some minor local conflicts on the updated copyrights of four java  files. \\nPlease holler when a fresh  patch is needed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12475981\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12475981&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12475981\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12475981_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12475981_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Feb\\/07 20:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-02-26T20:03:43+0000\'\u003e26\\/Feb\\/07 20:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs 2.1 is out, here is a new patch to try and revive this.\u003cbr\\/\u003e\\nThis replaces the pevious Matcheryyyymmdd.patch one of 2006\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12475981_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12475981_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Feb\\/07 20:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-02-26T20:03:43+0000\'\u003e26\\/Feb\\/07 20:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As 2.1 is out, here is a new patch to try and revive this. \\nThis replaces the pevious Matcheryyyymmdd.patch one of 2006              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12481263\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12481263&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12481263\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_12481263_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12481263_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/07 18:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-15T18:06:40+0000\'\u003e15\\/Mar\\/07 18:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIt\'s been a while since i looked at this issue, but it\'s come up in discussion recently so i took another glance...\u003c\\/p\u003e\\n\\n\u003cp\u003ePaul: I notice Filter.getMatcher returns null, and IndexSearcher tests for that and uses it to decide whether or not to iterator over the (non null) Matcher, or over the BitSet from Filter.bits.  is there any reason that logic can\'t be put in getMatcher, so that if subclasses of Filter don\'t override the getMatcher method it will call bits and then return a Matcher that iterates over the set Bits?\u003c\\/p\u003e\\n\\n\u003cp\u003e(this is the roll-out approach i advocated a while back when discussing this on email, excecept that at the time Matcher was refered to as SearchFilter: \u003ca href=\\\"http:\\/\\/www.nabble.com\\/RE%3A-Filter-p2605271.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.nabble.com\\/RE%3A-Filter-p2605271.html\u003c\\/a\u003e )\u003c\\/p\u003e\\n\\n\u003cp\u003eThinking about it now, we could even change Filter.bits so it\'s no longer abstract ... it could have an implementation that would call getMatcher, and iterate over all of the matched docs setting bits on a BitSet that is then returned ... the class would still be abstract, and the class javadocs  would make it clear that subclasses must override at least one of the methods ... legacy Filters will work fine because they\'ll already have a bits method, and people writing new Filters will see that bits is deprecated, so they\'ll just write a getMatcher method and be done.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis appears to be the same approach taken with Analyzer.tokenStream back in 1.4.3...\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"http:\\/\\/lucene.apache.org\\/java\\/1_4_3\\/api\\/org\\/apache\\/lucene\\/analysis\\/Analyzer.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/lucene.apache.org\\/java\\/1_4_3\\/api\\/org\\/apache\\/lucene\\/analysis\\/Analyzer.html\u003c\\/a\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_12481263_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12481263_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/07 18:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-15T18:06:40+0000\'\u003e15\\/Mar\\/07 18:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    It\'s been a while since i looked at this issue, but it\'s come up in discussion recently so i took another glance... \\n\\n Paul: I notice Filter.getMatcher returns null, and IndexSearcher tests for that and uses it to decide whether or not to iterator over the (non null) Matcher, or over the BitSet from Filter.bits.  is there any reason that logic can\'t be put in getMatcher, so that if subclasses of Filter don\'t override the getMatcher method it will call bits and then return a Matcher that iterates over the set Bits? \\n\\n (this is the roll-out approach i advocated a while back when discussing this on email, excecept that at the time Matcher was refered to as SearchFilter:  http:\\/\\/www.nabble.com\\/RE%3A-Filter-p2605271.html  ) \\n\\n Thinking about it now, we could even change Filter.bits so it\'s no longer abstract ... it could have an implementation that would call getMatcher, and iterate over all of the matched docs setting bits on a BitSet that is then returned ... the class would still be abstract, and the class javadocs  would make it clear that subclasses must override at least one of the methods ... legacy Filters will work fine because they\'ll already have a bits method, and people writing new Filters will see that bits is deprecated, so they\'ll just write a getMatcher method and be done. \\n\\n This appears to be the same approach taken with Analyzer.tokenStream back in 1.4.3... \\n\\n  http:\\/\\/lucene.apache.org\\/java\\/1_4_3\\/api\\/org\\/apache\\/lucene\\/analysis\\/Analyzer.html               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12481734\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12481734&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12481734\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12481734_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12481734_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Mar\\/07 19:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-16T19:09:25+0000\'\u003e16\\/Mar\\/07 19:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHoss,\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt;Paul: I notice Filter.getMatcher returns null, and IndexSearcher tests for that and uses\u003cbr\\/\u003e\\n&gt; it to decide whether or not to iterator over the (non null) Matcher, or over the BitSet\u003cbr\\/\u003e\\n&gt; from Filter.bits. is there any reason that logic can\'t be put in getMatcher, so that if\u003cbr\\/\u003e\\n&gt; subclasses of Filter don\'t override the getMatcher method it will call bits and then\u003cbr\\/\u003e\\n&gt; return a Matcher that iterates over the set Bits?\u003c\\/p\u003e\\n\\n\u003cp\u003eTwo reasons:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003euncertainty over performance of a Matcher instead of a BitSet,\u003c\\/li\u003e\\n\\t\u003cli\u003ethis way backward compatibility very easily guaranteed.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eThere is also \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-730\\\" title=\\\"Restore top level disjunction performance\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-730\\\"\u003e\u003cdel\u003eLUCENE-730\u003c\\/del\u003e\u003c\\/a\u003e, which may interfere with the removal of BitSet,\u003cbr\\/\u003e\\nsince it allows documents to be scored out of order. However, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-730\\\" title=\\\"Restore top level disjunction performance\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-730\\\"\u003e\u003cdel\u003eLUCENE-730\u003c\\/del\u003e\u003c\\/a\u003e\u003cbr\\/\u003e\\nshould only be used at the top level of a query search and without a Filter.\u003cbr\\/\u003e\\nI cannot think of an actual case in which there might be interference, but\u003cbr\\/\u003e\\nI may not have not looked into that deep enough.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; we could even change Filter.bits so it\'s no longer abstract ... it could have\u003cbr\\/\u003e\\n&gt; an implementation that would call getMatcher, and iterate over all of the matched\u003cbr\\/\u003e\\n&gt; docs setting bits on a BitSet that is then returned ... the class would still be\u003cbr\\/\u003e\\n&gt; abstract, and the class javadocs would make it clear that subclasses must override\u003cbr\\/\u003e\\n&gt; at least one of the methods...\u003c\\/p\u003e\\n\\n\u003cp\u003eI must say that creating a BitSet from a Matcher never occurred to me.\u003cbr\\/\u003e\\nAnyway, when Filter.bits() is deprecated I have no preference about how\u003cbr\\/\u003e\\nit is actually removed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12481734_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12481734_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Mar\\/07 19:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-16T19:09:25+0000\'\u003e16\\/Mar\\/07 19:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hoss, \\n\\n &gt;Paul: I notice Filter.getMatcher returns null, and IndexSearcher tests for that and uses \\n&gt; it to decide whether or not to iterator over the (non null) Matcher, or over the BitSet \\n&gt; from Filter.bits. is there any reason that logic can\'t be put in getMatcher, so that if \\n&gt; subclasses of Filter don\'t override the getMatcher method it will call bits and then \\n&gt; return a Matcher that iterates over the set Bits? \\n\\n Two reasons: \\n \\n\\t uncertainty over performance of a Matcher instead of a BitSet, \\n\\t this way backward compatibility very easily guaranteed. \\n \\n\\n\\n There is also   LUCENE-730  , which may interfere with the removal of BitSet, \\nsince it allows documents to be scored out of order. However,   LUCENE-730   \\nshould only be used at the top level of a query search and without a Filter. \\nI cannot think of an actual case in which there might be interference, but \\nI may not have not looked into that deep enough. \\n\\n &gt; we could even change Filter.bits so it\'s no longer abstract ... it could have \\n&gt; an implementation that would call getMatcher, and iterate over all of the matched \\n&gt; docs setting bits on a BitSet that is then returned ... the class would still be \\n&gt; abstract, and the class javadocs would make it clear that subclasses must override \\n&gt; at least one of the methods... \\n\\n I must say that creating a BitSet from a Matcher never occurred to me. \\nAnyway, when Filter.bits() is deprecated I have no preference about how \\nit is actually removed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12483724\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12483724&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12483724\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12483724_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483724_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Mar\\/07 19:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-23T19:54:04+0000\'\u003e23\\/Mar\\/07 19:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePaul:\u003cbr\\/\u003e\\nApplied the patch, applied cleanly, run ant test -&gt; BUILD SUCCESSFUL \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m primarily interested in using this in order to get matches, but avoid scoring.  From what I can tell, I\'d just need to switch to using the new match(Query, MatchCollector) method in IndexSearcher.  However, I need Sort and TopFieldDocs, and I don\'t see a match method with those.  Is there a reason why such a match method is not in the patch?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12483724_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483724_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Mar\\/07 19:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-23T19:54:04+0000\'\u003e23\\/Mar\\/07 19:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Paul: \\nApplied the patch, applied cleanly, run ant test -&gt; BUILD SUCCESSFUL   \\n\\n I\'m primarily interested in using this in order to get matches, but avoid scoring.  From what I can tell, I\'d just need to switch to using the new match(Query, MatchCollector) method in IndexSearcher.  However, I need Sort and TopFieldDocs, and I don\'t see a match method with those.  Is there a reason why such a match method is not in the patch?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12483731\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12483731&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12483731\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12483731_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483731_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Mar\\/07 20:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-23T20:13:25+0000\'\u003e23\\/Mar\\/07 20:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOtis:\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; However, I need Sort and TopFieldDocs, and I don\'t see a match method with those.\u003cbr\\/\u003e\\n&gt; Is there a reason why such a match method is not in the patch? \u003c\\/p\u003e\\n\\n\u003cp\u003eA bit silly perhaps, but what sort criterion would like to have used when no score() value is available?\u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t know the sorting code, but it might be possible to use a field value for sorting.\u003cbr\\/\u003e\\nIn that case the sorting code for a Matcher would need to check whether the sort criterion does\u003cbr\\/\u003e\\nnot imply the use of a score value.\u003cbr\\/\u003e\\nI personally have no use for sorting by field values, so that is why I never thought of combining this with a Matcher.\u003c\\/p\u003e\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12483731_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483731_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Mar\\/07 20:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-23T20:13:25+0000\'\u003e23\\/Mar\\/07 20:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Otis: \\n\\n &gt; However, I need Sort and TopFieldDocs, and I don\'t see a match method with those. \\n&gt; Is there a reason why such a match method is not in the patch?  \\n\\n A bit silly perhaps, but what sort criterion would like to have used when no score() value is available? \\n\\n I don\'t know the sorting code, but it might be possible to use a field value for sorting. \\nIn that case the sorting code for a Matcher would need to check whether the sort criterion does \\nnot imply the use of a score value. \\nI personally have no use for sorting by field values, so that is why I never thought of combining this with a Matcher. \\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12483868\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12483868&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12483868\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12483868_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483868_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Mar\\/07 19:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-24T19:39:59+0000\'\u003e24\\/Mar\\/07 19:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; BitsMatcher could also work without the \\\"exhausted\\\" flag, but then an infinite loop\u003cbr\\/\u003e\\n&gt; might occur when trying to continue after the first time next() or skipTo() returned false.\u003cbr\\/\u003e\\n&gt; Continuing after false was returned in these cases is a bug, however an infinite loop\u003cbr\\/\u003e\\n&gt; can be difficult to debug. I\'d rather be on the safe side of that with the exhausted flag and wait for an actual \u003cbr\\/\u003e\\n&gt; profile to show the performance problem.\u003c\\/p\u003e\\n\\n\u003cp\u003eWe know that matchers will be inner-loop stuff.  It seems like any scorers that call next() after false was returned should be fixed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12483868_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483868_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Mar\\/07 19:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-24T19:39:59+0000\'\u003e24\\/Mar\\/07 19:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; BitsMatcher could also work without the \\\"exhausted\\\" flag, but then an infinite loop \\n&gt; might occur when trying to continue after the first time next() or skipTo() returned false. \\n&gt; Continuing after false was returned in these cases is a bug, however an infinite loop \\n&gt; can be difficult to debug. I\'d rather be on the safe side of that with the exhausted flag and wait for an actual  \\n&gt; profile to show the performance problem. \\n\\n We know that matchers will be inner-loop stuff.  It seems like any scorers that call next() after false was returned should be fixed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12483894\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12483894&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12483894\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12483894_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483894_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Mar\\/07 23:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-24T23:15:55+0000\'\u003e24\\/Mar\\/07 23:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; We know that matchers will be inner-loop stuff. It seems like any scorers that call next() after false was returned should be fixed.\u003c\\/p\u003e\\n\\n\u003cp\u003eI fully agree. The \\\"exhausted\\\" flag is not much more than a matter of taste.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn case the speed advantage of removing this flag is preferred, I don\'t mind resolving the eventual conflict in my working copy.\u003cbr\\/\u003e\\nBut I don\'t know yet how I would resolve that conflict \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12483894_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483894_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Mar\\/07 23:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-24T23:15:55+0000\'\u003e24\\/Mar\\/07 23:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; We know that matchers will be inner-loop stuff. It seems like any scorers that call next() after false was returned should be fixed. \\n\\n I fully agree. The \\\"exhausted\\\" flag is not much more than a matter of taste. \\n\\n In case the speed advantage of removing this flag is preferred, I don\'t mind resolving the eventual conflict in my working copy. \\nBut I don\'t know yet how I would resolve that conflict                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12483895\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12483895&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12483895\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12483895_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483895_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Mar\\/07 23:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-24T23:22:40+0000\'\u003e24\\/Mar\\/07 23:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; In case the speed advantage of removing this flag is preferred, I don\'t mind resolving the eventual conflict in my\u003cbr\\/\u003e\\n&gt; working copy.  But I don\'t know yet how I would resolve that conflict \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eAh, that\'s a bit different.  You mean there are cases that are non-trivial to fix where next() is called after false is returned?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12483895_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12483895_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Mar\\/07 23:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-03-24T23:22:40+0000\'\u003e24\\/Mar\\/07 23:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; In case the speed advantage of removing this flag is preferred, I don\'t mind resolving the eventual conflict in my \\n&gt; working copy.  But I don\'t know yet how I would resolve that conflict   \\n\\n Ah, that\'s a bit different.  You mean there are cases that are non-trivial to fix where next() is called after false is returned?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487106\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487106&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487106\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487106_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487106_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Apr\\/07 21:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-05T21:33:18+0000\'\u003e05\\/Apr\\/07 21:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePerhaps I did something wrong with the benchmark, but I didn\'t get any speed-up when using searcher.match(Query, MatchCollector) vs. searcher.search(Query, HitCollector).\u003c\\/p\u003e\\n\\n\u003cp\u003eHere are the benchmark numbers (50000 queries with each), HitCollector first, MatchCollector second:\u003c\\/p\u003e\\n\\n\u003cp\u003eHITCOLLECTOR:\u003c\\/p\u003e\\n\\n\u003cp\u003e     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report Sum By (any) Name (11 about 41 out of 41)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation           round mrg buf   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Rounds_4                0  10  10        1       808020        787.5    1,026.04     7,217,624     17,780,736\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate -  -  -  -  -  - - - - - -  -   4 -  -  - 2003 -  -   129.9 -  -  61.67 -   9,938,986 -   13,821,952\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e CreateIndex             -   -   -        4            1          4.4        0.91     3,937,522     10,916,864\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000 -  -  -   - - - - - -  -   4 -  -  - 2000 -  -   138.1 -  -  57.92 -   9,368,584 -   13,821,952\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Optimize                -   -   -        4            1          1.4        2.83     9,938,218     13,821,952\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e CloseIndex -  -  -  -   - - - - - -  -   4 -  -  -  - 1 -  - 2,000.0 -  -   0.00 -   9,938,986 -   13,821,952\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e OpenReader              -   -   -        4            1         24.0        0.17     9,957,592     13,821,952\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_50000 -   - - - - - -  -   4 -  -   50000 -  - 1,070.3 -  - 186.86 -  10,500,146 -   13,821,952\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e CloseReader             -   -   -        4            1      4,000.0        0.00     9,059,756     13,821,952\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e WarmNewRdr_50 -  -  -   - - - - - -  -   4 -  -  100000 -   16,237.7 -  -  24.63 -   9,060,268 -   13,821,952\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchNewRdr_50000        -   -   -        4        50000        265.9      752.02    10,800,006     13,821,952\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report sum by Prefix (MAddDocs) and Round (4 about 4 out of 41)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation     round mrg buf   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000     0  10  10        1         2000         94.6       21.15     7,844,112     10,407,936\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000 -   1 100  10 -  -   1 -  -  - 2000 -  -   136.7 -  -  14.63 -   8,968,144 -   11,309,056\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000     2  10 100        1         2000        173.2       11.55    10,528,264     15,740,928\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000 -   3 100 100 -  -   1 -  -  - 2000 -  -   188.7 -  -  10.60 -  10,133,816 -   17,829,888\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eMATCHCOLLECTOR:\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report Sum By (any) Name (11 about 41 out of 41)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation           round mrg buf   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Rounds_4                0  10  10        1       808020        781.0    1,034.62    10,566,608     15,859,712\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate -  -  -  -  -  - - - - - -  -   4 -  -  - 2003 -  -   130.9 -  -  61.23 -  10,963,452 -   14,806,016\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e CreateIndex             -   -   -        4            1         33.9        0.12     3,616,570     11,020,288\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000 -  -  -   - - - - - -  -   4 -  -  - 2000 -  -   137.3 -  -  58.29 -  10,445,568 -   14,806,016\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Optimize                -   -   -        4            1          1.4        2.82    10,979,398     14,806,016\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e CloseIndex -  -  -  -   - - - - - -  -   4 -  -  -  - 1 -  - 2,000.0 -  -   0.00 -  10,963,452 -   14,806,016\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e OpenReader              -   -   -        4            1         22.0        0.18    10,982,058     14,806,016\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_50000 -   - - - - - -  -   4 -  -   50000 -  - 1,064.7 -  - 187.84 -  11,060,036 -   14,806,016\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e CloseReader             -   -   -        4            1      4,000.0        0.00    10,353,206     14,806,016\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e WarmNewRdr_50 -  -  -   - - - - - -  -   4 -  -  100000 -   16,419.0 -  -  24.36 -  10,431,062 -   14,806,016\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchNewRdr_50000        -   -   -        4        50000        263.0      760.34    11,912,358     14,806,016\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report sum by Prefix (MAddDocs) and Round (4 about 4 out of 41)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation     round mrg buf   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000     0  10  10        1         2000         92.2       21.69     7,844,112     10,407,936\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000 -   1 100  10 -  -   1 -  -  - 2000 -  -   136.6 -  -  14.64 -   7,720,352 -   10,407,936\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000     2  10 100        1         2000        167.8       11.92    11,325,952     17,571,840\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_2000 -   3 100 100 -  -   1 -  -  - 2000 -  -   199.3 -  -  10.03 -  14,891,856 -   20,836,352\u003c\\/p\u003e\\n\\n\\n\\n\u003cp\u003eThis is what I did for the benchmark.  I used Doron\'s handy conf\\/benchmark.\u003cbr\\/\u003e\\nI added a new .alg based on micro-standard.alg, here\'s the diff:\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e$ diff conf\\/micro-standard.alg conf\\/matcher-micro-standard.alg \u003cbr\\/\u003e\\n60c60\u003cbr\\/\u003e\\n&lt;     { \\\"SearchSameRdr\\\" Search &gt; : 50000\u003cbr\\/\u003e\\n&#8212;\u003cbr\\/\u003e\\n&gt;     { \\\"SearchSameRdr\\\" SearchMatch &gt; : 50000\u003cbr\\/\u003e\\n65c65\u003cbr\\/\u003e\\n&lt;     { \\\"SrchNewRdr\\\" Search &gt; : 50000\u003cbr\\/\u003e\\n&#8212;\u003cbr\\/\u003e\\n&gt;     { \\\"SrchNewRdr\\\" SearchMatch &gt; : 50000\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eThen I added 2 new Tasks for benchamrking the Matcher (searcher.search(Query, MatchCollector)) and modified the ReadTask to call searcher.search(Query, HitCollector) instead of the method to get Hits.\u003c\\/p\u003e\\n\\n\u003cp\u003eI commented out all search results traversal and doc retrieval, as I didn\'t care to measure that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487106_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487106_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Apr\\/07 21:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-05T21:33:18+0000\'\u003e05\\/Apr\\/07 21:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Perhaps I did something wrong with the benchmark, but I didn\'t get any speed-up when using searcher.match(Query, MatchCollector) vs. searcher.search(Query, HitCollector). \\n\\n Here are the benchmark numbers (50000 queries with each), HitCollector first, MatchCollector second: \\n\\n HITCOLLECTOR: \\n\\n       &#91;java&#93;  ------------&gt; Report Sum By (any) Name (11 about 41 out of 41) \\n      &#91;java&#93;  Operation           round mrg buf   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  Rounds_4                0  10  10        1       808020        787.5    1,026.04     7,217,624     17,780,736 \\n      &#91;java&#93;  Populate -  -  -  -  -  - - - - - -  -   4 -  -  - 2003 -  -   129.9 -  -  61.67 -   9,938,986 -   13,821,952 \\n      &#91;java&#93;  CreateIndex             -   -   -        4            1          4.4        0.91     3,937,522     10,916,864 \\n      &#91;java&#93;  MAddDocs_2000 -  -  -   - - - - - -  -   4 -  -  - 2000 -  -   138.1 -  -  57.92 -   9,368,584 -   13,821,952 \\n      &#91;java&#93;  Optimize                -   -   -        4            1          1.4        2.83     9,938,218     13,821,952 \\n      &#91;java&#93;  CloseIndex -  -  -  -   - - - - - -  -   4 -  -  -  - 1 -  - 2,000.0 -  -   0.00 -   9,938,986 -   13,821,952 \\n      &#91;java&#93;  OpenReader              -   -   -        4            1         24.0        0.17     9,957,592     13,821,952 \\n      &#91;java&#93;  SearchSameRdr_50000 -   - - - - - -  -   4 -  -   50000 -  - 1,070.3 -  - 186.86 -  10,500,146 -   13,821,952 \\n      &#91;java&#93;  CloseReader             -   -   -        4            1      4,000.0        0.00     9,059,756     13,821,952 \\n      &#91;java&#93;  WarmNewRdr_50 -  -  -   - - - - - -  -   4 -  -  100000 -   16,237.7 -  -  24.63 -   9,060,268 -   13,821,952 \\n      &#91;java&#93;  SrchNewRdr_50000        -   -   -        4        50000        265.9      752.02    10,800,006     13,821,952 \\n\\n\\n       &#91;java&#93;  ------------&gt; Report sum by Prefix (MAddDocs) and Round (4 about 4 out of 41) \\n      &#91;java&#93;  Operation     round mrg buf   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  MAddDocs_2000     0  10  10        1         2000         94.6       21.15     7,844,112     10,407,936 \\n      &#91;java&#93;  MAddDocs_2000 -   1 100  10 -  -   1 -  -  - 2000 -  -   136.7 -  -  14.63 -   8,968,144 -   11,309,056 \\n      &#91;java&#93;  MAddDocs_2000     2  10 100        1         2000        173.2       11.55    10,528,264     15,740,928 \\n      &#91;java&#93;  MAddDocs_2000 -   3 100 100 -  -   1 -  -  - 2000 -  -   188.7 -  -  10.60 -  10,133,816 -   17,829,888 \\n\\n\\n MATCHCOLLECTOR: \\n\\n\\n       &#91;java&#93;  ------------&gt; Report Sum By (any) Name (11 about 41 out of 41) \\n      &#91;java&#93;  Operation           round mrg buf   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  Rounds_4                0  10  10        1       808020        781.0    1,034.62    10,566,608     15,859,712 \\n      &#91;java&#93;  Populate -  -  -  -  -  - - - - - -  -   4 -  -  - 2003 -  -   130.9 -  -  61.23 -  10,963,452 -   14,806,016 \\n      &#91;java&#93;  CreateIndex             -   -   -        4            1         33.9        0.12     3,616,570     11,020,288 \\n      &#91;java&#93;  MAddDocs_2000 -  -  -   - - - - - -  -   4 -  -  - 2000 -  -   137.3 -  -  58.29 -  10,445,568 -   14,806,016 \\n      &#91;java&#93;  Optimize                -   -   -        4            1          1.4        2.82    10,979,398     14,806,016 \\n      &#91;java&#93;  CloseIndex -  -  -  -   - - - - - -  -   4 -  -  -  - 1 -  - 2,000.0 -  -   0.00 -  10,963,452 -   14,806,016 \\n      &#91;java&#93;  OpenReader              -   -   -        4            1         22.0        0.18    10,982,058     14,806,016 \\n      &#91;java&#93;  SearchSameRdr_50000 -   - - - - - -  -   4 -  -   50000 -  - 1,064.7 -  - 187.84 -  11,060,036 -   14,806,016 \\n      &#91;java&#93;  CloseReader             -   -   -        4            1      4,000.0        0.00    10,353,206     14,806,016 \\n      &#91;java&#93;  WarmNewRdr_50 -  -  -   - - - - - -  -   4 -  -  100000 -   16,419.0 -  -  24.36 -  10,431,062 -   14,806,016 \\n      &#91;java&#93;  SrchNewRdr_50000        -   -   -        4        50000        263.0      760.34    11,912,358     14,806,016 \\n\\n\\n       &#91;java&#93;  ------------&gt; Report sum by Prefix (MAddDocs) and Round (4 about 4 out of 41) \\n      &#91;java&#93;  Operation     round mrg buf   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  MAddDocs_2000     0  10  10        1         2000         92.2       21.69     7,844,112     10,407,936 \\n      &#91;java&#93;  MAddDocs_2000 -   1 100  10 -  -   1 -  -  - 2000 -  -   136.6 -  -  14.64 -   7,720,352 -   10,407,936 \\n      &#91;java&#93;  MAddDocs_2000     2  10 100        1         2000        167.8       11.92    11,325,952     17,571,840 \\n      &#91;java&#93;  MAddDocs_2000 -   3 100 100 -  -   1 -  -  - 2000 -  -   199.3 -  -  10.03 -  14,891,856 -   20,836,352 \\n\\n\\n\\n This is what I did for the benchmark.  I used Doron\'s handy conf\\/benchmark. \\nI added a new .alg based on micro-standard.alg, here\'s the diff: \\n\\n\\n $ diff conf\\/micro-standard.alg conf\\/matcher-micro-standard.alg  \\n60c60 \\n&lt;     { \\\"SearchSameRdr\\\" Search &gt; : 50000 \\n&#8212; \\n&gt;     { \\\"SearchSameRdr\\\" SearchMatch &gt; : 50000 \\n65c65 \\n&lt;     { \\\"SrchNewRdr\\\" Search &gt; : 50000 \\n&#8212; \\n&gt;     { \\\"SrchNewRdr\\\" SearchMatch &gt; : 50000 \\n\\n\\n Then I added 2 new Tasks for benchamrking the Matcher (searcher.search(Query, MatchCollector)) and modified the ReadTask to call searcher.search(Query, HitCollector) instead of the method to get Hits. \\n\\n I commented out all search results traversal and doc retrieval, as I didn\'t care to measure that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487430\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487430&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487430\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487430_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487430_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/07 03:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-08T03:59:14+0000\'\u003e08\\/Apr\\/07 03:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe benchmark does not search with filters. Is any speedup still expected? (why?)\u003c\\/p\u003e\\n\\n\u003cp\u003eI applied the patch on current trunk and ran the benchmark - it shows that when all queries use the same reader, Match is faster while when each query opens its own reader bitset is faster. Is this an expected result? \u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003eOperation           round   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\\nSrchMtchSamRdr_5000     -       10         5000        642.2       77.85    12,331,866     16,408,576\\nSrchBitsSamRdr_5000 -   - -  -  10 -  -  - 5000 -  -   586.9 -  -  85.20 -   9,515,875 -   12,009,472\\nSrchMtchNewRdr_500      -       10          500        134.7       37.11    13,376,113     17,171,660\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eThis test is using all Reuters documents and the searches rounds are repeated 10 times. The Match tasks were not included so I wrote them. The updated bench-diff.txt attached contains these task classes and the algorithm.  (When you use this, note that once the index is created you can comment the first part - the \\\"Populate\\\" part - and then only rerun the querying part.)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487430_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487430_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/07 03:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-08T03:59:14+0000\'\u003e08\\/Apr\\/07 03:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The benchmark does not search with filters. Is any speedup still expected? (why?) \\n\\n I applied the patch on current trunk and ran the benchmark - it shows that when all queries use the same reader, Match is faster while when each query opens its own reader bitset is faster. Is this an expected result?  \\n\\n  \\n Operation           round   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\\nSrchMtchSamRdr_5000     -       10         5000        642.2       77.85    12,331,866     16,408,576\\nSrchBitsSamRdr_5000 -   - -  -  10 -  -  - 5000 -  -   586.9 -  -  85.20 -   9,515,875 -   12,009,472\\nSrchMtchNewRdr_500      -       10          500        134.7       37.11    13,376,113     17,171,660\\n \\n  \\n\\n This test is using all Reuters documents and the searches rounds are repeated 10 times. The Match tasks were not included so I wrote them. The updated bench-diff.txt attached contains these task classes and the algorithm.  (When you use this, note that once the index is created you can comment the first part - the \\\"Populate\\\" part - and then only rerun the querying part.)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487431\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487431&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487431\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487431_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487431_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/07 04:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-08T04:07:42+0000\'\u003e08\\/Apr\\/07 04:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOne line was cut out - here are the four lines again\u003c\\/p\u003e\\n\\n\u003cp\u003eOperation           round   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\nSrchMtchSamRdr_5000     -       10         5000        642.2       77.85    12,331,866     16,408,576\u003cbr\\/\u003e\\nSrchBitsSamRdr_5000 -   - -  -  10 -  -  - 5000 -  -   586.9 -  -  85.20 -   9,515,875 -   12,009,472\u003cbr\\/\u003e\\nSrchMtchNewRdr_500      -       10          500        134.7       37.11    13,376,113     17,171,660\u003cbr\\/\u003e\\nSrchBitsNewRdr_500 -  - - -  -  10 -  -  -  500 -  -   154.0 -  -  32.47 -  15,351,395 -   17,522,688\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487431_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487431_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/07 04:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-08T04:07:42+0000\'\u003e08\\/Apr\\/07 04:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    One line was cut out - here are the four lines again \\n\\n Operation           round   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\nSrchMtchSamRdr_5000     -       10         5000        642.2       77.85    12,331,866     16,408,576 \\nSrchBitsSamRdr_5000 -   - -  -  10 -  -  - 5000 -  -   586.9 -  -  85.20 -   9,515,875 -   12,009,472 \\nSrchMtchNewRdr_500      -       10          500        134.7       37.11    13,376,113     17,171,660 \\nSrchBitsNewRdr_500 -  - - -  -  10 -  -  -  500 -  -   154.0 -  -  32.47 -  15,351,395 -   17,522,688              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487432\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487432&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487432\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487432_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487432_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/07 05:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-08T05:21:02+0000\'\u003e08\\/Apr\\/07 05:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDoron, thanks for jumping on this!\u003c\\/p\u003e\\n\\n\u003cp\u003e1. I thought I\'d see better performance with the Matcher because it skips scoring.  While Paul\'s patch does make changes to the Filtering code, I\'m more focused on HitCollector vs. MatchCollector performance here.  Am I missing something here?  If scoring is skipped, we should see at least some speed improvement, and your results show that.\u003c\\/p\u003e\\n\\n\u003cp\u003e2. You said you \u003cb\u003edid\u003c\\/b\u003e see MatchCollector was faster than HitCollector.  Hmmm, weird, not in my 4 runs:\u003c\\/p\u003e\\n\\n\u003cp\u003eMatcher:\u003cbr\\/\u003e\\n \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_50000 - - - - - - - - 4 - - 50000 - - 1,064.7 - - 187.84 - 11,060,036 - 14,806,016 \u003cbr\\/\u003e\\nHitCollector: \u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_50000 - - - - - - - - 4 - - 50000 - - 1,070.3 - - 186.86 - 10,500,146 - 13,821,952 \u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll try it again on a different computer.  My previous runs were on a Mac with OSX.\u003c\\/p\u003e\\n\\n\u003cp\u003e3. My bench-diff.txt did include Match tasks:\u003c\\/p\u003e\\n\\n\u003cp\u003e$ grep Match bench-diff.txt | grep class\u003cbr\\/\u003e\\npublic class SearchMatchTask extends MatchTask {\u003cbr\\/\u003e\\npublic abstract class MatchTask extends ReadTask {\u003c\\/p\u003e\\n\\n\u003cp\u003e... but I didn\'t svn add them, so I produced the \\\"diff\\\" by simply cat-ing the new tasks to bench-diff.txt .  So if you used my bench-diff.txt as a patch, it wouldn\'t have worked.  Not a big deal, just clarifying.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487432_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487432_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/07 05:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-08T05:21:02+0000\'\u003e08\\/Apr\\/07 05:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Doron, thanks for jumping on this! \\n\\n 1. I thought I\'d see better performance with the Matcher because it skips scoring.  While Paul\'s patch does make changes to the Filtering code, I\'m more focused on HitCollector vs. MatchCollector performance here.  Am I missing something here?  If scoring is skipped, we should see at least some speed improvement, and your results show that. \\n\\n 2. You said you  did  see MatchCollector was faster than HitCollector.  Hmmm, weird, not in my 4 runs: \\n\\n Matcher: \\n  &#91;java&#93;  SearchSameRdr_50000 - - - - - - - - 4 - - 50000 - - 1,064.7 - - 187.84 - 11,060,036 - 14,806,016  \\nHitCollector:  \\n &#91;java&#93;  SearchSameRdr_50000 - - - - - - - - 4 - - 50000 - - 1,070.3 - - 186.86 - 10,500,146 - 13,821,952  \\n\\n I\'ll try it again on a different computer.  My previous runs were on a Mac with OSX. \\n\\n 3. My bench-diff.txt did include Match tasks: \\n\\n $ grep Match bench-diff.txt | grep class \\npublic class SearchMatchTask extends MatchTask { \\npublic abstract class MatchTask extends ReadTask { \\n\\n ... but I didn\'t svn add them, so I produced the \\\"diff\\\" by simply cat-ing the new tasks to bench-diff.txt .  So if you used my bench-diff.txt as a patch, it wouldn\'t have worked.  Not a big deal, just clarifying.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487456\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487456&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487456\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487456_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487456_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/07 20:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-08T20:20:29+0000\'\u003e08\\/Apr\\/07 20:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e...right, your diff-txt had the Match tasks - I missed that - checked it, it is exactly what I did, so we\'re ok here. \u003c\\/p\u003e\\n\\n\u003cp\u003eWhen you rerun, you may want to use my alg - to compare the two approaches in one run. You can run this by something like:\u003cbr\\/\u003e\\n     ant run-task -Dtask.mem=256M -Dtask.alg=conf\\\\matcher-vs-bitset.alg\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso, to get cleaner results, add the line:\u003cbr\\/\u003e\\n     ResetSystemSoft\u003cbr\\/\u003e\\njust in the beginning of the \\\"search round\\\" - this resets the (query) inputs and also calls GC.\u003c\\/p\u003e\\n\\n\u003cp\u003eI tried like this twice, and got inconsistent results:\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen the bitset searches preceded the match searches:\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation           round   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchBitsSamRdr_5000     -       10         5000        706.4       70.78     7,511,219     16,573,645\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchMtchSamRdr_5000 -   - -  -  10 -  -  - 5000 -  -   689.6 -  -  72.50 -   8,223,005 -   11,926,323\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchBitsNewRdr_500      -       10          500        152.5       32.80    14,360,618     16,962,356\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchMtchNewRdr_500 -  - - -  -  10 -  -  -  500 -  -   171.3 -  -  29.19 -  15,150,797 -   17,395,712\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen the match searches preceded the bitset searches:\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation           round   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchMtchSamRdr_5000     -       10         5000        763.5       65.49     9,563,243     17,128,244\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchBitsSamRdr_5000 -   - -  -  10 -  -  - 5000 -  -   729.3 -  -  68.56 -  10,003,775 -   13,001,114\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchMtchNewRdr_500      -       10          500        175.7       28.46    12,068,559     17,524,326\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SrchBitsNewRdr_500 -  - - -  -  10 -  -  -  500 -  -   183.7 -  -  27.22 -  15,098,480 -   17,974,476\u003c\\/p\u003e\\n\\n\u003cp\u003eMy conclusion from this is that the speed-up, if exists, is minor, at least for the setup of this test. \u003c\\/p\u003e\\n\\n\u003cp\u003eThere are only 15 unique queries in this test - also printed in the log - are these the queries you would expect to save in? \u003c\\/p\u003e\\n\\n\u003cp\u003eI didn\'t follow this issue very closely so I don\'t know where the saving is expected here. Both SearchTask and MatchTask now do nothing in collect, so no difference at the actual collect() call.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso, Scorer.score(HitCollector) and Matcher.match(MatchCollector) are very similar:\u003cbr\\/\u003e\\n  public void score(HitCollector hc) throws IOException {\u003cbr\\/\u003e\\n    while (next()) \u003c\\/p\u003e\\n{\\n      hc.collect(doc(), score());\\n    }\\n\u003cp\u003e  }\u003cbr\\/\u003e\\n  public void match(MatchCollector mc) throws IOException {\u003cbr\\/\u003e\\n    while (next()) \u003c\\/p\u003e\\n{\\n      mc.collect(doc());\\n    }\\n\u003cp\u003e  }\u003cbr\\/\u003e\\nEspecially for the case that the collect() method is doing nothing, as in this test.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think there is a potential gain for large boolean OR queries, because score() would have to call next() on all TermScorers and collect\\/sum their scores, while match() could use skipTo(last+1) because any match encountered is a match and there is no need to sum the individual scores for the same doc by other scorers. However as far as I can tell, current match() implementation does not take advantage of this, but I may be overlooking something?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487456_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487456_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/07 20:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-08T20:20:29+0000\'\u003e08\\/Apr\\/07 20:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    ...right, your diff-txt had the Match tasks - I missed that - checked it, it is exactly what I did, so we\'re ok here.  \\n\\n When you rerun, you may want to use my alg - to compare the two approaches in one run. You can run this by something like: \\n     ant run-task -Dtask.mem=256M -Dtask.alg=conf\\\\matcher-vs-bitset.alg \\n\\n Also, to get cleaner results, add the line: \\n     ResetSystemSoft \\njust in the beginning of the \\\"search round\\\" - this resets the (query) inputs and also calls GC. \\n\\n I tried like this twice, and got inconsistent results: \\n\\n When the bitset searches preceded the match searches: \\n      &#91;java&#93;  Operation           round   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  SrchBitsSamRdr_5000     -       10         5000        706.4       70.78     7,511,219     16,573,645 \\n      &#91;java&#93;  SrchMtchSamRdr_5000 -   - -  -  10 -  -  - 5000 -  -   689.6 -  -  72.50 -   8,223,005 -   11,926,323 \\n      &#91;java&#93;  SrchBitsNewRdr_500      -       10          500        152.5       32.80    14,360,618     16,962,356 \\n      &#91;java&#93;  SrchMtchNewRdr_500 -  - - -  -  10 -  -  -  500 -  -   171.3 -  -  29.19 -  15,150,797 -   17,395,712 \\n\\n When the match searches preceded the bitset searches: \\n      &#91;java&#93;  Operation           round   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  SrchMtchSamRdr_5000     -       10         5000        763.5       65.49     9,563,243     17,128,244 \\n      &#91;java&#93;  SrchBitsSamRdr_5000 -   - -  -  10 -  -  - 5000 -  -   729.3 -  -  68.56 -  10,003,775 -   13,001,114 \\n      &#91;java&#93;  SrchMtchNewRdr_500      -       10          500        175.7       28.46    12,068,559     17,524,326 \\n      &#91;java&#93;  SrchBitsNewRdr_500 -  - - -  -  10 -  -  -  500 -  -   183.7 -  -  27.22 -  15,098,480 -   17,974,476 \\n\\n My conclusion from this is that the speed-up, if exists, is minor, at least for the setup of this test.  \\n\\n There are only 15 unique queries in this test - also printed in the log - are these the queries you would expect to save in?  \\n\\n I didn\'t follow this issue very closely so I don\'t know where the saving is expected here. Both SearchTask and MatchTask now do nothing in collect, so no difference at the actual collect() call. \\n\\n Also, Scorer.score(HitCollector) and Matcher.match(MatchCollector) are very similar: \\n  public void score(HitCollector hc) throws IOException { \\n    while (next())  \\n{\\n      hc.collect(doc(), score());\\n    }\\n   } \\n  public void match(MatchCollector mc) throws IOException { \\n    while (next())  \\n{\\n      mc.collect(doc());\\n    }\\n   } \\nEspecially for the case that the collect() method is doing nothing, as in this test. \\n\\n I think there is a potential gain for large boolean OR queries, because score() would have to call next() on all TermScorers and collect\\/sum their scores, while match() could use skipTo(last+1) because any match encountered is a match and there is no need to sum the individual scores for the same doc by other scorers. However as far as I can tell, current match() implementation does not take advantage of this, but I may be overlooking something?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487594\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487594&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487594\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12487594_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487594_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/07 18:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-09T18:32:48+0000\'\u003e09\\/Apr\\/07 18:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; When you rerun, you may want to use my alg - to compare the two approaches in one run.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is more dangerous though.  GC from one method\'s garbage can penalize the 2nd methods performance.\u003cbr\\/\u003e\\nAlso, hotspot effects are hard to account for (if method1 and method2 use common methods, method2 will often execute faster than method one because more optimization has been done on those common methods).\u003c\\/p\u003e\\n\\n\u003cp\u003eThe hotspot effect can be minimized by running the test multiple times in the same JVM instance and discarding the first runs, but it\'s not so easy for GC.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12487594_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487594_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/07 18:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-09T18:32:48+0000\'\u003e09\\/Apr\\/07 18:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; When you rerun, you may want to use my alg - to compare the two approaches in one run. \\n\\n This is more dangerous though.  GC from one method\'s garbage can penalize the 2nd methods performance. \\nAlso, hotspot effects are hard to account for (if method1 and method2 use common methods, method2 will often execute faster than method one because more optimization has been done on those common methods). \\n\\n The hotspot effect can be minimized by running the test multiple times in the same JVM instance and discarding the first runs, but it\'s not so easy for GC.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487613\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487613&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487613\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"klaasm\\\" id=\\\"commentauthor_12487613_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=klaasm\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"klaasm\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Klaas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487613_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/07 19:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-09T19:27:38+0000\'\u003e09\\/Apr\\/07 19:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eInstead of discarding the first run, the approach I usually take is to run 3-4 times and pick the minimum.  You can then run several of these \\\"sets\\\" and average over the minimum of each.  GC is still an issues, though.  It is hard to get around when it is a mark&amp;sweep collector (reference counting is much friendlier in this regard)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"klaasm\\\" id=\\\"commentauthor_12487613_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=klaasm\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"klaasm\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Klaas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487613_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/07 19:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-09T19:27:38+0000\'\u003e09\\/Apr\\/07 19:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Instead of discarding the first run, the approach I usually take is to run 3-4 times and pick the minimum.  You can then run several of these \\\"sets\\\" and average over the minimum of each.  GC is still an issues, though.  It is hard to get around when it is a mark&amp;sweep collector (reference counting is much friendlier in this regard)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487616\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487616&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487616\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487616_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487616_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/07 19:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-09T19:34:13+0000\'\u003e09\\/Apr\\/07 19:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; &gt; When you rerun, you may want to use my alg - to compare the two approaches in one run. \u003cbr\\/\u003e\\n&gt; This is more dangerous though. \u003c\\/p\u003e\\n\\n\u003cp\u003eAgree. I was trying to get rid of this by splitting each round to 3: - gc(), warm(), work() - when work() and warm() are the same, just that warm()\'s stats are disregarded. Still switching the order of \\\"by match\\\" and \\\"by bits\\\" yield different results. \u003c\\/p\u003e\\n\\n\u003cp\u003eSometimes we would like not to disregard GC - in particular if one approach is creating more (or more complex) garbage than another approach. \u003c\\/p\u003e\\n\\n\u003cp\u003ePerhaps we should look at two measures: best &amp; avg\\/sum (2nd ignoring first run, for hotspot). \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487616_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487616_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/07 19:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-09T19:34:13+0000\'\u003e09\\/Apr\\/07 19:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; &gt; When you rerun, you may want to use my alg - to compare the two approaches in one run.  \\n&gt; This is more dangerous though.  \\n\\n Agree. I was trying to get rid of this by splitting each round to 3: - gc(), warm(), work() - when work() and warm() are the same, just that warm()\'s stats are disregarded. Still switching the order of \\\"by match\\\" and \\\"by bits\\\" yield different results.  \\n\\n Sometimes we would like not to disregard GC - in particular if one approach is creating more (or more complex) garbage than another approach.  \\n\\n Perhaps we should look at two measures: best &amp; avg\\/sum (2nd ignoring first run, for hotspot).               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487631\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487631&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487631\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487631_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487631_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/07 21:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-09T21:02:44+0000\'\u003e09\\/Apr\\/07 21:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDoron: just to address your question from Apr\\/7 - I expect\\/hope to see an improvement in performance because of this difference:\u003c\\/p\u003e\\n\\n\u003cp\u003e      hc.collect(doc(), score()); \u003cbr\\/\u003e\\n      mc.collect(doc()); \u003c\\/p\u003e\\n\\n\u003cp\u003ethe delta being the cost of the score() call that does the scoring.  If I understand things correctly, that means that what grant described at the bottom of \u003ca href=\\\"http:\\/\\/lucene.apache.org\\/java\\/docs\\/scoring.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/lucene.apache.org\\/java\\/docs\\/scoring.html\u003c\\/a\u003e will all be skipped.  No Scorer, no BooleanScorer(2), no ConjunctionScorer...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487631_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487631_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/07 21:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-09T21:02:44+0000\'\u003e09\\/Apr\\/07 21:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Doron: just to address your question from Apr\\/7 - I expect\\/hope to see an improvement in performance because of this difference: \\n\\n       hc.collect(doc(), score());  \\n      mc.collect(doc());  \\n\\n the delta being the cost of the score() call that does the scoring.  If I understand things correctly, that means that what grant described at the bottom of  http:\\/\\/lucene.apache.org\\/java\\/docs\\/scoring.html  will all be skipped.  No Scorer, no BooleanScorer(2), no ConjunctionScorer...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487667\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487667&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487667\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487667_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487667_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 01:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T01:14:12+0000\'\u003e10\\/Apr\\/07 01:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; No Scorer, no BooleanScorer(2), no ConjunctionScorer... \u003c\\/p\u003e\\n\\n\u003cp\u003eThanks, I was reading \\\"score\\\" instead of \\\"score()\\\"...\u003c\\/p\u003e\\n\\n\u003cp\u003eBut there is a scorer in the process, it is used for next()-ing to matched docs. So most of the work - preparing to be able to compute the scores - was done already. The scorer doc queue is created and populated. Not calling score() is saving the (final) looping on the scorers for aggregating their scores, multiplying by coord factor, etc. I assume this is why only a small speed up is seen. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"doronc\\\" id=\\\"commentauthor_12487667_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=doronc\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"doronc\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Doron Cohen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487667_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 01:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T01:14:12+0000\'\u003e10\\/Apr\\/07 01:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; No Scorer, no BooleanScorer(2), no ConjunctionScorer...  \\n\\n Thanks, I was reading \\\"score\\\" instead of \\\"score()\\\"... \\n\\n But there is a scorer in the process, it is used for next()-ing to matched docs. So most of the work - preparing to be able to compute the scores - was done already. The scorer doc queue is created and populated. Not calling score() is saving the (final) looping on the scorers for aggregating their scores, multiplying by coord factor, etc. I assume this is why only a small speed up is seen.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487674\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487674&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487674\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487674_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487674_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 02:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T02:35:47+0000\'\u003e10\\/Apr\\/07 02:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAhhhh.  I\'ll look at the patch again tomorrow and follow what you said.  All this time I was under the impression that one of the points or at least side-effects of the Matcher was that scoring was skipped, which would be perfect where matches are ordered by anything other than relevance.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487674_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487674_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 02:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T02:35:47+0000\'\u003e10\\/Apr\\/07 02:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Ahhhh.  I\'ll look at the patch again tomorrow and follow what you said.  All this time I was under the impression that one of the points or at least side-effects of the Matcher was that scoring was skipped, which would be perfect where matches are ordered by anything other than relevance. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487675\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487675&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487675\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"creamyg\\\" id=\\\"commentauthor_12487675_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=creamyg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"creamyg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Marvin Humphrey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487675_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 02:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T02:54:55+0000\'\u003e10\\/Apr\\/07 02:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDisjunctionSumScorer (the ORScorer) actually calls Scorer.score() on all of the matching scorers in the ScorerDocQueue during next(), in order to accumulate an aggregate score.  The MatchCollector can\'t save you from that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"creamyg\\\" id=\\\"commentauthor_12487675_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=creamyg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"creamyg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Marvin Humphrey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487675_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 02:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T02:54:55+0000\'\u003e10\\/Apr\\/07 02:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    DisjunctionSumScorer (the ORScorer) actually calls Scorer.score() on all of the matching scorers in the ScorerDocQueue during next(), in order to accumulate an aggregate score.  The MatchCollector can\'t save you from that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487706\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487706&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487706\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12487706_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487706_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 07:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T07:22:59+0000\'\u003e10\\/Apr\\/07 07:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThat could be improved in a DisjunctionMatcher.\u003cbr\\/\u003e\\nWith a bit of bookkeeping DisjunctionSumScorer could also delay calling score() on the subscorers\u003cbr\\/\u003e\\nbut the bookkeeping would affect performance for the normal case.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor the usual queries the score() call will never have much of a performance impact.\u003cbr\\/\u003e\\nThe reason for this is that TermScorer.score() is really very efficient, iirc it caches\u003cbr\\/\u003e\\nweighted tf() values for low term frequencies.\u003cbr\\/\u003e\\nAll the rest is mostly additions, and occasionally a multiplication for a coordination factor.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo determine which documents match the query, the index need to be accessed,\u003cbr\\/\u003e\\nand that takes more time than score value computations because the complete index\u003cbr\\/\u003e\\nalmost never fits in the fastest cache.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12487706_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487706_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 07:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T07:22:59+0000\'\u003e10\\/Apr\\/07 07:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    That could be improved in a DisjunctionMatcher. \\nWith a bit of bookkeeping DisjunctionSumScorer could also delay calling score() on the subscorers \\nbut the bookkeeping would affect performance for the normal case. \\n\\n For the usual queries the score() call will never have much of a performance impact. \\nThe reason for this is that TermScorer.score() is really very efficient, iirc it caches \\nweighted tf() values for low term frequencies. \\nAll the rest is mostly additions, and occasionally a multiplication for a coordination factor. \\n\\n To determine which documents match the query, the index need to be accessed, \\nand that takes more time than score value computations because the complete index \\nalmost never fits in the fastest cache. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487789\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487789&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487789\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487789_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487789_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 15:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T15:10:53+0000\'\u003e10\\/Apr\\/07 15:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAh, too bad. \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/sad.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003cbr\\/\u003e\\nLast time I benchmarked Lucene searching on Sun\'s Niagara vs. non-massive Intel boxes, Intel boxes with Linux on them actually won, and my impression was that this was due to Niagara\'s weak FPU (a known weakness in Niagara, I believe).  Thus, I thought, if we could just skip scoring and various floating point calculations, we\'d see better performance, esp. on Niagara boxes.\u003c\\/p\u003e\\n\\n\u003cp\u003ePaul, when you say \\\"fastest cache\\\", what exactly are you referring to?  The Niagara I tested things on had 32GB of RAM, and I gave the JVM 20+GB, so at least the JVM had plenty of RAM to work with.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487789_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487789_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 15:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T15:10:53+0000\'\u003e10\\/Apr\\/07 15:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Ah, too bad.   \\nLast time I benchmarked Lucene searching on Sun\'s Niagara vs. non-massive Intel boxes, Intel boxes with Linux on them actually won, and my impression was that this was due to Niagara\'s weak FPU (a known weakness in Niagara, I believe).  Thus, I thought, if we could just skip scoring and various floating point calculations, we\'d see better performance, esp. on Niagara boxes. \\n\\n Paul, when you say \\\"fastest cache\\\", what exactly are you referring to?  The Niagara I tested things on had 32GB of RAM, and I gave the JVM 20+GB, so at least the JVM had plenty of RAM to work with.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487882\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487882&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487882\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12487882_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487882_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 18:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T18:59:48+0000\'\u003e10\\/Apr\\/07 18:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eBy fastest cache I meant the L1 cache of the processor. The size is normally in tens of kilobytes.\u003cbr\\/\u003e\\nAn array lookup hitting that cache takes about as much time as a floating point addition.\u003c\\/p\u003e\\n\\n\u003cp\u003eDuring a query search the use of a.o. the term frequencies, the proximity data, and the document weights normally cause an L1 cache miss.\u003c\\/p\u003e\\n\\n\u003cp\u003eI would expect that by not doing the score value computations, only the cache misses for document weights can be saved.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12487882_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487882_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 18:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T18:59:48+0000\'\u003e10\\/Apr\\/07 18:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    By fastest cache I meant the L1 cache of the processor. The size is normally in tens of kilobytes. \\nAn array lookup hitting that cache takes about as much time as a floating point addition. \\n\\n During a query search the use of a.o. the term frequencies, the proximity data, and the document weights normally cause an L1 cache miss. \\n\\n I would expect that by not doing the score value computations, only the cache misses for document weights can be saved.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487940\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487940&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487940\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_12487940_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487940_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 22:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T22:24:15+0000\'\u003e10\\/Apr\\/07 22:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m a little behind on following this issue, but if i can attempt to sum up the recent discussion about performance...\u003c\\/p\u003e\\n\\n\u003cp\u003e   \\\"Migrating towards a \\\"Matcher\\\" API \u003cb\u003emay\u003c\\/b\u003e allow some types of Queries to be faster in situations where clients can use a MatchCollector instead of a HitCollector, but this won\'t be a silver bullet performance win for all Query classes &#8211; just those where some of the score calculations is (or can be) isolated to the score method (as opposed to skipTO or next)\\\"\u003c\\/p\u003e\\n\\n\u003cp\u003eI think it\'s important to remember the motivation of this issue wasn\'t to improve the speed performance of non-scoring searchers, it was to decouple the concept of \\\"Filtering\\\" results away from needing to populate a (potentially large) BitSet when the logic neccessary for Filtering can easily be expressed in terms of a doc iterator (aka: a Matcher) &#8211; opening up the possibility of memory performance improvements.  \u003c\\/p\u003e\\n\\n\u003cp\u003eA second benefit that has arisen as the issue evolved, has been the API generalization of the \\\"Matcher\\\" concept to be a super class of Scorer for simpler APIs moving forward.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_12487940_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487940_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Apr\\/07 22:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-10T22:24:15+0000\'\u003e10\\/Apr\\/07 22:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m a little behind on following this issue, but if i can attempt to sum up the recent discussion about performance... \\n\\n    \\\"Migrating towards a \\\"Matcher\\\" API  may  allow some types of Queries to be faster in situations where clients can use a MatchCollector instead of a HitCollector, but this won\'t be a silver bullet performance win for all Query classes &#8211; just those where some of the score calculations is (or can be) isolated to the score method (as opposed to skipTO or next)\\\" \\n\\n I think it\'s important to remember the motivation of this issue wasn\'t to improve the speed performance of non-scoring searchers, it was to decouple the concept of \\\"Filtering\\\" results away from needing to populate a (potentially large) BitSet when the logic neccessary for Filtering can easily be expressed in terms of a doc iterator (aka: a Matcher) &#8211; opening up the possibility of memory performance improvements.   \\n\\n A second benefit that has arisen as the issue evolved, has been the API generalization of the \\\"Matcher\\\" concept to be a super class of Scorer for simpler APIs moving forward. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12487966\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12487966&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12487966\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487966_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487966_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/07 02:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-11T02:07:53+0000\'\u003e11\\/Apr\\/07 02:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRight.  I was under the wrong impression that the Matcher also happens to avoid scoring.  However, now that we\'ve all looked at this patch (still applies cleanly and unit tests all pass), and nobody had any criticisms, I think we should commit it, say this Friday.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs I\'m in the performance squeezing mode, I\'ll go look at \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-730\\\" title=\\\"Restore top level disjunction performance\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-730\\\"\u003e\u003cdel\u003eLUCENE-730\u003c\\/del\u003e\u003c\\/a\u003e, another one of Paul\'s great patches, and see if I can measure performance improvement there.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12487966_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12487966_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/07 02:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-11T02:07:53+0000\'\u003e11\\/Apr\\/07 02:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Right.  I was under the wrong impression that the Matcher also happens to avoid scoring.  However, now that we\'ve all looked at this patch (still applies cleanly and unit tests all pass), and nobody had any criticisms, I think we should commit it, say this Friday. \\n\\n As I\'m in the performance squeezing mode, I\'ll go look at   LUCENE-730  , another one of Paul\'s great patches, and see if I can measure performance improvement there.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12488733\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12488733&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12488733\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_12488733_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12488733_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Apr\\/07 18:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-13T18:00:44+0000\'\u003e13\\/Apr\\/07 18:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m still behind on following this issue, but Otis: if you are interested in moving forward with this, you might consider trying the cahnges i proposed in my \\\"15\\/Mar\\/07 11:06 AM\\\" Comment...\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-584#action_12481263\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-584#action_12481263\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e...I think it would keep IndexSearcher a little cleaner, and make it easier for people to migrate existing Filter\'s gradually (without requiring extra work for people writing new \\\"Matcher\\\" style Filters from scratch)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_12488733_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12488733_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Apr\\/07 18:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-04-13T18:00:44+0000\'\u003e13\\/Apr\\/07 18:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m still behind on following this issue, but Otis: if you are interested in moving forward with this, you might consider trying the cahnges i proposed in my \\\"15\\/Mar\\/07 11:06 AM\\\" Comment... \\n\\n  https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-584#action_12481263  \\n\\n ...I think it would keep IndexSearcher a little cleaner, and make it easier for people to migrate existing Filter\'s gradually (without requiring extra work for people writing new \\\"Matcher\\\" style Filters from scratch)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12511186\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12511186&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12511186\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12511186_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12511186_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jul\\/07 17:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-09T17:31:58+0000\'\u003e09\\/Jul\\/07 17:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWith 2.2 out, and \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-730\\\" title=\\\"Restore top level disjunction performance\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-730\\\"\u003e\u003cdel\u003eLUCENE-730\u003c\\/del\u003e\u003c\\/a\u003e out of the way, wouldn\'t this be a good moment for some progress with this issue?\u003cbr\\/\u003e\\nThe patch still applies cleanly, and I\'d like to start working on a skipping extension of SortedVIntList, much like the latest index format for document lists.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12511186_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12511186_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jul\\/07 17:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-09T17:31:58+0000\'\u003e09\\/Jul\\/07 17:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    With 2.2 out, and   LUCENE-730   out of the way, wouldn\'t this be a good moment for some progress with this issue? \\nThe patch still applies cleanly, and I\'d like to start working on a skipping extension of SortedVIntList, much like the latest index format for document lists.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12515248\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12515248&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12515248\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515248_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515248_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 10:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T10:21:05+0000\'\u003e25\\/Jul\\/07 10:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis DefaultMatcher2007072.patch adds a default Matcher to be used in Filter instead of the BitSet . It contains static methods that create a default Matcher from a BitSet and from an OpenBitSet. The patch also add OpenBitSet to org.apache.lucene.util; it was taken from a recent solr revision.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn this way the deprecation of Filter.bits(IndexReader) can be done by replacing implementations of that method by Filter.getMatcher(IndexReader) and adding the above default Matcher in the return statement:\u003cbr\\/\u003e\\nreturn DefaultMatcher.defaultMatcher(bits);\u003c\\/p\u003e\\n\\n\u003cp\u003eThe idea is to have this hook available so that a sensible default Matcher is easily available, that can also be adapted to use better Matcher implementations when these become available.\u003cbr\\/\u003e\\nThe current implementation uses a SortedVIntList when it is smaller than an (Open)BitSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have begun introducing the default matcher in my working copy of the core, but as expected, that turns out to be quite a bit of work.\u003cbr\\/\u003e\\nBefore I continue with that, I\'d like to have comments on this default matcher approach.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515248_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515248_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 10:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T10:21:05+0000\'\u003e25\\/Jul\\/07 10:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This DefaultMatcher2007072.patch adds a default Matcher to be used in Filter instead of the BitSet . It contains static methods that create a default Matcher from a BitSet and from an OpenBitSet. The patch also add OpenBitSet to org.apache.lucene.util; it was taken from a recent solr revision. \\n\\n In this way the deprecation of Filter.bits(IndexReader) can be done by replacing implementations of that method by Filter.getMatcher(IndexReader) and adding the above default Matcher in the return statement: \\nreturn DefaultMatcher.defaultMatcher(bits); \\n\\n The idea is to have this hook available so that a sensible default Matcher is easily available, that can also be adapted to use better Matcher implementations when these become available. \\nThe current implementation uses a SortedVIntList when it is smaller than an (Open)BitSet. \\n\\n I have begun introducing the default matcher in my working copy of the core, but as expected, that turns out to be quite a bit of work. \\nBefore I continue with that, I\'d like to have comments on this default matcher approach.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12515313\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12515313&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12515313\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515313_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515313_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 15:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T15:10:30+0000\'\u003e25\\/Jul\\/07 15:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThere is some code in contrib where a Filter is assumed to have BitSet available:\u003c\\/p\u003e\\n\\n\u003cp\u003econtrib\\/queries\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/BooleanFilter.java\u003cbr\\/\u003e\\ncontrib\\/miscellaneous\\/src\\/java\\/org\\/apache\\/lucene\\/misc\\/ChainedFilter.java\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen Filter is going to move from BitSet to Matcher, these will have to be reimplemented.\u003cbr\\/\u003e\\nThey basically use Filters to provide BitSets, but it seems to me that they also\u003cbr\\/\u003e\\ncould use lists of BitSets, for example.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515313_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515313_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 15:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T15:10:30+0000\'\u003e25\\/Jul\\/07 15:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    There is some code in contrib where a Filter is assumed to have BitSet available: \\n\\n contrib\\/queries\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/BooleanFilter.java \\ncontrib\\/miscellaneous\\/src\\/java\\/org\\/apache\\/lucene\\/misc\\/ChainedFilter.java \\n\\n When Filter is going to move from BitSet to Matcher, these will have to be reimplemented. \\nThey basically use Filters to provide BitSets, but it seems to me that they also \\ncould use lists of BitSets, for example.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12515372\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12515372&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12515372\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515372_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515372_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 18:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T18:12:36+0000\'\u003e25\\/Jul\\/07 18:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe whole thing in three patches:\u003c\\/p\u003e\\n\\n\u003cp\u003eThe Matcher-ground patch is the groundwork, which should be very similar to the earlier groundwork patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe Matcher-default patch provides a default implementation, the same as the one I posted earlier today. Among others, It includes OpenBitSet from solr in org.apache.lucene.util .\u003c\\/p\u003e\\n\\n\u003cp\u003eThe Matcher-core uses the default implementation inside the rest of the lucene core and test code. It replaces Filter.bits() methods with Filter.getMatcher() methods in the subclasses of Filter.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eAll core tests pass with these patches aplied., except the one below.\u003cbr\\/\u003e\\nI could not determine why this test fails, and the only\u003cbr\\/\u003e\\nreason I can think of now is that Matcher is not serializable.\u003cbr\\/\u003e\\nCould someone give me a clue on this?\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e Testsuite: org.apache.lucene.search.TestRemoteCachingWrapperFilter\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e Tests run: 1, Failures: 1, Errors: 0, Time elapsed: 1.32 sec\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e Testcase: testTermRemoteFilter(org.apache.lucene.search.TestRemoteCachingWrapperFilter):    FAIL\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e expected:&lt;1&gt; but was:&lt;0&gt;\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e junit.framework.AssertionFailedError: expected:&lt;1&gt; but was:&lt;0&gt;\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e     at org.apache.lucene.search.TestRemoteCachingWrapperFilter.search(TestRemoteCachingWrapperFiava:84)\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e     at org.apache.lucene.search.TestRemoteCachingWrapperFilter.testTermRemoteFilter(TestRemoteCarapperFilter.java:109)\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e\u003cbr\\/\u003e\\n    \u003cspan class=\\\"error\\\"\u003e&#91;junit&#93;\u003c\\/span\u003e Test org.apache.lucene.search.TestRemoteCachingWrapperFilter FAILED\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eFinally, contrib may not even compile with the patches applied.\u003cbr\\/\u003e\\nI used a version of Filter with an abstract getMatcher() method for the Matcher-core patch,\u003cbr\\/\u003e\\nand I also used that to cut the explicit BitSet things from my contrib working copy.\u003cbr\\/\u003e\\nHowever, I don\'t want to provide a patch for contrib yet, it\'s too far from ready here,\u003cbr\\/\u003e\\nand I\'d like some comments on how to go about that first.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515372_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515372_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 18:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T18:12:36+0000\'\u003e25\\/Jul\\/07 18:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The whole thing in three patches: \\n\\n The Matcher-ground patch is the groundwork, which should be very similar to the earlier groundwork patch. \\n\\n The Matcher-default patch provides a default implementation, the same as the one I posted earlier today. Among others, It includes OpenBitSet from solr in org.apache.lucene.util . \\n\\n The Matcher-core uses the default implementation inside the rest of the lucene core and test code. It replaces Filter.bits() methods with Filter.getMatcher() methods in the subclasses of Filter. \\n\\n\\n All core tests pass with these patches aplied., except the one below. \\nI could not determine why this test fails, and the only \\nreason I can think of now is that Matcher is not serializable. \\nCould someone give me a clue on this? \\n\\n      &#91;junit&#93;  Testsuite: org.apache.lucene.search.TestRemoteCachingWrapperFilter \\n     &#91;junit&#93;  Tests run: 1, Failures: 1, Errors: 0, Time elapsed: 1.32 sec \\n     &#91;junit&#93;  \\n     &#91;junit&#93;  Testcase: testTermRemoteFilter(org.apache.lucene.search.TestRemoteCachingWrapperFilter):    FAIL \\n     &#91;junit&#93;  expected:&lt;1&gt; but was:&lt;0&gt; \\n     &#91;junit&#93;  junit.framework.AssertionFailedError: expected:&lt;1&gt; but was:&lt;0&gt; \\n     &#91;junit&#93;      at org.apache.lucene.search.TestRemoteCachingWrapperFilter.search(TestRemoteCachingWrapperFiava:84) \\n     &#91;junit&#93;      at org.apache.lucene.search.TestRemoteCachingWrapperFilter.testTermRemoteFilter(TestRemoteCarapperFilter.java:109) \\n     &#91;junit&#93;  \\n     &#91;junit&#93;  \\n     &#91;junit&#93;  Test org.apache.lucene.search.TestRemoteCachingWrapperFilter FAILED \\n\\n\\n Finally, contrib may not even compile with the patches applied. \\nI used a version of Filter with an abstract getMatcher() method for the Matcher-core patch, \\nand I also used that to cut the explicit BitSet things from my contrib working copy. \\nHowever, I don\'t want to provide a patch for contrib yet, it\'s too far from ready here, \\nand I\'d like some comments on how to go about that first.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12515395\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12515395&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12515395\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12515395_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515395_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 19:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T19:48:34+0000\'\u003e25\\/Jul\\/07 19:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Paul,\u003cbr\\/\u003e\\nNot sure if I\'m missing something but I think this patch may not work for scenarios other than the simple option of a single filter being used on a search.\u003c\\/p\u003e\\n\\n\u003cp\u003eA Matcher does not have the same utility as a BitSet because using a BitSet you can:\u003c\\/p\u003e\\n\\n\u003cp\u003e1) iterate across it using multiple threads.\u003cbr\\/\u003e\\n2) Clone it.\u003cbr\\/\u003e\\n3) Merge it quickly with other bitsets using Boolean logic .\u003cbr\\/\u003e\\n4) Use it more than once.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think these differences become important in the following scenarios :\u003c\\/p\u003e\\n\\n\u003cp\u003eIn CachingWrapperFilter I don\'t think you can cache Matchers instead of bitsets - because Matchers don\'t have features 1 and 4\u003c\\/p\u003e\\n\\n\u003cp\u003eBooleanFilter and ChainedFilter in contrib don\'t work with Matchers because there is no support  for 3) \u003c\\/p\u003e\\n\\n\u003cp\u003eIs there something obvious I\'ve missed?\u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12515395_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515395_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 19:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T19:48:34+0000\'\u003e25\\/Jul\\/07 19:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Paul, \\nNot sure if I\'m missing something but I think this patch may not work for scenarios other than the simple option of a single filter being used on a search. \\n\\n A Matcher does not have the same utility as a BitSet because using a BitSet you can: \\n\\n 1) iterate across it using multiple threads. \\n2) Clone it. \\n3) Merge it quickly with other bitsets using Boolean logic . \\n4) Use it more than once. \\n\\n I think these differences become important in the following scenarios : \\n\\n In CachingWrapperFilter I don\'t think you can cache Matchers instead of bitsets - because Matchers don\'t have features 1 and 4 \\n\\n BooleanFilter and ChainedFilter in contrib don\'t work with Matchers because there is no support  for 3)  \\n\\n Is there something obvious I\'ve missed? \\n\\n Cheers \\nMark              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12515434\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12515434&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12515434\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515434_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515434_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 21:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T21:54:08+0000\'\u003e25\\/Jul\\/07 21:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHave a look at BitSetMatcher in the -default patch. It is constructed from a BitSet, and it has a method getMatcher() that returns a Matcher that acts as a searching iterator over the BitSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo that is 1) to 4), at least potentially. A clone() method is currently not implemented iirc, but each call to getMatcher() will return a new iterator over the underlying BitSet. And when guaranteed non modifyability is needed, a constructor can take a copy of the given document set, in whatever form.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe point of Matcher is that it allows other implementations than BitSet, like OpenBitSet and SortedVIntList. Both have the properties that you are looking for. SortedVIntList can\u003cbr\\/\u003e\\nsave a lot of memory when compared to (Open)BitSet, and OpenBitSet is somewhat faster than BitSet. \u003c\\/p\u003e\\n\\n\u003cp\u003eI\'d like to have a skip list version of SortedVIntList, too. This would be slightly larger than SortedVIntList, but more efficient on skipTo().\u003c\\/p\u003e\\n\\n\u003cp\u003eBut the first thing that is necessary is to have Filter independent from BitSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe real pain with that is going to be the code that currently implements Filters\u003cbr\\/\u003e\\noutside the lucene code base, and a default implementation of a Matcher\u003cbr\\/\u003e\\nshould be of help there, just as it is in the -core patch now.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe default implementation will probably need to be improved from its current\u003cbr\\/\u003e\\nstate, but that can be done later. For example, one could also use OpenBitSet\u003cbr\\/\u003e\\nin all cases, and even collect the filtered documents directly in that.\u003c\\/p\u003e\\n\\n\u003cp\u003eCheers,\u003cbr\\/\u003e\\nPaul Elschot\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515434_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515434_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 21:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T21:54:08+0000\'\u003e25\\/Jul\\/07 21:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Have a look at BitSetMatcher in the -default patch. It is constructed from a BitSet, and it has a method getMatcher() that returns a Matcher that acts as a searching iterator over the BitSet. \\n\\n So that is 1) to 4), at least potentially. A clone() method is currently not implemented iirc, but each call to getMatcher() will return a new iterator over the underlying BitSet. And when guaranteed non modifyability is needed, a constructor can take a copy of the given document set, in whatever form. \\n\\n The point of Matcher is that it allows other implementations than BitSet, like OpenBitSet and SortedVIntList. Both have the properties that you are looking for. SortedVIntList can \\nsave a lot of memory when compared to (Open)BitSet, and OpenBitSet is somewhat faster than BitSet.  \\n\\n I\'d like to have a skip list version of SortedVIntList, too. This would be slightly larger than SortedVIntList, but more efficient on skipTo(). \\n\\n But the first thing that is necessary is to have Filter independent from BitSet. \\n\\n The real pain with that is going to be the code that currently implements Filters \\noutside the lucene code base, and a default implementation of a Matcher \\nshould be of help there, just as it is in the -core patch now. \\n\\n The default implementation will probably need to be improved from its current \\nstate, but that can be done later. For example, one could also use OpenBitSet \\nin all cases, and even collect the filtered documents directly in that. \\n\\n Cheers, \\nPaul Elschot              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12515437\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12515437&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12515437\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515437_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515437_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 22:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T22:05:03+0000\'\u003e25\\/Jul\\/07 22:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI forgot to mention that boolean logic on Matchers is already in present in BooleanScorer2.\u003cbr\\/\u003e\\nThis is because each Scorer is a Matcher.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515437_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515437_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jul\\/07 22:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-25T22:05:03+0000\'\u003e25\\/Jul\\/07 22:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I forgot to mention that boolean logic on Matchers is already in present in BooleanScorer2. \\nThis is because each Scorer is a Matcher.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12515494\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12515494&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12515494\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12515494_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515494_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jul\\/07 04:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-26T04:08:47+0000\'\u003e26\\/Jul\\/07 04:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the reply, Paul.\u003c\\/p\u003e\\n\\n\u003cp\u003eI saw BitSetMatcher etc and appreciate the motivation behind the design for alternative implementations . What concerns me with the Matcher API in general is that Matchers have non-threadsafe safe state (i.e. the current position required to support next() )and as such aren\'t safely cachable in the same way as BitSets. I see the searcher code uses the safer skipTo() rather than next()  but there\'s still the \\\"if(exhausted)\\\" thread safety problem to worry about which is why I raised points 1 and 4.\u003c\\/p\u003e\\n\\n\u003cp\u003eAdditionally, combining Bitsets using Booolean logic is one method call whereas combining heterogenous Matchers using Boolean logic requires iteration across them and therefore potentially many method calls (point 3). I haven\'t benchmarked this but I imagine it to be significantly slower?\u003cbr\\/\u003e\\nI use BooleanFilter a lot for security where many large sets are cached and combined on the fly - caching all the possible combinations as single bitsets would lead to too many possible combinations. \u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12515494_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515494_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jul\\/07 04:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-26T04:08:47+0000\'\u003e26\\/Jul\\/07 04:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the reply, Paul. \\n\\n I saw BitSetMatcher etc and appreciate the motivation behind the design for alternative implementations . What concerns me with the Matcher API in general is that Matchers have non-threadsafe safe state (i.e. the current position required to support next() )and as such aren\'t safely cachable in the same way as BitSets. I see the searcher code uses the safer skipTo() rather than next()  but there\'s still the \\\"if(exhausted)\\\" thread safety problem to worry about which is why I raised points 1 and 4. \\n\\n Additionally, combining Bitsets using Booolean logic is one method call whereas combining heterogenous Matchers using Boolean logic requires iteration across them and therefore potentially many method calls (point 3). I haven\'t benchmarked this but I imagine it to be significantly slower? \\nI use BooleanFilter a lot for security where many large sets are cached and combined on the fly - caching all the possible combinations as single bitsets would lead to too many possible combinations.  \\n\\n Cheers \\nMark              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12515630\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12515630&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12515630\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515630_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515630_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jul\\/07 08:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-26T08:47:08+0000\'\u003e26\\/Jul\\/07 08:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMark,\u003c\\/p\u003e\\n\\n\u003cp\u003eThe exhausted flag is only in the iterator\\/Matcher, not in the underlying set data structure. One can use as many iterators as necessary, for example one per thread, and then there is never a threadsafety problem. (See BitSetMatcher.getMatcher() which uses a local class for the resulting Matcher.)\u003c\\/p\u003e\\n\\n\u003cp\u003eYou wrote: I use BooleanFilter a lot for security where many large sets are cached and combined on the fly - caching all the possible combinations as single bitsets would lead to too many possible combinations.\u003c\\/p\u003e\\n\\n\u003cp\u003eThat can still be done, but one needs to get to the BitSets for example by caching them outside the Filters and constructing the resulting BitSetMatcher for the combined Filter on the fly.\u003c\\/p\u003e\\n\\n\u003cp\u003eAn alternative would be to have a BooleanQuery.add(Matcher, Occur), where the occurrence can only be required or prohibited. Then there is no need to construct any resulting filter because the boolean logic will be executed during the search.  This might even be more efficient than combining the full BitSets ahead of the search.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd with many large BitSets cache memory savings from more compact implementations can also be helpful.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12515630_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12515630_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jul\\/07 08:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-26T08:47:08+0000\'\u003e26\\/Jul\\/07 08:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mark, \\n\\n The exhausted flag is only in the iterator\\/Matcher, not in the underlying set data structure. One can use as many iterators as necessary, for example one per thread, and then there is never a threadsafety problem. (See BitSetMatcher.getMatcher() which uses a local class for the resulting Matcher.) \\n\\n You wrote: I use BooleanFilter a lot for security where many large sets are cached and combined on the fly - caching all the possible combinations as single bitsets would lead to too many possible combinations. \\n\\n That can still be done, but one needs to get to the BitSets for example by caching them outside the Filters and constructing the resulting BitSetMatcher for the combined Filter on the fly. \\n\\n An alternative would be to have a BooleanQuery.add(Matcher, Occur), where the occurrence can only be required or prohibited. Then there is no need to construct any resulting filter because the boolean logic will be executed during the search.  This might even be more efficient than combining the full BitSets ahead of the search. \\n\\n And with many large BitSets cache memory savings from more compact implementations can also be helpful. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12516154\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12516154&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12516154\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516154_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516154_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jul\\/07 09:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-28T09:16:51+0000\'\u003e28\\/Jul\\/07 09:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMark,\u003c\\/p\u003e\\n\\n\u003cp\u003eAn easy way to keep things like BooleanFilter working could be to\u003cbr\\/\u003e\\nintroduce a subclass of Filter, say BitsFilter that adds a bits(IndexReader) method.\u003cbr\\/\u003e\\nThis class should also implement getMatcher(), the default implementation could\u003cbr\\/\u003e\\nbe used for that initially.\u003cbr\\/\u003e\\nThen BooleanFilter could simply be a subclass of BitsFilter, possibly without further\u003cbr\\/\u003e\\nmodifications, although I would prefer to rename it to BooleanBitsFilter.\u003c\\/p\u003e\\n\\n\u003cp\u003eThat would only involve some deprecation warnings in BitsFilter for the period\u003cbr\\/\u003e\\nthat Filter.bits() is deprecated.\u003c\\/p\u003e\\n\\n\u003cp\u003eI would not even mind cooking this up as patch to contrib.\u003c\\/p\u003e\\n\\n\u003cp\u003eThoughts?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516154_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516154_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jul\\/07 09:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-28T09:16:51+0000\'\u003e28\\/Jul\\/07 09:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mark, \\n\\n An easy way to keep things like BooleanFilter working could be to \\nintroduce a subclass of Filter, say BitsFilter that adds a bits(IndexReader) method. \\nThis class should also implement getMatcher(), the default implementation could \\nbe used for that initially. \\nThen BooleanFilter could simply be a subclass of BitsFilter, possibly without further \\nmodifications, although I would prefer to rename it to BooleanBitsFilter. \\n\\n That would only involve some deprecation warnings in BitsFilter for the period \\nthat Filter.bits() is deprecated. \\n\\n I would not even mind cooking this up as patch to contrib. \\n\\n Thoughts?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12516487\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12516487&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12516487\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516487_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516487_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jul\\/07 19:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-30T19:15:38+0000\'\u003e30\\/Jul\\/07 19:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eA different take in the patches of 20070730.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn this version class Filter has only one method:\u003cbr\\/\u003e\\npublic abstract Matcher getMatcher(IndexReader).\u003c\\/p\u003e\\n\\n\u003cp\u003eClass BitSetFilter is added as a subclass of Filter, and it has the familiar\u003cbr\\/\u003e\\npublic abstract BitSet bits(IndexReader),\u003cbr\\/\u003e\\nas well as a default implementation of the getMatcher() method.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the ..core.. patch, and in the ..contrib.. patches (to follow), most uses of Filter simply replaced by BitSetFilter. This turned out to be an easy way of dealing\u003cbr\\/\u003e\\nwith this API change in Filter.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis change to Filter and its replacement by BitSetFilter could well be taking\u003cbr\\/\u003e\\nthings too far for now, and I\'d like to know whether other approaches\u003cbr\\/\u003e\\nare preferred.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe ..default.. patch contains a default implementation of a Matcher from a BitSet, and it has OpenBitSet and friends from solr, as well as SortedVIntList as posted earlier.\u003c\\/p\u003e\\n\\n\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516487_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516487_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jul\\/07 19:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-30T19:15:38+0000\'\u003e30\\/Jul\\/07 19:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    A different take in the patches of 20070730. \\n\\n In this version class Filter has only one method: \\npublic abstract Matcher getMatcher(IndexReader). \\n\\n Class BitSetFilter is added as a subclass of Filter, and it has the familiar \\npublic abstract BitSet bits(IndexReader), \\nas well as a default implementation of the getMatcher() method. \\n\\n In the ..core.. patch, and in the ..contrib.. patches (to follow), most uses of Filter simply replaced by BitSetFilter. This turned out to be an easy way of dealing \\nwith this API change in Filter. \\n\\n This change to Filter and its replacement by BitSetFilter could well be taking \\nthings too far for now, and I\'d like to know whether other approaches \\nare preferred. \\n\\n The ..default.. patch contains a default implementation of a Matcher from a BitSet, and it has OpenBitSet and friends from solr, as well as SortedVIntList as posted earlier. \\n\\n\\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12516490\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12516490&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12516490\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516490_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516490_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jul\\/07 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-30T19:24:50+0000\'\u003e30\\/Jul\\/07 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSome 20070730 patches to contrib using BitSetFilter.\u003cbr\\/\u003e\\nThe contrib-misc and contrib-queries patches are reasonbly good,\u003cbr\\/\u003e\\ntheir tests pass and replacing Filter by BitSetFilter is right for them.\u003c\\/p\u003e\\n\\n\u003cp\u003eHowever, I\'m not happy with the contrib-xml patch to the xml-query parser.\u003cbr\\/\u003e\\nI had to criple some of the code and to disable the TestQueryTemplateManager test.\u003cbr\\/\u003e\\nI don\'t know how to get around this, basically because I don\'t know whether\u003cbr\\/\u003e\\nit is a good idea at all to move the xml-query-parser to BitSetFilter. It might be\u003cbr\\/\u003e\\nbetter to move it to Filter.getMatcher() instead, but I have no idea how to do this.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516490_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516490_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jul\\/07 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-30T19:24:50+0000\'\u003e30\\/Jul\\/07 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Some 20070730 patches to contrib using BitSetFilter. \\nThe contrib-misc and contrib-queries patches are reasonbly good, \\ntheir tests pass and replacing Filter by BitSetFilter is right for them. \\n\\n However, I\'m not happy with the contrib-xml patch to the xml-query parser. \\nI had to criple some of the code and to disable the TestQueryTemplateManager test. \\nI don\'t know how to get around this, basically because I don\'t know whether \\nit is a good idea at all to move the xml-query-parser to BitSetFilter. It might be \\nbetter to move it to Filter.getMatcher() instead, but I have no idea how to do this.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12516491\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12516491&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12516491\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516491_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516491_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jul\\/07 19:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-30T19:27:06+0000\'\u003e30\\/Jul\\/07 19:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUploading the patches again, this time with the ASF license.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516491_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516491_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jul\\/07 19:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-30T19:27:06+0000\'\u003e30\\/Jul\\/07 19:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Uploading the patches again, this time with the ASF license.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12516502\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12516502&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12516502\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516502_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516502_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jul\\/07 19:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-30T19:50:31+0000\'\u003e30\\/Jul\\/07 19:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSome more remarks on the 20070730 patches.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo recap, this introduces Matcher as a superclass of Scorer to take the role that BitSet currently has in Filter.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe total number of java files changed\\/added by these patches is 47, so some extra care will be needed.\u003cbr\\/\u003e\\nThe following issues are still pending:\u003c\\/p\u003e\\n\\n\u003cp\u003eWhat approach should be taken for the API change to Filter (see above, 2 comments up)?\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'d like to get all test cases to pass again. TestRemoteCachingWrapperFilter still does not pass, and\u003cbr\\/\u003e\\nI don\'t know why.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor xml-query-parser in contrib I\'d like to know in which direction to proceed (see 1 comment up).\u003cbr\\/\u003e\\nDoes it make sense to try and get the TestQueryTemplateManager test to pass again?\u003c\\/p\u003e\\n\\n\u003cp\u003eThe ..default.. patch has taken OpenBitSet and friends from solr to have a default implementation.\u003cbr\\/\u003e\\nHowever, I have not checked whether there is unused code in there, so some trimming may still\u003cbr\\/\u003e\\nbe appropriate.\u003c\\/p\u003e\\n\\n\u003cp\u003eOnce these issues have been resolved far enough, I would recommend to introduce this shortly after a release so there is some time to let things settle.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12516502_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12516502_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jul\\/07 19:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-07-30T19:50:31+0000\'\u003e30\\/Jul\\/07 19:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Some more remarks on the 20070730 patches. \\n\\n To recap, this introduces Matcher as a superclass of Scorer to take the role that BitSet currently has in Filter. \\n\\n The total number of java files changed\\/added by these patches is 47, so some extra care will be needed. \\nThe following issues are still pending: \\n\\n What approach should be taken for the API change to Filter (see above, 2 comments up)? \\n\\n I\'d like to get all test cases to pass again. TestRemoteCachingWrapperFilter still does not pass, and \\nI don\'t know why. \\n\\n For xml-query-parser in contrib I\'d like to know in which direction to proceed (see 1 comment up). \\nDoes it make sense to try and get the TestQueryTemplateManager test to pass again? \\n\\n The ..default.. patch has taken OpenBitSet and friends from solr to have a default implementation. \\nHowever, I have not checked whether there is unused code in there, so some trimming may still \\nbe appropriate. \\n\\n Once these issues have been resolved far enough, I would recommend to introduce this shortly after a release so there is some time to let things settle. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12518569\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12518569&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12518569\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12518569_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518569_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Aug\\/07 22:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-08T22:55:38+0000\'\u003e08\\/Aug\\/07 22:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Paul,\u003cbr\\/\u003e\\nMany thanks for your responses.\u003cbr\\/\u003e\\nSorry for the delay in communications - just got back from 2 weeks holiday and slowly picking my way through this patch. \u003c\\/p\u003e\\n\\n\u003cp\u003eYou said: \\\"there is never a threadsafety problem. (See BitSetMatcher.getMatcher() which uses a local class for the resulting Matcher.)\\\"\u003c\\/p\u003e\\n\\n\u003cp\u003eDid you mean BitSetFilter.getMatcher()? BitSetMatcher has no getMatcher method.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf so, doesn\'t my original thread safety issue still stand? - CachingWrapperFilter is caching Matchers (not Filters which are factories for matchers). \u003c\\/p\u003e\\n\\n\u003cp\u003eThe existing approach of adding a &lt;CachedFilter&gt; tag around my XML-based query templates offers a major speed up in my applications and I don\'t see this supported in this patch currently which gives me some concern. This existing caching technique is based on the use of CachingWrapperFilter.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe proposed framework seems to be missing a means of caching reusable, threadsafe  Matchers in a type-independent fashion. One solution (which I think you may be suggesting with the \\\"getMatcher\\\" comment) is to cache Filter objects and use Filter.getMatcher(reader) as a factory method for thread-specific, single-use Matchers but this would suggest that any caching then becomes an implied responsibility\\/overhead of each Filter implementation. Not too great. CachingWrapperFilter is an example of a better design where the caching policy has been implemented in a single class and it can be used to decorate any Filter implementation (RangeFilter etc) with the required caching behaviour. Unfortunately with this proposed patch there is no way that any such single caching policy can work with any Filter because Matcher is not reusable\\/cachable. Time to remove any  thread-specific state from Matcher?\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12518569_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518569_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Aug\\/07 22:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-08T22:55:38+0000\'\u003e08\\/Aug\\/07 22:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Paul, \\nMany thanks for your responses. \\nSorry for the delay in communications - just got back from 2 weeks holiday and slowly picking my way through this patch.  \\n\\n You said: \\\"there is never a threadsafety problem. (See BitSetMatcher.getMatcher() which uses a local class for the resulting Matcher.)\\\" \\n\\n Did you mean BitSetFilter.getMatcher()? BitSetMatcher has no getMatcher method. \\n\\n If so, doesn\'t my original thread safety issue still stand? - CachingWrapperFilter is caching Matchers (not Filters which are factories for matchers).  \\n\\n The existing approach of adding a &lt;CachedFilter&gt; tag around my XML-based query templates offers a major speed up in my applications and I don\'t see this supported in this patch currently which gives me some concern. This existing caching technique is based on the use of CachingWrapperFilter. \\n\\n The proposed framework seems to be missing a means of caching reusable, threadsafe  Matchers in a type-independent fashion. One solution (which I think you may be suggesting with the \\\"getMatcher\\\" comment) is to cache Filter objects and use Filter.getMatcher(reader) as a factory method for thread-specific, single-use Matchers but this would suggest that any caching then becomes an implied responsibility\\/overhead of each Filter implementation. Not too great. CachingWrapperFilter is an example of a better design where the caching policy has been implemented in a single class and it can be used to decorate any Filter implementation (RangeFilter etc) with the required caching behaviour. Unfortunately with this proposed patch there is no way that any such single caching policy can work with any Filter because Matcher is not reusable\\/cachable. Time to remove any  thread-specific state from Matcher? \\n\\n\\n Cheers \\nMark \\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12518642\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12518642&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12518642\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12518642_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518642_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 07:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T07:09:29+0000\'\u003e09\\/Aug\\/07 07:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSome further thought on the roles\\/responsibilities of the various components:\u003c\\/p\u003e\\n\\n\u003cp\u003eGiven a blank sheet of paper (a luxury we may not have) the minimum requirements I would have could be met with the following:\u003cbr\\/\u003e\\n(note that use of the words \\\"Matcher\\\" and \\\"Filter\\\" etc have been removed because sets of doc IDs have applications outside of filtering\\/querying e.g. category counts)\u003c\\/p\u003e\\n\\n\u003cp\u003einterface DocIdSetFactory\u003cbr\\/\u003e\\n{\u003cbr\\/\u003e\\n    DocIdSet getDocIdSet(IndexReader reader)\u003cbr\\/\u003e\\n}\u003cbr\\/\u003e\\nThis is more or less equivalent to the purpose of the existing \\\"Filter\\\" - different implementations define their own selection criteria and produce a set of matching doc Ids e.g. equivalent of RangeFilter. Each implementation must implement \\\"hashcode\\\" and \\\"equals\\\" methods based on it\'s criteria so the factory can be cached and reused (in the same way Query objects are expected to). The existing CachedFilterBuilder in the XMLQueryParser provides one example of a strategy for caching Filters using this facility. \u003c\\/p\u003e\\n\\n\\n\u003cp\u003einterface DocIdSet\u003cbr\\/\u003e\\n{\u003cbr\\/\u003e\\n    DocIdSetIterator getIterator();\u003cbr\\/\u003e\\n}\u003cbr\\/\u003e\\nThis interface defines an immutable, threadsafe (and therefore cachable) collection of doc IDs. Different implementations provide space-efficient alternatives for sparse or heavily populated sets e.g. BitSet, OpenBitSet, SortedVIntList. As an example caching strategy - the existing CachingWrapperFilter would cache these objects in a WeakHashMap keyed on IndexReader.\u003c\\/p\u003e\\n\\n\u003cp\u003einterface DocIdSetIterator\u003cbr\\/\u003e\\n{\u003cbr\\/\u003e\\n    boolean next();\u003cbr\\/\u003e\\n    int getDoc();\u003cbr\\/\u003e\\n   ....etc\u003cbr\\/\u003e\\n}\u003cbr\\/\u003e\\nA thread unsafe, single use object, (probably with only one implementation) that is used to iterate across any DocIdSet. Not cachable and used by Scorers.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the existing proposal it feels like DocIdSet and DocIdSetIterator are rolled into one in the form of the Matcher which complicates\\/prevents caching strategies.\u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12518642_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518642_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 07:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T07:09:29+0000\'\u003e09\\/Aug\\/07 07:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Some further thought on the roles\\/responsibilities of the various components: \\n\\n Given a blank sheet of paper (a luxury we may not have) the minimum requirements I would have could be met with the following: \\n(note that use of the words \\\"Matcher\\\" and \\\"Filter\\\" etc have been removed because sets of doc IDs have applications outside of filtering\\/querying e.g. category counts) \\n\\n interface DocIdSetFactory \\n{ \\n    DocIdSet getDocIdSet(IndexReader reader) \\n} \\nThis is more or less equivalent to the purpose of the existing \\\"Filter\\\" - different implementations define their own selection criteria and produce a set of matching doc Ids e.g. equivalent of RangeFilter. Each implementation must implement \\\"hashcode\\\" and \\\"equals\\\" methods based on it\'s criteria so the factory can be cached and reused (in the same way Query objects are expected to). The existing CachedFilterBuilder in the XMLQueryParser provides one example of a strategy for caching Filters using this facility.  \\n\\n\\n interface DocIdSet \\n{ \\n    DocIdSetIterator getIterator(); \\n} \\nThis interface defines an immutable, threadsafe (and therefore cachable) collection of doc IDs. Different implementations provide space-efficient alternatives for sparse or heavily populated sets e.g. BitSet, OpenBitSet, SortedVIntList. As an example caching strategy - the existing CachingWrapperFilter would cache these objects in a WeakHashMap keyed on IndexReader. \\n\\n interface DocIdSetIterator \\n{ \\n    boolean next(); \\n    int getDoc(); \\n   ....etc \\n} \\nA thread unsafe, single use object, (probably with only one implementation) that is used to iterate across any DocIdSet. Not cachable and used by Scorers. \\n\\n In the existing proposal it feels like DocIdSet and DocIdSetIterator are rolled into one in the form of the Matcher which complicates\\/prevents caching strategies. \\n\\n Cheers \\nMark \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12518825\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12518825&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12518825\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12518825_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518825_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 19:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T19:45:10+0000\'\u003e09\\/Aug\\/07 19:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMark,\u003c\\/p\u003e\\n\\n\u003cp\u003eI said: \\\"there is never a threadsafety problem. (See BitSetMatcher.getMatcher() which uses a local class for the resulting Matcher.)\\\"\u003cbr\\/\u003e\\nThat was a mistake. BitSetMatcher is a Matcher constructed from a BitSet, and SortedVIntList has a getMatcher() method, and I confused the two.\u003c\\/p\u003e\\n\\n\u003cp\u003eA Matcher is intended to be used in a single thread, so I don\'t expect thread safety problems.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe problem for the XML parser is that with this patch, the implementing data structure of a Filter becomes\u003cbr\\/\u003e\\nunaccessible from the Filter class, so it cannot be cached from there.\u003cbr\\/\u003e\\nThat means that some cached data structure will have to be chosen, and one way to do\u003cbr\\/\u003e\\nthat is by using class BitSetFilter from the patch. This has a bits() method just like the current Filter class.\u003cbr\\/\u003e\\nCachingWrapperFilter could then become a cache for BitSetFilter.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere is indeed no caching of filters in this patch.\u003cbr\\/\u003e\\nThe reason for that is that some Filters do not need a cache. For example:\u003cbr\\/\u003e\\nclass TermFilter {\u003cbr\\/\u003e\\n  TermFilter(Term t) \u003c\\/p\u003e\\n{this.term = t;}\\n\u003cp\u003e  Matcher getMatcher(reader) \u003c\\/p\u003e\\n{return new TermMatcher( reader.termDocs(this.term);}\\n\u003cp\u003e}\u003cbr\\/\u003e\\nTermMatcher does not exist (yet), but it could be easily introduced by leaving all the\u003cbr\\/\u003e\\nscoring out of the current TermScorer.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs for DocIdSet, as long as this provides a Matcher as an iterator, it can be used to\u003cbr\\/\u003e\\nimplement a (caching) filter.\u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t think this patch complicates the implementation of caching strategies.\u003cbr\\/\u003e\\nFor example one could define:\u003cbr\\/\u003e\\nclass CachableFilter extends Filter {\u003cbr\\/\u003e\\n  ... some methods to access the underlying data structure to be cached. ...\u003cbr\\/\u003e\\n}\u003cbr\\/\u003e\\nor write a similar adapter for some subclass of Filter and then write a FilterCache that caches these.\u003c\\/p\u003e\\n\\n\u003cp\u003eI did consider defining Matcher as an interface, but I preferred not to do that because\u003cbr\\/\u003e\\nof the default explain() method in the Matcher class of the patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12518825_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518825_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 19:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T19:45:10+0000\'\u003e09\\/Aug\\/07 19:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mark, \\n\\n I said: \\\"there is never a threadsafety problem. (See BitSetMatcher.getMatcher() which uses a local class for the resulting Matcher.)\\\" \\nThat was a mistake. BitSetMatcher is a Matcher constructed from a BitSet, and SortedVIntList has a getMatcher() method, and I confused the two. \\n\\n A Matcher is intended to be used in a single thread, so I don\'t expect thread safety problems. \\n\\n The problem for the XML parser is that with this patch, the implementing data structure of a Filter becomes \\nunaccessible from the Filter class, so it cannot be cached from there. \\nThat means that some cached data structure will have to be chosen, and one way to do \\nthat is by using class BitSetFilter from the patch. This has a bits() method just like the current Filter class. \\nCachingWrapperFilter could then become a cache for BitSetFilter. \\n\\n There is indeed no caching of filters in this patch. \\nThe reason for that is that some Filters do not need a cache. For example: \\nclass TermFilter { \\n  TermFilter(Term t)  \\n{this.term = t;}\\n   Matcher getMatcher(reader)  \\n{return new TermMatcher( reader.termDocs(this.term);}\\n } \\nTermMatcher does not exist (yet), but it could be easily introduced by leaving all the \\nscoring out of the current TermScorer. \\n\\n As for DocIdSet, as long as this provides a Matcher as an iterator, it can be used to \\nimplement a (caching) filter. \\n\\n I don\'t think this patch complicates the implementation of caching strategies. \\nFor example one could define: \\nclass CachableFilter extends Filter { \\n  ... some methods to access the underlying data structure to be cached. ... \\n} \\nor write a similar adapter for some subclass of Filter and then write a FilterCache that caches these. \\n\\n I did consider defining Matcher as an interface, but I preferred not to do that because \\nof the default explain() method in the Matcher class of the patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12518845\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12518845&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12518845\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12518845_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518845_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 21:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T21:32:26+0000\'\u003e09\\/Aug\\/07 21:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Paul,\u003c\\/p\u003e\\n\\n\u003cp\u003eNot sure we\'ve reached a common understanding here yet.\u003c\\/p\u003e\\n\\n\u003cp\u003eYou said \\\"That was a mistake. BitSetMatcher is a Matcher constructed from a BitSet, and SortedVIntList has a getMatcher() method, and I confused the two. \\\"\u003cbr\\/\u003e\\nOk, thanks for the clarification. I still feel uncomfortable because the method getMatcher() is not abstracted to a common interface. This was the thinking behind my \\\"getIterator\\\" method on DocIdSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eI too made a mistake in my earlier comments. DocIdSetIterator does NOT have \\\"probably one implementation\\\". There would be an implementation for each different type of DocIdSet (Bitset\\/OpenBitSet\\/VIntList).\u003c\\/p\u003e\\n\\n\u003cp\u003eYou said \\\"some Filters do not need a cache. For example: TermFilter\\\".  I\'m not sure why that has been singled out as not worthy of caching. I have certain terms (e.g. gender:male) where the TermDocs is very large (50% of all docs in the index!) so multiple calls to TermDocs for term \\\"gender:male\\\" (if that is what you are suggesting) is highly undesirable. These are typically handled in the XMLQueryParser using syntax like this:\u003cbr\\/\u003e\\n  &lt;CachedFilter&gt;\u003cbr\\/\u003e\\n        &lt;TermsFilter fieldName=\\\"gender\\\"&gt;male&lt;\\/TermsFilter&gt;\u003cbr\\/\u003e\\n  &lt;\\/CachedFilter&gt;\u003c\\/p\u003e\\n\\n\u003cp\u003eYou said: \\\"CachingWrapperFilter could then become a cache for BitSetFilter. \\\"\u003cbr\\/\u003e\\nThis means that the only caching strategy is one based on bitsets - does this not lose perhaps the main benefit of your whole proposal? - the ability to have alternative space efficient storage of sets of document ids e.g. SortedVIntList.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf this is undesirable (my guess is \\\"yes\\\") then the proposal in my previous comment is a solution which allows for caching of any\\/all types of the new sets (openBitSet,BitSet,SortedVIntList etc) Regardless of my choice of class names or decisions over interfaces vs abstract classes do you not at least agree the need for 3 types of functionality:\u003c\\/p\u003e\\n\\n\u003cp\u003e1) A factory for instantiating sets of document ids matching a particular set of criteria (which can be costly to call). While the factory is not expected to implement a caching  strategy it is expected to implement hashcode\\/equals simply to aid any caching services which would need this help to identify previously instantiated sets which share the same criteria as ant new requests (This service I identified as my \\\"DocIdSetFactory\\\" and TermsFilter\\/RangeFilter would be example implementations). \u003cbr\\/\u003e\\n2) An object representing an instantiated set of document ids which can be cached and can create iterators for use in seperate threads (identified as my DocIdSet -  example implementations being called something like BitSetDocSet, SortedVIntList) \u003cbr\\/\u003e\\n3) An iterator for a set of document ids (my DocIdSetIterator - example impls being called something like BitSetDocSetIterator SortedVIntListIterator)\u003c\\/p\u003e\\n\\n\u003cp\u003eEach type of functionality can have different implementations so the functionality must be defined using an interface or abstract class. \u003cbr\\/\u003e\\nIf we can agree this much as a set of responsibilities then we can begin to map these services onto something more concrete.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e\\n\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12518845_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518845_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 21:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T21:32:26+0000\'\u003e09\\/Aug\\/07 21:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Paul, \\n\\n Not sure we\'ve reached a common understanding here yet. \\n\\n You said \\\"That was a mistake. BitSetMatcher is a Matcher constructed from a BitSet, and SortedVIntList has a getMatcher() method, and I confused the two. \\\" \\nOk, thanks for the clarification. I still feel uncomfortable because the method getMatcher() is not abstracted to a common interface. This was the thinking behind my \\\"getIterator\\\" method on DocIdSet. \\n\\n I too made a mistake in my earlier comments. DocIdSetIterator does NOT have \\\"probably one implementation\\\". There would be an implementation for each different type of DocIdSet (Bitset\\/OpenBitSet\\/VIntList). \\n\\n You said \\\"some Filters do not need a cache. For example: TermFilter\\\".  I\'m not sure why that has been singled out as not worthy of caching. I have certain terms (e.g. gender:male) where the TermDocs is very large (50% of all docs in the index!) so multiple calls to TermDocs for term \\\"gender:male\\\" (if that is what you are suggesting) is highly undesirable. These are typically handled in the XMLQueryParser using syntax like this: \\n  &lt;CachedFilter&gt; \\n        &lt;TermsFilter fieldName=\\\"gender\\\"&gt;male&lt;\\/TermsFilter&gt; \\n  &lt;\\/CachedFilter&gt; \\n\\n You said: \\\"CachingWrapperFilter could then become a cache for BitSetFilter. \\\" \\nThis means that the only caching strategy is one based on bitsets - does this not lose perhaps the main benefit of your whole proposal? - the ability to have alternative space efficient storage of sets of document ids e.g. SortedVIntList. \\n\\n If this is undesirable (my guess is \\\"yes\\\") then the proposal in my previous comment is a solution which allows for caching of any\\/all types of the new sets (openBitSet,BitSet,SortedVIntList etc) Regardless of my choice of class names or decisions over interfaces vs abstract classes do you not at least agree the need for 3 types of functionality: \\n\\n 1) A factory for instantiating sets of document ids matching a particular set of criteria (which can be costly to call). While the factory is not expected to implement a caching  strategy it is expected to implement hashcode\\/equals simply to aid any caching services which would need this help to identify previously instantiated sets which share the same criteria as ant new requests (This service I identified as my \\\"DocIdSetFactory\\\" and TermsFilter\\/RangeFilter would be example implementations).  \\n2) An object representing an instantiated set of document ids which can be cached and can create iterators for use in seperate threads (identified as my DocIdSet -  example implementations being called something like BitSetDocSet, SortedVIntList)  \\n3) An iterator for a set of document ids (my DocIdSetIterator - example impls being called something like BitSetDocSetIterator SortedVIntListIterator) \\n\\n Each type of functionality can have different implementations so the functionality must be defined using an interface or abstract class.  \\nIf we can agree this much as a set of responsibilities then we can begin to map these services onto something more concrete. \\n\\n\\n Cheers \\nMark \\n\\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12518858\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12518858&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12518858\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12518858_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518858_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 22:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T22:28:26+0000\'\u003e09\\/Aug\\/07 22:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMark,\u003c\\/p\u003e\\n\\n\u003cp\u003eI think we are one the same line, it\'s just that I don\'t want to go that far now.\u003cbr\\/\u003e\\nHave another look at the title of this issue, it may be in your title bar, but otherwise \u003cbr\\/\u003e\\nit\'s quite a bit of scrolling so I\'ll repeat it here: \\\"Decouple Filter from BitSet\\\". \u003cbr\\/\u003e\\nThat is the main thing that this patch tries to do.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd that also makes it a starting point for caching of different data structures for Filters.\u003cbr\\/\u003e\\nCaching of Filters is very much needed, but I\'d rather see that as another issue.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe DefaultMatcher class tries to do some compression by using a SortedVIntList when that is smaller than a BitSet, and that is about as far as I\'d like to go now.\u003c\\/p\u003e\\n\\n\u003cp\u003eProost,\u003cbr\\/\u003e\\nPaul Elschot\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12518858_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518858_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 22:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T22:28:26+0000\'\u003e09\\/Aug\\/07 22:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mark, \\n\\n I think we are one the same line, it\'s just that I don\'t want to go that far now. \\nHave another look at the title of this issue, it may be in your title bar, but otherwise  \\nit\'s quite a bit of scrolling so I\'ll repeat it here: \\\"Decouple Filter from BitSet\\\".  \\nThat is the main thing that this patch tries to do. \\n\\n And that also makes it a starting point for caching of different data structures for Filters. \\nCaching of Filters is very much needed, but I\'d rather see that as another issue. \\n\\n The DefaultMatcher class tries to do some compression by using a SortedVIntList when that is smaller than a BitSet, and that is about as far as I\'d like to go now. \\n\\n Proost, \\nPaul Elschot              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12518868\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12518868&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12518868\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12518868_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518868_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 23:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T23:14:32+0000\'\u003e09\\/Aug\\/07 23:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK, I appreciate caching may not be a top priority in this proposal but I have live systems in production using XMLQueryParser and which use the existing core facilities for caching. As it stands this proposal breaks this functionality (see \\\"FIXME\\\" in contrib\'s CachedFilterBuilder and my concerns over use of  unthreadsafe Matcher in the core class CachingWrapperFilter)\u003c\\/p\u003e\\n\\n\u003cp\u003eI am obviously concerned by this and keen to help shape a solution which preserves the existing capabilities while adding your new functionality. I\'m not sure I share your view that support for caching can be treated as a separate issue to be dealt with at a later date. There are a larger number of changes proposed in this patch and if the design does not at least consider future caching issues now, I suspect much will have to be reworked later. The change I can envisage most clearly is expressed in my concern that the DocIdSet and DocIdSetIterator services I outlined are being combined in Matcher as it stands now and these functions will have to be separated.\u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12518868_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12518868_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Aug\\/07 23:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-09T23:14:32+0000\'\u003e09\\/Aug\\/07 23:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK, I appreciate caching may not be a top priority in this proposal but I have live systems in production using XMLQueryParser and which use the existing core facilities for caching. As it stands this proposal breaks this functionality (see \\\"FIXME\\\" in contrib\'s CachedFilterBuilder and my concerns over use of  unthreadsafe Matcher in the core class CachingWrapperFilter) \\n\\n I am obviously concerned by this and keen to help shape a solution which preserves the existing capabilities while adding your new functionality. I\'m not sure I share your view that support for caching can be treated as a separate issue to be dealt with at a later date. There are a larger number of changes proposed in this patch and if the design does not at least consider future caching issues now, I suspect much will have to be reworked later. The change I can envisage most clearly is expressed in my concern that the DocIdSet and DocIdSetIterator services I outlined are being combined in Matcher as it stands now and these functions will have to be separated. \\n\\n Cheers \\nMark              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12522030\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12522030&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12522030\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_12522030_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12522030_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Aug\\/07 05:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-23T05:55:50+0000\'\u003e23\\/Aug\\/07 05:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI, unfortunately, haven\'t had the time to read through everything in the latest patches, but catching up on my jira mail one of Paul\'s comments jumped out at me, so i wanted to make sure it\'s completley clear: this latest set of patches completely breaks backwards compatibility for any clients who have Filter subclasses, or methods that take a Filter as a param, since the Filter class now has an abstract getMatcher method and no longer supports an abstract BitSet method &#8211; presumably the expectation being that all client code should have a search\\/replace done from Filter=&gt;BitSetFilter\u003c\\/p\u003e\\n\\n\u003cp\u003ewhich begs the question: why not eliminate BitSetFilter and move it\'s getMatcher impl to the Filter class?  (if the concern is just that there be a \\\"higher level\\\" class in which both methods are abstract, why not insert a parent with some new name above the Filter class?)\u003c\\/p\u003e\\n\\n\\n\\n\\n\u003cp\u003eFor the record: it really bothers me that the old attachments got deleted ... the inability to refresh my memory by looking at the older patches and compare them with the current patches is extremely frustrating\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_12522030_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12522030_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Aug\\/07 05:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-23T05:55:50+0000\'\u003e23\\/Aug\\/07 05:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I, unfortunately, haven\'t had the time to read through everything in the latest patches, but catching up on my jira mail one of Paul\'s comments jumped out at me, so i wanted to make sure it\'s completley clear: this latest set of patches completely breaks backwards compatibility for any clients who have Filter subclasses, or methods that take a Filter as a param, since the Filter class now has an abstract getMatcher method and no longer supports an abstract BitSet method &#8211; presumably the expectation being that all client code should have a search\\/replace done from Filter=&gt;BitSetFilter \\n\\n which begs the question: why not eliminate BitSetFilter and move it\'s getMatcher impl to the Filter class?  (if the concern is just that there be a \\\"higher level\\\" class in which both methods are abstract, why not insert a parent with some new name above the Filter class?) \\n\\n\\n\\n\\n For the record: it really bothers me that the old attachments got deleted ... the inability to refresh my memory by looking at the older patches and compare them with the current patches is extremely frustrating              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12523917\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12523917&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12523917\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12523917_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12523917_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/07 19:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-30T19:11:48+0000\'\u003e30\\/Aug\\/07 19:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis set of patches indeed break backward compatibility with the current Filter class.\u003cbr\\/\u003e\\nThat was done to show the ideal end situation, and to make sure that the patched code is indeed there.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo get backward compatibility I\'d prefer to temporarily copy the functionality from BitSetFilter into the Filter class, while still leaving BitSetFilter as it is:\u003c\\/p\u003e\\n\\n\u003cp\u003epublic class Filter {\u003cbr\\/\u003e\\n   \\/** @deprecated use class BitSetFilter instead *\\/\u003cbr\\/\u003e\\n  public abstract BitSet bits(IndexReader reader);\u003c\\/p\u003e\\n\\n\u003cp\u003e  \\/** this method will become abstract once the bits() method is removed from Filter: *\\/\u003cbr\\/\u003e\\n  public Matcher getMatcher(IndexReader reader) \u003c\\/p\u003e\\n{return DefaultFilter.defaultFilter(bits(reader));}\\n\u003cp\u003e}\u003c\\/p\u003e\\n\\n\u003cp\u003eThe main difference between the current set of patches and the removed patches is indicated\u003cbr\\/\u003e\\nin my first comment of 25 July 2007 above.\u003cbr\\/\u003e\\nI still have the older versions of the patch lying around here, so if you need a particular one, just indicated the date, and I\'ll repost or send it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12523917_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12523917_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Aug\\/07 19:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-08-30T19:11:48+0000\'\u003e30\\/Aug\\/07 19:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This set of patches indeed break backward compatibility with the current Filter class. \\nThat was done to show the ideal end situation, and to make sure that the patched code is indeed there. \\n\\n To get backward compatibility I\'d prefer to temporarily copy the functionality from BitSetFilter into the Filter class, while still leaving BitSetFilter as it is: \\n\\n public class Filter { \\n   \\/** @deprecated use class BitSetFilter instead *\\/ \\n  public abstract BitSet bits(IndexReader reader); \\n\\n   \\/** this method will become abstract once the bits() method is removed from Filter: *\\/ \\n  public Matcher getMatcher(IndexReader reader)  \\n{return DefaultFilter.defaultFilter(bits(reader));}\\n } \\n\\n The main difference between the current set of patches and the removed patches is indicated \\nin my first comment of 25 July 2007 above. \\nI still have the older versions of the patch lying around here, so if you need a particular one, just indicated the date, and I\'ll repost or send it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12524301\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12524301&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12524301\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12524301_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12524301_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Sep\\/07 20:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-01T20:21:09+0000\'\u003e01\\/Sep\\/07 20:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnother way to decouple from BitSet would be to keep introduce a new superclass of Filter that only has an abstract getMatcher() method, and to add an implementation of that method in the current Filter class.\u003cbr\\/\u003e\\nThat would boil down to the current patch with two classes renamed:\u003cbr\\/\u003e\\nFilter -&gt;  new class with abstract getMatcher() method.\u003cbr\\/\u003e\\nBitSetFilter -&gt; Filter.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis would avoid all backward compatibility issues, except for the unlikely case in which a getMatcher() method is already implemented in an existing subclass of Filter.\u003cbr\\/\u003e\\nAlso, to take advantage of the independence of BitSet in other implementations, only this new class would need to be used.\u003cbr\\/\u003e\\nThe only disadvantage I can see is that Filter is not renamed to BitSetFilter, which it actually is. But that can be fixed by making the javadoc of Filter explicit about the use of BitSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor the lucene core and some of the contrib, this would mean that it would move to this new superclass of Filter. Again, I don\'t expect backward compatibility issues there.\u003c\\/p\u003e\\n\\n\u003cp\u003eDoes anyone see any problems with this approach?\u003cbr\\/\u003e\\nWhen not, what name should this new superclass of Filter have? I\'m thinking of MatchFilter, any other suggestions?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12524301_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12524301_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Sep\\/07 20:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-01T20:21:09+0000\'\u003e01\\/Sep\\/07 20:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Another way to decouple from BitSet would be to keep introduce a new superclass of Filter that only has an abstract getMatcher() method, and to add an implementation of that method in the current Filter class. \\nThat would boil down to the current patch with two classes renamed: \\nFilter -&gt;  new class with abstract getMatcher() method. \\nBitSetFilter -&gt; Filter. \\n\\n This would avoid all backward compatibility issues, except for the unlikely case in which a getMatcher() method is already implemented in an existing subclass of Filter. \\nAlso, to take advantage of the independence of BitSet in other implementations, only this new class would need to be used. \\nThe only disadvantage I can see is that Filter is not renamed to BitSetFilter, which it actually is. But that can be fixed by making the javadoc of Filter explicit about the use of BitSet. \\n\\n For the lucene core and some of the contrib, this would mean that it would move to this new superclass of Filter. Again, I don\'t expect backward compatibility issues there. \\n\\n Does anyone see any problems with this approach? \\nWhen not, what name should this new superclass of Filter have? I\'m thinking of MatchFilter, any other suggestions?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12525223\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12525223&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12525223\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12525223_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12525223_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Sep\\/07 21:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-05T21:27:49+0000\'\u003e05\\/Sep\\/07 21:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis time (20070905), as indicated in the previous post, a set of patches that add MatchFilter as the new superclass of Filter. Backward compatibility is quite good, no changes at all are necessary in contrib.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the 1ground patch, the current core API is moved from Filter to MatchFilter. Since Filter is a subclass of MatchFilter, I do not expect backward compatibility issues with this, but it is a quite extensive API change.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the 2default patch, some support for MatchFilter caching was added in classes DefaultMatcher and MatcherProvider. OpenBitSet and some support for that was added from solr here, but OpenBitSet is not used (yet). SortedVIntList is also added, and this is used for caching in CachingWrapperFilter as below.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the 3core patch, this caching support is used in CachingWrapperFilter. See also java-dev of yesterday and today for a fixed thread safety problem there.\u003cbr\\/\u003e\\nThe remainder of the core code is also adapted to the use of Matcher in the 3core patch. ConstantScoreQuery is a nice example.\u003c\\/p\u003e\\n\\n\u003cp\u003eI also added the Apache Licence to all new files.\u003c\\/p\u003e\\n\\n\u003cp\u003eAll tests pass with the patches applied, core and contrib.\u003cbr\\/\u003e\\nQuite a bit of javadoc is included, and the javadocs build with only one (unrelated) warning.\u003c\\/p\u003e\\n\\n\u003cp\u003eThese 3 patches modify 35 source code files, so please tread carefully. They were generated against revision 573048.\u003cbr\\/\u003e\\nI did some local svn mv, svn add, and svn rm, and I hope I got\u003cbr\\/\u003e\\nthat right in the end. In case the patches do not apply cleanly, please holler.\u003c\\/p\u003e\\n\\n\u003cp\u003eI will remove my previous patch set in a week or so.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12525223_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12525223_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Sep\\/07 21:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-05T21:27:49+0000\'\u003e05\\/Sep\\/07 21:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This time (20070905), as indicated in the previous post, a set of patches that add MatchFilter as the new superclass of Filter. Backward compatibility is quite good, no changes at all are necessary in contrib. \\n\\n In the 1ground patch, the current core API is moved from Filter to MatchFilter. Since Filter is a subclass of MatchFilter, I do not expect backward compatibility issues with this, but it is a quite extensive API change. \\n\\n In the 2default patch, some support for MatchFilter caching was added in classes DefaultMatcher and MatcherProvider. OpenBitSet and some support for that was added from solr here, but OpenBitSet is not used (yet). SortedVIntList is also added, and this is used for caching in CachingWrapperFilter as below. \\n\\n In the 3core patch, this caching support is used in CachingWrapperFilter. See also java-dev of yesterday and today for a fixed thread safety problem there. \\nThe remainder of the core code is also adapted to the use of Matcher in the 3core patch. ConstantScoreQuery is a nice example. \\n\\n I also added the Apache Licence to all new files. \\n\\n All tests pass with the patches applied, core and contrib. \\nQuite a bit of javadoc is included, and the javadocs build with only one (unrelated) warning. \\n\\n These 3 patches modify 35 source code files, so please tread carefully. They were generated against revision 573048. \\nI did some local svn mv, svn add, and svn rm, and I hope I got \\nthat right in the end. In case the patches do not apply cleanly, please holler. \\n\\n I will remove my previous patch set in a week or so.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12528420\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12528420&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12528420\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rengels@ix.netcom.com\\\" id=\\\"commentauthor_12528420_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rengels%40ix.netcom.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rengels@ix.netcom.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e robert engels\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12528420_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Sep\\/07 15:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-18T15:51:41+0000\'\u003e18\\/Sep\\/07 15:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI don\'t think \u003c\\/p\u003e\\n\\n\u003cp\u003epublic interface AbstractBitSet\u003c\\/p\u003e\\n\\n\u003cp\u003eis according to standards.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt should just be\u003c\\/p\u003e\\n\\n\u003cp\u003epublic interface BitSet\u003c\\/p\u003e\\n\\n\u003cp\u003epossibly\u003c\\/p\u003e\\n\\n\u003cp\u003epublic interface IBitSet\u003c\\/p\u003e\\n\\n\u003cp\u003eif coming from the Windows world.\u003c\\/p\u003e\\n\\n\u003cp\u003eSince it is in a different package, there is no collision with the standard BitSet class.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rengels@ix.netcom.com\\\" id=\\\"commentauthor_12528420_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rengels%40ix.netcom.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rengels@ix.netcom.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e robert engels\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12528420_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Sep\\/07 15:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-18T15:51:41+0000\'\u003e18\\/Sep\\/07 15:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I don\'t think  \\n\\n public interface AbstractBitSet \\n\\n is according to standards. \\n\\n It should just be \\n\\n public interface BitSet \\n\\n possibly \\n\\n public interface IBitSet \\n\\n if coming from the Windows world. \\n\\n Since it is in a different package, there is no collision with the standard BitSet class.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12528539\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12528539&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12528539\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12528539_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12528539_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Sep\\/07 20:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-18T20:13:52+0000\'\u003e18\\/Sep\\/07 20:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe posted patch proposes to use this class to determine which documents should be filtered:\u003c\\/p\u003e\\n\\n\u003cp\u003epublic abstract class Matcher {\u003cbr\\/\u003e\\n  public abstract boolean next() throws IOException;\u003cbr\\/\u003e\\n  public abstract boolean skipTo(int target) throws IOException;\u003cbr\\/\u003e\\n  public abstract int doc();\u003cbr\\/\u003e\\n  \\/\\/ plus a few more methods\u003cbr\\/\u003e\\n}\u003c\\/p\u003e\\n\\n\u003cp\u003eThis class is then used as a superclass of org.apache.lucene.search.Scorer.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12528539_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12528539_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Sep\\/07 20:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-18T20:13:52+0000\'\u003e18\\/Sep\\/07 20:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The posted patch proposes to use this class to determine which documents should be filtered: \\n\\n public abstract class Matcher { \\n  public abstract boolean next() throws IOException; \\n  public abstract boolean skipTo(int target) throws IOException; \\n  public abstract int doc(); \\n  \\/\\/ plus a few more methods \\n} \\n\\n This class is then used as a superclass of org.apache.lucene.search.Scorer.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12529632\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12529632&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12529632\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12529632_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12529632_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Sep\\/07 08:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-22T08:15:11+0000\'\u003e22\\/Sep\\/07 08:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs the current patch set is large, I\'ve been pondering how to do this in a series of smaller patches that can each be applied by itself. This is possible in the following way:\u003c\\/p\u003e\\n\\n\u003cp\u003e1. introduce Matcher as superclass of Scorer and adapt javadocs to use matching consistently.\u003cbr\\/\u003e\\n2. introduce MatchFilter as superclass of Filter and add a minimal DefaultMatcher to be used in IndexSearcher, i.e. add BitSetMatcher\u003cbr\\/\u003e\\n3. change the current Searcher\\/Searchable API to use MatchFilter instead of Filter.\u003c\\/p\u003e\\n\\n\u003cp\u003eStep 1 can be reasonably done before a new a release.\u003cbr\\/\u003e\\nAfter step 2 this issue might be closed, and all the rest could be treated as new issues.\u003c\\/p\u003e\\n\\n\u003cp\u003eAfter that three (almost) independent paths can be followed:\u003cbr\\/\u003e\\n4. add more data structures to be used for filter caches.\u003cbr\\/\u003e\\n5. adapt CachingWrapperFilter to provide a Matcher from a cached datastructure, for example SortedVIntList or BitSet or OpenBitSet.\u003cbr\\/\u003e\\n6. further use of Matcher, mostly in BooleanScorer2.\u003c\\/p\u003e\\n\\n\u003cp\u003eMy question is: shall I go ahead and provide a patch for step 1?\u003c\\/p\u003e\\n\\n\u003cp\u003eAt the moment I\'m refining BooleanScorer2. to use Matcher. This is for the case of multiple prohibited clauses, and also to allow the use of required and prohibited Matchers to allow adding filtering clauses to BooleanQuery.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12529632_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12529632_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Sep\\/07 08:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-09-22T08:15:11+0000\'\u003e22\\/Sep\\/07 08:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As the current patch set is large, I\'ve been pondering how to do this in a series of smaller patches that can each be applied by itself. This is possible in the following way: \\n\\n 1. introduce Matcher as superclass of Scorer and adapt javadocs to use matching consistently. \\n2. introduce MatchFilter as superclass of Filter and add a minimal DefaultMatcher to be used in IndexSearcher, i.e. add BitSetMatcher \\n3. change the current Searcher\\/Searchable API to use MatchFilter instead of Filter. \\n\\n Step 1 can be reasonably done before a new a release. \\nAfter step 2 this issue might be closed, and all the rest could be treated as new issues. \\n\\n After that three (almost) independent paths can be followed: \\n4. add more data structures to be used for filter caches. \\n5. adapt CachingWrapperFilter to provide a Matcher from a cached datastructure, for example SortedVIntList or BitSet or OpenBitSet. \\n6. further use of Matcher, mostly in BooleanScorer2. \\n\\n My question is: shall I go ahead and provide a patch for step 1? \\n\\n At the moment I\'m refining BooleanScorer2. to use Matcher. This is for the case of multiple prohibited clauses, and also to allow the use of required and prohibited Matchers to allow adding filtering clauses to BooleanQuery.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12533178\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12533178&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12533178\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12533178_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12533178_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Oct\\/07 18:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-10-08T18:13:08+0000\'\u003e08\\/Oct\\/07 18:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis Matcher-20071008-1ground.patch replaces the previous version because in between there was a conclict with the javadocs of Scorer for document ordering.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn today\'s version, Scorer is unchanged, except for the superclass Matcher, and Matcher reuses the javadocs of Scorer as much as possible.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12533178_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12533178_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Oct\\/07 18:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-10-08T18:13:08+0000\'\u003e08\\/Oct\\/07 18:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This Matcher-20071008-1ground.patch replaces the previous version because in between there was a conclict with the javadocs of Scorer for document ordering. \\n\\n In today\'s version, Scorer is unchanged, except for the superclass Matcher, and Matcher reuses the javadocs of Scorer as much as possible.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12533179\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12533179&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12533179\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12533179_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12533179_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Oct\\/07 18:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-10-08T18:15:30+0000\'\u003e08\\/Oct\\/07 18:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 08\\/Oct\\/07 18:17\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached once more, this time with licence granted to ASF.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12533179_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12533179_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Oct\\/07 18:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-10-08T18:15:30+0000\'\u003e08\\/Oct\\/07 18:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 08\\/Oct\\/07 18:17\\\"\u003eedited\u003c\\/span\u003e                   Attached once more, this time with licence granted to ASF.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12544863\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12544863&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12544863\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12544863_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12544863_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Nov\\/07 18:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-22T18:31:27+0000\'\u003e22\\/Nov\\/07 18:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eResolved a local conflict in the javadocs of HitCollector.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12544863_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12544863_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Nov\\/07 18:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-22T18:31:27+0000\'\u003e22\\/Nov\\/07 18:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Resolved a local conflict in the javadocs of HitCollector.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12544865\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12544865&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12544865\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12544865_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12544865_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Nov\\/07 18:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-22T18:33:37+0000\'\u003e22\\/Nov\\/07 18:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eResolved a local conflict in the javadocs of HitCollector. This time with licence granted to ASF.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12544865_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12544865_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Nov\\/07 18:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-22T18:33:37+0000\'\u003e22\\/Nov\\/07 18:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Resolved a local conflict in the javadocs of HitCollector. This time with licence granted to ASF.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12546148\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12546148&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12546148\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12546148_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546148_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 07:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T07:57:40+0000\'\u003e28\\/Nov\\/07 07:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003e1. introduce Matcher as superclass of Scorer and adapt javadocs to use matching consistently.\u003cbr\\/\u003e\\n2. introduce MatchFilter as superclass of Filter and add a minimal DefaultMatcher to be used in IndexSearcher, i.e. add BitSetMatcher\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003ePaul, I like the iterative plan you suggested. I started reviewing the\u003cbr\\/\u003e\\nMatcher-20071122-1ground.patch. I\'ve some question:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eIs the API fully backwards compatible?\u003c\\/li\u003e\\n\\t\u003cli\u003eDid you make performance tests to check whether BitSetMatcher is\u003cbr\\/\u003e\\nslower than using a bitset directly?\u003c\\/li\u003e\\n\\t\u003cli\u003eWith just the mentioned patch applied I get compile errors,\u003cbr\\/\u003e\\nbecause the DefaultMatcher is missing. Could you provide a patch that\u003cbr\\/\u003e\\nalso includes the BitSetMatcher and Filter#getMatcher() returns it?\u003cbr\\/\u003e\\nAlso I believe the patch should modify Hits.java to use MatchFilter \u003cbr\\/\u003e\\ninstead of Filter? And a unit test that tests the BitSetMatcher \u003cbr\\/\u003e\\nwould be nice!\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12546148_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546148_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 07:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T07:57:40+0000\'\u003e28\\/Nov\\/07 07:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n 1. introduce Matcher as superclass of Scorer and adapt javadocs to use matching consistently. \\n2. introduce MatchFilter as superclass of Filter and add a minimal DefaultMatcher to be used in IndexSearcher, i.e. add BitSetMatcher  \\n\\n Paul, I like the iterative plan you suggested. I started reviewing the \\nMatcher-20071122-1ground.patch. I\'ve some question: \\n \\n\\t Is the API fully backwards compatible? \\n\\t Did you make performance tests to check whether BitSetMatcher is \\nslower than using a bitset directly? \\n\\t With just the mentioned patch applied I get compile errors, \\nbecause the DefaultMatcher is missing. Could you provide a patch that \\nalso includes the BitSetMatcher and Filter#getMatcher() returns it? \\nAlso I believe the patch should modify Hits.java to use MatchFilter  \\ninstead of Filter? And a unit test that tests the BitSetMatcher  \\nwould be nice! \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12546166\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12546166&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12546166\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12546166_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546166_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 08:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T08:43:29+0000\'\u003e28\\/Nov\\/07 08:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe patch is backwards compatible, except for current subclasses of Filter already have a getMatcher method. The fact that no changes are needed to contrib confirms the compatibility.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have made no performance tests on BitSetMatcher for two reasons.\u003cbr\\/\u003e\\nThe first reason is that OpenBitSet is actually faster than BitSet (have a look at the graph in the SomeMatchers.zip file attachment by Eks Dev), so it seems to be better to go in that direction.\u003cbr\\/\u003e\\nThe second is that it is easy to do the skipping in IndexSearcher on a BitSet directly by using nextSetBit on the BitSet instead of skipTo on the BitSetMatcher. For this it would only be necessary to check whether the given MatchFilter is a Filter.\u003cbr\\/\u003e\\nAnyway, I prefer to see where the real performance bottlenecks are before optimizing for performance.\u003c\\/p\u003e\\n\\n\u003cp\u003eDefaultMatcher should be in the ...2default... patch.\u003cbr\\/\u003e\\nThe change in Hits to use MatchFilter should be in the ...3core.. patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo far, I never tried to use these patches on their own, I have only split them for a better overview. Splitting the combined patches to iterate would need a different split, as you found out. It might even be necessary to split within a single class, but I\'ll gladly do that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12546166_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546166_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 08:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T08:43:29+0000\'\u003e28\\/Nov\\/07 08:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The patch is backwards compatible, except for current subclasses of Filter already have a getMatcher method. The fact that no changes are needed to contrib confirms the compatibility. \\n\\n I have made no performance tests on BitSetMatcher for two reasons. \\nThe first reason is that OpenBitSet is actually faster than BitSet (have a look at the graph in the SomeMatchers.zip file attachment by Eks Dev), so it seems to be better to go in that direction. \\nThe second is that it is easy to do the skipping in IndexSearcher on a BitSet directly by using nextSetBit on the BitSet instead of skipTo on the BitSetMatcher. For this it would only be necessary to check whether the given MatchFilter is a Filter. \\nAnyway, I prefer to see where the real performance bottlenecks are before optimizing for performance. \\n\\n DefaultMatcher should be in the ...2default... patch. \\nThe change in Hits to use MatchFilter should be in the ...3core.. patch. \\n\\n So far, I never tried to use these patches on their own, I have only split them for a better overview. Splitting the combined patches to iterate would need a different split, as you found out. It might even be necessary to split within a single class, but I\'ll gladly do that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12546174\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12546174&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12546174\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12546174_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546174_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 09:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T09:25:07+0000\'\u003e28\\/Nov\\/07 09:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK, here\'s a patch that compiles cleanly on current trunk and all tests \u003cbr\\/\u003e\\npass. It includes:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eall changes from Matcher-20071122-1ground.patch\u003c\\/li\u003e\\n\\t\u003cli\u003eutil\\/BitSetMatcher.java from Matcher-20070905-2default.patch\u003c\\/li\u003e\\n\\t\u003cli\u003eHits.java changes from Matcher-20070905-3core.patch\u003c\\/li\u003e\\n\\t\u003cli\u003eFilter#getMatcher() returns the BitSetMatcher\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eWould you be up for providing testcases?\u003c\\/p\u003e\\n\\n\u003cp\u003eAs I said I haven\'t fully reviewed the patch, but I\'m planning to do \u003cbr\\/\u003e\\nthat soon. I can vouch that all tests pass after applying the patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12546174_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546174_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 09:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T09:25:07+0000\'\u003e28\\/Nov\\/07 09:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK, here\'s a patch that compiles cleanly on current trunk and all tests  \\npass. It includes: \\n \\n\\t all changes from Matcher-20071122-1ground.patch \\n\\t util\\/BitSetMatcher.java from Matcher-20070905-2default.patch \\n\\t Hits.java changes from Matcher-20070905-3core.patch \\n\\t Filter#getMatcher() returns the BitSetMatcher \\n \\n\\n\\n Would you be up for providing testcases? \\n\\n As I said I haven\'t fully reviewed the patch, but I\'m planning to do  \\nthat soon. I can vouch that all tests pass after applying the patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12546393\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12546393&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12546393\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12546393_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546393_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 20:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T20:58:17+0000\'\u003e28\\/Nov\\/07 20:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWith the full patch applied, the following test cases use a BitSetMatcher:\u003c\\/p\u003e\\n\\n\u003cp\u003eTestQueryParser\u003cbr\\/\u003e\\nTestComplexExplanations\u003cbr\\/\u003e\\nTestComplexExplanationsOfNonMatches\u003cbr\\/\u003e\\nTestConstantScoreRangeQuery\u003cbr\\/\u003e\\nTestDateFilter\u003cbr\\/\u003e\\nTestFilteredQuery\u003cbr\\/\u003e\\nTestMultiSearcherRanking\u003cbr\\/\u003e\\nTestPrefixFilter\u003cbr\\/\u003e\\nTestRangeFilter\u003cbr\\/\u003e\\nTestRemoteCachingWrapperFilter\u003cbr\\/\u003e\\nTestRemoteSearchable\u003cbr\\/\u003e\\nTestScorerPerf\u003cbr\\/\u003e\\nTestSimpleExplanations\u003cbr\\/\u003e\\nTestSimpleExplanationsOfNonMatches\u003cbr\\/\u003e\\nTestSort\u003c\\/p\u003e\\n\\n\u003cp\u003eso I don\'t think it is necessary to provide seperate test cases.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12546393_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546393_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 20:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T20:58:17+0000\'\u003e28\\/Nov\\/07 20:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    With the full patch applied, the following test cases use a BitSetMatcher: \\n\\n TestQueryParser \\nTestComplexExplanations \\nTestComplexExplanationsOfNonMatches \\nTestConstantScoreRangeQuery \\nTestDateFilter \\nTestFilteredQuery \\nTestMultiSearcherRanking \\nTestPrefixFilter \\nTestRangeFilter \\nTestRemoteCachingWrapperFilter \\nTestRemoteSearchable \\nTestScorerPerf \\nTestSimpleExplanations \\nTestSimpleExplanationsOfNonMatches \\nTestSort \\n\\n so I don\'t think it is necessary to provide seperate test cases.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12546420\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12546420&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12546420\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12546420_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546420_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 21:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T21:45:57+0000\'\u003e28\\/Nov\\/07 21:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYes you\'re right, I ran the tests w\\/ code coverage analysis enabled, and the\u003cbr\\/\u003e\\nBitSetMatcher is fully covered. Good!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12546420_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12546420_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/07 21:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-28T21:45:57+0000\'\u003e28\\/Nov\\/07 21:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Yes you\'re right, I ran the tests w\\/ code coverage analysis enabled, and the \\nBitSetMatcher is fully covered. Good!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547524\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547524&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547524\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12547524_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547524_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Dec\\/07 22:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-01T22:19:13+0000\'\u003e01\\/Dec\\/07 22:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eThe patch is backwards compatible,\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think that custom Searcher or Searchable implementations won\'t compile anymore?\u003cbr\\/\u003e\\nBecause the signature of some abstract methods changed, e. g. in Searchable:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e@@ -86,13 +86,14 @@\\n    * &lt;p&gt;Called by {@link Hits}.\\n    *\\n    * &lt;p&gt;Applications should usually call {@link Searcher#search(Query)} or\\n-   * {@link Searcher#search(Query,Filter)} instead.\\n+   * {@link Searcher#search(Query,MatchFilter)} instead.\\n    * @\u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e BooleanQuery.TooManyClauses\\n    *\\/\\n-  TopDocs search(Weight weight, Filter filter, \u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e n) \u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e IOException;\\n+  TopDocs search(Weight weight, MatchFilter filter, \u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e n) \u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e IOException;\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12547524_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547524_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Dec\\/07 22:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-01T22:19:13+0000\'\u003e01\\/Dec\\/07 22:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n The patch is backwards compatible,  \\n\\n I think that custom Searcher or Searchable implementations won\'t compile anymore? \\nBecause the signature of some abstract methods changed, e. g. in Searchable: \\n\\n  \\n @@ -86,13 +86,14 @@\\n    * &lt;p&gt;Called by {@link Hits}.\\n    *\\n    * &lt;p&gt;Applications should usually call {@link Searcher#search(Query)} or\\n-   * {@link Searcher#search(Query,Filter)} instead.\\n+   * {@link Searcher#search(Query,MatchFilter)} instead.\\n    * @ throws  BooleanQuery.TooManyClauses\\n    *\\/\\n-  TopDocs search(Weight weight, Filter filter,  int  n)  throws  IOException;\\n+  TopDocs search(Weight weight, MatchFilter filter,  int  n)  throws  IOException;\\n \\n               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547612\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547612&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547612\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547612_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547612_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 10:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T10:56:20+0000\'\u003e02\\/Dec\\/07 10:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI tried implementing a Searchable, and indeed ran into compilation errors.\u003cbr\\/\u003e\\nSo, backward compatibility is indeed not complete.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso, Searchable is an interface, so it should not be changed.\u003cbr\\/\u003e\\nIn case there are other interfaces affected by the patch these should not be changed either.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere are two ways out of this:\u003c\\/p\u003e\\n\\n\u003cp\u003eDo a name change on MatcherFilter\\/Filter -&gt; Filter\\/BitSetFilter.\u003cbr\\/\u003e\\nChanging the current Filter to BitSetFilter gives other problems with contrib packages.\u003cbr\\/\u003e\\nI tried this some time ago, see above, but I could not make it work.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'d prefer to add an interface (or abstract class?) like Searchable that uses MatchFilter for those implementers that want to take advantage of MatchFilter.\u003cbr\\/\u003e\\nI don\'t expect problems from leaving the Searchable interface available unchanged.\u003cbr\\/\u003e\\nOther interfaces that use Filter can be treated the same way, in case there are any.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547612_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547612_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 10:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T10:56:20+0000\'\u003e02\\/Dec\\/07 10:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I tried implementing a Searchable, and indeed ran into compilation errors. \\nSo, backward compatibility is indeed not complete. \\n\\n Also, Searchable is an interface, so it should not be changed. \\nIn case there are other interfaces affected by the patch these should not be changed either. \\n\\n There are two ways out of this: \\n\\n Do a name change on MatcherFilter\\/Filter -&gt; Filter\\/BitSetFilter. \\nChanging the current Filter to BitSetFilter gives other problems with contrib packages. \\nI tried this some time ago, see above, but I could not make it work. \\n\\n I\'d prefer to add an interface (or abstract class?) like Searchable that uses MatchFilter for those implementers that want to take advantage of MatchFilter. \\nI don\'t expect problems from leaving the Searchable interface available unchanged. \\nOther interfaces that use Filter can be treated the same way, in case there are any. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547681\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547681&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547681\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12547681_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547681_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 22:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T22:31:54+0000\'\u003e02\\/Dec\\/07 22:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWhy do we actually need the new MatchFilter class at all?\u003cbr\\/\u003e\\nFilter is an abstract class, not an interface. So I think we could\u003cbr\\/\u003e\\nsimply add the new method getMatcher() like you already did\u003cbr\\/\u003e\\nin your patch:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e  \\/**\\n   * @\u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e A Matcher constructed from the provided BitSet.\\n   * @see    DefaultMatcher#defaultMatcher(BitSet)\\n   *\\/\\n  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e Matcher getMatcher(IndexReader reader) \u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e IOException {\\n    \u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e BitSetMatcher(bits(reader));\\n  }\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eThis shouldn\'t break existing Filter implementations? \u003cbr\\/\u003e\\nMaybe I\'m missing an apparent reason why we need the MatchFilter\u003cbr\\/\u003e\\nclass?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12547681_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547681_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 22:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T22:31:54+0000\'\u003e02\\/Dec\\/07 22:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Why do we actually need the new MatchFilter class at all? \\nFilter is an abstract class, not an interface. So I think we could \\nsimply add the new method getMatcher() like you already did \\nin your patch: \\n\\n  \\n   \\/**\\n   * @ return  A Matcher constructed from the provided BitSet.\\n   * @see    DefaultMatcher#defaultMatcher(BitSet)\\n   *\\/\\n   public  Matcher getMatcher(IndexReader reader)  throws  IOException {\\n     return   new  BitSetMatcher(bits(reader));\\n  }\\n \\n  \\n\\n This shouldn\'t break existing Filter implementations?  \\nMaybe I\'m missing an apparent reason why we need the MatchFilter \\nclass?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547686\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547686&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547686\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547686_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547686_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 23:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T23:03:21+0000\'\u003e02\\/Dec\\/07 23:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 02\\/Dec\\/07 23:04\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFor example, OpenBitSetFilter would like this:\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e\u003cspan class=\\\"code-keyword\\\"\u003eclass \u003c\\/span\u003eOpenBitSetFilter  \u003cspan class=\\\"code-comment\\\"\u003e\\/* ... *\\/\u003c\\/span\u003e {\\n  OpenBitSet bits(reader) { ... }\\n  Matcher getMatcher(reader) { ... }\\n}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eSince the only thing needed by an IndexSearcher would be the Matcher,\u003cbr\\/\u003e\\nMatchFilteris  what Filter and OpenBitSetFilter have in common:\u003cbr\\/\u003e\\nthe getMatcher() method.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547686_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547686_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 23:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T23:03:21+0000\'\u003e02\\/Dec\\/07 23:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 02\\/Dec\\/07 23:04\\\"\u003eedited\u003c\\/span\u003e                   For example, OpenBitSetFilter would like this: \\n  \\n  class  OpenBitSetFilter   \\/* ... *\\/  {\\n  OpenBitSet bits(reader) { ... }\\n  Matcher getMatcher(reader) { ... }\\n}\\n \\n  \\n Since the only thing needed by an IndexSearcher would be the Matcher, \\nMatchFilteris  what Filter and OpenBitSetFilter have in common: \\nthe getMatcher() method. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547689\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547689&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547689\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12547689_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547689_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 23:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T23:16:54+0000\'\u003e02\\/Dec\\/07 23:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWhat about adding the getMatcher() method to Filter and\u003cbr\\/\u003e\\ndeprecating bits(IndexReader)? Then when we release\u003cbr\\/\u003e\\n3.0 we can remove bits() and the only method in Filter\u003cbr\\/\u003e\\nwill be getMatcher().\u003c\\/p\u003e\\n\\n\u003cp\u003eThen this patch should be backwards compatible\u003cbr\\/\u003e\\nand we\'d do the API change with the next major release.\u003cbr\\/\u003e\\nAny objections?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12547689_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547689_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 23:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T23:16:54+0000\'\u003e02\\/Dec\\/07 23:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    What about adding the getMatcher() method to Filter and \\ndeprecating bits(IndexReader)? Then when we release \\n3.0 we can remove bits() and the only method in Filter \\nwill be getMatcher(). \\n\\n Then this patch should be backwards compatible \\nand we\'d do the API change with the next major release. \\nAny objections?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547691\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547691&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547691\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547691_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547691_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 23:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T23:33:36+0000\'\u003e02\\/Dec\\/07 23:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI had not thought about deprecating yet, but it should work nicely.\u003cbr\\/\u003e\\nI suppose you want to add a class BitSetFilter (subclass of Filter) as the preferred alternative\u003cbr\\/\u003e\\nto the deprecated method?\u003cbr\\/\u003e\\nInitially Filter and BitSetFilter would  be very similar, except that Filter.bits() would be deprecated.\u003cbr\\/\u003e\\nLater, after  removal of Filter.bits(), Filter.getMatcher() would be declared abstract.\u003c\\/p\u003e\\n\\n\u003cp\u003eI tried to do something pretty close to this for contrib\\/xml-query-parser, but I could not make that work,\u003cbr\\/\u003e\\nwhich is why I changed to adding a new superclass MatchFilter.\u003cbr\\/\u003e\\nNevertheless, I think the deprecation above should work, but at the moment I can\'t foresee the consequences.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547691_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547691_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Dec\\/07 23:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-02T23:33:36+0000\'\u003e02\\/Dec\\/07 23:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I had not thought about deprecating yet, but it should work nicely. \\nI suppose you want to add a class BitSetFilter (subclass of Filter) as the preferred alternative \\nto the deprecated method? \\nInitially Filter and BitSetFilter would  be very similar, except that Filter.bits() would be deprecated. \\nLater, after  removal of Filter.bits(), Filter.getMatcher() would be declared abstract. \\n\\n I tried to do something pretty close to this for contrib\\/xml-query-parser, but I could not make that work, \\nwhich is why I changed to adding a new superclass MatchFilter. \\nNevertheless, I think the deprecation above should work, but at the moment I can\'t foresee the consequences.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547734\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547734&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547734\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12547734_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547734_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 05:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T05:53:34+0000\'\u003e03\\/Dec\\/07 05:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK, here\'s a new version of the patch.\u003cbr\\/\u003e\\nChanges:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eRemoved MatchFilter entirely.\u003c\\/li\u003e\\n\\t\u003cli\u003eFilter.bits(IndexReader) is now deprecated and not abstract anymore.\u003cbr\\/\u003e\\nFilter.bits(IndexReader) returns null, and Filter.matcher(IndexReader)\u003cbr\\/\u003e\\nreturns the new BitSetMatcher. This allows to create new Filters that \u003cbr\\/\u003e\\nonly implement the new getMatcher(IndexReader) method. Existing filters\u003cbr\\/\u003e\\non the other hand will still work together with the BitSetMatcher.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eThe new class BitSetFilter extends Filter and defines the abstract\u003cbr\\/\u003e\\nmethod bits(IndexReader), just as Filter did before this patch.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eI deprecated also CachingWrapperFilter and RemoteCachingWrapperFilter\u003cbr\\/\u003e\\nand added corresponding CachingBitSetFilter and RemoteCachingBitSetFilter\u003cbr\\/\u003e\\nwhich do essentially the same but only accept BitSetFilters.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eAll testcases pass and believe this should be fully backwards compatible.\u003cbr\\/\u003e\\nAlso, all core classes that call Filter.bits() are deprecated themselves.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn Lucene 3.0 we should make the following changes:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eRemove Filter.bits() and define Filter.getMatcher() abstract.\u003c\\/li\u003e\\n\\t\u003cli\u003eRemove CachingWrapperFilter and RemoteCachingWrapperFilter\u003cbr\\/\u003e\\n(and corresponding testcases)\u003c\\/li\u003e\\n\\t\u003cli\u003eAdd new matchers, like the OpenBitSetMatcher and SortedVIntMatcher\u003cbr\\/\u003e\\nand add the DefaultMatcher class. (these classes are all located in\u003cbr\\/\u003e\\nPaul\'s patch files)\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12547734_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547734_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 05:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T05:53:34+0000\'\u003e03\\/Dec\\/07 05:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK, here\'s a new version of the patch. \\nChanges: \\n \\n\\t Removed MatchFilter entirely. \\n\\t Filter.bits(IndexReader) is now deprecated and not abstract anymore. \\nFilter.bits(IndexReader) returns null, and Filter.matcher(IndexReader) \\nreturns the new BitSetMatcher. This allows to create new Filters that  \\nonly implement the new getMatcher(IndexReader) method. Existing filters \\non the other hand will still work together with the BitSetMatcher. \\n \\n\\n\\n \\n\\t The new class BitSetFilter extends Filter and defines the abstract \\nmethod bits(IndexReader), just as Filter did before this patch. \\n \\n\\n\\n \\n\\t I deprecated also CachingWrapperFilter and RemoteCachingWrapperFilter \\nand added corresponding CachingBitSetFilter and RemoteCachingBitSetFilter \\nwhich do essentially the same but only accept BitSetFilters. \\n \\n\\n\\n All testcases pass and believe this should be fully backwards compatible. \\nAlso, all core classes that call Filter.bits() are deprecated themselves. \\n\\n In Lucene 3.0 we should make the following changes: \\n \\n\\t Remove Filter.bits() and define Filter.getMatcher() abstract. \\n\\t Remove CachingWrapperFilter and RemoteCachingWrapperFilter \\n(and corresponding testcases) \\n\\t Add new matchers, like the OpenBitSetMatcher and SortedVIntMatcher \\nand add the DefaultMatcher class. (these classes are all located in \\nPaul\'s patch files) \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547895\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547895&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547895\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547895_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547895_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 16:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T16:47:59+0000\'\u003e03\\/Dec\\/07 16:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eA few remarks on the lucene-584-take2 patch:\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the @deprecated javadoc at Filter.bits() a reference to BitSetFilter could be added.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhile Filter.bits() is still deprecated, one could also use the BitSet in IndexSearcher\u003cbr\\/\u003e\\nin case this turns out to be performance sensitive; see also my remark of 28 November.\u003c\\/p\u003e\\n\\n\u003cp\u003eA few complete (test) classes are deprecated, it might be good to add the target release\u003cbr\\/\u003e\\nfor removal there.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor the rest this patch looks good to me. Did you also run ant test-contrib ?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547895_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547895_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 16:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T16:47:59+0000\'\u003e03\\/Dec\\/07 16:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    A few remarks on the lucene-584-take2 patch: \\n\\n In the @deprecated javadoc at Filter.bits() a reference to BitSetFilter could be added. \\n\\n While Filter.bits() is still deprecated, one could also use the BitSet in IndexSearcher \\nin case this turns out to be performance sensitive; see also my remark of 28 November. \\n\\n A few complete (test) classes are deprecated, it might be good to add the target release \\nfor removal there. \\n\\n For the rest this patch looks good to me. Did you also run ant test-contrib ?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547901\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547901&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547901\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12547901_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547901_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 17:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T17:05:24+0000\'\u003e03\\/Dec\\/07 17:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eTo go back to post #1 on this topic:\u003c\\/p\u003e\\n\\n\u003cp\u003e   \u003cem\u003e\\\"Sparsely populated =java.util.BitSet=s are not efficient and waste lots of memory. It would be desirable to have an alternative BitSet implementation with smaller memory footprint.\\\"\u003c\\/em\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eGiven the motivation to move to more memory efficient structures  why is the only attempt at caching dedicated exclusively to caching the very structures we were trying to move away from?.....\u003c\\/p\u003e\\n\\n\u003cp\u003e       \u003cem\u003e\\\"I deprecated also CachingWrapperFilter and RemoteCachingWrapperFilter and added corresponding CachingBitSetFilter and RemoteCachingBitSetFilter\\\"\u003c\\/em\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eDoes this suggest we are to have type-specific CachingXxxxxFilters and RemoteCachingXxxxxFilters created for every new filter type? Why not provide a single caching mechanism that works for all those other, new, more memory-efficient structures? I beleive the reason this hasn\'t been done is due to the issue I highlighted earlier - the cachable artefacts (what I chose to call \\\"DocIdSet\\\" here: \u003ca href=\\\"#action_12518642\\\"\u003eaction_12518642\u003c\\/a\u003e ) are not modelled in  a way which promotes re-use. That\'s why we would end up needing a specialised caching implementations for each type. \u003c\\/p\u003e\\n\\n\u003cp\u003eIf we are to move forward from the existing Lucene implementation it\'s important to note the change:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eFilters currently produce, at great cost, BitSets. Bitsets provide both a cachable data structure and a thread-safe, reusable  means of iterating across the contents.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eBy replacing BitSets with Matchers this proposal has removed an important aspect of the existing design -  the visibility (and therefore cachability) of these expensive-to-recreate data structures. Matchers are single-use, non-threadsafe objects and hide the data structure over which they iterate. With this change if I want to implement a caching mechanism in my application I need to know the Filter type and what sort of data structure it returns and get it from it directly:\u003cbr\\/\u003e\\n  if(myFilter instanceof BitSetFilter)    wrap specific data structure using CachingBitSetFilter\u003cbr\\/\u003e\\n  else\u003cbr\\/\u003e\\n  if(myFilter instanceof OpenBitSetFilter)   wrap specific data structure using CachingXxxxxFilter\u003cbr\\/\u003e\\n  else...\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e...looks like an Anti-pattern to me. Worse, this ties the choice of datastructure to the type of Filter that produces it. Why can\'t my RangeFilter be free to create a SortedVIntList or a BitSet depending on the sparseness of matches for a particular set of criteria?\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m not saying \\\"lets just stick with Bitsets\\\", just consider caching more in the design. Post \u003ca href=\\\"#action_12518642\\\"\u003eaction_12518642\u003c\\/a\u003e lays out how this could be modelled with the introduction of DocIdSet and DocIdSetIterator as separate responsibilities (whereas Matcher currently combines them both).\u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12547901_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547901_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 17:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T17:05:24+0000\'\u003e03\\/Dec\\/07 17:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    To go back to post #1 on this topic: \\n\\n     \\\"Sparsely populated =java.util.BitSet=s are not efficient and waste lots of memory. It would be desirable to have an alternative BitSet implementation with smaller memory footprint.\\\"  \\n\\n Given the motivation to move to more memory efficient structures  why is the only attempt at caching dedicated exclusively to caching the very structures we were trying to move away from?..... \\n\\n         \\\"I deprecated also CachingWrapperFilter and RemoteCachingWrapperFilter and added corresponding CachingBitSetFilter and RemoteCachingBitSetFilter\\\"  \\n\\n Does this suggest we are to have type-specific CachingXxxxxFilters and RemoteCachingXxxxxFilters created for every new filter type? Why not provide a single caching mechanism that works for all those other, new, more memory-efficient structures? I beleive the reason this hasn\'t been done is due to the issue I highlighted earlier - the cachable artefacts (what I chose to call \\\"DocIdSet\\\" here:  action_12518642  ) are not modelled in  a way which promotes re-use. That\'s why we would end up needing a specialised caching implementations for each type.  \\n\\n If we are to move forward from the existing Lucene implementation it\'s important to note the change: \\n\\n \\n\\t Filters currently produce, at great cost, BitSets. Bitsets provide both a cachable data structure and a thread-safe, reusable  means of iterating across the contents. \\n \\n\\n\\n \\n\\t By replacing BitSets with Matchers this proposal has removed an important aspect of the existing design -  the visibility (and therefore cachability) of these expensive-to-recreate data structures. Matchers are single-use, non-threadsafe objects and hide the data structure over which they iterate. With this change if I want to implement a caching mechanism in my application I need to know the Filter type and what sort of data structure it returns and get it from it directly: \\n  if(myFilter instanceof BitSetFilter)    wrap specific data structure using CachingBitSetFilter \\n  else \\n  if(myFilter instanceof OpenBitSetFilter)   wrap specific data structure using CachingXxxxxFilter \\n  else... \\n \\n\\n\\n ...looks like an Anti-pattern to me. Worse, this ties the choice of datastructure to the type of Filter that produces it. Why can\'t my RangeFilter be free to create a SortedVIntList or a BitSet depending on the sparseness of matches for a particular set of criteria? \\n\\n I\'m not saying \\\"lets just stick with Bitsets\\\", just consider caching more in the design. Post  action_12518642  lays out how this could be modelled with the introduction of DocIdSet and DocIdSetIterator as separate responsibilities (whereas Matcher currently combines them both). \\n\\n Cheers \\nMark \\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547958\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547958&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547958\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547958_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547958_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 19:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T19:34:54+0000\'\u003e03\\/Dec\\/07 19:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMark, in the latest Matcher....-2default.patch there is the org.apache.lucene.MatcherProvider interface with this javadoc:\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/** To be used in a cache to implement caching for a MatchFilter. *\\/\u003c\\/p\u003e\\n\\n\u003cp\u003eThis interface has only one method:\u003c\\/p\u003e\\n\\n\u003cp\u003epublic Matcher getMatcher();\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eThere is also a cache for filters in the Matcher....3core.patch in the class CachingWrapperFilter .\u003c\\/p\u003e\\n\\n\u003cp\u003eWould those be a good starting point?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12547958_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547958_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 19:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T19:34:54+0000\'\u003e03\\/Dec\\/07 19:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mark, in the latest Matcher....-2default.patch there is the org.apache.lucene.MatcherProvider interface with this javadoc: \\n\\n \\/** To be used in a cache to implement caching for a MatchFilter. *\\/ \\n\\n This interface has only one method: \\n\\n public Matcher getMatcher(); \\n\\n\\n There is also a cache for filters in the Matcher....3core.patch in the class CachingWrapperFilter . \\n\\n Would those be a good starting point?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12547988\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547988&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12547988\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12547988_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547988_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 21:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T21:13:13+0000\'\u003e03\\/Dec\\/07 21:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m getting lost as to which patches we\'re considering here. I was looking at lucene-584-take2 patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eMatcherProvider in the earlier patch does look like something that will help with caching.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt;&gt;Would those be a good starting point?\u003c\\/p\u003e\\n\\n\u003cp\u003eOverall I feel uncomfortable with a lot of the classnames. I think the use of \\\"Matcher\\\" says more about what you want to do with the class in this particular case rather than what \u003cem\u003eit\u003c\\/em\u003e does generally. I have other uses in mind for these classes that are outside of filtering search results. For me, these classes can be thought of much more simply as utility classes in the same mould as the java Collections API. Fundamentally, they are efficient implementations of sets\\/lists of integers with support for iterators. The whole thing would be a lot cleaner if classes were named around this scheme.\u003cbr\\/\u003e\\n\\\"MatcherProvider\\\" for example is essentially a DocIdSet  which creates forms of DocIdSetIterators (Matchers) and could also usefully have a size() method. \u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12547988_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12547988_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 21:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T21:13:13+0000\'\u003e03\\/Dec\\/07 21:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m getting lost as to which patches we\'re considering here. I was looking at lucene-584-take2 patch. \\n\\n MatcherProvider in the earlier patch does look like something that will help with caching. \\n\\n &gt;&gt;Would those be a good starting point? \\n\\n Overall I feel uncomfortable with a lot of the classnames. I think the use of \\\"Matcher\\\" says more about what you want to do with the class in this particular case rather than what  it  does generally. I have other uses in mind for these classes that are outside of filtering search results. For me, these classes can be thought of much more simply as utility classes in the same mould as the java Collections API. Fundamentally, they are efficient implementations of sets\\/lists of integers with support for iterators. The whole thing would be a lot cleaner if classes were named around this scheme. \\n\\\"MatcherProvider\\\" for example is essentially a DocIdSet  which creates forms of DocIdSetIterators (Matchers) and could also usefully have a size() method.  \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12548030\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12548030&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12548030\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12548030_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12548030_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 22:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T22:50:06+0000\'\u003e03\\/Dec\\/07 22:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIn case there is a better name than Matcher for a Scorer without a score() method (and maybe without an explain() method), I\'m all ears. Names are important, and at this point they can still be changed very easily.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor Matcher I\'d rather have a method to estimate the number of matching docs than a size() method. This estimate would be useful in implementing conjunctions, as the Matchers with the lowest estimates could be used first. However, this is another issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12548030_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12548030_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Dec\\/07 22:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-03T22:50:06+0000\'\u003e03\\/Dec\\/07 22:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    In case there is a better name than Matcher for a Scorer without a score() method (and maybe without an explain() method), I\'m all ears. Names are important, and at this point they can still be changed very easily. \\n\\n For Matcher I\'d rather have a method to estimate the number of matching docs than a size() method. This estimate would be useful in implementing conjunctions, as the Matchers with the lowest estimates could be used first. However, this is another issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12548208\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12548208&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12548208\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12548208_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12548208_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Dec\\/07 10:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-04T10:49:56+0000\'\u003e04\\/Dec\\/07 10:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFor the data structures (bitset\\/openbitset\\/sorted VintList\\/) I would suggest one of these: IntSet, IntegerSet or IntegerSequence as names for the common interface.\u003cbr\\/\u003e\\nI did a quick Google for IntegerSet and you are in the number one spot, Paul \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e \u003ca href=\\\"http:\\/\\/www.google.com\\/search?hl=en&amp;q=integerset+bitset\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.google.com\\/search?hl=en&amp;q=integerset+bitset\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/\\/ A cachable, immutable, sorted, threadsafe collection of ints.\u003cbr\\/\u003e\\ninterface IntegerSet\u003cbr\\/\u003e\\n{\u003cbr\\/\u003e\\n   IntegerSetIterator getIterator();\u003cbr\\/\u003e\\n   int size(); \\/\\/negative numbers could be used to represent estimates?\u003cbr\\/\u003e\\n}\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/\\/ A single-use thread-unsafe iterator.\u003cbr\\/\u003e\\ninterface IntegerSetIterator\u003cbr\\/\u003e\\n{\u003cbr\\/\u003e\\n    boolean next();\u003cbr\\/\u003e\\n    boolean skipTo(int next);\u003cbr\\/\u003e\\n    int currentValue();\u003cbr\\/\u003e\\n}\u003c\\/p\u003e\\n\\n\u003cp\u003eIf \u003cem\u003edetailed\u003c\\/em\u003e explanations of hits are required these should really sit with the source not the result- i.e. with the Filters. They contain all the match criteria used to populate IntegerSets  and can be thought of more generically as IntegerSetBuilder. \u003c\\/p\u003e\\n\\n\u003cp\u003e\\/\\/Contains criteria to create a set of matching documents. MUST implement hashcode and equals based on this criteria to enable use as cache keys for IntegerSets.\u003cbr\\/\u003e\\ninterface IntegerSetBuilder extends Serializable\u003cbr\\/\u003e\\n{\u003cbr\\/\u003e\\n      IntegerSet build (IndexReader reader)\u003cbr\\/\u003e\\n      Explanation explain(int docNr);\u003cbr\\/\u003e\\n}\u003c\\/p\u003e\\n\\n\\n\\n\u003cp\u003eA single CachingIntegerSetBuilder class would be able to take ANY IntegerSetBuilder as a source, cache ANY type of IntegerSet they produced and defer back to the original IntegerSetBuilder for a full and thorough explanation of a match even when the match occurred on a cached IntegerSet, if required.\u003c\\/p\u003e\\n\\n\u003cp\u003eclass CachingIntegerSetBuilder implements IntegerSetBuilder\u003cbr\\/\u003e\\n{\u003cbr\\/\u003e\\n     private WeakHashMap perIndexReaderCache;\u003cbr\\/\u003e\\n     public CachingIntegerSetBuilder(IntegerSetBuilder delegate) \u003c\\/p\u003e\\n{....}\\n\u003cp\u003e     .....\u003cbr\\/\u003e\\n}\u003c\\/p\u003e\\n\\n\u003cp\u003eThe reason for introducing IntegerSetBuilder as a more generic name than \\\"Filter\\\" is IntegerSets have uses outside of  filtering e.g. to do category counts or clustering. In these use cases they don\'t actually perform anything to do with filtering.  It may actually be better named DocIdSetBuilder given that it is tied to Lucene\'s IndexReader and therefore limited to producing sets of document ids.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12548208_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12548208_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Dec\\/07 10:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-04T10:49:56+0000\'\u003e04\\/Dec\\/07 10:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    For the data structures (bitset\\/openbitset\\/sorted VintList\\/) I would suggest one of these: IntSet, IntegerSet or IntegerSequence as names for the common interface. \\nI did a quick Google for IntegerSet and you are in the number one spot, Paul    http:\\/\\/www.google.com\\/search?hl=en&amp;q=integerset+bitset  \\n\\n \\/\\/ A cachable, immutable, sorted, threadsafe collection of ints. \\ninterface IntegerSet \\n{ \\n   IntegerSetIterator getIterator(); \\n   int size(); \\/\\/negative numbers could be used to represent estimates? \\n} \\n\\n \\/\\/ A single-use thread-unsafe iterator. \\ninterface IntegerSetIterator \\n{ \\n    boolean next(); \\n    boolean skipTo(int next); \\n    int currentValue(); \\n} \\n\\n If  detailed  explanations of hits are required these should really sit with the source not the result- i.e. with the Filters. They contain all the match criteria used to populate IntegerSets  and can be thought of more generically as IntegerSetBuilder.  \\n\\n \\/\\/Contains criteria to create a set of matching documents. MUST implement hashcode and equals based on this criteria to enable use as cache keys for IntegerSets. \\ninterface IntegerSetBuilder extends Serializable \\n{ \\n      IntegerSet build (IndexReader reader) \\n      Explanation explain(int docNr); \\n} \\n\\n\\n\\n A single CachingIntegerSetBuilder class would be able to take ANY IntegerSetBuilder as a source, cache ANY type of IntegerSet they produced and defer back to the original IntegerSetBuilder for a full and thorough explanation of a match even when the match occurred on a cached IntegerSet, if required. \\n\\n class CachingIntegerSetBuilder implements IntegerSetBuilder \\n{ \\n     private WeakHashMap perIndexReaderCache; \\n     public CachingIntegerSetBuilder(IntegerSetBuilder delegate)  \\n{....}\\n      ..... \\n} \\n\\n The reason for introducing IntegerSetBuilder as a more generic name than \\\"Filter\\\" is IntegerSets have uses outside of  filtering e.g. to do category counts or clustering. In these use cases they don\'t actually perform anything to do with filtering.  It may actually be better named DocIdSetBuilder given that it is tied to Lucene\'s IndexReader and therefore limited to producing sets of document ids.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12548341\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12548341&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12548341\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12548341_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12548341_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Dec\\/07 18:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-04T18:40:31+0000\'\u003e04\\/Dec\\/07 18:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFor the moment a DocId is an int, but that might change to long sooner than we think. So DocIdSet... would be a better name than IntegerSet..., and it\'s better to use an abstract superclass than an interface:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e\u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eclass \u003c\\/span\u003eDocIdSetIterator {\\n  \u003cspan class=\\\"code-object\\\"\u003eboolean\u003c\\/span\u003e next();\\n  \u003cspan class=\\\"code-object\\\"\u003eboolean\u003c\\/span\u003e skipTo(\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e next);\\n  \u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e doc();\\n}\\n\\n\u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ and the \u003cspan class=\\\"code-keyword\\\"\u003erest\u003c\\/span\u003e is in the patch, except the superclass \u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e Matcher:\\n\u003c\\/span\u003e\\n\u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eclass \u003c\\/span\u003eMatcher \u003cspan class=\\\"code-keyword\\\"\u003eextends\u003c\\/span\u003e DocIdSetIterator {\\n  Explanation explain(\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e doc);\\n}\\n\\n\u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eclass \u003c\\/span\u003eScorer \u003cspan class=\\\"code-keyword\\\"\u003eextends\u003c\\/span\u003e Matcher {\\n  \u003cspan class=\\\"code-object\\\"\u003efloat\u003c\\/span\u003e score();\\n  ...\\n}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eWould this DocIdSetIterator be close enough to the IntegerSetIterator?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12548341_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12548341_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Dec\\/07 18:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-04T18:40:31+0000\'\u003e04\\/Dec\\/07 18:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    For the moment a DocId is an int, but that might change to long sooner than we think. So DocIdSet... would be a better name than IntegerSet..., and it\'s better to use an abstract superclass than an interface: \\n\\n  \\n  abstract   class  DocIdSetIterator {\\n   boolean  next();\\n   boolean  skipTo( int  next);\\n   int  doc();\\n}\\n\\n \\/\\/ and the  rest  is in the patch, except the superclass  for  Matcher:\\n \\n abstract   class  Matcher  extends  DocIdSetIterator {\\n  Explanation explain( int  doc);\\n}\\n\\n abstract   class  Scorer  extends  Matcher {\\n   float  score();\\n  ...\\n}\\n \\n  \\n\\n Would this DocIdSetIterator be close enough to the IntegerSetIterator?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557566\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557566&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557566\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12557566_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557566_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/08 08:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-10T08:04:46+0000\'\u003e10\\/Jan\\/08 08:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK, I created a new patch based on the recent feedback.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis patch introduces two new abstract classes:\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e\\/**\\n * A DocIdSet contains a set of doc ids. Implementing classes must provide\\n * a {@link DocIdSetIterator} to access the set. \\n *\\/\\n\u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eclass \u003c\\/span\u003eDocIdSet {\\n  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e DocIdSetIterator iterator();\\n}\\n\\n\\/**\\n * This \u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eclass \u003c\\/span\u003edefines methods to iterate over a set of\\n * non-decreasing doc ids.\\n *\\/\\n\u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eclass \u003c\\/span\u003eDocIdSetIterator {\\n  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e doc();\\n  \\n  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eboolean\u003c\\/span\u003e next() \u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e IOException;\\n    \\n  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003eabstract\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eboolean\u003c\\/span\u003e skipTo(\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e target) \u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e IOException;\\n}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eAdditional changes:\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eScorer extends DocIdSetIterator now.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eFilter.bits(IndexReader) is not abstract anymore. It is deprecated and\u003cbr\\/\u003e\\nreturns null. Added method Filter.getDocIdSet(IndexReader) which returns\u003cbr\\/\u003e\\nnew DocIdBitSet(bits(reader)) for backwards compatibility.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eAdded getDocIdSet(IndexReader) implementations to all core readers and\u003cbr\\/\u003e\\ndeprecated bits(IndexReader). The Filters (e. g. RangeFilter) are now\u003cbr\\/\u003e\\nusing OpenBitSet instead of BitSet.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eMade according changes to the SpanFilter classes.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eFixed a bug in OpenBitSetIterator. It has an integer curDocId now, which\u003cbr\\/\u003e\\ndoc() returns. Before doc() sometimes returned wrong values. I also added\u003cbr\\/\u003e\\nTestOpenBitSet (take from current Solr trunk).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI haven\'t changed the contrib Filter implementations yet, they still use \u003cbr\\/\u003e\\nthe old (deprecated) API. We should address this with a different issue.\u003c\\/p\u003e\\n\\n\u003cp\u003eAll core &amp; contrib tests pass. This patch should also be fully backwards\u003cbr\\/\u003e\\ncompatible.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12557566_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557566_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/08 08:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-10T08:04:46+0000\'\u003e10\\/Jan\\/08 08:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK, I created a new patch based on the recent feedback. \\n\\n This patch introduces two new abstract classes: \\n  \\n \\/**\\n * A DocIdSet contains a set of doc ids. Implementing classes must provide\\n * a {@link DocIdSetIterator} to access the set. \\n *\\/\\n public   abstract   class  DocIdSet {\\n   public   abstract  DocIdSetIterator iterator();\\n}\\n\\n\\/**\\n * This  abstract   class  defines methods to iterate over a set of\\n * non-decreasing doc ids.\\n *\\/\\n public   abstract   class  DocIdSetIterator {\\n   public   abstract   int  doc();\\n  \\n   public   abstract   boolean  next()  throws  IOException;\\n    \\n   public   abstract   boolean  skipTo( int  target)  throws  IOException;\\n}\\n \\n  \\n\\n Additional changes: \\n\\n \\n\\t Scorer extends DocIdSetIterator now. \\n \\n\\n\\n \\n\\t Filter.bits(IndexReader) is not abstract anymore. It is deprecated and \\nreturns null. Added method Filter.getDocIdSet(IndexReader) which returns \\nnew DocIdBitSet(bits(reader)) for backwards compatibility. \\n \\n\\n\\n \\n\\t Added getDocIdSet(IndexReader) implementations to all core readers and \\ndeprecated bits(IndexReader). The Filters (e. g. RangeFilter) are now \\nusing OpenBitSet instead of BitSet. \\n \\n\\n\\n \\n\\t Made according changes to the SpanFilter classes. \\n \\n\\n\\n \\n\\t Fixed a bug in OpenBitSetIterator. It has an integer curDocId now, which \\ndoc() returns. Before doc() sometimes returned wrong values. I also added \\nTestOpenBitSet (take from current Solr trunk). \\n \\n\\n\\n I haven\'t changed the contrib Filter implementations yet, they still use  \\nthe old (deprecated) API. We should address this with a different issue. \\n\\n All core &amp; contrib tests pass. This patch should also be fully backwards \\ncompatible.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557595\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557595&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557595\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12557595_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557595_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/08 11:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-10T11:21:31+0000\'\u003e10\\/Jan\\/08 11:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOn the take3 patch of 10 Jan 2008:\u003c\\/p\u003e\\n\\n\u003cp\u003eSortedVIntList extends DocIdSet: nice, thanks.\u003c\\/p\u003e\\n\\n\u003cp\u003ePrefixGenerator is used but not defined in the patch, so it will not compile.\u003c\\/p\u003e\\n\\n\u003cp\u003eNevertheless, with all tests passing, I think this is a good way to\u003cbr\\/\u003e\\nmake Filter independent of BitSet.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eMinor concerns:\u003c\\/p\u003e\\n\\n\u003cp\u003eThere is neither a BitSetFilter nor an OpenBitSetFilter in the patch.\u003cbr\\/\u003e\\nThese might be useful for existing code currently implementing Filter\u003cbr\\/\u003e\\nto overcome the deprecation of Filter.bits().\u003cbr\\/\u003e\\nWith the current core moving to OpenBitSet, it might also use an\u003cbr\\/\u003e\\nexplicit OpenBitSetFilter.\u003c\\/p\u003e\\n\\n\u003cp\u003eSome javadoc changes did not make it into the take3 patch, I\'ll check these later.\u003c\\/p\u003e\\n\\n\u003cp\u003eFilteredQuery.explain(): When a document does not pass the Filter\u003cbr\\/\u003e\\nI think it would be better not to use setValue(0.0f) on the resulting\u003cbr\\/\u003e\\nExplanation. However, this may be necessary for backward compatibility.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eFor the future:\u003c\\/p\u003e\\n\\n\u003cp\u003eAbout adding a Filter as a clause to BooleanScorer, and adding\u003cbr\\/\u003e\\nDocSetIdIterator as a \\\"Scorer\\\" to ConjunctionScorer:\u003cbr\\/\u003e\\nThis is the reason for the CHECKME in IndexSearcher for using\u003cbr\\/\u003e\\nConjunctionScorer when a filter is given.\u003cbr\\/\u003e\\nA ConjunctionScorer that accepts a DocIdSetIterator could also be used in\u003cbr\\/\u003e\\nFilteredQuery.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12557595_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557595_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/08 11:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-10T11:21:31+0000\'\u003e10\\/Jan\\/08 11:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    On the take3 patch of 10 Jan 2008: \\n\\n SortedVIntList extends DocIdSet: nice, thanks. \\n\\n PrefixGenerator is used but not defined in the patch, so it will not compile. \\n\\n Nevertheless, with all tests passing, I think this is a good way to \\nmake Filter independent of BitSet. \\n\\n\\n Minor concerns: \\n\\n There is neither a BitSetFilter nor an OpenBitSetFilter in the patch. \\nThese might be useful for existing code currently implementing Filter \\nto overcome the deprecation of Filter.bits(). \\nWith the current core moving to OpenBitSet, it might also use an \\nexplicit OpenBitSetFilter. \\n\\n Some javadoc changes did not make it into the take3 patch, I\'ll check these later. \\n\\n FilteredQuery.explain(): When a document does not pass the Filter \\nI think it would be better not to use setValue(0.0f) on the resulting \\nExplanation. However, this may be necessary for backward compatibility. \\n\\n\\n For the future: \\n\\n About adding a Filter as a clause to BooleanScorer, and adding \\nDocSetIdIterator as a \\\"Scorer\\\" to ConjunctionScorer: \\nThis is the reason for the CHECKME in IndexSearcher for using \\nConjunctionScorer when a filter is given. \\nA ConjunctionScorer that accepts a DocIdSetIterator could also be used in \\nFilteredQuery.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557755\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557755&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557755\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12557755_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557755_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/08 19:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-10T19:18:12+0000\'\u003e10\\/Jan\\/08 19:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eOn the take3 patch of 10 Jan 2008:\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThanks for the review!\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003ePrefixGenerator is used but not defined in the patch, so it will not compile.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eNot sure I understand what you mean. PrefixGenerator is (and was) \u003cbr\\/\u003e\\ndefined in PrefixFilter.java. It compiles for me.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eThere is neither a BitSetFilter nor an OpenBitSetFilter in the patch.\u003cbr\\/\u003e\\nThese might be useful for existing code currently implementing Filter\u003cbr\\/\u003e\\nto overcome the deprecation of Filter.bits().\u003cbr\\/\u003e\\nWith the current core moving to OpenBitSet, it might also use an\u003cbr\\/\u003e\\nexplicit OpenBitSetFilter.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think that it should be straightforward for users having filters that use\u003cbr\\/\u003e\\nBitSets to wrap the new DocIdBitSet around the BitSet, just as Filter currently \u003cbr\\/\u003e\\ndoes for backwards compatibility?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eSome javadoc changes did not make it into the take3 patch, I\'ll check these later.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eOh, which ones?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eFilteredQuery.explain(): When a document does not pass the Filter\u003cbr\\/\u003e\\nI think it would be better not to use setValue(0.0f) on the resulting\u003cbr\\/\u003e\\nExplanation. However, this may be necessary for backward compatibility.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYeah, it used to work this way, that\'s why I didn\'t change it for backwards-\u003cbr\\/\u003e\\ncompatibility reasons.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eAbout adding a Filter as a clause to BooleanScorer, and adding\u003cbr\\/\u003e\\nDocSetIdIterator as a \\\"Scorer\\\" to ConjunctionScorer:\u003cbr\\/\u003e\\nThis is the reason for the CHECKME in IndexSearcher for using\u003cbr\\/\u003e\\nConjunctionScorer when a filter is given.\u003cbr\\/\u003e\\nA ConjunctionScorer that accepts a DocIdSetIterator could also be used in\u003cbr\\/\u003e\\nFilteredQuery.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWell, let\'s address this with a different issue after this one is committed.\u003cbr\\/\u003e\\nI might have some concerns here, but I\'ve to further think about it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12557755_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557755_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/08 19:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-10T19:18:12+0000\'\u003e10\\/Jan\\/08 19:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n On the take3 patch of 10 Jan 2008:  \\n\\n Thanks for the review! \\n\\n \\n PrefixGenerator is used but not defined in the patch, so it will not compile.  \\n\\n Not sure I understand what you mean. PrefixGenerator is (and was)  \\ndefined in PrefixFilter.java. It compiles for me. \\n\\n \\n There is neither a BitSetFilter nor an OpenBitSetFilter in the patch. \\nThese might be useful for existing code currently implementing Filter \\nto overcome the deprecation of Filter.bits(). \\nWith the current core moving to OpenBitSet, it might also use an \\nexplicit OpenBitSetFilter.  \\n\\n I think that it should be straightforward for users having filters that use \\nBitSets to wrap the new DocIdBitSet around the BitSet, just as Filter currently  \\ndoes for backwards compatibility? \\n\\n \\n Some javadoc changes did not make it into the take3 patch, I\'ll check these later.  \\n\\n Oh, which ones? \\n\\n \\n FilteredQuery.explain(): When a document does not pass the Filter \\nI think it would be better not to use setValue(0.0f) on the resulting \\nExplanation. However, this may be necessary for backward compatibility.  \\n\\n Yeah, it used to work this way, that\'s why I didn\'t change it for backwards- \\ncompatibility reasons. \\n\\n \\n About adding a Filter as a clause to BooleanScorer, and adding \\nDocSetIdIterator as a \\\"Scorer\\\" to ConjunctionScorer: \\nThis is the reason for the CHECKME in IndexSearcher for using \\nConjunctionScorer when a filter is given. \\nA ConjunctionScorer that accepts a DocIdSetIterator could also be used in \\nFilteredQuery.  \\n\\n Well, let\'s address this with a different issue after this one is committed. \\nI might have some concerns here, but I\'ve to further think about it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557814\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557814&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557814\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12557814_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557814_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/08 22:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-10T22:05:02+0000\'\u003e10\\/Jan\\/08 22:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs for PrefixGenerator:\u003cbr\\/\u003e\\nin my (up to date) trunk directory, this command: find . -name \'\u003cb\u003ePrefixGenerator\u003c\\/b\u003e\'\u003cbr\\/\u003e\\nonly gave this result: .\\/build\\/classes\\/java\\/org\\/apache\\/lucene\\/search\\/PrefixGenerator.class\u003cbr\\/\u003e\\nand that disappeared after ant clean.\u003cbr\\/\u003e\\nIt seems that the source class was removed from the trunk.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eI think that it should be straightforward for users having filters that use\u003cbr\\/\u003e\\nBitSets to wrap the new DocIdBitSet around the BitSet, just as Filter currently\u003cbr\\/\u003e\\ndoes for backwards compatibility?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eBitSetFilter would inherit from Filter, and have an abstract bits() method, not deprecated.\u003cbr\\/\u003e\\nThis would be useful for people that don\'t what to move to OpenBitSet yet.\u003cbr\\/\u003e\\nA rename (and maybe a package change) from Filter to BitSetFilter should be sufficient\u003cbr\\/\u003e\\nin their code to get rid of the deprecation warning for Filter.bits().\u003c\\/p\u003e\\n\\n\u003cp\u003eOpenBitSetFilter similar, and that could be used in a few places in the patch iirc.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe javadoc changes I meant came with Matcher and use \'match\' consistently for documents\u003cbr\\/\u003e\\nthat are collected during a query search.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12557814_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557814_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/08 22:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-10T22:05:02+0000\'\u003e10\\/Jan\\/08 22:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As for PrefixGenerator: \\nin my (up to date) trunk directory, this command: find . -name \' PrefixGenerator \' \\nonly gave this result: .\\/build\\/classes\\/java\\/org\\/apache\\/lucene\\/search\\/PrefixGenerator.class \\nand that disappeared after ant clean. \\nIt seems that the source class was removed from the trunk. \\n\\n \\n I think that it should be straightforward for users having filters that use \\nBitSets to wrap the new DocIdBitSet around the BitSet, just as Filter currently \\ndoes for backwards compatibility?  \\n\\n BitSetFilter would inherit from Filter, and have an abstract bits() method, not deprecated. \\nThis would be useful for people that don\'t what to move to OpenBitSet yet. \\nA rename (and maybe a package change) from Filter to BitSetFilter should be sufficient \\nin their code to get rid of the deprecation warning for Filter.bits(). \\n\\n OpenBitSetFilter similar, and that could be used in a few places in the patch iirc. \\n\\n The javadoc changes I meant came with Matcher and use \'match\' consistently for documents \\nthat are collected during a query search. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557935\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557935&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557935\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12557935_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557935_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 08:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T08:44:14+0000\'\u003e11\\/Jan\\/08 08:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eAs for PrefixGenerator:\u003cbr\\/\u003e\\nin my (up to date) trunk directory, this command: find . -name \'PrefixGenerator\'\u003cbr\\/\u003e\\nonly gave this result: .\\/build\\/classes\\/java\\/org\\/apache\\/lucene\\/search\\/PrefixGenerator.class\u003cbr\\/\u003e\\nand that disappeared after ant clean.\u003cbr\\/\u003e\\nIt seems that the source class was removed from the trunk.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eAs I said, PrefixGenerator is defined in PrefixFilter.java.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12557935_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557935_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 08:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T08:44:14+0000\'\u003e11\\/Jan\\/08 08:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n As for PrefixGenerator: \\nin my (up to date) trunk directory, this command: find . -name \'PrefixGenerator\' \\nonly gave this result: .\\/build\\/classes\\/java\\/org\\/apache\\/lucene\\/search\\/PrefixGenerator.class \\nand that disappeared after ant clean. \\nIt seems that the source class was removed from the trunk.  \\n\\n As I said, PrefixGenerator is defined in PrefixFilter.java.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557936\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557936&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557936\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12557936_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557936_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 08:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T08:58:06+0000\'\u003e11\\/Jan\\/08 08:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eBitSetFilter would inherit from Filter, and have an abstract bits() method, not deprecated.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eOK I added a BitSetFilter. The rest of the patch is identical to take3.\u003c\\/p\u003e\\n\\n\u003cp\u003eI thought that I copied all your javadoc changes that still applied (after the removal of Matcher, MatchFilter, etc.) over into this patch. But well, if you think I missed any important ones let me know or feel free to update the patch!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12557936_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557936_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 08:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T08:58:06+0000\'\u003e11\\/Jan\\/08 08:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n BitSetFilter would inherit from Filter, and have an abstract bits() method, not deprecated.  \\n\\n OK I added a BitSetFilter. The rest of the patch is identical to take3. \\n\\n I thought that I copied all your javadoc changes that still applied (after the removal of Matcher, MatchFilter, etc.) over into this patch. But well, if you think I missed any important ones let me know or feel free to update the patch!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557955\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557955&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557955\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12557955_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557955_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 10:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T10:30:18+0000\'\u003e11\\/Jan\\/08 10:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m sorry about my PrefixGenerator remarks, I did not read your answer accurately.\u003c\\/p\u003e\\n\\n\u003cp\u003eOn the take4 patch of 11 Jan 2008:\u003c\\/p\u003e\\n\\n\u003cp\u003eI have started in a fresh trunk checkout that passed all tests.\u003cbr\\/\u003e\\nBoth parts of take4 apply cleanly, using patch -p0 &lt; ... .\u003cbr\\/\u003e\\nant jar, ant test-core and ant test-contrib all pass nicely.\u003c\\/p\u003e\\n\\n\u003cp\u003eI remember having problems with moving contrib\\/xml-queryparser from Filter\u003cbr\\/\u003e\\nto BitSetFilter, see my comment of 30 July 2007.\u003cbr\\/\u003e\\nSo I\'d like to verify that this can be done, and I hope Mark Harwood can give\u003cbr\\/\u003e\\nsome hints as to how to do this.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor me, this was the main reason to make this move:\u003cbr\\/\u003e\\nfrom Filter with subclass BitSetFilter (as in the take4 patch, and in my first attempts)\u003cbr\\/\u003e\\nto MatchFilter with subclass Filter (as in Matcher... patches of Sep and Nov 2007).\u003cbr\\/\u003e\\nIn these Matcher... patches no changes were necessary to contrib\\/xml-queryparser.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eLess important for now:\u003c\\/p\u003e\\n\\n\u003cp\u003eThe test classes extend TestCase, but iirc there is also a LuceneTestCase for this.\u003c\\/p\u003e\\n\\n\u003cp\u003eOn the take4 patch ant javadocs-core gives this:\u003cbr\\/\u003e\\nBitSetFilter.java:40: warning - Tag @link: reference not found: DocIdBitSetIterator\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12557955_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557955_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 10:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T10:30:18+0000\'\u003e11\\/Jan\\/08 10:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m sorry about my PrefixGenerator remarks, I did not read your answer accurately. \\n\\n On the take4 patch of 11 Jan 2008: \\n\\n I have started in a fresh trunk checkout that passed all tests. \\nBoth parts of take4 apply cleanly, using patch -p0 &lt; ... . \\nant jar, ant test-core and ant test-contrib all pass nicely. \\n\\n I remember having problems with moving contrib\\/xml-queryparser from Filter \\nto BitSetFilter, see my comment of 30 July 2007. \\nSo I\'d like to verify that this can be done, and I hope Mark Harwood can give \\nsome hints as to how to do this. \\n\\n For me, this was the main reason to make this move: \\nfrom Filter with subclass BitSetFilter (as in the take4 patch, and in my first attempts) \\nto MatchFilter with subclass Filter (as in Matcher... patches of Sep and Nov 2007). \\nIn these Matcher... patches no changes were necessary to contrib\\/xml-queryparser. \\n\\n\\n Less important for now: \\n\\n The test classes extend TestCase, but iirc there is also a LuceneTestCase for this. \\n\\n On the take4 patch ant javadocs-core gives this: \\nBitSetFilter.java:40: warning - Tag @link: reference not found: DocIdBitSetIterator              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557992\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557992&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557992\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12557992_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557992_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 14:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T14:06:24+0000\'\u003e11\\/Jan\\/08 14:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI tried to move contrib from Filter.bits() to BitSetFilter.bits().\u003c\\/p\u003e\\n\\n\u003cp\u003eThe ContribQueries20080111.patch does that with contrib\\/queries,\u003cbr\\/\u003e\\nand with that applied the xml-query-parser tests still pass.\u003cbr\\/\u003e\\nI don\'t expect changes will be needed to xml-query-parser because it\u003cbr\\/\u003e\\ndoes not use Filter.bits().\u003cbr\\/\u003e\\nAt the moment I don\'t know why I had problems with it half a year ago.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eFor contrib\\/miscellaneous the changes needed to ChainedFilter are more involved:\u003c\\/p\u003e\\n\\n\u003cp\u003eTo make the tests pass, I had to make RangeFilter and QueryFilter subclasses of BitSetFilter, and to remove the final keyword from BitSetFilter.getDocIdSet().\u003cbr\\/\u003e\\nThe alternative would be to add BitSet versions of RangeFilter and QueryFilter\u003cbr\\/\u003e\\nto ChainedFilterTest.\u003cbr\\/\u003e\\nSo it can be made to work, but ChainedFilter and\\/or ChainedFilterTest will need to be changed.\u003c\\/p\u003e\\n\\n\u003cp\u003eStepping back a bit, I think ChainedFilter might better move to OpenBitSetFilter.\u003cbr\\/\u003e\\nNo patch for contrib\\/miscelleneous, it\'s too ugly at the moment here.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe conclusion is that I see no real problems with the take4 patch to move contrib\u003cbr\\/\u003e\\nfrom Filter.bits to BitSetFilter.bits.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12557992_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557992_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 14:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T14:06:24+0000\'\u003e11\\/Jan\\/08 14:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I tried to move contrib from Filter.bits() to BitSetFilter.bits(). \\n\\n The ContribQueries20080111.patch does that with contrib\\/queries, \\nand with that applied the xml-query-parser tests still pass. \\nI don\'t expect changes will be needed to xml-query-parser because it \\ndoes not use Filter.bits(). \\nAt the moment I don\'t know why I had problems with it half a year ago. \\n\\n\\n For contrib\\/miscellaneous the changes needed to ChainedFilter are more involved: \\n\\n To make the tests pass, I had to make RangeFilter and QueryFilter subclasses of BitSetFilter, and to remove the final keyword from BitSetFilter.getDocIdSet(). \\nThe alternative would be to add BitSet versions of RangeFilter and QueryFilter \\nto ChainedFilterTest. \\nSo it can be made to work, but ChainedFilter and\\/or ChainedFilterTest will need to be changed. \\n\\n Stepping back a bit, I think ChainedFilter might better move to OpenBitSetFilter. \\nNo patch for contrib\\/miscelleneous, it\'s too ugly at the moment here. \\n\\n The conclusion is that I see no real problems with the take4 patch to move contrib \\nfrom Filter.bits to BitSetFilter.bits.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12557999\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12557999&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12557999\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12557999_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557999_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 14:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T14:44:59+0000\'\u003e11\\/Jan\\/08 14:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eit looks like  ChainedFilter could  become obsolete if Filter\\/DocSetIdIterator gets added as a Clause to the  BooleanQuery? I am thinking along the lines: ChainedFilter evaluates boolean expression of docId-s, that is exactly what BooleanQuery does plus \\\"a bit\\\" more (scoring)... \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12557999_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12557999_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 14:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T14:44:59+0000\'\u003e11\\/Jan\\/08 14:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    it looks like  ChainedFilter could  become obsolete if Filter\\/DocSetIdIterator gets added as a Clause to the  BooleanQuery? I am thinking along the lines: ChainedFilter evaluates boolean expression of docId-s, that is exactly what BooleanQuery does plus \\\"a bit\\\" more (scoring)...               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12558076\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12558076&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12558076\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12558076_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558076_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T19:24:19+0000\'\u003e11\\/Jan\\/08 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eit looks like ChainedFilter could become obsolete if Filter\\/DocSetIdIterator gets added as a Clause to the BooleanQuery?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThe function is indeed the same, but ChainedFilter works directly on BitSets and BooleanQuery works on input Scorers\\/DocIdSetIterators and outputs collected docids (and score values). Working directly on  (Open)BitSets is normally faster, so ChainedFilter can have a good use.\u003cbr\\/\u003e\\nAnd boolean operations on DocIdSets are not (yet) directly available in Lucene. The various boolean scorers have the logic, but currently only for Scorers.\u003c\\/p\u003e\\n\\n\u003cp\u003eThat leaves the question on what to do with ChainedFilter here. Any ideas?\u003cbr\\/\u003e\\nThe easiest way is to open another issue for it. This will have to be resolved before Filter.bits() is removed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12558076_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558076_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T19:24:19+0000\'\u003e11\\/Jan\\/08 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n it looks like ChainedFilter could become obsolete if Filter\\/DocSetIdIterator gets added as a Clause to the BooleanQuery?  \\n\\n The function is indeed the same, but ChainedFilter works directly on BitSets and BooleanQuery works on input Scorers\\/DocIdSetIterators and outputs collected docids (and score values). Working directly on  (Open)BitSets is normally faster, so ChainedFilter can have a good use. \\nAnd boolean operations on DocIdSets are not (yet) directly available in Lucene. The various boolean scorers have the logic, but currently only for Scorers. \\n\\n That leaves the question on what to do with ChainedFilter here. Any ideas? \\nThe easiest way is to open another issue for it. This will have to be resolved before Filter.bits() is removed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12558115\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12558115&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12558115\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12558115_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558115_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 20:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T20:40:26+0000\'\u003e11\\/Jan\\/08 20:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ehmm, in order to have fast and\\/or operations we need to know the type of the underlaying object in Filter, and sometimes we must use iterators (e.g. case where one Filter\\/DocSetId is int list and another Hash bit set ). I guess, knowing type of DocIdSet is the trick to pool. \u003c\\/p\u003e\\n\\n\u003cp\u003eDefault implementation of ChainedFilter (there is also BooleanFilter somewhere in contrib, I like it more) should be using iterator (like scorers), and at a few key points checking if(first instance of SomeInstanceOfDocIdSet &amp;&amp; second  SomeInstanceOfDocIdSet) first.doFastOR\\/AND(second);\u003c\\/p\u003e\\n\\n\u003cp\u003esomething in that direction looks reasonable to me for ChainedFilter \u003cbr\\/\u003e\\nIf it proves to be really better to have it around. I am still of an opinion that it would be better to integrate DocIdSet into BooleanQuery as a clause, somehow, that would be some kind of ConstantBoolean(MUST\\/SHOULD\\/NOT)Clause, much cleaner from design\\/usability point of view, even at some minor penalty in performance (anyhow, you can always combine filters before you enter scorers) but you are right that is another issue... let us stop polluting this issue \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e \u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12558115_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558115_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 20:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T20:40:26+0000\'\u003e11\\/Jan\\/08 20:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    hmm, in order to have fast and\\/or operations we need to know the type of the underlaying object in Filter, and sometimes we must use iterators (e.g. case where one Filter\\/DocSetId is int list and another Hash bit set ). I guess, knowing type of DocIdSet is the trick to pool.  \\n\\n Default implementation of ChainedFilter (there is also BooleanFilter somewhere in contrib, I like it more) should be using iterator (like scorers), and at a few key points checking if(first instance of SomeInstanceOfDocIdSet &amp;&amp; second  SomeInstanceOfDocIdSet) first.doFastOR\\/AND(second); \\n\\n something in that direction looks reasonable to me for ChainedFilter  \\nIf it proves to be really better to have it around. I am still of an opinion that it would be better to integrate DocIdSet into BooleanQuery as a clause, somehow, that would be some kind of ConstantBoolean(MUST\\/SHOULD\\/NOT)Clause, much cleaner from design\\/usability point of view, even at some minor penalty in performance (anyhow, you can always combine filters before you enter scorers) but you are right that is another issue... let us stop polluting this issue    \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12558118\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12558118&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12558118\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12558118_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558118_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 20:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T20:47:02+0000\'\u003e11\\/Jan\\/08 20:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI moved Filter \\\"forward\\\" by removing the deprecated bits() method\u003cbr\\/\u003e\\nand declaring the getDocIdSet() method abstract.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo get ant test-core passing with this it was necessary to\u003cbr\\/\u003e\\nupdate some test code to implement Filter.getDocIdSet(),\u003cbr\\/\u003e\\nand a patch for that is attached: Test20080111.patch .\u003c\\/p\u003e\\n\\n\u003cp\u003eThe change to Filter is not included in the patch.\u003cbr\\/\u003e\\nAlso, in a few places in the take4 patch Filter.bits() is used\u003cbr\\/\u003e\\ndeprecated methods. These methods had to be removed, but this\u003cbr\\/\u003e\\nremoval is not included in the patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12558118_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558118_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 20:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T20:47:02+0000\'\u003e11\\/Jan\\/08 20:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I moved Filter \\\"forward\\\" by removing the deprecated bits() method \\nand declaring the getDocIdSet() method abstract. \\n\\n To get ant test-core passing with this it was necessary to \\nupdate some test code to implement Filter.getDocIdSet(), \\nand a patch for that is attached: Test20080111.patch . \\n\\n The change to Filter is not included in the patch. \\nAlso, in a few places in the take4 patch Filter.bits() is used \\ndeprecated methods. These methods had to be removed, but this \\nremoval is not included in the patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12558121\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12558121&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12558121\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12558121_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558121_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 20:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T20:48:26+0000\'\u003e11\\/Jan\\/08 20:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpload once more, this time with licence.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12558121_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558121_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/08 20:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-11T20:48:26+0000\'\u003e11\\/Jan\\/08 20:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Upload once more, this time with licence.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12558856\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12558856&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12558856\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12558856_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558856_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jan\\/08 00:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-15T00:02:46+0000\'\u003e15\\/Jan\\/08 00:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think I understand now which problems you had when you wanted to \u003cbr\\/\u003e\\nchange BooleanFilter and xml-query-parser to use the new Filter APIs.\u003c\\/p\u003e\\n\\n\u003cp\u003eBooleanFilter is optimized to utilize BitSets for performing boolean\u003cbr\\/\u003e\\noperations fast. Now if we change BooleanFilter to use the new \u003cbr\\/\u003e\\nDocIdSetIterator, then it can\'t use the fast BitSet operations (e. g.\u003cbr\\/\u003e\\nunion for or, intersect for and) anymore. \u003c\\/p\u003e\\n\\n\u003cp\u003eNow we can introduce BitSetFilter as you suggested and what I did in\u003cbr\\/\u003e\\nthe take4 patch. But here\'s the problem: Introducing subclasses of \u003cbr\\/\u003e\\nFilter doesn\'t play nicely with the caching mechanism in Lucene.\u003cbr\\/\u003e\\nFor example: if we change BooleanFilter to only work with \u003cbr\\/\u003e\\nBitSetFilters, then it won\'t work with a CachingWrapperFilter anymore,\u003cbr\\/\u003e\\nbecause CachingWrapperFilter extends Filter. Then we would have to\u003cbr\\/\u003e\\nintroduce new CachingWrapper***Filter, for the different kinds of\u003cbr\\/\u003e\\nFilter subclasses, which is a bad design as Mark pointed out in his\u003cbr\\/\u003e\\ncomment: \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547901#action_12547901\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547901#action_12547901\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eOne solution would be to add a getBitSet() method to DocIdBitSet.\u003cbr\\/\u003e\\nDocIdBitSet is a new class that is basically just a wrapper around a\u003cbr\\/\u003e\\nJava BitSet and provides a DocIdSetIterator to access the BitSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eThen BooleanFilter could do something like this:\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003eDocIdSet docIdSet = filter.getDocIdSet();\\n\u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (docIdSet \u003cspan class=\\\"code-keyword\\\"\u003einstanceof\u003c\\/span\u003e DocIdBitSet) {\\n  BitSet bits = ((DocIdBitSet) docIdSet).getBitSet();\\n  ... \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ existing code\\n\u003c\\/span\u003e} \u003cspan class=\\\"code-keyword\\\"\u003eelse\u003c\\/span\u003e {\\n  \u003cspan class=\\\"code-keyword\\\"\u003ethrow\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e UnsupportedOperationException(\\\"BooleanFilter only \\n  supports Filters that use DocIdBitSet.\\\");\\n}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eBut then, changing the core filters to use OpenBitSets instead of\u003cbr\\/\u003e\\nJava BitSets is technically an API change, because BooleanFilter\u003cbr\\/\u003e\\nwould not work anymore with the core filters.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo if we took this approach we would have to wait until 3.0 to move\u003cbr\\/\u003e\\nthe core from BitSet to OpenBitSet and also change BooleanFilter \u003cbr\\/\u003e\\nthen to use OpenBitSets. BooleanFilter could then also work with\u003cbr\\/\u003e\\neither of the two BitSet implementions, but probably not with those\u003cbr\\/\u003e\\ntwo mixed.\u003c\\/p\u003e\\n\\n\u003cp\u003eAny feedback about this is very welcome. I\'ll try to further think\u003cbr\\/\u003e\\nabout how to marry the new Filter API, caching mechanism and Filter\u003cbr\\/\u003e\\nimplementations like BooleanFilter nicely.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12558856_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558856_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jan\\/08 00:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-15T00:02:46+0000\'\u003e15\\/Jan\\/08 00:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think I understand now which problems you had when you wanted to  \\nchange BooleanFilter and xml-query-parser to use the new Filter APIs. \\n\\n BooleanFilter is optimized to utilize BitSets for performing boolean \\noperations fast. Now if we change BooleanFilter to use the new  \\nDocIdSetIterator, then it can\'t use the fast BitSet operations (e. g. \\nunion for or, intersect for and) anymore.  \\n\\n Now we can introduce BitSetFilter as you suggested and what I did in \\nthe take4 patch. But here\'s the problem: Introducing subclasses of  \\nFilter doesn\'t play nicely with the caching mechanism in Lucene. \\nFor example: if we change BooleanFilter to only work with  \\nBitSetFilters, then it won\'t work with a CachingWrapperFilter anymore, \\nbecause CachingWrapperFilter extends Filter. Then we would have to \\nintroduce new CachingWrapper***Filter, for the different kinds of \\nFilter subclasses, which is a bad design as Mark pointed out in his \\ncomment:  https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12547901#action_12547901  \\n\\n One solution would be to add a getBitSet() method to DocIdBitSet. \\nDocIdBitSet is a new class that is basically just a wrapper around a \\nJava BitSet and provides a DocIdSetIterator to access the BitSet. \\n\\n Then BooleanFilter could do something like this: \\n  \\n DocIdSet docIdSet = filter.getDocIdSet();\\n if  (docIdSet  instanceof  DocIdBitSet) {\\n  BitSet bits = ((DocIdBitSet) docIdSet).getBitSet();\\n  ...  \\/\\/ existing code\\n }  else  {\\n   throw   new  UnsupportedOperationException(\\\"BooleanFilter only \\n  supports Filters that use DocIdBitSet.\\\");\\n}\\n \\n  \\n\\n But then, changing the core filters to use OpenBitSets instead of \\nJava BitSets is technically an API change, because BooleanFilter \\nwould not work anymore with the core filters. \\n\\n So if we took this approach we would have to wait until 3.0 to move \\nthe core from BitSet to OpenBitSet and also change BooleanFilter  \\nthen to use OpenBitSets. BooleanFilter could then also work with \\neither of the two BitSet implementions, but probably not with those \\ntwo mixed. \\n\\n Any feedback about this is very welcome. I\'ll try to further think \\nabout how to marry the new Filter API, caching mechanism and Filter \\nimplementations like BooleanFilter nicely.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12558997\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12558997&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12558997\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12558997_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558997_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jan\\/08 09:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-15T09:44:19+0000\'\u003e15\\/Jan\\/08 09:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMichal, would this work? \u003cbr\\/\u003e\\n1. providing default implementation for basic methods that is using skipping iterator(always there), so it works by default for \u003cb\u003eall\u003c\\/b\u003e implementations, something along the lines:\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/**\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eA DocIdSet contains a set of doc ids. Implementing classes must provide\u003c\\/li\u003e\\n\\t\u003cli\u003ea \\n{@link DocIdSetIterator}\\n\u003cp\u003e to access the set.\u003cbr\\/\u003e\\n *\\/\u003cbr\\/\u003e\\npublic abstract class DocIdSet {\u003cbr\\/\u003e\\n\\tpublic abstract DocIdSetIterator iterator();\u003c\\/p\u003e\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003epublic  DocIdSet and(DocIdSet){\u003cbr\\/\u003e\\n\\/\\/ default implementation using \u003cb\u003eiterator\u003c\\/b\u003e;\u003cbr\\/\u003e\\n}\u003c\\/p\u003e\\n\\n\u003cp\u003epublic  DocIdSet or(DocIdSet)\u003c\\/p\u003e\\n{\\n\\/\\/ default implementation using iterator;\\n}\\n\\n}\\n\\n\u003cp\u003e2.  And then we \u003cb\u003eoptimize\u003c\\/b\u003e particular cases, e.g\u003c\\/p\u003e\\n\\n\u003cp\u003epublic class DocIdBitSet extends DocIdSet{   \u003cbr\\/\u003e\\n        BitSet bits; \\/\\/ Must be there in order for iterator to work....\u003c\\/p\u003e\\n\\n\u003cp\u003e\\tpublic DocIdSetIterator iterator()\u003c\\/p\u003e\\n{\\n\\t\\t\\/\\/this is easy...\\n\\t}\\n\\n\u003cp\u003epublic  DocIdSet and(DocIdSet dis){\u003cbr\\/\u003e\\n\\tif (dois instanceof DocIdBitSet) \u003c\\/p\u003e\\n{\\n                \\/\\/not exactly like this, but the idea is there\\n  \\t\\t this.bits.and(((DocIdBitSet) dis));\\n\\t\\t return this;\\n \\t}\\n\u003cp\u003e\\treturn super.and(DocIdSet);\u003c\\/p\u003e\\n\\n\u003cp\u003e }\u003cbr\\/\u003e\\n}\u003c\\/p\u003e\\n\\n\u003cp\u003eSo it works always, and it works fast if need be, one instanceof check does not hurt there. Did I miss something obvious?\u003c\\/p\u003e\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"eksdev\\\" id=\\\"commentauthor_12558997_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=eksdev\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"eksdev\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Eks Dev\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12558997_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jan\\/08 09:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-15T09:44:19+0000\'\u003e15\\/Jan\\/08 09:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Michal, would this work?  \\n1. providing default implementation for basic methods that is using skipping iterator(always there), so it works by default for  all  implementations, something along the lines: \\n\\n \\/** \\n \\n\\t A DocIdSet contains a set of doc ids. Implementing classes must provide \\n\\t a \\n{@link DocIdSetIterator}\\n  to access the set. \\n *\\/ \\npublic abstract class DocIdSet { \\n\\tpublic abstract DocIdSetIterator iterator();  \\n \\n\\n\\n public  DocIdSet and(DocIdSet){ \\n\\/\\/ default implementation using  iterator ; \\n} \\n\\n public  DocIdSet or(DocIdSet) \\n{\\n\\/\\/ default implementation using iterator;\\n}\\n\\n}\\n\\n 2.  And then we  optimize  particular cases, e.g \\n\\n public class DocIdBitSet extends DocIdSet{    \\n        BitSet bits; \\/\\/ Must be there in order for iterator to work.... \\n\\n \\tpublic DocIdSetIterator iterator() \\n{\\n\\t\\t\\/\\/this is easy...\\n\\t}\\n\\n public  DocIdSet and(DocIdSet dis){ \\n\\tif (dois instanceof DocIdBitSet)  \\n{\\n                \\/\\/not exactly like this, but the idea is there\\n  \\t\\t this.bits.and(((DocIdBitSet) dis));\\n\\t\\t return this;\\n \\t}\\n \\treturn super.and(DocIdSet); \\n\\n  } \\n} \\n\\n So it works always, and it works fast if need be, one instanceof check does not hurt there. Did I miss something obvious? \\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12559168\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12559168&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12559168\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12559168_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12559168_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jan\\/08 18:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-15T18:52:34+0000\'\u003e15\\/Jan\\/08 18:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI indeed recall having an problem with remote filter caching. At the time I thought it was related to serialization but I could not resolve it that way. Never mind, it does not matter anymore.\u003c\\/p\u003e\\n\\n\u003cp\u003eBooleanFilter and ChainedFilter have the same issue here. As they provide just about the same functionality, could they perhaps be merged?\u003c\\/p\u003e\\n\\n\u003cp\u003eThe solution using DocIdSet.and() and DocIdSet.or() looks good to me, but it will require some form of collector for the results, much like HitCollector.collect(doc, score) now and MatchCollector.collect(doc) in the Matcher...patch.\u003cbr\\/\u003e\\nThe boolean operations could then be accumulated into a BitSet or into an OpenBitSet, using a special case for DocId(Open)BitSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'d like these boolean operations on DocIdSets to be general enough for use in Scorers, for example for the conjunctions in ConjunctionScorer, PhraseScorer and in the two NearSpans. But that is another issue.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12559168_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12559168_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jan\\/08 18:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-15T18:52:34+0000\'\u003e15\\/Jan\\/08 18:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I indeed recall having an problem with remote filter caching. At the time I thought it was related to serialization but I could not resolve it that way. Never mind, it does not matter anymore. \\n\\n BooleanFilter and ChainedFilter have the same issue here. As they provide just about the same functionality, could they perhaps be merged? \\n\\n The solution using DocIdSet.and() and DocIdSet.or() looks good to me, but it will require some form of collector for the results, much like HitCollector.collect(doc, score) now and MatchCollector.collect(doc) in the Matcher...patch. \\nThe boolean operations could then be accumulated into a BitSet or into an OpenBitSet, using a special case for DocId(Open)BitSet. \\n\\n I\'d like these boolean operations on DocIdSets to be general enough for use in Scorers, for example for the conjunctions in ConjunctionScorer, PhraseScorer and in the two NearSpans. But that is another issue. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564415\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12564415&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564415\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12564415_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564415_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 17:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T17:27:40+0000\'\u003e31\\/Jan\\/08 17:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Paul,\u003cbr\\/\u003e\\nJust eyeballed the code but not had a chance to patch and run it yet.\u003c\\/p\u003e\\n\\n\u003cp\u003eI was wondering about the return type for skipTo() after looking at these types of calls:\u003cbr\\/\u003e\\n       if (docIdSetIterator.skipTo\u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/information.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e &amp;&amp; (docIdSetIterator.doc() == i))\u003c\\/p\u003e\\n\\n\u003cp\u003eYou could save a method invocation in cases like this if skipTo() returned the next doc id rather than a boolean. Returning a -1 would be the equivalent of what used to be \\\"false\\\".\u003cbr\\/\u003e\\nNot tried benchmarking it but does this seem like something worth considering?\u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12564415_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564415_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 17:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T17:27:40+0000\'\u003e31\\/Jan\\/08 17:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Paul, \\nJust eyeballed the code but not had a chance to patch and run it yet. \\n\\n I was wondering about the return type for skipTo() after looking at these types of calls: \\n       if (docIdSetIterator.skipTo  &amp;&amp; (docIdSetIterator.doc() == i)) \\n\\n You could save a method invocation in cases like this if skipTo() returned the next doc id rather than a boolean. Returning a -1 would be the equivalent of what used to be \\\"false\\\". \\nNot tried benchmarking it but does this seem like something worth considering? \\n\\n Cheers \\nMark              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564620\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12564620&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564620\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12564620_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564620_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 03:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T03:46:33+0000\'\u003e01\\/Feb\\/08 03:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eYou could save a method invocation in cases like this if skipTo() returned the next doc id rather than a boolean. Returning a -1 would be the equivalent of what used to be \\\"false\\\".\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eTo change the signature of skipTo()  would be an API change, because with this patch Scorer extends DocIdSetIterator.\u003c\\/p\u003e\\n\\n\u003cp\u003e-Michael\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12564620_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564620_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 03:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T03:46:33+0000\'\u003e01\\/Feb\\/08 03:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n You could save a method invocation in cases like this if skipTo() returned the next doc id rather than a boolean. Returning a -1 would be the equivalent of what used to be \\\"false\\\".  \\n\\n To change the signature of skipTo()  would be an API change, because with this patch Scorer extends DocIdSetIterator. \\n\\n -Michael              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564622\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12564622&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564622\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12564622_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564622_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 03:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T03:54:24+0000\'\u003e01\\/Feb\\/08 03:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK here\'s a new version of the patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt\'s based on the take4 patch with the following changes:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eremoved BitSetFilter\u003c\\/li\u003e\\n\\t\u003cli\u003eadded getBitSet() method to DocIdBitSet\u003c\\/li\u003e\\n\\t\u003cli\u003eadded Paul\'s Test20080111.patch\u003c\\/li\u003e\\n\\t\u003cli\u003echanged TestScorerPerf to use a DocIdBitSet\u003c\\/li\u003e\\n\\t\u003cli\u003echanged ChainedFilterTest, CachedFilterBuilder, TestRemoteSearchable\u003cbr\\/\u003e\\nto use QueryWrapperFilter instead of deprecated QueryFilter\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eComments:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eAs mentioned in my previous comment it\'s not possible to wrap a\u003cbr\\/\u003e\\nCachingWrapperFilter around a BitSetFilter and then retrieve the BitSet \u003cbr\\/\u003e\\nfrom the CachingWrapperFilter. That\'s the reason why I removed \u003cbr\\/\u003e\\nBitSetFilter and added the getBitSet() method to DocIdBitSet instead.\u003cbr\\/\u003e\\nSo you can do something like this:\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003eDocIdSet docIdSet = filter.getDocIdSet();\\n\u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (docIdSet \u003cspan class=\\\"code-keyword\\\"\u003einstanceof\u003c\\/span\u003e DocIdBitSet) {\\n  BitSet bits = ((DocIdBitSet) docIdSet).getBitSet();\\n  ...\\n}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/li\u003e\\n\\t\u003cli\u003eI didn\'t include Paul\'s ContribQueries20080111.patch because it only\u003cbr\\/\u003e\\nchanges some contrib filters to extend BitSetFilter instead of Filter.\u003c\\/li\u003e\\n\\t\u003cli\u003eI like Eks\' suggestion of implementing the BooleanFilter in a way that\u003cbr\\/\u003e\\nit can use any DocIdSetIterator and optimize special cases, when DocIdSet \u003cbr\\/\u003e\\nis a DocIdBitSet, OpenBitSet, etc. We should do this with a different JIRA \u003cbr\\/\u003e\\nissue - this patch is already big enough.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\\n\u003cp\u003eAll core &amp; contrib tests pass.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'d like to commit this in a couple of days if nobody objects.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12564622_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564622_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 03:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T03:54:24+0000\'\u003e01\\/Feb\\/08 03:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK here\'s a new version of the patch. \\n\\n It\'s based on the take4 patch with the following changes: \\n \\n\\t removed BitSetFilter \\n\\t added getBitSet() method to DocIdBitSet \\n\\t added Paul\'s Test20080111.patch \\n\\t changed TestScorerPerf to use a DocIdBitSet \\n\\t changed ChainedFilterTest, CachedFilterBuilder, TestRemoteSearchable \\nto use QueryWrapperFilter instead of deprecated QueryFilter \\n \\n\\n\\n Comments: \\n \\n\\t As mentioned in my previous comment it\'s not possible to wrap a \\nCachingWrapperFilter around a BitSetFilter and then retrieve the BitSet  \\nfrom the CachingWrapperFilter. That\'s the reason why I removed  \\nBitSetFilter and added the getBitSet() method to DocIdBitSet instead. \\nSo you can do something like this:\\n  \\n DocIdSet docIdSet = filter.getDocIdSet();\\n if  (docIdSet  instanceof  DocIdBitSet) {\\n  BitSet bits = ((DocIdBitSet) docIdSet).getBitSet();\\n  ...\\n}\\n \\n   \\n\\t I didn\'t include Paul\'s ContribQueries20080111.patch because it only \\nchanges some contrib filters to extend BitSetFilter instead of Filter. \\n\\t I like Eks\' suggestion of implementing the BooleanFilter in a way that \\nit can use any DocIdSetIterator and optimize special cases, when DocIdSet  \\nis a DocIdBitSet, OpenBitSet, etc. We should do this with a different JIRA  \\nissue - this patch is already big enough. \\n \\n\\n\\n\\n All core &amp; contrib tests pass. \\n\\n I\'d like to commit this in a couple of days if nobody objects.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564875\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12564875&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564875\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12564875_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564875_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 18:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T18:57:50+0000\'\u003e01\\/Feb\\/08 18:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe take5 patch tests ok here.\u003c\\/p\u003e\\n\\n\u003cp\u003eOne very minor remark: the javadoc at RangeFilter.getDocIdSet still mentions BitSet.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12564875_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564875_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 18:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T18:57:50+0000\'\u003e01\\/Feb\\/08 18:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The take5 patch tests ok here. \\n\\n One very minor remark: the javadoc at RangeFilter.getDocIdSet still mentions BitSet.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564878\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12564878&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564878\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12564878_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564878_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 19:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T19:03:26+0000\'\u003e01\\/Feb\\/08 19:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks, Paul for testing and reviewing.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll correct the javadocs.\u003c\\/p\u003e\\n\\n\u003cp\u003eOK, I will commit this tomorrow if nobody objects!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12564878_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564878_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 19:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T19:03:26+0000\'\u003e01\\/Feb\\/08 19:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks, Paul for testing and reviewing. \\n\\n I\'ll correct the javadocs. \\n\\n OK, I will commit this tomorrow if nobody objects!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12565101\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12565101&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12565101\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12565101_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565101_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Feb\\/08 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-02T19:16:38+0000\'\u003e02\\/Feb\\/08 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted.\u003c\\/p\u003e\\n\\n\u003cp\u003eI looked again at all the comments here - wow this issue was open for a long time and at lot of work was done here.\u003c\\/p\u003e\\n\\n\u003cp\u003ePaul, thanks for your patience and all your hard work!!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12565101_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565101_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Feb\\/08 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-02T19:16:38+0000\'\u003e02\\/Feb\\/08 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed. \\n\\n I looked again at all the comments here - wow this issue was open for a long time and at lot of work was done here. \\n\\n Paul, thanks for your patience and all your hard work!!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12565156\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12565156&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12565156\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12565156_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565156_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Feb\\/08 08:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-03T08:57:06+0000\'\u003e03\\/Feb\\/08 08:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks, my pleasure.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have attached a patch to CHANGES.txt to explicitly state that filters outside the lucene code base will need to be adapted.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12565156_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565156_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Feb\\/08 08:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-03T08:57:06+0000\'\u003e03\\/Feb\\/08 08:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks, my pleasure. \\n\\n I have attached a patch to CHANGES.txt to explicitly state that filters outside the lucene code base will need to be adapted.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12565285\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12565285&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12565285\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12565285_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565285_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/08 07:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-04T07:43:20+0000\'\u003e04\\/Feb\\/08 07:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eI have attached a patch to CHANGES.txt to explicitly state that filters outside the lucene code base will need to be adapted.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI added your comment to CHANGES.txt, Paul. Thanks again!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12565285_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565285_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/08 07:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-04T07:43:20+0000\'\u003e04\\/Feb\\/08 07:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n I have attached a patch to CHANGES.txt to explicitly state that filters outside the lucene code base will need to be adapted.  \\n\\n I added your comment to CHANGES.txt, Paul. Thanks again!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12577207\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12577207&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12577207\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_12577207_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12577207_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/08 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-10T21:31:52+0000\'\u003e10\\/Mar\\/08 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Mark Miller - 10\\/Mar\\/08 21:48\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think there is still an issue here. The code below just broke for me.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava.lang.ClassCastException: org.apache.lucene.util.OpenBitSet cannot be cast to java.util.BitSet\u003cbr\\/\u003e\\n\\tat org.apache.lucene.search.CachingWrapperFilter.bits(CachingWrapperFilter.java:55)\u003cbr\\/\u003e\\n\\tat org.apache.lucene.misc.ChainedFilter.bits(ChainedFilter.java:177)\u003cbr\\/\u003e\\n\\tat org.apache.lucene.misc.ChainedFilter.bits(ChainedFilter.java:152)\u003cbr\\/\u003e\\n\\tat org.apache.lucene.search.Filter.getDocIdSet(Filter.java:49)\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e void testChainedCachedQueryFilter() \u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e IOException, ParseException {\\n    \u003cspan class=\\\"code-object\\\"\u003eString\u003c\\/span\u003e path = \u003cspan class=\\\"code-quote\\\"\u003e\\\"c:\\/TestIndex\\\"\u003c\\/span\u003e;\\n    Analyzer analyzer = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e WhitespaceAnalyzer();\\n    IndexWriter writer = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e IndexWriter(path, analyzer, \u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e);\\n\\n    Document doc = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Document();\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"category\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"red\\\"\u003c\\/span\u003e, Store.YES, Index.TOKENIZED));\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"content\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"the big bad fox\\\"\u003c\\/span\u003e, Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n    doc = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Document();\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"category\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"red\\\"\u003c\\/span\u003e, Store.YES, Index.TOKENIZED));\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"content\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"the big bad pig\\\"\u003c\\/span\u003e, Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n    doc = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Document();\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"category\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"red\\\"\u003c\\/span\u003e, Store.YES, Index.TOKENIZED));\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"content\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"the horrific girl\\\"\u003c\\/span\u003e, Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n    doc = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Document();\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"category\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"blue\\\"\u003c\\/span\u003e, Store.YES, Index.TOKENIZED));\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"content\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"the dirty boy\\\"\u003c\\/span\u003e, Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n    doc = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Document();\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"category\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"blue\\\"\u003c\\/span\u003e, Store.YES, Index.TOKENIZED));\\n    doc.add(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Field(\u003cspan class=\\\"code-quote\\\"\u003e\\\"content\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-quote\\\"\u003e\\\"the careful bad fox\\\"\u003c\\/span\u003e, Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n\\n    writer.close();\\n\\n    Searcher searcher = \u003cspan class=\\\"code-keyword\\\"\u003enull\u003c\\/span\u003e;\\n\\n    searcher = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e IndexSearcher(path);\\n\\n    QueryParser qp = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e QueryParser(\u003cspan class=\\\"code-quote\\\"\u003e\\\"field\\\"\u003c\\/span\u003e, \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e KeywordAnalyzer());\\n    Query query = qp.parse(\u003cspan class=\\\"code-quote\\\"\u003e\\\"content:fox\\\"\u003c\\/span\u003e);\\n    QueryWrapperFilter queryFilter = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e QueryWrapperFilter(query);\\n    CachingWrapperFilter cwf = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e CachingWrapperFilter(queryFilter);\\n\\n    TopDocs hits = searcher.search(query, cwf, 1);\\n    \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.out.println(\u003cspan class=\\\"code-quote\\\"\u003e\\\"hits:\\\"\u003c\\/span\u003e + hits.totalHits);\\n\\n    queryFilter = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e QueryWrapperFilter(qp.parse(\u003cspan class=\\\"code-quote\\\"\u003e\\\"category:red\\\"\u003c\\/span\u003e));\\n    CachingWrapperFilter fcwf = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e CachingWrapperFilter(queryFilter);\\n    Filter[] chain = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Filter[2];\\n    chain[0] = cwf;\\n    chain[1] = fcwf;\\n    ChainedFilter cf = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e ChainedFilter(chain, ChainedFilter.AND);\\n\\n    hits = searcher.search(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e MatchAllDocsQuery(), cf, 1);\\n\\n    \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.out.println(\u003cspan class=\\\"code-quote\\\"\u003e\\\"red:\\\"\u003c\\/span\u003e + hits.totalHits);\\n\\n    queryFilter = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e QueryWrapperFilter(qp.parse(\u003cspan class=\\\"code-quote\\\"\u003e\\\"category:blue\\\"\u003c\\/span\u003e));\\n    CachingWrapperFilter fbcwf = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e CachingWrapperFilter(queryFilter);\\n    chain = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Filter[2];\\n    chain[0] = cwf;\\n    chain[1] = fbcwf;\\n    cf = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e ChainedFilter(chain, ChainedFilter.AND);\\n\\n    hits = searcher.search(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e MatchAllDocsQuery(), cf, 1);\\n\\n    \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.out.println(\u003cspan class=\\\"code-quote\\\"\u003e\\\"blue:\\\"\u003c\\/span\u003e + hits.totalHits);\\n\\n  }\\n\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_12577207_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12577207_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/08 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-10T21:31:52+0000\'\u003e10\\/Mar\\/08 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Mark Miller - 10\\/Mar\\/08 21:48\\\"\u003eedited\u003c\\/span\u003e                   I think there is still an issue here. The code below just broke for me. \\n\\n java.lang.ClassCastException: org.apache.lucene.util.OpenBitSet cannot be cast to java.util.BitSet \\n\\tat org.apache.lucene.search.CachingWrapperFilter.bits(CachingWrapperFilter.java:55) \\n\\tat org.apache.lucene.misc.ChainedFilter.bits(ChainedFilter.java:177) \\n\\tat org.apache.lucene.misc.ChainedFilter.bits(ChainedFilter.java:152) \\n\\tat org.apache.lucene.search.Filter.getDocIdSet(Filter.java:49) \\n\\n  \\n    public  void testChainedCachedQueryFilter()  throws  IOException, ParseException {\\n     String  path =  \\\"c:\\/TestIndex\\\" ;\\n    Analyzer analyzer =  new  WhitespaceAnalyzer();\\n    IndexWriter writer =  new  IndexWriter(path, analyzer,  true );\\n\\n    Document doc =  new  Document();\\n    doc.add( new  Field( \\\"category\\\" ,  \\\"red\\\" , Store.YES, Index.TOKENIZED));\\n    doc.add( new  Field( \\\"content\\\" ,  \\\"the big bad fox\\\" , Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n    doc =  new  Document();\\n    doc.add( new  Field( \\\"category\\\" ,  \\\"red\\\" , Store.YES, Index.TOKENIZED));\\n    doc.add( new  Field( \\\"content\\\" ,  \\\"the big bad pig\\\" , Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n    doc =  new  Document();\\n    doc.add( new  Field( \\\"category\\\" ,  \\\"red\\\" , Store.YES, Index.TOKENIZED));\\n    doc.add( new  Field( \\\"content\\\" ,  \\\"the horrific girl\\\" , Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n    doc =  new  Document();\\n    doc.add( new  Field( \\\"category\\\" ,  \\\"blue\\\" , Store.YES, Index.TOKENIZED));\\n    doc.add( new  Field( \\\"content\\\" ,  \\\"the dirty boy\\\" , Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n    doc =  new  Document();\\n    doc.add( new  Field( \\\"category\\\" ,  \\\"blue\\\" , Store.YES, Index.TOKENIZED));\\n    doc.add( new  Field( \\\"content\\\" ,  \\\"the careful bad fox\\\" , Store.NO, Index.TOKENIZED));\\n    writer.addDocument(doc);\\n\\n    writer.close();\\n\\n    Searcher searcher =  null ;\\n\\n    searcher =  new  IndexSearcher(path);\\n\\n    QueryParser qp =  new  QueryParser( \\\"field\\\" ,  new  KeywordAnalyzer());\\n    Query query = qp.parse( \\\"content:fox\\\" );\\n    QueryWrapperFilter queryFilter =  new  QueryWrapperFilter(query);\\n    CachingWrapperFilter cwf =  new  CachingWrapperFilter(queryFilter);\\n\\n    TopDocs hits = searcher.search(query, cwf, 1);\\n     System .out.println( \\\"hits:\\\"  + hits.totalHits);\\n\\n    queryFilter =  new  QueryWrapperFilter(qp.parse( \\\"category:red\\\" ));\\n    CachingWrapperFilter fcwf =  new  CachingWrapperFilter(queryFilter);\\n    Filter[] chain =  new  Filter[2];\\n    chain[0] = cwf;\\n    chain[1] = fcwf;\\n    ChainedFilter cf =  new  ChainedFilter(chain, ChainedFilter.AND);\\n\\n    hits = searcher.search( new  MatchAllDocsQuery(), cf, 1);\\n\\n     System .out.println( \\\"red:\\\"  + hits.totalHits);\\n\\n    queryFilter =  new  QueryWrapperFilter(qp.parse( \\\"category:blue\\\" ));\\n    CachingWrapperFilter fbcwf =  new  CachingWrapperFilter(queryFilter);\\n    chain =  new  Filter[2];\\n    chain[0] = cwf;\\n    chain[1] = fbcwf;\\n    cf =  new  ChainedFilter(chain, ChainedFilter.AND);\\n\\n    hits = searcher.search( new  MatchAllDocsQuery(), cf, 1);\\n\\n     System .out.println( \\\"blue:\\\"  + hits.totalHits);\\n\\n  }\\n\\n \\n  \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12577326\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12577326&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12577326\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12577326_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12577326_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/08 07:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-11T07:58:43+0000\'\u003e11\\/Mar\\/08 07:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFrom the traceback I suppose this happened at the end, using the ChainedFilter?\u003cbr\\/\u003e\\nIirc ChainedFilter is from contrib\\/..., and it is mentioned at \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-1187\\\" title=\\\"Things to be done now that Filter is independent from BitSet\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-1187\\\"\u003e\u003cdel\u003eLUCENE-1187\u003c\\/del\u003e\u003c\\/a\u003e as one of the things to be done.\u003cbr\\/\u003e\\nCould you contribute this code as a contrib\\/... test case there?\u003cbr\\/\u003e\\nSorry, I don\'t remember exactly from which contrib module ChainedFilter is.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12577326_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12577326_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/08 07:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-11T07:58:43+0000\'\u003e11\\/Mar\\/08 07:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    From the traceback I suppose this happened at the end, using the ChainedFilter? \\nIirc ChainedFilter is from contrib\\/..., and it is mentioned at   LUCENE-1187   as one of the things to be done. \\nCould you contribute this code as a contrib\\/... test case there? \\nSorry, I don\'t remember exactly from which contrib module ChainedFilter is.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12643495\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12643495&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12643495\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wheijke\\\" id=\\\"commentauthor_12643495_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wheijke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wheijke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Wouter Heijke\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12643495_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/08 14:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-29T14:20:26+0000\'\u003e29\\/Oct\\/08 14:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWe got the same error here on a 15Gb index with Lucene 2.4.0:\u003c\\/p\u003e\\n\\n\u003cp\u003ejava.lang.ClassCastException: java.util.BitSet cannot be cast to org.apache.lucene.search.DocIdSet\u003cbr\\/\u003e\\n org.apache.lucene.search.CachingWrapperFilter.getDocIdSet(CachingWrapperFilter.java:76)\u003cbr\\/\u003e\\n org.apache.lucene.misc.ChainedFilter.getDocIdSet(ChainedFilter.java:200)\u003cbr\\/\u003e\\n org.apache.lucene.misc.ChainedFilter.getDocIdSet(ChainedFilter.java:145)\u003cbr\\/\u003e\\n org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:140)\u003cbr\\/\u003e\\n org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:112)\u003cbr\\/\u003e\\n org.apache.lucene.search.Searcher.search(Searcher.java:136)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wheijke\\\" id=\\\"commentauthor_12643495_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wheijke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wheijke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Wouter Heijke\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12643495_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/08 14:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-29T14:20:26+0000\'\u003e29\\/Oct\\/08 14:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    We got the same error here on a 15Gb index with Lucene 2.4.0: \\n\\n java.lang.ClassCastException: java.util.BitSet cannot be cast to org.apache.lucene.search.DocIdSet \\n org.apache.lucene.search.CachingWrapperFilter.getDocIdSet(CachingWrapperFilter.java:76) \\n org.apache.lucene.misc.ChainedFilter.getDocIdSet(ChainedFilter.java:200) \\n org.apache.lucene.misc.ChainedFilter.getDocIdSet(ChainedFilter.java:145) \\n org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:140) \\n org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:112) \\n org.apache.lucene.search.Searcher.search(Searcher.java:136)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12643767\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12643767&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12643767\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12643767_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12643767_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Oct\\/08 07:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-30T07:18:22+0000\'\u003e30\\/Oct\\/08 07:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWouter, about this:\u003cbr\\/\u003e\\n\u003ctt\u003ejava.lang.ClassCastException: java.util.BitSet cannot be cast to org.apache.lucene.search.DocIdSet\u003c\\/tt\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-1187\\\" title=\\\"Things to be done now that Filter is independent from BitSet\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-1187\\\"\u003e\u003cdel\u003eLUCENE-1187\u003c\\/del\u003e\u003c\\/a\u003e should have fixed this, so could you file a bug report?\u003cbr\\/\u003e\\nIn case you need a workaround, also have a look at \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-1296\\\" title=\\\"Allow use of compact DocIdSet in CachingWrapperFilter\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-1296\\\"\u003e\u003cdel\u003eLUCENE-1296\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_12643767_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12643767_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Oct\\/08 07:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-30T07:18:22+0000\'\u003e30\\/Oct\\/08 07:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Wouter, about this: \\n java.lang.ClassCastException: java.util.BitSet cannot be cast to org.apache.lucene.search.DocIdSet  \\n\\n   LUCENE-1187   should have fixed this, so could you file a bug report? \\nIn case you need a workaround, also have a look at   LUCENE-1296  . \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12745763\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12745763&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12745763\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_12745763_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12745763_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Aug\\/09 01:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-08-21T01:27:10+0000\'\u003e21\\/Aug\\/09 01:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think I have tracked down this issue as the one changing things most regarding Scorer documentation in org.apache.lucene.search.package.html.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ve started updating it, but it needs a tad more work I think - reopening this issue as a convenient marker for this work.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_12745763_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12745763_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Aug\\/09 01:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-08-21T01:27:10+0000\'\u003e21\\/Aug\\/09 01:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think I have tracked down this issue as the one changing things most regarding Scorer documentation in org.apache.lucene.search.package.html. \\n\\n I\'ve started updating it, but it needs a tad more work I think - reopening this issue as a convenient marker for this work.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12746017\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12746017&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12746017\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12746017_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12746017_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Aug\\/09 15:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-08-21T15:27:14+0000\'\u003e21\\/Aug\\/09 15:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMark, are you working on this? Wanna assign this to you?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"michaelbusch\\\" id=\\\"commentauthor_12746017_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=michaelbusch\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"michaelbusch\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael Busch\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12746017_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Aug\\/09 15:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-08-21T15:27:14+0000\'\u003e21\\/Aug\\/09 15:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mark, are you working on this? Wanna assign this to you?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12746507\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-584?focusedCommentId=12746507&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12746507\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_12746507_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12746507_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Aug\\/09 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-08-22T21:18:04+0000\'\u003e22\\/Aug\\/09 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIts better now I think - could prob be improved still (by someone who has sunk their head into the new Scorer stuff more than I have) - but I read over the code and did what I could. At the least, its no longer wildly out of whack.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_12746507_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12746507_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Aug\\/09 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-08-22T21:18:04+0000\'\u003e22\\/Aug\\/09 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Its better now I think - could prob be improved still (by someone who has sunk their head into the new Scorer stuff more than I have) - but I read over the code and did what I could. At the least, its no longer wildly out of whack.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516201829165"> 
    <input type="hidden" title="jira.request.server.time" value="895"> 
    <input type="hidden" title="jira.request.id" value="910x7647929x7"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="5"> 
    <input type="hidden" title="db.reads.time.in.ms" value="61"> 
    <input type="hidden" title="db.conns.time.in.ms" value="69"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 910x7647929x7
	          REQUEST TIMESTAMP : [17/Jan/2018:15:10:29 +0000]
	               REQUEST TIME : 0.8950
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 5

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=27, elapsedTotal=61068827, elapsedMin=644259, elapsedMax=16611160, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=31, elapsedTotal=69019538, elapsedMin=667843, elapsedMax=16833877, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|c6babc5bab8903236863dfab1b0bbb75314362f6|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"772165337d3bcf\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-627"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-627] highlighter problems with overlapping tokens - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-627] highlighter problems with overlapping tokens - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loadingâ€¦
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-627">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-627" href="/jira/browse/LUCENE-627" id="key-val" rel="12345948">LUCENE-627</a></li>
                </ol>
                <h1 id="summary-val">highlighter problems with overlapping tokens</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-627"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-627/LUCENE-627.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-627/LUCENE-627.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-627/LUCENE-627.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-627/LUCENE-627.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="2.1 ">2.1</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+2.1" title="2.1 ">2.1</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22core%2Fother%22" title="core/other issues related to any code under core. Usage of this document is discouraged. Please create (or ask for) a proper component.">core/other</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12345948-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>The lucene highlighter has problems when tokens that overlap are generated.</p> 
                  <p>For example, if analysis of iPod generates the tokens "i", "pod", "ipod" (with pod and ipod in the same position),<br> then the highlighter will output this as iipod, regardless of if any of those tokens are highlighted.</p> 
                  <p>Discovered via <a href="http://issues.apache.org/jira/browse/SOLR-24" class="external-link" rel="nofollow">http://issues.apache.org/jira/browse/SOLR-24</a></p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-627?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-627?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-627?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-627?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12336906" data-issue-id="12345948" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12336906/highlight_overlap.diff" draggable="true" data-downloadurl="application/octet-stream:highlight_overlap.diff:https://issues.apache.org/jira/secure/attachment/12336906/highlight_overlap.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12336906/highlight_overlap.diff" title="Latest  14/Jul/06 20:41 - Yonik Seeley" draggable="true" data-downloadurl="application/octet-stream:highlight_overlap.diff:https://issues.apache.org/jira/secure/attachment/12336906/highlight_overlap.diff">highlight_overlap.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-07-14T20:41:32.000Z">14/Jul/06 20:41</time>
                   </dd>
                   <dd class="attachment-size">
                    18 kB
                   </dd>
                   <dd class="attachment-author">
                    Yonik Seeley
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12340628" data-issue-id="12345948" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12340628/Highlighter.java.diff" draggable="true" data-downloadurl="text/plain:Highlighter.java.diff:https://issues.apache.org/jira/secure/attachment/12340628/Highlighter.java.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12340628/Highlighter.java.diff" title="Latest  12/Sep/06 08:16 - Kerang Lv" draggable="true" data-downloadurl="text/plain:Highlighter.java.diff:https://issues.apache.org/jira/secure/attachment/12340628/Highlighter.java.diff">Highlighter.java.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-09-12T08:16:15.000Z">12/Sep/06 08:16</time>
                   </dd>
                   <dd class="attachment-size">
                    2 kB
                   </dd>
                   <dd class="attachment-author">
                    Kerang Lv
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="relates to">
                   relates to
                  </dt> 
                  <dd id="internal-12763793_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="LUCENE-6139: TokenGroup.getStart|EndOffset should return matchStart|EndOffset not start|endOffset"> <a href="/jira/browse/LUCENE-6139" data-issue-key="LUCENE-6139" class="issue-link link-title resolution">LUCENE-6139</a> <span class="link-summary">TokenGroup.getStart|EndOffset should return matchStart|EndOffset not start|endOffset</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10453"></span></span> Unassigned </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_yseeley@gmail.com" rel="yseeley@gmail.com" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Yonik Seeley&quot;,&quot;emailAddress&quot;:&quot;yseeley@gmail.com&quot;,&quot;username&quot;:&quot;yseeley@gmail.com&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="yseeley@gmail.com"></span></span> Yonik Seeley </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">1</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="14/Jul/06 00:10"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2006-07-14T00:10:19+0000">14/Jul/06 00:10</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="31/Dec/14 22:01"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2014-12-31T22:01:07+0000">31/Dec/14 22:01</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="16/Jul/06 03:19"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2006-07-16T03:19:47+0000">16/Jul/06 03:19</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-627?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-627?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12420915\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420915&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420915\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12420915_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420915_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 02:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T02:33:26+0000\'\u003e14\\/Jul\\/06 02:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWorks OK for me - just added this to the Highlighter\'s Junit test and all is well.\u003cbr\\/\u003e\\nSomething up with your analyzer?\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e\\tpublic void testOverlapAnalyzer2() throws Exception\u003c\\/p\u003e\\n\\t{\\n\\t\\tHashMap synonyms = new HashMap();\\n\\t\\tsynonyms.put(\\\"ipod\\\", \\\"i,pod\\\");\\n\\t\\tAnalyzer analyzer = new SynonymAnalyzer(synonyms);\\n\\t\\tString srchkey = \\\"ipod\\\";\\n\\n\\t\\tString s = \\\"I want an ipod\\\";\\n\\t\\tQueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer());\\n\\t\\tQuery query = parser.parse(srchkey);\\n\\n\\t\\tHighlighter highlighter = new Highlighter(new QueryScorer(query));\\n\\t\\tTokenStream tokenStream =\\n\\t\\t\\tanalyzer.tokenStream(null, new StringReader(s));\\n\\t\\t\\/\\/ Get 3 best fragments and seperate with a \\\"...\\\"\\n\\t\\tString result = highlighter.getBestFragments(tokenStream, s, 3, \\\"...\\\");\\n\\t\\tString expectedResult=\\\"I want an &lt;B&gt;ipod&lt;\\/B&gt;\\\";\\n\\t\\tassertEquals(expectedResult,result);\\n\\t} \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12420915_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420915_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 02:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T02:33:26+0000\'\u003e14\\/Jul\\/06 02:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Works OK for me - just added this to the Highlighter\'s Junit test and all is well. \\nSomething up with your analyzer? \\n\\n\\n \\tpublic void testOverlapAnalyzer2() throws Exception \\n\\t{\\n\\t\\tHashMap synonyms = new HashMap();\\n\\t\\tsynonyms.put(\\\"ipod\\\", \\\"i,pod\\\");\\n\\t\\tAnalyzer analyzer = new SynonymAnalyzer(synonyms);\\n\\t\\tString srchkey = \\\"ipod\\\";\\n\\n\\t\\tString s = \\\"I want an ipod\\\";\\n\\t\\tQueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer());\\n\\t\\tQuery query = parser.parse(srchkey);\\n\\n\\t\\tHighlighter highlighter = new Highlighter(new QueryScorer(query));\\n\\t\\tTokenStream tokenStream =\\n\\t\\t\\tanalyzer.tokenStream(null, new StringReader(s));\\n\\t\\t\\/\\/ Get 3 best fragments and seperate with a \\\"...\\\"\\n\\t\\tString result = highlighter.getBestFragments(tokenStream, s, 3, \\\"...\\\");\\n\\t\\tString expectedResult=\\\"I want an &lt;B&gt;ipod&lt;\\/B&gt;\\\";\\n\\t\\tassertEquals(expectedResult,result);\\n\\t}             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420916\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420916&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420916\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420916_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420916_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 02:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T02:42:57+0000\'\u003e14\\/Jul\\/06 02:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe start and end offsets also overlap... I wonder if that\'s what is different.\u003c\\/p\u003e\\n\\n\u003cp\u003eSolr\'s analyzer output:\u003cbr\\/\u003e\\n\u003ca href=\\\"http:\\/\\/localhost:8983\\/solr\\/admin\\/analysis.jsp?name=text&amp;verbose=on&amp;val=iPod\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/localhost:8983\\/solr\\/admin\\/analysis.jsp?name=text&amp;verbose=on&amp;val=iPod\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eterm position 1, 2\u003cbr\\/\u003e\\nterm text \\ti, pod\\/ipod\u003cbr\\/\u003e\\nterm type    word, word\\/word\u003cbr\\/\u003e\\nsource start,end (0,1),\\t(1,4)\\/(0,4)\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll try and come up with a junit test that demonstrates it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420916_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420916_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 02:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T02:42:57+0000\'\u003e14\\/Jul\\/06 02:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The start and end offsets also overlap... I wonder if that\'s what is different. \\n\\n Solr\'s analyzer output: \\n http:\\/\\/localhost:8983\\/solr\\/admin\\/analysis.jsp?name=text&amp;verbose=on&amp;val=iPod  \\n\\n term position 1, 2 \\nterm text \\ti, pod\\/ipod \\nterm type    word, word\\/word \\nsource start,end (0,1),\\t(1,4)\\/(0,4) \\n\\n I\'ll try and come up with a junit test that demonstrates it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420919\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420919&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420919\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420919_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420919_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 03:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T03:05:29+0000\'\u003e14\\/Jul\\/06 03:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK, here we go... the following test fails with\u003cbr\\/\u003e\\nExpected :ipod &lt;B&gt;foo&lt;\\/B&gt;\u003cbr\\/\u003e\\nActual  :iiPod &lt;B&gt;foo&lt;\\/B&gt;\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e  public void testOverlapAnalyzer2() throws Exception\u003cbr\\/\u003e\\n  {\u003c\\/p\u003e\\n\\n\u003cp\u003e    String s = \\\"iPod foo\\\";\u003cbr\\/\u003e\\n    \\/\\/ the token stream for the string above:\u003cbr\\/\u003e\\n    TokenStream ts = new TokenStream() {\u003cbr\\/\u003e\\n      Iterator iter;\u003c\\/p\u003e\\n      {\\n        List lst = new ArrayList();\\n        Token t;\\n        t = new Token(\\\"i\\\",0,1);\\n        lst.add(t);\\n        t = new Token(\\\"pod\\\",1,4);\\n        t.setPositionIncrement(0);\\n        lst.add(t);\\n        t = new Token(\\\"ipod\\\",0,4);\\n        lst.add(t);\\n        t = new Token(\\\"foo\\\",5,8);\\n        lst.add(t);\\n        iter = lst.iterator();\\n      }\\n\u003cp\u003e      public Token next() throws IOException \u003c\\/p\u003e\\n{\\n        return iter.hasNext() ? (Token)iter.next() : null;\\n      }\\n\u003cp\u003e    };\u003c\\/p\u003e\\n\\n\u003cp\u003e    String srchkey = \\\"foo\\\";\u003c\\/p\u003e\\n\\n\u003cp\u003e    QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer());\u003cbr\\/\u003e\\n    Query query = parser.parse(srchkey);\u003c\\/p\u003e\\n\\n\u003cp\u003e    Highlighter highlighter = new Highlighter(new QueryScorer(query));\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/\\/ Get 3 best fragments and seperate with a \\\"...\\\"\u003cbr\\/\u003e\\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\");\u003cbr\\/\u003e\\n    String expectedResult=\\\"ipod &lt;B&gt;foo&lt;\\/B&gt;\\\";\u003cbr\\/\u003e\\n    assertEquals(expectedResult,result);\u003cbr\\/\u003e\\n  }\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420919_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420919_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 03:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T03:05:29+0000\'\u003e14\\/Jul\\/06 03:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK, here we go... the following test fails with \\nExpected :ipod &lt;B&gt;foo&lt;\\/B&gt; \\nActual  :iiPod &lt;B&gt;foo&lt;\\/B&gt; \\n\\n\\n   public void testOverlapAnalyzer2() throws Exception \\n  { \\n\\n     String s = \\\"iPod foo\\\"; \\n    \\/\\/ the token stream for the string above: \\n    TokenStream ts = new TokenStream() { \\n      Iterator iter; \\n      {\\n        List lst = new ArrayList();\\n        Token t;\\n        t = new Token(\\\"i\\\",0,1);\\n        lst.add(t);\\n        t = new Token(\\\"pod\\\",1,4);\\n        t.setPositionIncrement(0);\\n        lst.add(t);\\n        t = new Token(\\\"ipod\\\",0,4);\\n        lst.add(t);\\n        t = new Token(\\\"foo\\\",5,8);\\n        lst.add(t);\\n        iter = lst.iterator();\\n      }\\n       public Token next() throws IOException  \\n{\\n        return iter.hasNext() ? (Token)iter.next() : null;\\n      }\\n     }; \\n\\n     String srchkey = \\\"foo\\\"; \\n\\n     QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()); \\n    Query query = parser.parse(srchkey); \\n\\n     Highlighter highlighter = new Highlighter(new QueryScorer(query)); \\n\\n \\/\\/ Get 3 best fragments and seperate with a \\\"...\\\" \\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\"); \\n    String expectedResult=\\\"ipod &lt;B&gt;foo&lt;\\/B&gt;\\\"; \\n    assertEquals(expectedResult,result); \\n  }              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420920\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420920&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420920\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12420920_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420920_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 03:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T03:22:02+0000\'\u003e14\\/Jul\\/06 03:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe problem appears to be because the \\\"pod\\\" token advances the start position to 1 while the next token \\\"ipod\\\" takes a step back (to 0)\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ve found if you just arrange the tokens to be emitted in start pos order all is fine - see below\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e\\t  public void testOverlapAnalyzer2() throws Exception\u003cbr\\/\u003e\\n\\t  {\u003c\\/p\u003e\\n\\n\u003cp\u003e\\t    String s = \\\"iPod foo\\\";\u003cbr\\/\u003e\\n\\t    \\/\\/ the token stream for the string above:\u003cbr\\/\u003e\\n\\t    TokenStream ts = new TokenStream() {\u003cbr\\/\u003e\\n\\t      Iterator iter;\u003c\\/p\u003e\\n\\t      {\\n\\t        List lst = new ArrayList();\\n\\t        Token t;\\n                             \\/\\/moved this token to start\\n\\t        t = new Token(\\\"ipod\\\",0,4);\\n\\t        lst.add(t);\\n\\t        t = new Token(\\\"i\\\",0,1);\\n\\t        lst.add(t);\\n\\t        t = new Token(\\\"pod\\\",1,4);\\n\\t        t.setPositionIncrement(0);\\n\\t        lst.add(t);\\n\\t        t = new Token(\\\"foo\\\",5,8);\\n\\t        lst.add(t);\\n\\t        iter = lst.iterator();\\n\\t      }\\n\u003cp\u003e\\t      public Token next() throws IOException \u003c\\/p\u003e\\n{\\n\\t        return iter.hasNext() ? (Token)iter.next() : null;\\n\\t      }\\n\u003cp\u003e\\t    };\u003c\\/p\u003e\\n\\n\u003cp\u003e\\t    String srchkey = \\\"foo\\\";\u003c\\/p\u003e\\n\\n\u003cp\u003e\\t    QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer());\u003cbr\\/\u003e\\n\\t    Query query = parser.parse(srchkey);\u003c\\/p\u003e\\n\\n\u003cp\u003e\\t    Highlighter highlighter = new Highlighter(new QueryScorer(query));\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/\\/\\t Get 3 best fragments and seperate with a \\\"...\\\"\u003cbr\\/\u003e\\n\\t    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\");\u003cbr\\/\u003e\\n                         \\/\\/had to upper case the P in the test here\u003cbr\\/\u003e\\n\\t    String expectedResult=\\\"iPod &lt;B&gt;foo&lt;\\/B&gt;\\\";\u003cbr\\/\u003e\\n\\t    assertEquals(expectedResult,result);\u003cbr\\/\u003e\\n\\t  }\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12420920_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420920_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 03:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T03:22:02+0000\'\u003e14\\/Jul\\/06 03:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The problem appears to be because the \\\"pod\\\" token advances the start position to 1 while the next token \\\"ipod\\\" takes a step back (to 0) \\n\\n I\'ve found if you just arrange the tokens to be emitted in start pos order all is fine - see below \\n\\n\\n \\t  public void testOverlapAnalyzer2() throws Exception \\n\\t  { \\n\\n \\t    String s = \\\"iPod foo\\\"; \\n\\t    \\/\\/ the token stream for the string above: \\n\\t    TokenStream ts = new TokenStream() { \\n\\t      Iterator iter; \\n\\t      {\\n\\t        List lst = new ArrayList();\\n\\t        Token t;\\n                             \\/\\/moved this token to start\\n\\t        t = new Token(\\\"ipod\\\",0,4);\\n\\t        lst.add(t);\\n\\t        t = new Token(\\\"i\\\",0,1);\\n\\t        lst.add(t);\\n\\t        t = new Token(\\\"pod\\\",1,4);\\n\\t        t.setPositionIncrement(0);\\n\\t        lst.add(t);\\n\\t        t = new Token(\\\"foo\\\",5,8);\\n\\t        lst.add(t);\\n\\t        iter = lst.iterator();\\n\\t      }\\n \\t      public Token next() throws IOException  \\n{\\n\\t        return iter.hasNext() ? (Token)iter.next() : null;\\n\\t      }\\n \\t    }; \\n\\n \\t    String srchkey = \\\"foo\\\"; \\n\\n \\t    QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()); \\n\\t    Query query = parser.parse(srchkey); \\n\\n \\t    Highlighter highlighter = new Highlighter(new QueryScorer(query)); \\n\\n \\/\\/\\t Get 3 best fragments and seperate with a \\\"...\\\" \\n\\t    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\"); \\n                         \\/\\/had to upper case the P in the test here \\n\\t    String expectedResult=\\\"iPod &lt;B&gt;foo&lt;\\/B&gt;\\\"; \\n\\t    assertEquals(expectedResult,result); \\n\\t  }              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420923\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420923&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420923\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12420923_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420923_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 03:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T03:26:01+0000\'\u003e14\\/Jul\\/06 03:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePosition increments wrong in my  above code but the solution of sequencing start offsets correctly still holds true:\u003c\\/p\u003e\\n\\n\u003cp\u003e\\t        t = new Token(\\\"ipod\\\",0,4);\u003cbr\\/\u003e\\n\\t        t.setPositionIncrement(0);\u003cbr\\/\u003e\\n\\t        lst.add(t);\u003cbr\\/\u003e\\n\\t        t = new Token(\\\"i\\\",0,1);\u003cbr\\/\u003e\\n\\t        t.setPositionIncrement(0);\u003cbr\\/\u003e\\n\\t        lst.add(t);\u003cbr\\/\u003e\\n\\t        t = new Token(\\\"pod\\\",1,4);\u003cbr\\/\u003e\\n\\t        lst.add(t);\u003cbr\\/\u003e\\n\\t        t = new Token(\\\"foo\\\",5,8);\u003cbr\\/\u003e\\n\\t        lst.add(t);\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12420923_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420923_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 03:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T03:26:01+0000\'\u003e14\\/Jul\\/06 03:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Position increments wrong in my  above code but the solution of sequencing start offsets correctly still holds true: \\n\\n \\t        t = new Token(\\\"ipod\\\",0,4); \\n\\t        t.setPositionIncrement(0); \\n\\t        lst.add(t); \\n\\t        t = new Token(\\\"i\\\",0,1); \\n\\t        t.setPositionIncrement(0); \\n\\t        lst.add(t); \\n\\t        t = new Token(\\\"pod\\\",1,4); \\n\\t        lst.add(t); \\n\\t        t = new Token(\\\"foo\\\",5,8); \\n\\t        lst.add(t);              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420924\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420924&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420924\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420924_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420924_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 03:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T03:31:22+0000\'\u003e14\\/Jul\\/06 03:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe original token stream is a valid one though right?  If so, it seems like the fix should be in the highlighter module.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420924_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420924_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 03:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T03:31:22+0000\'\u003e14\\/Jul\\/06 03:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The original token stream is a valid one though right?  If so, it seems like the fix should be in the highlighter module.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420950\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420950&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420950\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12420950_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420950_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 05:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T05:10:04+0000\'\u003e14\\/Jul\\/06 05:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt;&gt;The original token stream is a valid one though right? \u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t think so, see below...\u003c\\/p\u003e\\n\\n\u003cp\u003e       List lst = new ArrayList(); \u003cbr\\/\u003e\\n        Token t; \u003cbr\\/\u003e\\n        t = new Token(\\\"i\\\",0,1); \u003cbr\\/\u003e\\n        lst.add(t); \u003cbr\\/\u003e\\n        t = new Token(\\\"pod\\\",1,4); \u003cbr\\/\u003e\\n        t.setPositionIncrement(0); \u003cbr\\/\u003e\\n        lst.add(t); \u003cbr\\/\u003e\\n        t = new Token(\\\"ipod\\\",0,4); \u003cbr\\/\u003e\\n!! Missing a t.setPositionIncrement(0) here.\u003cbr\\/\u003e\\n        lst.add(t); \u003cbr\\/\u003e\\n        t = new Token(\\\"foo\\\",5,8); \u003cbr\\/\u003e\\n        lst.add(t); \u003cbr\\/\u003e\\n        iter = lst.iterator(); \u003c\\/p\u003e\\n\\n\u003cp\u003eHaving fixed the above I believe this change below is all that is required to fix the highlighter:\u003c\\/p\u003e\\n\\n\u003cp\u003eTokenGroup.java\u003c\\/p\u003e\\n\\n\u003cp\u003e\\tboolean isDistinct(Token token)\u003c\\/p\u003e\\n\\t{\\n\\/\\/\\t\\treturn token.startOffset()&gt;=endOffset;\\n\\t\\treturn token.getPositionIncrement()&gt;0;\\n\\t}\\n\\n\u003cp\u003eAll my Junit  tests pass with this change - can you verify this is true for you too?\u003cbr\\/\u003e\\nThis change would break highlighting for any analyzers that had position increments but whose offsets somehow overlapped - text would potentially be duplicated in the same way you originally reported your problem. I can\'t verify this to be true for CJK analyzers etc so feel a little uneasy about committing this. \u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12420950_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420950_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 05:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T05:10:04+0000\'\u003e14\\/Jul\\/06 05:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt;&gt;The original token stream is a valid one though right?  \\n\\n I don\'t think so, see below... \\n\\n        List lst = new ArrayList();  \\n        Token t;  \\n        t = new Token(\\\"i\\\",0,1);  \\n        lst.add(t);  \\n        t = new Token(\\\"pod\\\",1,4);  \\n        t.setPositionIncrement(0);  \\n        lst.add(t);  \\n        t = new Token(\\\"ipod\\\",0,4);  \\n!! Missing a t.setPositionIncrement(0) here. \\n        lst.add(t);  \\n        t = new Token(\\\"foo\\\",5,8);  \\n        lst.add(t);  \\n        iter = lst.iterator();  \\n\\n Having fixed the above I believe this change below is all that is required to fix the highlighter: \\n\\n TokenGroup.java \\n\\n \\tboolean isDistinct(Token token) \\n\\t{\\n\\/\\/\\t\\treturn token.startOffset()&gt;=endOffset;\\n\\t\\treturn token.getPositionIncrement()&gt;0;\\n\\t}\\n\\n All my Junit  tests pass with this change - can you verify this is true for you too? \\nThis change would break highlighting for any analyzers that had position increments but whose offsets somehow overlapped - text would potentially be duplicated in the same way you originally reported your problem. I can\'t verify this to be true for CJK analyzers etc so feel a little uneasy about committing this.  \\n\\n Cheers \\nMark              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420954\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420954&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420954\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420954_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420954_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 05:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T05:25:06+0000\'\u003e14\\/Jul\\/06 05:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt;&gt;The original token stream is a valid one though right?\u003cbr\\/\u003e\\n&gt; I don\'t think so, see below...\u003c\\/p\u003e\\n\\n\u003cp\u003eAh, right... I constructed the wrong one first.  I wanted pod and ipod in the same position... so the token stream looks like \\\"i\\\" (\\\"pod\\\"|\\\"ipod\\\") \\\"foo\\\".\u003cbr\\/\u003e\\nNow this token-stream is correct, I believe, but the same problem happens.\u003c\\/p\u003e\\n\\n\u003cp\u003eA work-around is to swap the order that \\\"pod\\\" and \\\"ipod\\\" tokens appear, but it seems like any such workaround should be put into the highlighter rather than external to it.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e  public void testOverlapAnalyzer2() throws Exception\u003cbr\\/\u003e\\n  {\u003c\\/p\u003e\\n\\n\u003cp\u003e    String s = \\\"iPod foo\\\";\u003cbr\\/\u003e\\n    \\/\\/ the token stream for the string above:\u003cbr\\/\u003e\\n    TokenStream ts = new TokenStream() {\u003cbr\\/\u003e\\n      Iterator iter;\u003c\\/p\u003e\\n      {\\n        List lst = new ArrayList();\\n        Token t;\\n        t = new Token(\\\"i\\\",0,1);\\n        lst.add(t);\\n        t = new Token(\\\"pod\\\",1,4);\\n        lst.add(t);\\n        t = new Token(\\\"ipod\\\",0,4);\\n        t.setPositionIncrement(0);   \\/\\/ pod and ipod occupy the same token position.\\n        lst.add(t);\\n        t = new Token(\\\"foo\\\",5,8);\\n        lst.add(t);\\n        iter = lst.iterator();\\n      }\\n\u003cp\u003e      public Token next() throws IOException \u003c\\/p\u003e\\n{\\n        return iter.hasNext() ? (Token)iter.next() : null;\\n      }\\n\u003cp\u003e    };\u003c\\/p\u003e\\n\\n\u003cp\u003e    String srchkey = \\\"foo\\\";\u003c\\/p\u003e\\n\\n\u003cp\u003e    QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer());\u003cbr\\/\u003e\\n    Query query = parser.parse(srchkey);\u003c\\/p\u003e\\n\\n\u003cp\u003e    Highlighter highlighter = new Highlighter(new QueryScorer(query));\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/\\/ Get 3 best fragments and seperate with a \\\"...\\\"\u003cbr\\/\u003e\\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\");\u003cbr\\/\u003e\\n    String expectedResult=\\\"iPod &lt;B&gt;foo&lt;\\/B&gt;\\\";\u003cbr\\/\u003e\\n    assertEquals(expectedResult,result);\u003cbr\\/\u003e\\n  }\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420954_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420954_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 05:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T05:25:06+0000\'\u003e14\\/Jul\\/06 05:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt;&gt;The original token stream is a valid one though right? \\n&gt; I don\'t think so, see below... \\n\\n Ah, right... I constructed the wrong one first.  I wanted pod and ipod in the same position... so the token stream looks like \\\"i\\\" (\\\"pod\\\"|\\\"ipod\\\") \\\"foo\\\". \\nNow this token-stream is correct, I believe, but the same problem happens. \\n\\n A work-around is to swap the order that \\\"pod\\\" and \\\"ipod\\\" tokens appear, but it seems like any such workaround should be put into the highlighter rather than external to it. \\n\\n\\n   public void testOverlapAnalyzer2() throws Exception \\n  { \\n\\n     String s = \\\"iPod foo\\\"; \\n    \\/\\/ the token stream for the string above: \\n    TokenStream ts = new TokenStream() { \\n      Iterator iter; \\n      {\\n        List lst = new ArrayList();\\n        Token t;\\n        t = new Token(\\\"i\\\",0,1);\\n        lst.add(t);\\n        t = new Token(\\\"pod\\\",1,4);\\n        lst.add(t);\\n        t = new Token(\\\"ipod\\\",0,4);\\n        t.setPositionIncrement(0);   \\/\\/ pod and ipod occupy the same token position.\\n        lst.add(t);\\n        t = new Token(\\\"foo\\\",5,8);\\n        lst.add(t);\\n        iter = lst.iterator();\\n      }\\n       public Token next() throws IOException  \\n{\\n        return iter.hasNext() ? (Token)iter.next() : null;\\n      }\\n     }; \\n\\n     String srchkey = \\\"foo\\\"; \\n\\n     QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()); \\n    Query query = parser.parse(srchkey); \\n\\n     Highlighter highlighter = new Highlighter(new QueryScorer(query)); \\n\\n \\/\\/ Get 3 best fragments and seperate with a \\\"...\\\" \\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\"); \\n    String expectedResult=\\\"iPod &lt;B&gt;foo&lt;\\/B&gt;\\\"; \\n    assertEquals(expectedResult,result); \\n  }              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420971\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420971&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420971\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420971_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420971_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 07:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T07:40:51+0000\'\u003e14\\/Jul\\/06 07:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI just tried the change to isDistinct, and it didn\'t work for the corrected tokenstream I posted.\u003cbr\\/\u003e\\nI agree that it doesn\'t seem like the right fix anyway.   It seems like things should be based on startOffset and endOffset.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420971_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420971_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 07:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T07:40:51+0000\'\u003e14\\/Jul\\/06 07:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I just tried the change to isDistinct, and it didn\'t work for the corrected tokenstream I posted. \\nI agree that it doesn\'t seem like the right fix anyway.   It seems like things should be based on startOffset and endOffset.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420972\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420972&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420972\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420972_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420972_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 07:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T07:58:17+0000\'\u003e14\\/Jul\\/06 07:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere\'s another fun one \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003ejunit.framework.ComparisonFailure: \u003cbr\\/\u003e\\nExpected :zooPod&lt;B&gt;Foo&lt;\\/B&gt;\u003cbr\\/\u003e\\nActual  :zoozooPod&lt;B&gt;zooPodFoo&lt;\\/B&gt;\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e  public void testOverlapAnalyzer3() throws Exception\u003cbr\\/\u003e\\n  {\u003c\\/p\u003e\\n\\n\u003cp\u003e    String s = \\\"zooPodFoo\\\";\u003cbr\\/\u003e\\n    \\/\\/ the token stream for the string above:\u003cbr\\/\u003e\\n    TokenStream ts = new TokenStream() {\u003cbr\\/\u003e\\n      Iterator iter;\u003c\\/p\u003e\\n      {\\n        List lst = new ArrayList();\\n        Token t;\\n        t = new Token(\\\"zoo\\\",0,3);\\n        lst.add(t);\\n        t = new Token(\\\"pod\\\",3,6);\\n        lst.add(t);\\n        t = new Token(\\\"zoopod\\\",0,6);\\n        t.setPositionIncrement(0);\\n        lst.add(t);\\n        t = new Token(\\\"foo\\\",6,9);\\n        lst.add(t);\\n        t = new Token(\\\"zoopodfoo\\\",0,9);\\n        t.setPositionIncrement(0);        \\n        lst.add(t);\\n        iter = lst.iterator();\\n      }\\n\u003cp\u003e      public Token next() throws IOException \u003c\\/p\u003e\\n{\\n        return iter.hasNext() ? (Token)iter.next() : null;\\n      }\\n\u003cp\u003e    };\u003c\\/p\u003e\\n\\n\u003cp\u003e    String srchkey = \\\"foo\\\";\u003c\\/p\u003e\\n\\n\u003cp\u003e    QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer());\u003cbr\\/\u003e\\n    Query query = parser.parse(srchkey);\u003c\\/p\u003e\\n\\n\u003cp\u003e    Highlighter highlighter = new Highlighter(new QueryScorer(query));\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/\\/ Get 3 best fragments and seperate with a \\\"...\\\"\u003cbr\\/\u003e\\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\");\u003cbr\\/\u003e\\n    String expectedResult=\\\"zooPod&lt;B&gt;Foo&lt;\\/B&gt;\\\";\u003cbr\\/\u003e\\n    assertEquals(expectedResult,result);\u003cbr\\/\u003e\\n  }\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420972_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420972_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 07:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T07:58:17+0000\'\u003e14\\/Jul\\/06 07:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here\'s another fun one   \\n\\n junit.framework.ComparisonFailure:  \\nExpected :zooPod&lt;B&gt;Foo&lt;\\/B&gt; \\nActual  :zoozooPod&lt;B&gt;zooPodFoo&lt;\\/B&gt; \\n\\n\\n   public void testOverlapAnalyzer3() throws Exception \\n  { \\n\\n     String s = \\\"zooPodFoo\\\"; \\n    \\/\\/ the token stream for the string above: \\n    TokenStream ts = new TokenStream() { \\n      Iterator iter; \\n      {\\n        List lst = new ArrayList();\\n        Token t;\\n        t = new Token(\\\"zoo\\\",0,3);\\n        lst.add(t);\\n        t = new Token(\\\"pod\\\",3,6);\\n        lst.add(t);\\n        t = new Token(\\\"zoopod\\\",0,6);\\n        t.setPositionIncrement(0);\\n        lst.add(t);\\n        t = new Token(\\\"foo\\\",6,9);\\n        lst.add(t);\\n        t = new Token(\\\"zoopodfoo\\\",0,9);\\n        t.setPositionIncrement(0);        \\n        lst.add(t);\\n        iter = lst.iterator();\\n      }\\n       public Token next() throws IOException  \\n{\\n        return iter.hasNext() ? (Token)iter.next() : null;\\n      }\\n     }; \\n\\n     String srchkey = \\\"foo\\\"; \\n\\n     QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()); \\n    Query query = parser.parse(srchkey); \\n\\n     Highlighter highlighter = new Highlighter(new QueryScorer(query)); \\n\\n \\/\\/ Get 3 best fragments and seperate with a \\\"...\\\" \\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\"); \\n    String expectedResult=\\\"zooPod&lt;B&gt;Foo&lt;\\/B&gt;\\\"; \\n    assertEquals(expectedResult,result); \\n  } \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12420978\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12420978&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12420978\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420978_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420978_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 09:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T09:04:05+0000\'\u003e14\\/Jul\\/06 09:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIt seems like maybe the only way to handle some of this stuff is two passes... one to collect the scores &amp; offsets of matches, and then a second pass to generate the fragments.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12420978_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12420978_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 09:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T09:04:05+0000\'\u003e14\\/Jul\\/06 09:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    It seems like maybe the only way to handle some of this stuff is two passes... one to collect the scores &amp; offsets of matches, and then a second pass to generate the fragments.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12421024\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12421024&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12421024\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12421024_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421024_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 13:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T13:53:51+0000\'\u003e14\\/Jul\\/06 13:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt;&gt;It seems like maybe the only way to handle some of this stuff is two passes\u003c\\/p\u003e\\n\\n\u003cp\u003eThe highlighter does not expect token positions to \\\"rewind\\\" in this manner. I\'m not sure where this ends. Imagine an analyzer, which having considered and emitted tokens for a whole document, chooses to append some  tokens positioned which  has offsets referencing much earlier sections of the document. (Why, I\'m not sure but there\'s nothing to say this couldn\'t happen).\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt;&gt;It seems like maybe the only way to handle some of this stuff is two passes\u003c\\/p\u003e\\n\\n\u003cp\u003eMaybe a special \\\"OrderFixer\\\" TokenStream could be used by to wrap \\\"rewinding\\\" token streams such as yours and then accumulate all tokens in a  buffer before then sorting and outputting them in ascending start offset order. If the Highlighter ignored position increment and just used offsets (as it does currently) I suspect all would be OK\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12421024_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421024_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 13:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T13:53:51+0000\'\u003e14\\/Jul\\/06 13:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt;&gt;It seems like maybe the only way to handle some of this stuff is two passes \\n\\n The highlighter does not expect token positions to \\\"rewind\\\" in this manner. I\'m not sure where this ends. Imagine an analyzer, which having considered and emitted tokens for a whole document, chooses to append some  tokens positioned which  has offsets referencing much earlier sections of the document. (Why, I\'m not sure but there\'s nothing to say this couldn\'t happen). \\n\\n &gt;&gt;It seems like maybe the only way to handle some of this stuff is two passes \\n\\n Maybe a special \\\"OrderFixer\\\" TokenStream could be used by to wrap \\\"rewinding\\\" token streams such as yours and then accumulate all tokens in a  buffer before then sorting and outputting them in ascending start offset order. If the Highlighter ignored position increment and just used offsets (as it does currently) I suspect all would be OK \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12421128\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12421128&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12421128\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421128_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421128_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 14:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T14:51:19+0000\'\u003e14\\/Jul\\/06 14:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRight... I\'m not sure the highlighter should be expected to handle all cases, but WordDelimiterFilter doesn\'t seem \u003cb\u003ethat\u003c\\/b\u003e complex or atypical.\u003c\\/p\u003e\\n\\n\u003cp\u003e\\\"a-b-c\\\" would be indexed as \\\"a\\\",\\\"b\\\",\\\"c\\\"\\/\\\"abc\\\"\u003cbr\\/\u003e\\n(c and abc occupy the same token position)\u003c\\/p\u003e\\n\\n\u003cp\u003eAnother thing I ran across is the addition of non-scoring tokens to a TokenGroup... this ends up highlighting the widest token in the token group, rather than the widest that matched.  I was able to get around this by checking that score&gt;0 in TokenGroup, but was this indended?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421128_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421128_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 14:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T14:51:19+0000\'\u003e14\\/Jul\\/06 14:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Right... I\'m not sure the highlighter should be expected to handle all cases, but WordDelimiterFilter doesn\'t seem  that  complex or atypical. \\n\\n \\\"a-b-c\\\" would be indexed as \\\"a\\\",\\\"b\\\",\\\"c\\\"\\/\\\"abc\\\" \\n(c and abc occupy the same token position) \\n\\n Another thing I ran across is the addition of non-scoring tokens to a TokenGroup... this ends up highlighting the widest token in the token group, rather than the widest that matched.  I was able to get around this by checking that score&gt;0 in TokenGroup, but was this indended?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12421162\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12421162&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12421162\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421162_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421162_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 16:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T16:58:06+0000\'\u003e14\\/Jul\\/06 16:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m going with the OrderFixer approach for now... if startOffsets are equal, but endOffsets are not, does it matter which comes first?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421162_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421162_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 16:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T16:58:06+0000\'\u003e14\\/Jul\\/06 16:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m going with the OrderFixer approach for now... if startOffsets are equal, but endOffsets are not, does it matter which comes first?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12421220\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12421220&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12421220\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421220_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421220_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 20:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T20:41:32+0000\'\u003e14\\/Jul\\/06 20:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere is a patch that makes the tests work after tokens are re-ordered.\u003cbr\\/\u003e\\nI basically keep track of the start and end offsets of what matches, not just of the TokenGroup, so highlighting is more specific.\u003c\\/p\u003e\\n\\n\u003cp\u003eSorry about the messy patch - my IDE collapses the tabs so I don\'t even see them (I only realize there are tabs after I do a diff).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421220_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421220_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/06 20:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-14T20:41:32+0000\'\u003e14\\/Jul\\/06 20:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here is a patch that makes the tests work after tokens are re-ordered. \\nI basically keep track of the start and end offsets of what matches, not just of the TokenGroup, so highlighting is more specific. \\n\\n Sorry about the messy patch - my IDE collapses the tabs so I don\'t even see them (I only realize there are tabs after I do a diff).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12421332\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12421332&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12421332\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421332_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421332_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jul\\/06 19:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-15T19:40:18+0000\'\u003e15\\/Jul\\/06 19:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSo Mark, does this patch look OK?\u003cbr\\/\u003e\\nWithout it, even if I order the tokens by startOffset, I get things like\u003cbr\\/\u003e\\nHiHi-Speed &lt;em&gt;USB&lt;\\/em&gt;\u003c\\/p\u003e\\n\\n\u003cp\u003eWordDelimiterFilter (that\'s what is producing these types of tokens) is widely used in Solr-land, so I\'m eager to get this fixed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421332_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421332_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jul\\/06 19:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-15T19:40:18+0000\'\u003e15\\/Jul\\/06 19:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    So Mark, does this patch look OK? \\nWithout it, even if I order the tokens by startOffset, I get things like \\nHiHi-Speed &lt;em&gt;USB&lt;\\/em&gt; \\n\\n WordDelimiterFilter (that\'s what is producing these types of tokens) is widely used in Solr-land, so I\'m eager to get this fixed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12421342\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12421342&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12421342\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12421342_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421342_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jul\\/06 20:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-15T20:52:04+0000\'\u003e15\\/Jul\\/06 20:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Yonik,\u003cbr\\/\u003e\\nBeen away for a little while and just managed to catch up with your changes. Thanks for this.\u003c\\/p\u003e\\n\\n\u003cp\u003eLooking at the patch all seems good. I would just change a couple of things:\u003c\\/p\u003e\\n\\n\u003cp\u003e1) TokenGroup.getTotalScore should just return your new \\\"tot\\\" variable\u003cbr\\/\u003e\\n2) TokenGroup.clear() needs to reinitialize \\\"tot\\\" to zero.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eOther than that all looks good to me. Let me know if you\'re happy and I\'ll commit it.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks again\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12421342_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421342_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jul\\/06 20:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-15T20:52:04+0000\'\u003e15\\/Jul\\/06 20:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Yonik, \\nBeen away for a little while and just managed to catch up with your changes. Thanks for this. \\n\\n Looking at the patch all seems good. I would just change a couple of things: \\n\\n 1) TokenGroup.getTotalScore should just return your new \\\"tot\\\" variable \\n2) TokenGroup.clear() needs to reinitialize \\\"tot\\\" to zero. \\n\\n\\n Other than that all looks good to me. Let me know if you\'re happy and I\'ll commit it. \\n\\n Thanks again              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12421347\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12421347&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12421347\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421347_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421347_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jul\\/06 21:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-15T21:14:26+0000\'\u003e15\\/Jul\\/06 21:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; 1) TokenGroup.getTotalScore should just return your new \\\"tot\\\" variable\u003c\\/p\u003e\\n\\n\u003cp\u003eOK, I had considered that change before, but because all the vars were package protected rather than private, I wasn\'t sure if it was safe.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; 2) TokenGroup.clear() needs to reinitialize \\\"tot\\\" to zero.\u003c\\/p\u003e\\n\\n\u003cp\u003eOops... that one I missed.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; Other than that all looks good to me. Let me know if you\'re happy and I\'ll commit it.\u003c\\/p\u003e\\n\\n\u003cp\u003eLooks fine to me... please do!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421347_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421347_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jul\\/06 21:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-15T21:14:26+0000\'\u003e15\\/Jul\\/06 21:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; 1) TokenGroup.getTotalScore should just return your new \\\"tot\\\" variable \\n\\n OK, I had considered that change before, but because all the vars were package protected rather than private, I wasn\'t sure if it was safe. \\n\\n &gt; 2) TokenGroup.clear() needs to reinitialize \\\"tot\\\" to zero. \\n\\n Oops... that one I missed. \\n\\n &gt; Other than that all looks good to me. Let me know if you\'re happy and I\'ll commit it. \\n\\n Looks fine to me... please do!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12421372\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12421372&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12421372\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421372_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421372_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Jul\\/06 03:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-16T03:19:47+0000\'\u003e16\\/Jul\\/06 03:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eClosing... works fine for me now.\u003cbr\\/\u003e\\nThanks!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12421372_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12421372_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Jul\\/06 03:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-07-16T03:19:47+0000\'\u003e16\\/Jul\\/06 03:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Closing... works fine for me now. \\nThanks!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12434087\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12434087&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12434087\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lhelper\\\" id=\\\"commentauthor_12434087_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lhelper\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lhelper\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kerang Lv\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434087_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Sep\\/06 08:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-12T08:12:52+0000\'\u003e12\\/Sep\\/06 08:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Yonik, \u003cbr\\/\u003e\\nI\'m trying to add support for some overlapping bigram analyzer, e.g. the CJKAnalyzer(\u003ca href=\\\"http:\\/\\/svn.apache.org\\/repos\\/asf\\/lucene\\/java\\/trunk\\/contrib\\/analyzers\\/src\\/java\\/org\\/apache\\/lucene\\/analysis\\/cjk\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/svn.apache.org\\/repos\\/asf\\/lucene\\/java\\/trunk\\/contrib\\/analyzers\\/src\\/java\\/org\\/apache\\/lucene\\/analysis\\/cjk\\/\u003c\\/a\u003e) onto your patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eWith your patch, the following test fails with:\u003cbr\\/\u003e\\nExpected :?&lt;B&gt;\u003ccite\u003e&lt;\\/B&gt;\u003c\\/cite\u003e&lt;B&gt;\u003ccite\u003e&lt;\\/B&gt;\u003c\\/cite\u003e?\u003cbr\\/\u003e\\nActual :?&lt;B&gt;??????&lt;\\/B&gt;\u003c\\/p\u003e\\n\\n\u003cp\u003epublic void testOverlapAnalyzer4() throws Exception\u003cbr\\/\u003e\\n{\u003cbr\\/\u003e\\n    String s = \\\"??????????\\\";\u003cbr\\/\u003e\\n    \\/\\/ the token stream for the string above:\u003cbr\\/\u003e\\n    TokenStream ts = new TokenStream() {\u003cbr\\/\u003e\\n      Iterator iter;\u003c\\/p\u003e\\n      {\\n        List lst = new ArrayList();\\n        Token t;\\n        t = new Token(\\\"??\\\",0,2);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",1,3);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",2,4);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",3,5);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",4,6);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",5,7);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",6,8);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",7,9);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",8,10);\\n        lst.add(t);\\n        iter = lst.iterator();\\n      }\\n\u003cp\u003e      public Token next() throws IOException \u003c\\/p\u003e\\n{\\n        return iter.hasNext() ? (Token)iter.next() : null;\\n      }\\n\u003cp\u003e    };\u003c\\/p\u003e\\n\\n\u003cp\u003e    String srchkey = \\\"?? ??\\\";\u003c\\/p\u003e\\n\\n\u003cp\u003e    QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer());\u003cbr\\/\u003e\\n    Query query = parser.parse(srchkey);\u003c\\/p\u003e\\n\\n\u003cp\u003e    Highlighter highlighter = new Highlighter(new QueryScorer(query));\u003c\\/p\u003e\\n\\n\u003cp\u003e    \\/\\/ Get 3 best fragments and seperate with a \\\"...\\\"\u003cbr\\/\u003e\\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\");\u003cbr\\/\u003e\\n    String expectedResult=\\\"?&lt;B&gt;\u003ccite\u003e&lt;\\/B&gt;\u003c\\/cite\u003e&lt;B&gt;\u003ccite\u003e&lt;\\/B&gt;\u003c\\/cite\u003e?\\\";\u003cbr\\/\u003e\\n    assertEquals(expectedResult,result);\u003cbr\\/\u003e\\n} \u003c\\/p\u003e\\n\\n\u003cp\u003eWith some overlapping bigram analyzer, the current token\'s startOffset is the previous token\'s endOffset - 1, so the TokenGroup.isDistinct(token) returns false the most time, which lead to bad range tokenText.\u003c\\/p\u003e\\n\\n\u003cp\u003eHere is a patch that makes the tests work.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lhelper\\\" id=\\\"commentauthor_12434087_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lhelper\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lhelper\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kerang Lv\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434087_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Sep\\/06 08:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-12T08:12:52+0000\'\u003e12\\/Sep\\/06 08:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Yonik,  \\nI\'m trying to add support for some overlapping bigram analyzer, e.g. the CJKAnalyzer( http:\\/\\/svn.apache.org\\/repos\\/asf\\/lucene\\/java\\/trunk\\/contrib\\/analyzers\\/src\\/java\\/org\\/apache\\/lucene\\/analysis\\/cjk\\/ ) onto your patch. \\n\\n With your patch, the following test fails with: \\nExpected :?&lt;B&gt; &lt;\\/B&gt; &lt;B&gt; &lt;\\/B&gt; ? \\nActual :?&lt;B&gt;??????&lt;\\/B&gt; \\n\\n public void testOverlapAnalyzer4() throws Exception \\n{ \\n    String s = \\\"??????????\\\"; \\n    \\/\\/ the token stream for the string above: \\n    TokenStream ts = new TokenStream() { \\n      Iterator iter; \\n      {\\n        List lst = new ArrayList();\\n        Token t;\\n        t = new Token(\\\"??\\\",0,2);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",1,3);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",2,4);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",3,5);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",4,6);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",5,7);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",6,8);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",7,9);\\n        lst.add(t);\\n        t = new Token(\\\"??\\\",8,10);\\n        lst.add(t);\\n        iter = lst.iterator();\\n      }\\n       public Token next() throws IOException  \\n{\\n        return iter.hasNext() ? (Token)iter.next() : null;\\n      }\\n     }; \\n\\n     String srchkey = \\\"?? ??\\\"; \\n\\n     QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()); \\n    Query query = parser.parse(srchkey); \\n\\n     Highlighter highlighter = new Highlighter(new QueryScorer(query)); \\n\\n     \\/\\/ Get 3 best fragments and seperate with a \\\"...\\\" \\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\"); \\n    String expectedResult=\\\"?&lt;B&gt; &lt;\\/B&gt; &lt;B&gt; &lt;\\/B&gt; ?\\\"; \\n    assertEquals(expectedResult,result); \\n}  \\n\\n With some overlapping bigram analyzer, the current token\'s startOffset is the previous token\'s endOffset - 1, so the TokenGroup.isDistinct(token) returns false the most time, which lead to bad range tokenText. \\n\\n Here is a patch that makes the tests work.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12434291\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12434291&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12434291\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12434291_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434291_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Sep\\/06 21:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-12T21:57:00+0000\'\u003e12\\/Sep\\/06 21:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Kerang, can you supply a patch\\/tests against the latest version?\u003c\\/p\u003e\\n\\n\u003cp\u003eI committed a change to highlighter on the 16th August with what I beleived to be a fix for  this problem:   \u003ca href=\\\"http:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-645\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-645\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eLooking at the patch you provided it seems to be old code which is missing support for this fix.\u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12434291_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12434291_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Sep\\/06 21:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-12T21:57:00+0000\'\u003e12\\/Sep\\/06 21:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Kerang, can you supply a patch\\/tests against the latest version? \\n\\n I committed a change to highlighter on the 16th August with what I beleived to be a fix for  this problem:    http:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-645  \\n\\n Looking at the patch you provided it seems to be old code which is missing support for this fix. \\n\\n Cheers \\nMark              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438333\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12438333&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438333\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lhelper\\\" id=\\\"commentauthor_12438333_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lhelper\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lhelper\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kerang Lv\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438333_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 06:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T06:57:47+0000\'\u003e28\\/Sep\\/06 06:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Mark, sorry for the long time missing!\u003c\\/p\u003e\\n\\n\u003cp\u003eHere is the test, it fails again with the lastest version (Revision 450719):\u003c\\/p\u003e\\n\\n\u003cp\u003eExpected :A&lt;B&gt;BC&lt;\\/B&gt;DE&lt;B&gt;FG&lt;\\/B&gt;HIJ\u003cbr\\/\u003e\\nActual:A&lt;B&gt;BCDEFG&lt;\\/B&gt;HIJ\u003c\\/p\u003e\\n\\n\u003cp\u003epublic void testOverlapAnalyzer4() throws Exception \u003cbr\\/\u003e\\n{ \u003cbr\\/\u003e\\n    String s = \\\"ABCDEFGHIJ\\\"; \u003cbr\\/\u003e\\n    \\/\\/ the token stream for the string above: \u003cbr\\/\u003e\\n    TokenStream ts = new TokenStream() { \u003cbr\\/\u003e\\n      Iterator iter; \u003c\\/p\u003e\\n      { \\n        List lst = new ArrayList(); \\n        Token t; \\n        t = new Token(\\\"AB\\\",0,2); \\n        lst.add(t); \\n        t = new Token(\\\"BC\\\",1,3); \\n        lst.add(t); \\n        t = new Token(\\\"CD\\\",2,4); \\n        lst.add(t); \\n        t = new Token(\\\"DE\\\",3,5); \\n        lst.add(t); \\n        t = new Token(\\\"EF\\\",4,6); \\n        lst.add(t); \\n        t = new Token(\\\"FG\\\",5,7); \\n        lst.add(t); \\n        t = new Token(\\\"GH\\\",6,8); \\n        lst.add(t); \\n        t = new Token(\\\"HI\\\",7,9); \\n        lst.add(t); \\n        t = new Token(\\\"IJ\\\",8,10); \\n        lst.add(t); \\n        iter = lst.iterator(); \\n      } \\n\u003cp\u003e      public Token next() throws IOException \u003c\\/p\u003e\\n{ \\n        return iter.hasNext() ? (Token)iter.next() : null; \\n      }\\n\u003cp\u003e \u003cbr\\/\u003e\\n    }; \u003c\\/p\u003e\\n\\n\u003cp\u003e    String srchkey = \\\"BC FG\\\"; \u003c\\/p\u003e\\n\\n\u003cp\u003e    QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()); \u003cbr\\/\u003e\\n    Query query = parser.parse(srchkey); \u003c\\/p\u003e\\n\\n\u003cp\u003e    Highlighter highlighter = new Highlighter(new QueryScorer(query)); \u003c\\/p\u003e\\n\\n\u003cp\u003e    \\/\\/ Get 3 best fragments and seperate with a \\\"...\\\" \u003cbr\\/\u003e\\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\"); \u003cbr\\/\u003e\\n    String expectedResult=\\\"A&lt;B&gt;BC&lt;\\/B&gt;DE&lt;B&gt;FG&lt;\\/B&gt;HIJ\\\"; \u003cbr\\/\u003e\\n    assertEquals(expectedResult,result); \u003cbr\\/\u003e\\n} \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lhelper\\\" id=\\\"commentauthor_12438333_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lhelper\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lhelper\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kerang Lv\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438333_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 06:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T06:57:47+0000\'\u003e28\\/Sep\\/06 06:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Mark, sorry for the long time missing! \\n\\n Here is the test, it fails again with the lastest version (Revision 450719): \\n\\n Expected :A&lt;B&gt;BC&lt;\\/B&gt;DE&lt;B&gt;FG&lt;\\/B&gt;HIJ \\nActual:A&lt;B&gt;BCDEFG&lt;\\/B&gt;HIJ \\n\\n public void testOverlapAnalyzer4() throws Exception  \\n{  \\n    String s = \\\"ABCDEFGHIJ\\\";  \\n    \\/\\/ the token stream for the string above:  \\n    TokenStream ts = new TokenStream() {  \\n      Iterator iter;  \\n      { \\n        List lst = new ArrayList(); \\n        Token t; \\n        t = new Token(\\\"AB\\\",0,2); \\n        lst.add(t); \\n        t = new Token(\\\"BC\\\",1,3); \\n        lst.add(t); \\n        t = new Token(\\\"CD\\\",2,4); \\n        lst.add(t); \\n        t = new Token(\\\"DE\\\",3,5); \\n        lst.add(t); \\n        t = new Token(\\\"EF\\\",4,6); \\n        lst.add(t); \\n        t = new Token(\\\"FG\\\",5,7); \\n        lst.add(t); \\n        t = new Token(\\\"GH\\\",6,8); \\n        lst.add(t); \\n        t = new Token(\\\"HI\\\",7,9); \\n        lst.add(t); \\n        t = new Token(\\\"IJ\\\",8,10); \\n        lst.add(t); \\n        iter = lst.iterator(); \\n      } \\n       public Token next() throws IOException  \\n{ \\n        return iter.hasNext() ? (Token)iter.next() : null; \\n      }\\n   \\n    };  \\n\\n     String srchkey = \\\"BC FG\\\";  \\n\\n     QueryParser parser=new QueryParser(\\\"text\\\",new WhitespaceAnalyzer());  \\n    Query query = parser.parse(srchkey);  \\n\\n     Highlighter highlighter = new Highlighter(new QueryScorer(query));  \\n\\n     \\/\\/ Get 3 best fragments and seperate with a \\\"...\\\"  \\n    String result = highlighter.getBestFragments(ts, s, 3, \\\"...\\\");  \\n    String expectedResult=\\\"A&lt;B&gt;BC&lt;\\/B&gt;DE&lt;B&gt;FG&lt;\\/B&gt;HIJ\\\";  \\n    assertEquals(expectedResult,result);  \\n}               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438531\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12438531&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438531\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12438531_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438531_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 19:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T19:17:00+0000\'\u003e28\\/Sep\\/06 19:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the test Kerang.\u003c\\/p\u003e\\n\\n\u003cp\u003eI no longer have a clear view as to what is expected behaviour here and whether this is a test that needs to pass.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt seems to conflict with the expected results for Yonik\'s test method \\\"testOverlapAnalyzer2\\\".\u003cbr\\/\u003e\\nIn that test, (like yours) for a cluster of overlapping tokens with search terms identified at the beginning and end, Yonik expects the whole cluster from search term 1\'s start offset to search term 2\'s end offset to be surrounded by one highlight tag. Your test expected 2 tags.\u003c\\/p\u003e\\n\\n\u003cp\u003eWho is right?\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is a snippet from Yonik\'s test:\u003cbr\\/\u003e\\n    query = new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()).parse(\\\"hi speed\\\");\u003cbr\\/\u003e\\n    highlighter = new Highlighter(new QueryScorer(query));\u003cbr\\/\u003e\\n    result = highlighter.getBestFragments(getTS2(), s, 3, \\\"...\\\");\u003cbr\\/\u003e\\n    assertEquals(\\\"&lt;B&gt;Hi-Speed&lt;\\/B&gt;10 foo\\\",result);\u003c\\/p\u003e\\n\\n\u003cp\u003eand yours:\u003c\\/p\u003e\\n\\n\u003cp\u003e      String srchkey = \\\"BC FG\\\"; \u003cbr\\/\u003e\\n      String expectedResult=\\\"A&lt;B&gt;BC&lt;\\/B&gt;DE&lt;B&gt;FG&lt;\\/B&gt;HIJ\\\"; \u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t really have an opinion either way so I\'ll turn it over to you\u003c\\/p\u003e\\n\\n\u003cp\u003eCheers\u003cbr\\/\u003e\\nMark\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markh\\\" id=\\\"commentauthor_12438531_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markh\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markh\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Harwood\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438531_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 19:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T19:17:00+0000\'\u003e28\\/Sep\\/06 19:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the test Kerang. \\n\\n I no longer have a clear view as to what is expected behaviour here and whether this is a test that needs to pass. \\n\\n It seems to conflict with the expected results for Yonik\'s test method \\\"testOverlapAnalyzer2\\\". \\nIn that test, (like yours) for a cluster of overlapping tokens with search terms identified at the beginning and end, Yonik expects the whole cluster from search term 1\'s start offset to search term 2\'s end offset to be surrounded by one highlight tag. Your test expected 2 tags. \\n\\n Who is right? \\n\\n This is a snippet from Yonik\'s test: \\n    query = new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()).parse(\\\"hi speed\\\"); \\n    highlighter = new Highlighter(new QueryScorer(query)); \\n    result = highlighter.getBestFragments(getTS2(), s, 3, \\\"...\\\"); \\n    assertEquals(\\\"&lt;B&gt;Hi-Speed&lt;\\/B&gt;10 foo\\\",result); \\n\\n and yours: \\n\\n       String srchkey = \\\"BC FG\\\";  \\n      String expectedResult=\\\"A&lt;B&gt;BC&lt;\\/B&gt;DE&lt;B&gt;FG&lt;\\/B&gt;HIJ\\\";  \\n\\n I don\'t really have an opinion either way so I\'ll turn it over to you \\n\\n Cheers \\nMark \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438553\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12438553&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438553\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12438553_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438553_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 21:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T21:11:08+0000\'\u003e28\\/Sep\\/06 21:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI agree with Kerang about the expected behavior (of this specific case at least).\u003cbr\\/\u003e\\nThe test case of mine quoted above was not what I was shooting for, but was an acceptable unintended side-effect of fixing the other cases.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo I\'m fine with this case being changed to\u003cbr\\/\u003e\\n    query = new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()).parse(\\\"hi speed\\\");\u003cbr\\/\u003e\\n    highlighter = new Highlighter(new QueryScorer(query));\u003cbr\\/\u003e\\n    result = highlighter.getBestFragments(getTS2(), s, 3, \\\"...\\\");\u003cbr\\/\u003e\\n    assertEquals(\\\"&lt;B&gt;Hi&lt;\\/B&gt;-&lt;B&gt;Speed&lt;\\/B&gt;10 foo\\\",result);\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12438553_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438553_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 21:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T21:11:08+0000\'\u003e28\\/Sep\\/06 21:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I agree with Kerang about the expected behavior (of this specific case at least). \\nThe test case of mine quoted above was not what I was shooting for, but was an acceptable unintended side-effect of fixing the other cases. \\n\\n So I\'m fine with this case being changed to \\n    query = new QueryParser(\\\"text\\\",new WhitespaceAnalyzer()).parse(\\\"hi speed\\\"); \\n    highlighter = new Highlighter(new QueryScorer(query)); \\n    result = highlighter.getBestFragments(getTS2(), s, 3, \\\"...\\\"); \\n    assertEquals(\\\"&lt;B&gt;Hi&lt;\\/B&gt;-&lt;B&gt;Speed&lt;\\/B&gt;10 foo\\\",result);              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12662579\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=12662579&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12662579\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ryguasu\\\" id=\\\"commentauthor_12662579_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ryguasu\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ryguasu\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Chris Harris\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12662579_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/09 00:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-01-10T00:35:44+0000\'\u003e10\\/Jan\\/09 00:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m here two years after the last comment, trying to create a sense of closure for myself regarding the above conversation:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eIt appears that Mark Harwood committed a slightly modified version of Yonik\'s 2006-07-14 01:41 PM patch in r422031 and r422302.\u003c\\/li\u003e\\n\\t\u003cli\u003eIt\'s not clear to me whether there was any actual code or test suite changes that eventually resulted from Mark, Yonik and Kerang\'s subsequent discussion about what, exactly, should be considered correct highlighting of multiple tokens.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ryguasu\\\" id=\\\"commentauthor_12662579_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ryguasu\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ryguasu\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Chris Harris\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12662579_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/09 00:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-01-10T00:35:44+0000\'\u003e10\\/Jan\\/09 00:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m here two years after the last comment, trying to create a sense of closure for myself regarding the above conversation: \\n\\n \\n\\t It appears that Mark Harwood committed a slightly modified version of Yonik\'s 2006-07-14 01:41 PM patch in r422031 and r422302. \\n\\t It\'s not clear to me whether there was any actual code or test suite changes that eventually resulted from Mark, Yonik and Kerang\'s subsequent discussion about what, exactly, should be considered correct highlighting of multiple tokens. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14262458\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-627?focusedCommentId=14262458&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14262458\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14262458_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14262458_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Dec\\/14 22:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-12-31T22:01:07+0000\'\u003e31\\/Dec\\/14 22:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=ryguasu\\\" class=\\\"user-hover\\\" rel=\\\"ryguasu\\\"\u003eChris Harris\u003c\\/a\u003e HighlighterTest was affected by r422302.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think that \u003cem\u003eeither\u003c\\/em\u003e \u003ctt\u003e&lt;B&gt;Hi&lt;\\/B&gt;-&lt;B&gt;Speed&lt;\\/B&gt;10 foo\u003c\\/tt\u003e OR \u003ctt\u003e&lt;B&gt;Hi-Speed&lt;\\/B&gt;10 foo\u003c\\/tt\u003e are acceptable results from a boolean query of \\\"hi\\\" and \\\"speed\\\".\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14262458_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14262458_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Dec\\/14 22:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-12-31T22:01:07+0000\'\u003e31\\/Dec\\/14 22:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Chris Harris  HighlighterTest was affected by r422302. \\n\\n I think that  either   &lt;B&gt;Hi&lt;\\/B&gt;-&lt;B&gt;Speed&lt;\\/B&gt;10 foo  OR  &lt;B&gt;Hi-Speed&lt;\\/B&gt;10 foo  are acceptable results from a boolean query of \\\"hi\\\" and \\\"speed\\\".              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520242421095"> 
    <input type="hidden" title="jira.request.server.time" value="197"> 
    <input type="hidden" title="jira.request.id" value="573x94504543x7"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="5"> 
    <input type="hidden" title="db.reads.time.in.ms" value="29"> 
    <input type="hidden" title="db.conns.time.in.ms" value="36"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 573x94504543x7
	          REQUEST TIMESTAMP : [05/Mar/2018:09:33:41 +0000]
	               REQUEST TIME : 0.1970
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 5

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=19, elapsedTotal=29389198, elapsedMin=666268, elapsedMax=10977816, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=23, elapsedTotal=36209928, elapsedMin=699884, elapsedMax=11035019, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
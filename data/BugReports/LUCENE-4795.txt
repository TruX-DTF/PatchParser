<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|d1692d1833ba8222bce40ec621d486f6864c7009|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"90f58ce2483990\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-4795"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-4795] Add FacetsCollector based on SortedSetDocValues - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-4795] Add FacetsCollector based on SortedSetDocValues - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loadingâ€¦
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-4795">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-4795" href="/jira/browse/LUCENE-4795" id="key-val" rel="12633906">LUCENE-4795</a></li>
                </ol>
                <h1 id="summary-val">Add FacetsCollector based on SortedSetDocValues</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-4795"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-4795/LUCENE-4795.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-4795/LUCENE-4795.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-4795/LUCENE-4795.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-4795/LUCENE-4795.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+4.3" title="4.3 Major release after 4.2">4.3</a>, <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+6.0" title="6.0 Major release after 5.5">6.0</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22modules%2Ffacet%22" title="modules/facet Faceted Indexing &amp; Search module">modules/facet</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12633906-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310120" class="item"> 
                     <div class="wrap"> 
                      <strong title="Lucene Fields" class="name">Lucene Fields:</strong> 
                      <div id="customfield_12310120-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310120-field"> 
                        <span>New</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>Recently (<a href="https://issues.apache.org/jira/browse/LUCENE-4765" title="Multi-valued docvalues field" class="issue-link" data-issue-key="LUCENE-4765"><del>LUCENE-4765</del></a>) we added multi-valued DocValues field<br> (SortedSetDocValuesField), and this can be used for faceting in Solr<br> (<a href="https://issues.apache.org/jira/browse/SOLR-4490" title="add support  for multivalued docvalues" class="issue-link" data-issue-key="SOLR-4490"><del>SOLR-4490</del></a>). I think we should also add support in the facet module?</p> 
                  <p>It'd be an option with different tradeoffs. Eg, it wouldn't require<br> the taxonomy index, since the main index handles label/ord resolving.</p> 
                  <p>There are at least two possible approaches:</p> 
                  <ul> 
                   <li>On every reopen, build the seg -&gt; global ord map, and then on<br> every collect, get the seg ord, map it to the global ord space,<br> and increment counts. This adds cost during reopen in proportion<br> to number of unique terms ...</li> 
                  </ul> 
                  <ul> 
                   <li>On every collect, increment counts based on the seg ords, and then<br> do a "merge" in the end just like distributed faceting does.</li> 
                  </ul> 
                  <p>The first approach is much easier so I built a quick prototype using<br> that. The prototype does the counting, but it does NOT do the top K<br> facets gathering in the end, and it doesn't "know" parent/child ord<br> relationships, so there's tons more to do before this is real. I also<br> was unsure how to properly integrate it since the existing classes<br> seem to expect that you use a taxonomy index to resolve ords.</p> 
                  <p>I ran a quick performance test. base = trunk except I disabled the<br> "compute top-K" in FacetsAccumulator to make the comparison fair; comp<br> = using the prototype collector in the patch:</p> 
                  <div class="preformatted panel" style="border-width: 1px;">
                   <div class="preformattedContent panelContent"> 
                    <pre>                    Task    QPS base      StdDev    QPS comp      StdDev                Pct diff
               OrHighLow       18.79      (2.5%)       14.36      (3.3%)  -23.6% ( -28% -  -18%)
                HighTerm       21.58      (2.4%)       16.53      (3.7%)  -23.4% ( -28% -  -17%)
               OrHighMed       18.20      (2.5%)       13.99      (3.3%)  -23.2% ( -28% -  -17%)
                 Prefix3       14.37      (1.5%)       11.62      (3.5%)  -19.1% ( -23% -  -14%)
                 LowTerm      130.80      (1.6%)      106.95      (2.4%)  -18.2% ( -21% -  -14%)
              OrHighHigh        9.60      (2.6%)        7.88      (3.5%)  -17.9% ( -23% -  -12%)
             AndHighHigh       24.61      (0.7%)       20.74      (1.9%)  -15.7% ( -18% -  -13%)
                  Fuzzy1       49.40      (2.5%)       43.48      (1.9%)  -12.0% ( -15% -   -7%)
         MedSloppyPhrase       27.06      (1.6%)       23.95      (2.3%)  -11.5% ( -15% -   -7%)
                 MedTerm       51.43      (2.0%)       46.21      (2.7%)  -10.2% ( -14% -   -5%)
                  IntNRQ        4.02      (1.6%)        3.63      (4.0%)   -9.7% ( -15% -   -4%)
                Wildcard       29.14      (1.5%)       26.46      (2.5%)   -9.2% ( -13% -   -5%)
        HighSloppyPhrase        0.92      (4.5%)        0.87      (5.8%)   -5.4% ( -15% -    5%)
             MedSpanNear       29.51      (2.5%)       27.94      (2.2%)   -5.3% (  -9% -    0%)
            HighSpanNear        3.55      (2.4%)        3.38      (2.0%)   -4.9% (  -9% -    0%)
              AndHighMed      108.34      (0.9%)      104.55      (1.1%)   -3.5% (  -5% -   -1%)
         LowSloppyPhrase       20.50      (2.0%)       20.09      (4.2%)   -2.0% (  -8% -    4%)
               LowPhrase       21.60      (6.0%)       21.26      (5.1%)   -1.6% ( -11% -   10%)
                  Fuzzy2       53.16      (3.9%)       52.40      (2.7%)   -1.4% (  -7% -    5%)
             LowSpanNear        8.42      (3.2%)        8.45      (3.0%)    0.3% (  -5% -    6%)
                 Respell       45.17      (4.3%)       45.38      (4.4%)    0.5% (  -7% -    9%)
               MedPhrase      113.93      (5.8%)      115.02      (4.9%)    1.0% (  -9% -   12%)
              AndHighLow      596.42      (2.5%)      617.12      (2.8%)    3.5% (  -1% -    8%)
              HighPhrase       17.30     (10.5%)       18.36      (9.1%)    6.2% ( -12% -   28%)
</pre> 
                   </div>
                  </div> 
                  <p>I'm impressed that this approach is only ~24% slower in the worst<br> case! I think this means it's a good option to make available? Yes<br> it has downsides (NRT reopen more costly, small added RAM usage,<br> slightly slower faceting), but it's also simpler (no taxo index to<br> manage).</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-4795?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-4795?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-4795?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-4795?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12573787" data-issue-id="12633906" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12573787/LUCENE-4795.patch" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12573787/LUCENE-4795.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12573787/LUCENE-4795.patch" title="Latest  14/Mar/13 22:50 - Michael McCandless" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12573787/LUCENE-4795.patch">LUCENE-4795.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-03-14T22:50:23.878Z">14/Mar/13 22:50</time>
                   </dd>
                   <dd class="attachment-size">
                    48 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12573541" data-issue-id="12633906" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12573541/LUCENE-4795.patch" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12573541/LUCENE-4795.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12573541/LUCENE-4795.patch" title=" 13/Mar/13 17:55 - Michael McCandless" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12573541/LUCENE-4795.patch">LUCENE-4795.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-03-13T17:55:11.146Z">13/Mar/13 17:55</time>
                   </dd>
                   <dd class="attachment-size">
                    32 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12573142" data-issue-id="12633906" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12573142/LUCENE-4795.patch" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12573142/LUCENE-4795.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12573142/LUCENE-4795.patch" title=" 11/Mar/13 18:39 - Michael McCandless" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12573142/LUCENE-4795.patch">LUCENE-4795.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-03-11T18:39:06.514Z">11/Mar/13 18:39</time>
                   </dd>
                   <dd class="attachment-size">
                    27 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12571738" data-issue-id="12633906" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12571738/LUCENE-4795.patch" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12571738/LUCENE-4795.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12571738/LUCENE-4795.patch" title=" 02/Mar/13 14:37 - Michael McCandless" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12571738/LUCENE-4795.patch">LUCENE-4795.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-03-02T14:37:24.206Z">02/Mar/13 14:37</time>
                   </dd>
                   <dd class="attachment-size">
                    24 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12570797" data-issue-id="12633906" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12570797/LUCENE-4795.patch" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12570797/LUCENE-4795.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12570797/LUCENE-4795.patch" title=" 25/Feb/13 14:54 - Michael McCandless" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12570797/LUCENE-4795.patch">LUCENE-4795.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-02-25T14:54:15.631Z">25/Feb/13 14:54</time>
                   </dd>
                   <dd class="attachment-size">
                    4 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12570788" data-issue-id="12633906" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12570788/LUCENE-4795.patch" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12570788/LUCENE-4795.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12570788/LUCENE-4795.patch" title=" 25/Feb/13 13:59 - Michael McCandless" draggable="true" data-downloadurl="text/plain:LUCENE-4795.patch:https://issues.apache.org/jira/secure/attachment/12570788/LUCENE-4795.patch">LUCENE-4795.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-02-25T13:59:25.249Z">25/Feb/13 13:59</time>
                   </dd>
                   <dd class="attachment-size">
                    4 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12570790" data-issue-id="12633906" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12570790/pleaseBenchmarkMe.patch" draggable="true" data-downloadurl="text/x-diff:pleaseBenchmarkMe.patch:https://issues.apache.org/jira/secure/attachment/12570790/pleaseBenchmarkMe.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12570790/pleaseBenchmarkMe.patch" title="Latest  25/Feb/13 14:07 - Robert Muir" draggable="true" data-downloadurl="text/x-diff:pleaseBenchmarkMe.patch:https://issues.apache.org/jira/secure/attachment/12570790/pleaseBenchmarkMe.patch">pleaseBenchmarkMe.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-02-25T14:07:30.331Z">25/Feb/13 14:07</time>
                   </dd>
                   <dd class="attachment-size">
                    1 kB
                   </dd>
                   <dd class="attachment-author">
                    Robert Muir
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_mikemccand" rel="mikemccand" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Michael McCandless&quot;,&quot;emailAddress&quot;:&quot;lucene@mikemccandless.com&quot;,&quot;username&quot;:&quot;mikemccand&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="mikemccand"></span></span> Michael McCandless </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_mikemccand" rel="mikemccand" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Michael McCandless&quot;,&quot;emailAddress&quot;:&quot;lucene@mikemccandless.com&quot;,&quot;username&quot;:&quot;mikemccand&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="mikemccand"></span></span> Michael McCandless </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">3</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="25/Feb/13 13:58"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2013-02-25T13:58:35+0000">25/Feb/13 13:58</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="09/May/16 18:35"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-05-09T18:35:04+0000">09/May/16 18:35</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="15/Mar/13 20:17"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2013-03-15T20:17:17+0000">15/Mar/13 20:17</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4795?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4795?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-13585867\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13585867&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13585867\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13585867_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585867_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:07:30+0000\'\u003e25\\/Feb\\/13 14:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for benchmarking this approach Mike! \u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m happy with the results, though i still added a TODO that we should investigate the cost of the special packed-ints compression we do.\u003c\\/p\u003e\\n\\n\u003cp\u003ecan you benchmark the attached change just out of curiousity?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13585867_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585867_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:07:30+0000\'\u003e25\\/Feb\\/13 14:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for benchmarking this approach Mike!  \\n\\n I\'m happy with the results, though i still added a TODO that we should investigate the cost of the special packed-ints compression we do. \\n\\n can you benchmark the attached change just out of curiousity?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13585878\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13585878&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13585878\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13585878_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585878_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:19:37+0000\'\u003e25\\/Feb\\/13 14:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNot having to manage a taxonomy index is very appealing to me!\u003c\\/p\u003e\\n\\n\u003cp\u003eWhat about collecting based on segment ords and bulk translating these ords to the global ords in setNextReader and when the collection ends? This way ordinalMap.get would be called less often (once per value per segment instead of once per value per doc per segment) and in a sequential way so I assume it would be faster while remaining easy to implement?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13585878_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585878_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:19:37+0000\'\u003e25\\/Feb\\/13 14:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Not having to manage a taxonomy index is very appealing to me! \\n\\n What about collecting based on segment ords and bulk translating these ords to the global ords in setNextReader and when the collection ends? This way ordinalMap.get would be called less often (once per value per segment instead of once per value per doc per segment) and in a sequential way so I assume it would be faster while remaining easy to implement?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13585882\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13585882&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13585882\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13585882_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585882_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:26:48+0000\'\u003e25\\/Feb\\/13 14:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eWhat about collecting based on segment ords and bulk translating these ords to the global ords in setNextReader and when the collection ends? \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat sounds great!  I\'ll try that.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13585882_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585882_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:26:48+0000\'\u003e25\\/Feb\\/13 14:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     What about collecting based on segment ords and bulk translating these ords to the global ords in setNextReader and when the collection ends?   \\n\\n That sounds great!  I\'ll try that. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13585892\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13585892&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13585892\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13585892_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585892_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:45:41+0000\'\u003e25\\/Feb\\/13 14:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNice Mike.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf you want to integrate that with the current classes, all you need to do is to implement a partial TaxonomyReader, which resolves ordinals to CPs using the global ord map? Or actually make that TR the entity that\'s responsible to manage to global ordinal map, so that TR.doOpenIfChanged opens the new segments and updates the global map?\u003c\\/p\u003e\\n\\n\u003cp\u003eSince this taxonomy, at least currently, doesn\'t support hierarchical facets, you\'ll need to hack something as a ParallelTaxoArray, but that should be easy .. I think.\u003c\\/p\u003e\\n\\n\u003cp\u003eIs the only benefit in this approach that you don\'t need to manage a sidecar taxonomy index?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13585892_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585892_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:45:41+0000\'\u003e25\\/Feb\\/13 14:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Nice Mike. \\n\\n If you want to integrate that with the current classes, all you need to do is to implement a partial TaxonomyReader, which resolves ordinals to CPs using the global ord map? Or actually make that TR the entity that\'s responsible to manage to global ordinal map, so that TR.doOpenIfChanged opens the new segments and updates the global map? \\n\\n Since this taxonomy, at least currently, doesn\'t support hierarchical facets, you\'ll need to hack something as a ParallelTaxoArray, but that should be easy .. I think. \\n\\n Is the only benefit in this approach that you don\'t need to manage a sidecar taxonomy index?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13585899\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13585899&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13585899\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13585899_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585899_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:53:08+0000\'\u003e25\\/Feb\\/13 14:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFixed small bug (wasn\'t counting ord 0); here\'s the same test as\u003cbr\\/\u003e\\nbefore, just running on Term &amp; Or queries:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e                    Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                 MedTerm       52.70      (3.1%)       40.87      (2.0%)  -22.5% ( -26% -  -17%)\\n               OrHighMed       25.54      (3.6%)       20.18      (2.4%)  -21.0% ( -26% -  -15%)\\n                HighTerm        9.22      (4.1%)        7.33      (2.4%)  -20.4% ( -25% -  -14%)\\n              OrHighHigh       12.92      (3.6%)       10.41      (2.8%)  -19.4% ( -24% -  -13%)\\n               OrHighLow       13.12      (3.8%)       10.61      (2.8%)  -19.2% ( -24% -  -13%)\\n                 LowTerm      145.94      (1.9%)      125.51      (1.6%)  -14.0% ( -17% -  -10%)\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eThen I applied Rob\'s patch (base = trunk, comp = Rob\'s + my patch):\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e                    Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                 MedTerm       52.97      (2.2%)       42.34      (1.6%)  -20.1% ( -23% -  -16%)\\n               OrHighMed       25.66      (2.2%)       20.73      (1.7%)  -19.2% ( -22% -  -15%)\\n              OrHighHigh       12.99      (2.4%)       10.69      (1.8%)  -17.7% ( -21% -  -13%)\\n               OrHighLow       13.19      (2.3%)       10.94      (2.0%)  -17.0% ( -20% -  -12%)\\n                HighTerm        9.30      (2.6%)        7.76      (1.8%)  -16.6% ( -20% -  -12%)\\n                 LowTerm      146.48      (1.3%)      129.04      (0.9%)  -11.9% ( -13% -   -9%)\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eSo a wee bit faster but not much... (good!  The awesome predictive\u003cbr\\/\u003e\\ncompression from MonotonicALB doesn\'t hurt much).\u003c\\/p\u003e\\n\\n\u003cp\u003eThen I made a new collector that resolves ords after each segment from\u003cbr\\/\u003e\\nAdrien\'s idea (SortedSetDocValuesCollectorMergeBySeg) &#8211; base = same\u003cbr\\/\u003e\\nas above, comp = new collector w\\/o Rob\'s patch:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e                    Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                HighTerm        9.29      (3.1%)        7.14      (1.9%)  -23.2% ( -27% -  -18%)\\n               OrHighMed       25.51      (2.7%)       19.60      (2.2%)  -23.2% ( -27% -  -18%)\\n               OrHighLow       13.08      (2.8%)       10.20      (2.3%)  -22.0% ( -26% -  -17%)\\n              OrHighHigh       12.89      (2.9%)       10.21      (2.6%)  -20.8% ( -25% -  -15%)\\n                 MedTerm       53.00      (2.7%)       43.34      (1.5%)  -18.2% ( -21% -  -14%)\\n                 LowTerm      145.97      (1.6%)      133.05      (0.9%)   -8.9% ( -11% -   -6%)\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eStrangely it\'s not really faster ... maybe I have a bug.\u003cbr\\/\u003e\\nUnfortunately, until we get the top K working, we can\'t do the\u003cbr\\/\u003e\\nend-to-end comparison to make sure we\'re getting the right facet\u003cbr\\/\u003e\\nvalues ...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13585899_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585899_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:53:08+0000\'\u003e25\\/Feb\\/13 14:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Fixed small bug (wasn\'t counting ord 0); here\'s the same test as \\nbefore, just running on Term &amp; Or queries: \\n\\n  \\n                     Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                 MedTerm       52.70      (3.1%)       40.87      (2.0%)  -22.5% ( -26% -  -17%)\\n               OrHighMed       25.54      (3.6%)       20.18      (2.4%)  -21.0% ( -26% -  -15%)\\n                HighTerm        9.22      (4.1%)        7.33      (2.4%)  -20.4% ( -25% -  -14%)\\n              OrHighHigh       12.92      (3.6%)       10.41      (2.8%)  -19.4% ( -24% -  -13%)\\n               OrHighLow       13.12      (3.8%)       10.61      (2.8%)  -19.2% ( -24% -  -13%)\\n                 LowTerm      145.94      (1.9%)      125.51      (1.6%)  -14.0% ( -17% -  -10%)\\n \\n  \\n\\n Then I applied Rob\'s patch (base = trunk, comp = Rob\'s + my patch): \\n\\n  \\n                     Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                 MedTerm       52.97      (2.2%)       42.34      (1.6%)  -20.1% ( -23% -  -16%)\\n               OrHighMed       25.66      (2.2%)       20.73      (1.7%)  -19.2% ( -22% -  -15%)\\n              OrHighHigh       12.99      (2.4%)       10.69      (1.8%)  -17.7% ( -21% -  -13%)\\n               OrHighLow       13.19      (2.3%)       10.94      (2.0%)  -17.0% ( -20% -  -12%)\\n                HighTerm        9.30      (2.6%)        7.76      (1.8%)  -16.6% ( -20% -  -12%)\\n                 LowTerm      146.48      (1.3%)      129.04      (0.9%)  -11.9% ( -13% -   -9%)\\n \\n  \\n\\n So a wee bit faster but not much... (good!  The awesome predictive \\ncompression from MonotonicALB doesn\'t hurt much). \\n\\n Then I made a new collector that resolves ords after each segment from \\nAdrien\'s idea (SortedSetDocValuesCollectorMergeBySeg) &#8211; base = same \\nas above, comp = new collector w\\/o Rob\'s patch: \\n\\n  \\n                     Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                HighTerm        9.29      (3.1%)        7.14      (1.9%)  -23.2% ( -27% -  -18%)\\n               OrHighMed       25.51      (2.7%)       19.60      (2.2%)  -23.2% ( -27% -  -18%)\\n               OrHighLow       13.08      (2.8%)       10.20      (2.3%)  -22.0% ( -26% -  -17%)\\n              OrHighHigh       12.89      (2.9%)       10.21      (2.6%)  -20.8% ( -25% -  -15%)\\n                 MedTerm       53.00      (2.7%)       43.34      (1.5%)  -18.2% ( -21% -  -14%)\\n                 LowTerm      145.97      (1.6%)      133.05      (0.9%)   -8.9% ( -11% -   -6%)\\n \\n  \\n\\n Strangely it\'s not really faster ... maybe I have a bug. \\nUnfortunately, until we get the top K working, we can\'t do the \\nend-to-end comparison to make sure we\'re getting the right facet \\nvalues ...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13585901\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13585901&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13585901\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13585901_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585901_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:55:33+0000\'\u003e25\\/Feb\\/13 14:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for benchmarking: I think we should keep the monotonic compression! \u003cbr\\/\u003e\\nIt will use significantly less RAM for this thing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13585901_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585901_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 14:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T14:55:33+0000\'\u003e25\\/Feb\\/13 14:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for benchmarking: I think we should keep the monotonic compression!  \\nIt will use significantly less RAM for this thing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13585903\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13585903&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13585903\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13585903_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585903_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 15:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T15:00:56+0000\'\u003e25\\/Feb\\/13 15:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eIf you want to integrate that with the current classes, all you need to do is to implement a partial TaxonomyReader, which resolves ordinals to CPs using the global ord map? Or actually make that TR the entity that\'s responsible to manage to global ordinal map, so that TR.doOpenIfChanged opens the new segments and updates the global map?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat sounds great!\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eSince this taxonomy, at least currently, doesn\'t support hierarchical facets, you\'ll need to hack something as a ParallelTaxoArray, but that should be easy .. I think.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eOK.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think it could be hierarchical w\\/o so much work, ie on reopen as it\u003cbr\\/\u003e\\nwalks the terms it should be able to easily build up the parent\\/child\u003cbr\\/\u003e\\narrays since the terms are in sorted order.  Hmm, except, with SSDV\u003cbr\\/\u003e\\nyou cannot have a term\\/ord that had no docs indexed.  So the\u003cbr\\/\u003e\\n\\\"ancestor\\\" ords would not exist... hmm.  Better start\u003cbr\\/\u003e\\nnon-hierarchical.\u003c\\/p\u003e\\n\\n\u003cp\u003eI guess if we are non-hierarchical then we don\'t really need to\u003cbr\\/\u003e\\nintegrate at indexing time?  Ie, app can just add the facet values\u003cbr\\/\u003e\\nusing SortedSetDVF.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIs the only benefit in this approach that you don\'t need to manage a sidecar taxonomy index?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think so?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13585903_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13585903_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Feb\\/13 15:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-02-25T15:00:56+0000\'\u003e25\\/Feb\\/13 15:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     If you want to integrate that with the current classes, all you need to do is to implement a partial TaxonomyReader, which resolves ordinals to CPs using the global ord map? Or actually make that TR the entity that\'s responsible to manage to global ordinal map, so that TR.doOpenIfChanged opens the new segments and updates the global map?  \\n\\n That sounds great! \\n\\n  Since this taxonomy, at least currently, doesn\'t support hierarchical facets, you\'ll need to hack something as a ParallelTaxoArray, but that should be easy .. I think.  \\n\\n OK. \\n\\n I think it could be hierarchical w\\/o so much work, ie on reopen as it \\nwalks the terms it should be able to easily build up the parent\\/child \\narrays since the terms are in sorted order.  Hmm, except, with SSDV \\nyou cannot have a term\\/ord that had no docs indexed.  So the \\n\\\"ancestor\\\" ords would not exist... hmm.  Better start \\nnon-hierarchical. \\n\\n I guess if we are non-hierarchical then we don\'t really need to \\nintegrate at indexing time?  Ie, app can just add the facet values \\nusing SortedSetDVF. \\n\\n  Is the only benefit in this approach that you don\'t need to manage a sidecar taxonomy index?  \\n\\n I think so?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13591422\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13591422&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13591422\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13591422_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13591422_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Mar\\/13 14:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-02T14:37:24+0000\'\u003e02\\/Mar\\/13 14:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNew patch ... I think it\'s close but there are still some nocommits.\u003c\\/p\u003e\\n\\n\u003cp\u003e I switched to a FacetsAccumulator (SortedSetDVAccumulator) instead of\u003cbr\\/\u003e\\nXXXCollector because:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eIt\'s more fair since it now does all counting \\\"in the end\\\",\u003cbr\\/\u003e\\n    matching trunk, which was a bit faster than count-as-you-go when\u003cbr\\/\u003e\\n    we last tested.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eIt means you can use this class with DrillSideways ... I fixed\u003cbr\\/\u003e\\n    TestDrillSideways to test it (passes!).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI also got a custom topK impl working.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe facets are the same as trunk, except for tie-break differences.\u003cbr\\/\u003e\\nThe new collector is better in this regard: it breaks ties in an\u003cbr\\/\u003e\\nunderstandable-to-the-end-user way (by ord = Unicode sort order),\u003cbr\\/\u003e\\nunlike the taxo index which is \\\"order in which label was indexed into\u003cbr\\/\u003e\\ntaxo index\\\" (confusing to end user).\u003c\\/p\u003e\\n\\n\u003cp\u003eI first went down the road of making a TaxoReader that wraps a\u003cbr\\/\u003e\\nSlowCompositeReaderWrapper ... but this became problematic because a\u003cbr\\/\u003e\\nDV instance is not thread-safe, yet TaxoReader\'s APIs are supposed to\u003cbr\\/\u003e\\nbe thread-safe.  I also really didn\'t like making 3 int\u003cspan class=\\\"error\\\"\u003e&#91;maxOrd&#93;\u003c\\/span\u003e to\u003cbr\\/\u003e\\nhandle \\\"hierarchy\\\" when SorteSetDV facets only support 2 level\u003cbr\\/\u003e\\nhierarchy (dim + child).\u003c\\/p\u003e\\n\\n\u003cp\u003eSo I backed off of that and made a separate State object, which you\u003cbr\\/\u003e\\nmust re-init after ever top-reader-reopen, and it does the heavyish\u003cbr\\/\u003e\\nstuff.\u003c\\/p\u003e\\n\\n\u003cp\u003eCurrent results (base = trunk w\\/ allbutdim, comp = patch, full wikibig\u003cbr\\/\u003e\\nindex with 5 flat dims):\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e                    Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                HighTerm        9.36      (1.9%)        7.02      (3.6%)  -25.0% ( -29% -  -19%)\\n                 MedTerm       53.21      (1.5%)       40.65      (2.8%)  -23.6% ( -27% -  -19%)\\n               OrHighLow       13.25      (2.1%)       10.55      (3.4%)  -20.4% ( -25% -  -15%)\\n               OrHighMed       25.77      (1.9%)       20.90      (3.1%)  -18.9% ( -23% -  -14%)\\n              OrHighHigh       13.03      (2.2%)       10.63      (3.2%)  -18.4% ( -23% -  -13%)\\n                 LowTerm      146.28      (1.7%)      120.22      (1.7%)  -17.8% ( -20% -  -14%)\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13591422_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13591422_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Mar\\/13 14:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-02T14:37:24+0000\'\u003e02\\/Mar\\/13 14:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    New patch ... I think it\'s close but there are still some nocommits. \\n\\n  I switched to a FacetsAccumulator (SortedSetDVAccumulator) instead of \\nXXXCollector because: \\n\\n \\n\\t It\'s more fair since it now does all counting \\\"in the end\\\", \\n    matching trunk, which was a bit faster than count-as-you-go when \\n    we last tested. \\n \\n\\n\\n \\n\\t It means you can use this class with DrillSideways ... I fixed \\n    TestDrillSideways to test it (passes!). \\n \\n\\n\\n I also got a custom topK impl working. \\n\\n The facets are the same as trunk, except for tie-break differences. \\nThe new collector is better in this regard: it breaks ties in an \\nunderstandable-to-the-end-user way (by ord = Unicode sort order), \\nunlike the taxo index which is \\\"order in which label was indexed into \\ntaxo index\\\" (confusing to end user). \\n\\n I first went down the road of making a TaxoReader that wraps a \\nSlowCompositeReaderWrapper ... but this became problematic because a \\nDV instance is not thread-safe, yet TaxoReader\'s APIs are supposed to \\nbe thread-safe.  I also really didn\'t like making 3 int &#91;maxOrd&#93;  to \\nhandle \\\"hierarchy\\\" when SorteSetDV facets only support 2 level \\nhierarchy (dim + child). \\n\\n So I backed off of that and made a separate State object, which you \\nmust re-init after ever top-reader-reopen, and it does the heavyish \\nstuff. \\n\\n Current results (base = trunk w\\/ allbutdim, comp = patch, full wikibig \\nindex with 5 flat dims): \\n\\n  \\n                     Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                HighTerm        9.36      (1.9%)        7.02      (3.6%)  -25.0% ( -29% -  -19%)\\n                 MedTerm       53.21      (1.5%)       40.65      (2.8%)  -23.6% ( -27% -  -19%)\\n               OrHighLow       13.25      (2.1%)       10.55      (3.4%)  -20.4% ( -25% -  -15%)\\n               OrHighMed       25.77      (1.9%)       20.90      (3.1%)  -18.9% ( -23% -  -14%)\\n              OrHighHigh       13.03      (2.2%)       10.63      (3.2%)  -18.4% ( -23% -  -13%)\\n                 LowTerm      146.28      (1.7%)      120.22      (1.7%)  -17.8% ( -20% -  -14%)\\n \\n               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599114\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599114&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599114\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13599114_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599114_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/13 18:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-11T18:39:06+0000\'\u003e11\\/Mar\\/13 18:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNew patch, just cleaning everything up ... I think it\'s ready.\u003c\\/p\u003e\\n\\n\u003cp\u003eI know this approach isn\'t perfect (it has its own topK code), but I\u003cbr\\/\u003e\\nthink it\'s a good enough start that we should get it in and make it\u003cbr\\/\u003e\\navailable.  We can iterate over time ...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13599114_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599114_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/13 18:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-11T18:39:06+0000\'\u003e11\\/Mar\\/13 18:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    New patch, just cleaning everything up ... I think it\'s ready. \\n\\n I know this approach isn\'t perfect (it has its own topK code), but I \\nthink it\'s a good enough start that we should get it in and make it \\navailable.  We can iterate over time ...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599150\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599150&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599150\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13599150_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599150_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/13 19:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-11T19:10:44+0000\'\u003e11\\/Mar\\/13 19:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m not sure i understand the dim\\/value stuff going on inside the single dv field.\u003c\\/p\u003e\\n\\n\u003cp\u003ewouldnt it be more natural to just use multiple lucene fields?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13599150_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599150_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/13 19:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-11T19:10:44+0000\'\u003e11\\/Mar\\/13 19:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m not sure i understand the dim\\/value stuff going on inside the single dv field. \\n\\n wouldnt it be more natural to just use multiple lucene fields?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599334\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599334&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599334\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13599334_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599334_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/13 21:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-11T21:27:38+0000\'\u003e11\\/Mar\\/13 21:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003ewouldnt it be more natural to just use multiple lucene fields?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYeah ... maybe.  I agree this is a weird thing about the facet module,\u003cbr\\/\u003e\\ni.e. that we don\'t have a FacetField, and you add one per \\\"dimension\\\",\u003cbr\\/\u003e\\nlike new FacetField(\\\"category\\\", ...), new FacetField(\\\"price\\\", ...).\u003c\\/p\u003e\\n\\n\u003cp\u003eInstead you have any number of CategoryPaths, like\u003cbr\\/\u003e\\n\\/price\\/1-100\\/20-30\\/25.99 and \\/category\\/Fiction\\/..., and those are all\u003cbr\\/\u003e\\nindexed into a single $facet binary DV field (by default), using a\u003cbr\\/\u003e\\nsingle call to FacetFields.addFields.\u003c\\/p\u003e\\n\\n\u003cp\u003eWe could maybe generalize this new FacetsAccumulator to allow for\u003cbr\\/\u003e\\n\\\"single DV field has single facet dim\\\" approach ... but it\'s a break\u003cbr\\/\u003e\\nfrom how the rest of facets work, and I also suspect there\'s a\u003cbr\\/\u003e\\nnon-trivial performance hit to it (haven\'t yet tested).\u003c\\/p\u003e\\n\\n\u003cp\u003eI think we should explore that later?  The current patch at least\u003cbr\\/\u003e\\nmakes faceting in the \\\"facet module\\\" approach possible...\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13599334_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599334_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/13 21:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-11T21:27:38+0000\'\u003e11\\/Mar\\/13 21:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     wouldnt it be more natural to just use multiple lucene fields?  \\n\\n Yeah ... maybe.  I agree this is a weird thing about the facet module, \\ni.e. that we don\'t have a FacetField, and you add one per \\\"dimension\\\", \\nlike new FacetField(\\\"category\\\", ...), new FacetField(\\\"price\\\", ...). \\n\\n Instead you have any number of CategoryPaths, like \\n\\/price\\/1-100\\/20-30\\/25.99 and \\/category\\/Fiction\\/..., and those are all \\nindexed into a single $facet binary DV field (by default), using a \\nsingle call to FacetFields.addFields. \\n\\n We could maybe generalize this new FacetsAccumulator to allow for \\n\\\"single DV field has single facet dim\\\" approach ... but it\'s a break \\nfrom how the rest of facets work, and I also suspect there\'s a \\nnon-trivial performance hit to it (haven\'t yet tested). \\n\\n I think we should explore that later?  The current patch at least \\nmakes faceting in the \\\"facet module\\\" approach possible... \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599623\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599623&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599623\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13599623_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599623_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 02:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T02:33:29+0000\'\u003e12\\/Mar\\/13 02:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI agree: and actually rethinking it, I think its healthier to keep as much of the facet modules existing approach (minus the sidecar for this case).\u003c\\/p\u003e\\n\\n\u003cp\u003eWe can always add other approaches that work on each field like solr\\/elasticsearch. I\'d rather have more choices out there.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13599623_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599623_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 02:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T02:33:29+0000\'\u003e12\\/Mar\\/13 02:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I agree: and actually rethinking it, I think its healthier to keep as much of the facet modules existing approach (minus the sidecar for this case). \\n\\n We can always add other approaches that work on each field like solr\\/elasticsearch. I\'d rather have more choices out there.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599687\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599687&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599687\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13599687_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599687_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 04:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T04:23:28+0000\'\u003e12\\/Mar\\/13 04:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI also suspect there\'s a non-trivial performance hit to it (haven\'t yet tested)\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eMike, we did experiment with that during the overall refactoring\\/optimization work. I was able to dig up the results &#8211; we tried to simulate \\\"column-stride ordinals\\\" by indexing different dimensions into different DV fields, using different taxoWriters. I created a SingleValuedFacetField (over the old DV, using VAR_INTS) and indexed the ordinal of the CP there. So I think kind of simulates SortedSet when there\'s only one value?\u003c\\/p\u003e\\n\\n\u003cp\u003eThe results were not good:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e                   Per Dim    Trunk   Diff (%)\\nAndHighHigh         64.35     89.41    38.94%\\nAndHighLow         358.7    1033.32   188.07%\\nAndHighMed         181.22    318.36    75.68%\\nFuzzy1              78.49    116.99    49.05%\\nFuzzy2              72.79    104.12    43.04%\\nHighPhrase          36.83     43.67    18.57%\\nHighSloppyPhrase     3.12      3.25     4.17%\\nHighSpanNear        10.76     11.74     9.11%\\nHighTerm            40.23     65.07    61.74%\\nIntNRQ             109.46    114.52     4.62%\\nLowPhrase           60.63     72.59    19.73%\\nLowSloppyPhrase     66.01     82.9     25.59%\\nLowSpanNear         38.5      43.81    13.79%\\nLowTerm            187.58     378.86  101.97%\\nMedPhrase          103.57     153.26   47.98%\\nMedSloppyPhrase     70.86     89.78    26.70%\\nMedSpanNear         69.29     89.2     28.73%\\nMedTerm            120.72    237.39    96.65%\\nOrHighHigh          26.41     38.55    45.97%\\nOrHighLow           36.6      55.38    51.31%\\nOrHighMed           37.62     56.81    51.01%\\nPKLookup           250.59    301.5     20.32%\\nPrefix3            170.76    176.48     3.35%\\nRespell            101.4     136.58    34.69%\\nWildcard           225.08    252.69    12.27%\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eTrunk was trunk at the time, and per-dim is the new FacetField. We suspected that that\'s because when you index different dimensions into different DV fields, you need to go over the result docs X times (where X is the number of dimensions you asked to count; we tested 9).\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI think its healthier to keep as much of the facet modules existing approach\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eDo you have an idea how can one use the new field to index weighted facets? I.e. \u003ctt\u003ecategory\\/Computers=0.9\u003c\\/tt\u003e and \u003ctt\u003ecategory\\/Sceience=0.84\u003c\\/tt\u003e? If the only way is to use BinaryDV, is there a way we can use the ordinals from SortedSet to put in a \u003ctt\u003eBDV 1=0.9, 2=0.84\u003c\\/tt\u003e? Hmm, but since those ords are per-segment, we\'d need to rewrite the BDV upon merge right?\u003c\\/p\u003e\\n\\n\u003cp\u003eI ask because it seems that the only thing that we get from this SortedSet approach is not having to maintain a sidecar index (which for some reason freaks everybody), and we even lose performance. Plus, I don\'t see how we can support other facet features with it. So perhaps we should focus on how to use the search index to build a taxonomy? Maybe it\'s all in-memory, that\'s fine. If we manage to support on-disk lookups too, even better. But if we do that, then we should have no problems supporting all current facet features, because all that the taxonomy index gives us is a global-ordinal (plus hierarchy management, but I think we can do that w\\/ SortedSet too). We can of course explore that in a different issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13599687_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599687_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 04:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T04:23:28+0000\'\u003e12\\/Mar\\/13 04:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I also suspect there\'s a non-trivial performance hit to it (haven\'t yet tested)  \\n\\n Mike, we did experiment with that during the overall refactoring\\/optimization work. I was able to dig up the results &#8211; we tried to simulate \\\"column-stride ordinals\\\" by indexing different dimensions into different DV fields, using different taxoWriters. I created a SingleValuedFacetField (over the old DV, using VAR_INTS) and indexed the ordinal of the CP there. So I think kind of simulates SortedSet when there\'s only one value? \\n\\n The results were not good: \\n\\n  \\n                    Per Dim    Trunk   Diff (%)\\nAndHighHigh         64.35     89.41    38.94%\\nAndHighLow         358.7    1033.32   188.07%\\nAndHighMed         181.22    318.36    75.68%\\nFuzzy1              78.49    116.99    49.05%\\nFuzzy2              72.79    104.12    43.04%\\nHighPhrase          36.83     43.67    18.57%\\nHighSloppyPhrase     3.12      3.25     4.17%\\nHighSpanNear        10.76     11.74     9.11%\\nHighTerm            40.23     65.07    61.74%\\nIntNRQ             109.46    114.52     4.62%\\nLowPhrase           60.63     72.59    19.73%\\nLowSloppyPhrase     66.01     82.9     25.59%\\nLowSpanNear         38.5      43.81    13.79%\\nLowTerm            187.58     378.86  101.97%\\nMedPhrase          103.57     153.26   47.98%\\nMedSloppyPhrase     70.86     89.78    26.70%\\nMedSpanNear         69.29     89.2     28.73%\\nMedTerm            120.72    237.39    96.65%\\nOrHighHigh          26.41     38.55    45.97%\\nOrHighLow           36.6      55.38    51.31%\\nOrHighMed           37.62     56.81    51.01%\\nPKLookup           250.59    301.5     20.32%\\nPrefix3            170.76    176.48     3.35%\\nRespell            101.4     136.58    34.69%\\nWildcard           225.08    252.69    12.27%\\n \\n  \\n\\n Trunk was trunk at the time, and per-dim is the new FacetField. We suspected that that\'s because when you index different dimensions into different DV fields, you need to go over the result docs X times (where X is the number of dimensions you asked to count; we tested 9). \\n\\n  I think its healthier to keep as much of the facet modules existing approach  \\n\\n Do you have an idea how can one use the new field to index weighted facets? I.e.  category\\/Computers=0.9  and  category\\/Sceience=0.84 ? If the only way is to use BinaryDV, is there a way we can use the ordinals from SortedSet to put in a  BDV 1=0.9, 2=0.84 ? Hmm, but since those ords are per-segment, we\'d need to rewrite the BDV upon merge right? \\n\\n I ask because it seems that the only thing that we get from this SortedSet approach is not having to maintain a sidecar index (which for some reason freaks everybody), and we even lose performance. Plus, I don\'t see how we can support other facet features with it. So perhaps we should focus on how to use the search index to build a taxonomy? Maybe it\'s all in-memory, that\'s fine. If we manage to support on-disk lookups too, even better. But if we do that, then we should have no problems supporting all current facet features, because all that the taxonomy index gives us is a global-ordinal (plus hierarchy management, but I think we can do that w\\/ SortedSet too). We can of course explore that in a different issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599691\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599691&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599691\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13599691_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599691_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 04:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T04:29:01+0000\'\u003e12\\/Mar\\/13 04:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAbout the patch: Mike, why do you need to initialize a FacetRequest like so: \u003ctt\u003erequests.add(new CountFacetRequest(new CategoryPath(\\\"a\\\", sep), 10));\u003c\\/tt\u003e? Why do you need to do \\\"a\\/\\\" and not just \\\"a\\\"? It\'s not like how requests are initialized today right?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13599691_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599691_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 04:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T04:29:01+0000\'\u003e12\\/Mar\\/13 04:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    About the patch: Mike, why do you need to initialize a FacetRequest like so:  requests.add(new CountFacetRequest(new CategoryPath(\\\"a\\\", sep), 10)); ? Why do you need to do \\\"a\\/\\\" and not just \\\"a\\\"? It\'s not like how requests are initialized today right?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599699\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599699&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599699\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13599699_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599699_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 04:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T04:42:06+0000\'\u003e12\\/Mar\\/13 04:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eI ask because it seems that the only thing that we get from this SortedSet approach is not having to maintain a sidecar index (which for some reason freaks everybody), and we even lose performance. Plus, I don\'t see how we can support other facet features with it. So perhaps we should focus on how to use the search index to build a taxonomy? Maybe it\'s all in-memory, that\'s fine. If we manage to support on-disk lookups too, even better. But if we do that, then we should have no problems supporting all current facet features, because all that the taxonomy index gives us is a global-ordinal (plus hierarchy management, but I think we can do that w\\/ SortedSet too). We can of course explore that in a different issue.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWell the taxonomy index doesn\'t give you global ordinals. it gives you global \\\"termIDs\\\", which are unique integers: but they aren\'t ordinals: their sort order is meaningless. this creates additional trouble if you want to try to integrate the current lucene facet module with e.g. solr that has faceting options that rely upon these properties.\u003c\\/p\u003e\\n\\n\u003cp\u003eIts also unclear to me how the taxonomy index would really integrate in a distributed system like solr or elasticsearch. I know there has been discussion about it before, and I\'m sure there are solutions, but it just seems fairly complicated. \u003c\\/p\u003e\\n\\n\u003cp\u003eon the other hand SortedSet doesn\'t have these problems. maybe it doesnt support weighted facets or other features, but its a nice option. I personally don\'t think its the end of the world if Mike\'s patch doesnt support all the features of the faceting module initially or even ever.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe idea is just to have more choices. I\'m not saying you should get rid of the taxonomy index: just provide options. I don\'t think lucene\'s faceting support needs to be limited to only a single one-size-fits-all solution but instead have a few options with different tradeoffs. Compare with something like the suggest module, it has like 5 or 6 implementations.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13599699_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599699_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 04:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T04:42:06+0000\'\u003e12\\/Mar\\/13 04:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n I ask because it seems that the only thing that we get from this SortedSet approach is not having to maintain a sidecar index (which for some reason freaks everybody), and we even lose performance. Plus, I don\'t see how we can support other facet features with it. So perhaps we should focus on how to use the search index to build a taxonomy? Maybe it\'s all in-memory, that\'s fine. If we manage to support on-disk lookups too, even better. But if we do that, then we should have no problems supporting all current facet features, because all that the taxonomy index gives us is a global-ordinal (plus hierarchy management, but I think we can do that w\\/ SortedSet too). We can of course explore that in a different issue.  \\n\\n Well the taxonomy index doesn\'t give you global ordinals. it gives you global \\\"termIDs\\\", which are unique integers: but they aren\'t ordinals: their sort order is meaningless. this creates additional trouble if you want to try to integrate the current lucene facet module with e.g. solr that has faceting options that rely upon these properties. \\n\\n Its also unclear to me how the taxonomy index would really integrate in a distributed system like solr or elasticsearch. I know there has been discussion about it before, and I\'m sure there are solutions, but it just seems fairly complicated.  \\n\\n on the other hand SortedSet doesn\'t have these problems. maybe it doesnt support weighted facets or other features, but its a nice option. I personally don\'t think its the end of the world if Mike\'s patch doesnt support all the features of the faceting module initially or even ever. \\n\\n The idea is just to have more choices. I\'m not saying you should get rid of the taxonomy index: just provide options. I don\'t think lucene\'s faceting support needs to be limited to only a single one-size-fits-all solution but instead have a few options with different tradeoffs. Compare with something like the suggest module, it has like 5 or 6 implementations.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599779\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599779&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599779\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13599779_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599779_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 06:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T06:53:13+0000\'\u003e12\\/Mar\\/13 06:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eWell the taxonomy index doesn\'t give you global ordinals. it gives you global \\\"termIDs\\\", which are unique integers: but they aren\'t ordinals\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat\'s right. I am not familiar with how Solr utilizes that, but I agree with your statement. The term ordinal was derived from the fact that the taxonomy does preserve order between parent\\/children. I.e. Date &lt; Date\\/2010 &lt;&gt; Date\\/2011. So Date will always have a lower ordinal than its children, but there is not meaningful order between siblings.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIts also unclear to me how the taxonomy index would really integrate in a distributed system like solr or elasticsearch.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWhy? We work with the taxonomy index in two modes in a distributed environment:\u003c\\/p\u003e\\n\\n\u003col\u003e\\n\\t\u003cli\u003eEvery shard maintains its own taxonomy index and facets are merged by their label. That\'s basically what Solr\\/ES\\/SortedSet would do right?\u003c\\/li\u003e\\n\\t\u003cli\u003eIn a specific project we run, where every document goes through a MapReduce analysis (no NRT!), we maintain a truly global taxonomy index, where ordinal=17 means the same category in all shards. The taxonomy index itself is replicated to all shards. There are tradeoffs of course, but you cannot do that with SortedSet right? The advantage is that you can do the merge by the ordinal (integer ID), rather than the label.\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n\\n\\n\u003cblockquote\u003e\u003cp\u003eI personally don\'t think its the end of the world if Mike\'s patch doesnt support all the features of the faceting module initially or even ever.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1, I don\'t criticize that approach negatively. I personally don\'t understand why the sidecar taxonomy index freaks the hell out of people, but I don\'t mind if there are multiple facet implementations. I can share with you that we used to have few implementations too, before we converged to one (and then contributed to Lucene).\u003c\\/p\u003e\\n\\n\u003cp\u003eYou didn\'t answer my question though, and perhaps it doesn\'t belong in this issue, but is there a way to utilize the ordinal given to a DV value somehow? Or is it internal to the SortedSet DV?\u003c\\/p\u003e\\n\\n\u003cp\u003eMike, should you also check in SortedSetDocValuesAccumulator that FR.getDepth() == 1? I don\'t think that you support counting up to depth N, right?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13599779_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599779_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 06:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T06:53:13+0000\'\u003e12\\/Mar\\/13 06:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Well the taxonomy index doesn\'t give you global ordinals. it gives you global \\\"termIDs\\\", which are unique integers: but they aren\'t ordinals  \\n\\n That\'s right. I am not familiar with how Solr utilizes that, but I agree with your statement. The term ordinal was derived from the fact that the taxonomy does preserve order between parent\\/children. I.e. Date &lt; Date\\/2010 &lt;&gt; Date\\/2011. So Date will always have a lower ordinal than its children, but there is not meaningful order between siblings. \\n\\n  Its also unclear to me how the taxonomy index would really integrate in a distributed system like solr or elasticsearch.  \\n\\n Why? We work with the taxonomy index in two modes in a distributed environment: \\n\\n \\n\\t Every shard maintains its own taxonomy index and facets are merged by their label. That\'s basically what Solr\\/ES\\/SortedSet would do right? \\n\\t In a specific project we run, where every document goes through a MapReduce analysis (no NRT!), we maintain a truly global taxonomy index, where ordinal=17 means the same category in all shards. The taxonomy index itself is replicated to all shards. There are tradeoffs of course, but you cannot do that with SortedSet right? The advantage is that you can do the merge by the ordinal (integer ID), rather than the label. \\n \\n\\n\\n  I personally don\'t think its the end of the world if Mike\'s patch doesnt support all the features of the faceting module initially or even ever.  \\n\\n +1, I don\'t criticize that approach negatively. I personally don\'t understand why the sidecar taxonomy index freaks the hell out of people, but I don\'t mind if there are multiple facet implementations. I can share with you that we used to have few implementations too, before we converged to one (and then contributed to Lucene). \\n\\n You didn\'t answer my question though, and perhaps it doesn\'t belong in this issue, but is there a way to utilize the ordinal given to a DV value somehow? Or is it internal to the SortedSet DV? \\n\\n Mike, should you also check in SortedSetDocValuesAccumulator that FR.getDepth() == 1? I don\'t think that you support counting up to depth N, right?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599945\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599945&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599945\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13599945_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599945_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 11:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T11:48:32+0000\'\u003e12\\/Mar\\/13 11:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eMike, why do you need to initialize a FacetRequest like so: requests.add(new CountFacetRequest(new CategoryPath(\\\"a\\\", sep), 10));?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWoops, that\'s just silly: I\'ll remove the sep there.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eMike, should you also check in SortedSetDocValuesAccumulator that FR.getDepth() == 1? I don\'t think that you support counting up to depth N, right?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eRight, it only supports flat (dim \\/ label) today ... ok, I\'ll add that\u003cbr\\/\u003e\\ncheck.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13599945_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599945_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 11:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T11:48:32+0000\'\u003e12\\/Mar\\/13 11:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Mike, why do you need to initialize a FacetRequest like so: requests.add(new CountFacetRequest(new CategoryPath(\\\"a\\\", sep), 10));?  \\n\\n Woops, that\'s just silly: I\'ll remove the sep there. \\n\\n  Mike, should you also check in SortedSetDocValuesAccumulator that FR.getDepth() == 1? I don\'t think that you support counting up to depth N, right?  \\n\\n Right, it only supports flat (dim \\/ label) today ... ok, I\'ll add that \\ncheck.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13599990\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13599990&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13599990\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13599990_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599990_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 12:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T12:42:52+0000\'\u003e12\\/Mar\\/13 12:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks. Also (sorry that it comes in parts), I find this confusing: \u003ctt\u003enew SortedSetDocValuesField(\\\"myfacets\\\", new BytesRef(\\\"a\\\" + sep + \\\"foo\\\"))\u003c\\/tt\u003e. The user needs to decide under which field all facets will be indexed. This could lead users to do \u003ctt\u003enew SSDVF(\\\"author\\\", new BytesRef(\\\"shai\\\"))\u003c\\/tt\u003e and \u003ctt\u003enew SSDVF(\\\"date\\\", new BytesRef(\\\"2010\\/March\\/13\\\"))\u003c\\/tt\u003e. We know, from past results, that this will result in worse search performance. Also, this doesn\'t take a CP which is not consistent e.g. with the FacetRequest, where you need to pass a CP. So rather perhaps we should:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eAdd a FacetField (extends SSDVF) which takes a CP (potentially FacetIndexingParams as well).\u003c\\/li\u003e\\n\\t\u003cli\u003eIt will call super(CLP.DEFAULT_FIELD, new BytesRef(cp.toString())) (we can optimize that later, e.g. have CP expose a BytesRef API too if we want).\u003c\\/li\u003e\\n\\t\u003cli\u003ePotentially, allow (or not) to define the field type.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eWhat do you think?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13599990_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13599990_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 12:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T12:42:52+0000\'\u003e12\\/Mar\\/13 12:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks. Also (sorry that it comes in parts), I find this confusing:  new SortedSetDocValuesField(\\\"myfacets\\\", new BytesRef(\\\"a\\\" + sep + \\\"foo\\\")) . The user needs to decide under which field all facets will be indexed. This could lead users to do  new SSDVF(\\\"author\\\", new BytesRef(\\\"shai\\\"))  and  new SSDVF(\\\"date\\\", new BytesRef(\\\"2010\\/March\\/13\\\")) . We know, from past results, that this will result in worse search performance. Also, this doesn\'t take a CP which is not consistent e.g. with the FacetRequest, where you need to pass a CP. So rather perhaps we should: \\n\\n \\n\\t Add a FacetField (extends SSDVF) which takes a CP (potentially FacetIndexingParams as well). \\n\\t It will call super(CLP.DEFAULT_FIELD, new BytesRef(cp.toString())) (we can optimize that later, e.g. have CP expose a BytesRef API too if we want). \\n\\t Potentially, allow (or not) to define the field type. \\n \\n\\n\\n What do you think?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13600017\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13600017&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13600017\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13600017_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13600017_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 13:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T13:09:51+0000\'\u003e12\\/Mar\\/13 13:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnother thing, in the accumulator you do \u003ctt\u003eq.insertWithOverflow(new FacetResultNode(ord, counts\u003cspan class=\\\"error\\\"\u003e&#91;ord&#93;\u003c\\/span\u003e))\u003c\\/tt\u003e. Any reason why you don\'t get a hold of the returned FRN? Or pre-fill the queue with sentinel objects?\u003c\\/p\u003e\\n\\n\u003cp\u003eIn ReaderState you can call SlowComposite.wrap instead of checking \u003ctt\u003eif (reader instanceof AtomicReader)\u003c\\/tt\u003e which is essentially the same thing, just less lines of code.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13600017_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13600017_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 13:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T13:09:51+0000\'\u003e12\\/Mar\\/13 13:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Another thing, in the accumulator you do  q.insertWithOverflow(new FacetResultNode(ord, counts &#91;ord&#93; )) . Any reason why you don\'t get a hold of the returned FRN? Or pre-fill the queue with sentinel objects? \\n\\n In ReaderState you can call SlowComposite.wrap instead of checking  if (reader instanceof AtomicReader)  which is essentially the same thing, just less lines of code.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13600026\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13600026&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13600026\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13600026_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13600026_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 13:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T13:22:42+0000\'\u003e12\\/Mar\\/13 13:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eYou didn\'t answer my question though, and perhaps it doesn\'t belong in this issue, but is there a way to utilize the ordinal given to a DV value somehow? Or is it internal to the SortedSet DV?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eBecause I don\'t want to encourage crazy software designs to support fringe features. Want weighted faceting? use the tax index: pretty simple. \u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13600026_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13600026_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 13:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T13:22:42+0000\'\u003e12\\/Mar\\/13 13:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n You didn\'t answer my question though, and perhaps it doesn\'t belong in this issue, but is there a way to utilize the ordinal given to a DV value somehow? Or is it internal to the SortedSet DV?  \\n\\n Because I don\'t want to encourage crazy software designs to support fringe features. Want weighted faceting? use the tax index: pretty simple.  \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13600355\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13600355&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13600355\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13600355_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13600355_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 19:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T19:10:36+0000\'\u003e12\\/Mar\\/13 19:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eSo rather perhaps we should:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eAdd a FacetField (extends SSDVF) which takes a CP (potentially FacetIndexingParams as well).\u003c\\/li\u003e\\n\\t\u003cli\u003eIt will call super(CLP.DEFAULT_FIELD, new BytesRef(cp.toString())) (we can optimize that later, e.g. have CP expose a BytesRef API too if we want).\u003c\\/li\u003e\\n\\t\u003cli\u003ePotentially, allow (or not) to define the field type.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI agree it\'s awkward now.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut ... FacetField makes me nervous, just because it\'s too close to\u003cbr\\/\u003e\\nFacetFields and users may think they can mix &amp; match the two\u003cbr\\/\u003e\\napproaches.  It\'s trappy ... maybe SortedSetDocValuesFacetField\u003cbr\\/\u003e\\ninstead?\u003c\\/p\u003e\\n\\n\u003cp\u003eBut you\'d need to provide it with this separator... hmm, or maybe we\u003cbr\\/\u003e\\ncan use the same sep as FIP.\u003c\\/p\u003e\\n\\n\u003cp\u003eSeparately, I wonder whether facet module should escape the delimiter\u003cbr\\/\u003e\\nwhen it appears in a cat path label, in general (and, here)?  This way\u003cbr\\/\u003e\\nthe app does not have to ensure it never appears in any label (which I\u003cbr\\/\u003e\\nthink is tricky for some apps to do, eg a search server like\u003cbr\\/\u003e\\nElasticSearch\\/Solr can\'t do this).\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eAny reason why you don\'t get a hold of the returned FRN? \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI wanted to keep it simple for starters ... but I\'ll fix to reuse the\u003cbr\\/\u003e\\nrejected entry.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13600355_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13600355_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/13 19:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-12T19:10:36+0000\'\u003e12\\/Mar\\/13 19:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n So rather perhaps we should: \\n \\n\\t Add a FacetField (extends SSDVF) which takes a CP (potentially FacetIndexingParams as well). \\n\\t It will call super(CLP.DEFAULT_FIELD, new BytesRef(cp.toString())) (we can optimize that later, e.g. have CP expose a BytesRef API too if we want). \\n\\t Potentially, allow (or not) to define the field type. \\n \\n \\n\\n I agree it\'s awkward now. \\n\\n But ... FacetField makes me nervous, just because it\'s too close to \\nFacetFields and users may think they can mix &amp; match the two \\napproaches.  It\'s trappy ... maybe SortedSetDocValuesFacetField \\ninstead? \\n\\n But you\'d need to provide it with this separator... hmm, or maybe we \\ncan use the same sep as FIP. \\n\\n Separately, I wonder whether facet module should escape the delimiter \\nwhen it appears in a cat path label, in general (and, here)?  This way \\nthe app does not have to ensure it never appears in any label (which I \\nthink is tricky for some apps to do, eg a search server like \\nElasticSearch\\/Solr can\'t do this). \\n\\n  Any reason why you don\'t get a hold of the returned FRN?   \\n\\n I wanted to keep it simple for starters ... but I\'ll fix to reuse the \\nrejected entry.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13600804\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13600804&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13600804\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13600804_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13600804_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 04:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T04:28:59+0000\'\u003e13\\/Mar\\/13 04:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003emaybe SortedSetDocValuesFacetField instead?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere\'s also another thing that bothers me &#8211; nothing prevents the app from creating a SSDVField with hierarchical facets now. So while your tests don\'t do it, I could easily create such a category (Date\\/2010\\/March\\/21), and then what would happen?\u003c\\/p\u003e\\n\\n\u003cp\u003eBy having SSDVFacetField you can control that by yelling at whoever attempts to do that. For that, taking a CP (see comment below) would make the check easier (if cp.length &gt; 2, it\'s an error).\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eBut you\'d need to provide it with this separator... hmm, or maybe we can use the same sep as FIP.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think that you should give it a CP, not BytesRef. There is a difference between the separator you give to CP(str, \'\\/\') to the one that\'s defined in FIP. The one that you give to CP (and you can use the vararg constructor to avoid that) just tells CP how to break the string into the path components. For instance, if we removed that ctor, you\'d need to call the vararg one by splitting the string yourself.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe one in FIP is used to write the drill-down terms. Currently, following your recent change, it\'s set to a character that is really not expected to be part of a category string. Therefore I don\'t worry about it.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs for how the app can set the separator in a server-based environment, there are two options. Define it as part of the index schema &#8211; Solr\\/ES shouldn\'t care about it, they would just use it to split category strings, but app should know what\'s a safe separator for it. Another option that we chose to implement, since we work with JSON input, we just defined the facets as an array of strings and then there\'s no separator worry for the server. App should still be able to construct the array, meaning it should be able to split the category strings based on a \'safe\' separator. I don\'t think we should worry about escaping delimiters. If an app cannot be sure that e.g. \'&gt;\' is a safe separator, it should escape it itself?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13600804_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13600804_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 04:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T04:28:59+0000\'\u003e13\\/Mar\\/13 04:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     maybe SortedSetDocValuesFacetField instead?  \\n\\n +1. \\n\\n There\'s also another thing that bothers me &#8211; nothing prevents the app from creating a SSDVField with hierarchical facets now. So while your tests don\'t do it, I could easily create such a category (Date\\/2010\\/March\\/21), and then what would happen? \\n\\n By having SSDVFacetField you can control that by yelling at whoever attempts to do that. For that, taking a CP (see comment below) would make the check easier (if cp.length &gt; 2, it\'s an error). \\n\\n  But you\'d need to provide it with this separator... hmm, or maybe we can use the same sep as FIP.  \\n\\n I think that you should give it a CP, not BytesRef. There is a difference between the separator you give to CP(str, \'\\/\') to the one that\'s defined in FIP. The one that you give to CP (and you can use the vararg constructor to avoid that) just tells CP how to break the string into the path components. For instance, if we removed that ctor, you\'d need to call the vararg one by splitting the string yourself. \\n\\n The one in FIP is used to write the drill-down terms. Currently, following your recent change, it\'s set to a character that is really not expected to be part of a category string. Therefore I don\'t worry about it. \\n\\n As for how the app can set the separator in a server-based environment, there are two options. Define it as part of the index schema &#8211; Solr\\/ES shouldn\'t care about it, they would just use it to split category strings, but app should know what\'s a safe separator for it. Another option that we chose to implement, since we work with JSON input, we just defined the facets as an array of strings and then there\'s no separator worry for the server. App should still be able to construct the array, meaning it should be able to split the category strings based on a \'safe\' separator. I don\'t think we should worry about escaping delimiters. If an app cannot be sure that e.g. \'&gt;\' is a safe separator, it should escape it itself?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13601035\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13601035&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13601035\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13601035_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601035_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 11:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T11:00:36+0000\'\u003e13\\/Mar\\/13 11:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eBy having SSDVFacetField you can control that by yelling at whoever attempts to do that.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eGood!  I\'ll add that index-time check ...\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eThere is a difference between the separator you give to CP(str, \'\\/\') to the one that\'s defined in FIP. \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI\'m talking about FIP\'s\\/Consts.java separator, that\'s baked into the index.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think hidden separators are trappy, and yes U+001F is rather unlikely to appear, I still think it\'s bad to disallow it in the input.  Maybe an app wants to hide some payload in its facet labels so it joins two things with U+001F...\u003c\\/p\u003e\\n\\n\u003cp\u003eMaking users of server apps (Solr\\/ElasticSearch) specify this in their schema is still trappy...\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso, the cost of doing this escaping \\/ unescaping would be minor.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnyway, this is a separate issue ... I\'ll open a new jira.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13601035_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601035_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 11:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T11:00:36+0000\'\u003e13\\/Mar\\/13 11:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     By having SSDVFacetField you can control that by yelling at whoever attempts to do that.  \\n\\n Good!  I\'ll add that index-time check ... \\n\\n  There is a difference between the separator you give to CP(str, \'\\/\') to the one that\'s defined in FIP.   \\n\\n I\'m talking about FIP\'s\\/Consts.java separator, that\'s baked into the index. \\n\\n I think hidden separators are trappy, and yes U+001F is rather unlikely to appear, I still think it\'s bad to disallow it in the input.  Maybe an app wants to hide some payload in its facet labels so it joins two things with U+001F... \\n\\n Making users of server apps (Solr\\/ElasticSearch) specify this in their schema is still trappy... \\n\\n Also, the cost of doing this escaping \\/ unescaping would be minor. \\n\\n Anyway, this is a separate issue ... I\'ll open a new jira.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13601061\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13601061&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13601061\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13601061_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601061_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 12:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T12:04:12+0000\'\u003e13\\/Mar\\/13 12:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFrom more than a dozen faceted search applications I\'ve worked with, none had any issue with the separator. Therefore I think it\'s over defensive programming for Lucene to do it. If an app wants to be defensive, it can escape on its own.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13601061_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601061_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 12:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T12:04:12+0000\'\u003e13\\/Mar\\/13 12:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    From more than a dozen faceted search applications I\'ve worked with, none had any issue with the separator. Therefore I think it\'s over defensive programming for Lucene to do it. If an app wants to be defensive, it can escape on its own.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13601362\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13601362&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13601362\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13601362_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601362_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 17:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T17:06:48+0000\'\u003e13\\/Mar\\/13 17:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eFrom more than a dozen faceted search applications I\'ve worked with, none had any issue with the separator. Therefore I think it\'s over defensive programming for Lucene to do it. If an app wants to be defensive, it can escape on its own.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eOK, fair enough.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt still seems like bad practice to me but I guess we can keep it \\/ worry about it if a user hits it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13601362_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601362_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 17:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T17:06:48+0000\'\u003e13\\/Mar\\/13 17:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     From more than a dozen faceted search applications I\'ve worked with, none had any issue with the separator. Therefore I think it\'s over defensive programming for Lucene to do it. If an app wants to be defensive, it can escape on its own.  \\n\\n OK, fair enough. \\n\\n It still seems like bad practice to me but I guess we can keep it \\/ worry about it if a user hits it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13601430\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13601430&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13601430\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13601430_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601430_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 17:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T17:55:11+0000\'\u003e13\\/Mar\\/13 17:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch.  The sep is now hardwired to FIP\'s default sep, and I added SortedSetDocValuesFacetField for indexing.\u003c\\/p\u003e\\n\\n\u003cp\u003eOne thing I don\'t like is how I compute the DV field as clpParams.field + \\\"sdv\\\" ... I did this so that a single index could easily (w\\/o having to make a custom CLP) index both kinds of facets ... not sure if there\'s a better way.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13601430_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601430_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 17:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T17:55:11+0000\'\u003e13\\/Mar\\/13 17:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch.  The sep is now hardwired to FIP\'s default sep, and I added SortedSetDocValuesFacetField for indexing. \\n\\n One thing I don\'t like is how I compute the DV field as clpParams.field + \\\"sdv\\\" ... I did this so that a single index could easily (w\\/o having to make a custom CLP) index both kinds of facets ... not sure if there\'s a better way.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13601464\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13601464&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13601464\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13601464_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601464_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 18:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T18:30:12+0000\'\u003e13\\/Mar\\/13 18:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI don\'t think we should do it. First it\'s not really supported. Whoever users SSDVF must use the accompanied accumulator which cannot handle requests against the taxonomy, or hierarchical facets. Second, if someone already chose to have a sidecar taxonomy, why would he do both methods?\u003c\\/p\u003e\\n\\n\u003cp\u003eAgain, \\\"by mistake\\\" won\'t work because of what I wrote above. In order to make it work you need to write a special accumulator, and I think that if you already reached that level of expertise, you can work with per-dimension params? \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13601464_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601464_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 18:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T18:30:12+0000\'\u003e13\\/Mar\\/13 18:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I don\'t think we should do it. First it\'s not really supported. Whoever users SSDVF must use the accompanied accumulator which cannot handle requests against the taxonomy, or hierarchical facets. Second, if someone already chose to have a sidecar taxonomy, why would he do both methods? \\n\\n Again, \\\"by mistake\\\" won\'t work because of what I wrote above. In order to make it work you need to write a special accumulator, and I think that if you already reached that level of expertise, you can work with per-dimension params?               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13601481\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13601481&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13601481\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13601481_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601481_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 18:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T18:44:32+0000\'\u003e13\\/Mar\\/13 18:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHmmm, correction. You cannot write an accumulator which handles both type of facets since the ordinal space is different and therefore it cannot reuse the same FacetArrays. While potentially it could allocate two arrays and delegate to the appropriate accumulator, I think this points at the high risk of indexing facets in two ways.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf someone wants to do it though (I still don\'t think it makes sense), he should use PerDimIndexingParams. That\'s what we have them for.\u003c\\/p\u003e\\n\\n\u003cp\u003eMike, I think that SortedSetDVFacetField should go under o.a.l.facet.sortedset together with all relevant classes. That will make it both easier for people to integrate with it, since by looking at the jdocs you\'ll see all relevant classes as well as (I hope) reduce the chance for a mistake.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13601481_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601481_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 18:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T18:44:32+0000\'\u003e13\\/Mar\\/13 18:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hmmm, correction. You cannot write an accumulator which handles both type of facets since the ordinal space is different and therefore it cannot reuse the same FacetArrays. While potentially it could allocate two arrays and delegate to the appropriate accumulator, I think this points at the high risk of indexing facets in two ways. \\n\\n If someone wants to do it though (I still don\'t think it makes sense), he should use PerDimIndexingParams. That\'s what we have them for. \\n\\n Mike, I think that SortedSetDVFacetField should go under o.a.l.facet.sortedset together with all relevant classes. That will make it both easier for people to integrate with it, since by looking at the jdocs you\'ll see all relevant classes as well as (I hope) reduce the chance for a mistake.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13601531\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13601531&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13601531\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13601531_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601531_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 19:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T19:31:38+0000\'\u003e13\\/Mar\\/13 19:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe use case I\'m picturing is an app would choose to use the existing\u003cbr\\/\u003e\\nAPIs for the hierarchical fields and the sorted set field\\/accumulator\u003cbr\\/\u003e\\nfor the flat fields; I think this is a reasonable typical example and\u003cbr\\/\u003e\\nI think it\'s important to make that easy.  At search time they make\u003cbr\\/\u003e\\ntwo FacetCollectors ...\u003c\\/p\u003e\\n\\n\u003cp\u003eThe new method uses much less RAM for flat fields (doesn\'t allocate 3\u003cbr\\/\u003e\\nX int\u003cspan class=\\\"error\\\"\u003e&#91;maxOrd&#93;\u003c\\/span\u003e), which I think for some apps is a good tradeoff.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso, I don\'t like the risk that the app will try to add both \\\"styles\\\" of\u003cbr\\/\u003e\\nfacet field to a Document and expect it to work ... they will get a\u003cbr\\/\u003e\\ncryptic exception about DocValues type changing for a single field.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eMike, I think that SortedSetDVFacetField should go under o.a.l.facet.sortedset together with all relevant classes.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eGood idea; I\'ll do that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13601531_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13601531_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Mar\\/13 19:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-13T19:31:38+0000\'\u003e13\\/Mar\\/13 19:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The use case I\'m picturing is an app would choose to use the existing \\nAPIs for the hierarchical fields and the sorted set field\\/accumulator \\nfor the flat fields; I think this is a reasonable typical example and \\nI think it\'s important to make that easy.  At search time they make \\ntwo FacetCollectors ... \\n\\n The new method uses much less RAM for flat fields (doesn\'t allocate 3 \\nX int &#91;maxOrd&#93; ), which I think for some apps is a good tradeoff. \\n\\n Also, I don\'t like the risk that the app will try to add both \\\"styles\\\" of \\nfacet field to a Document and expect it to work ... they will get a \\ncryptic exception about DocValues type changing for a single field. \\n\\n  Mike, I think that SortedSetDVFacetField should go under o.a.l.facet.sortedset together with all relevant classes.  \\n\\n Good idea; I\'ll do that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13602063\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13602063&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13602063\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13602063_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13602063_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/13 05:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-14T05:53:25+0000\'\u003e14\\/Mar\\/13 05:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eAt search time they make two FacetCollectors\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThey should be making two FacetAccumulators and a delegating one. It\'s more efficient than having two collectors which track matching documents per-segment.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eThe new method uses much less RAM for flat fields\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI scanned the issue but did not find the right numbers. Do you have them? How much more RAM does the taxo consume (with its 3 int[]) on the non-hierarchical dimensions only, vs the sorted set approach?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eAlso, I don\'t like the risk that the app will try to add both \\\"styles\\\" of\u003cbr\\/\u003e\\nfacet field to a Document and expect it to work ... they will get a\u003cbr\\/\u003e\\ncryptic exception about DocValues type changing for a single field.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think that\'s fine? It\'s an exception that the app will hit quite fast (hopefully during testing). And if you put the sorted set stuff in its own package, then we should document that this does not work with FacetFields, unless the categories are put in different CLPs (using PerDimIndexingParams).\u003c\\/p\u003e\\n\\n\u003cp\u003eIMO, that that you add \\\"sdv\\\" to sorted set field is premature optimization. No one has used the new method yet, let alone tried to use both of them. Why not do it when it will really hit someone?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13602063_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13602063_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/13 05:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-14T05:53:25+0000\'\u003e14\\/Mar\\/13 05:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     At search time they make two FacetCollectors  \\n\\n They should be making two FacetAccumulators and a delegating one. It\'s more efficient than having two collectors which track matching documents per-segment. \\n\\n  The new method uses much less RAM for flat fields  \\n\\n I scanned the issue but did not find the right numbers. Do you have them? How much more RAM does the taxo consume (with its 3 int[]) on the non-hierarchical dimensions only, vs the sorted set approach? \\n\\n \\n Also, I don\'t like the risk that the app will try to add both \\\"styles\\\" of \\nfacet field to a Document and expect it to work ... they will get a \\ncryptic exception about DocValues type changing for a single field.  \\n\\n I think that\'s fine? It\'s an exception that the app will hit quite fast (hopefully during testing). And if you put the sorted set stuff in its own package, then we should document that this does not work with FacetFields, unless the categories are put in different CLPs (using PerDimIndexingParams). \\n\\n IMO, that that you add \\\"sdv\\\" to sorted set field is premature optimization. No one has used the new method yet, let alone tried to use both of them. Why not do it when it will really hit someone?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13602093\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13602093&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13602093\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13602093_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13602093_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/13 06:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-14T06:40:36+0000\'\u003e14\\/Mar\\/13 06:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFew more comments about the patch:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eSortedSetDVFacetField:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eShould it extend SSDVField? It means you will need to construct the BytesRef before you make all the validity checks, but that\'s ok?\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003eYou could also make all those validity checks in a static toBytesRef(CP) method?\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eYou should use FIP.getFacetDelimChar instead of the DEFAULT constant, as an app can override that\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003eAlso in SortedSetDVReaderState, tests (where it makes sense).\u003c\\/li\u003e\\n\\t\\t\\t\u003cli\u003eMaybe add a test which overrides FIP.getFacetDelimChar and make sure SSDFF uses it instead of the constant?\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eInstead of doing cp\u003cspan class=\\\"error\\\"\u003e&#91;0&#93;\u003c\\/span\u003e + delim + cp\u003cspan class=\\\"error\\\"\u003e&#91;1&#93;\u003c\\/span\u003e you can call cp.toString(fip.getFacetDelimChar())?\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003eIn that regard, if we added BytesRef.append(CharSequence) we could impl CP.toBytesRef(char delim) and save the redundant StringBuilder and String allocations.\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eIn TestDemoFacets you do \u003ctt\u003edoc.add(new SortedSetDocValuesFacetField(new CategoryPath(\\\"b\\\", \\\"baz\\\" + FacetIndexingParams.DEFAULT_FACET_DELIM_CHAR + \\\"foo\\\")))\u003c\\/tt\u003e. What\'s the purpose?\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eIf facetDelimChar is \'\\/\', this will create a drill-down term b\\/baz\\/foo right? What does this mean in terms of the test? Is this counted as baz\\/foo or baz? (perhaps add a comment in the test what exactly does it test?)\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eIn SSDVAccumulator:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eShould the javadocs say \\\"that uses previously indexed {@link SortedSetDocValuesFacetField}\\\"? Will it really work with any SSDV indexed?\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eIn the Aggregator, can u add a meaningful message to UnsupportedOpEx?\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eRegarding the top-K, you do not optimize for now the case where someone asks for \\\"all facets\\\" (i.e. numResults=Integer.MAX_VALUE, or &gt; numOrds). Would you like to handle it in this patch? Look at \u003ctt\u003eDepthOneFacetResultsHandler\u003c\\/tt\u003e, which adds all values to a list and sorts it, rather than working w\\/ the PQ.\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003eIf you don\'t want to handle it now (i.e. if you don\'t think that improves things) then at least construct the PQ with min(numResults, taxo.size).\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eIs this code really preferred over just setting bottomCount to top().value in every iteration? I think that in the common case we should expect more than K facets per dim, and if there are less, then I don\'t think it matters if we do that assignment, vs. always calling q.size().\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e+          \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (q.size() == request.numResults) {\\n+            bottomCount = (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e) q.top().value;\\n+            \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/\u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.out.println(\u003cspan class=\\\"code-quote\\\"\u003e\\\"    \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e bottom=\\\"\u003c\\/span\u003e + bottomCount);\\n\u003c\\/span\u003e+          }\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13602093_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13602093_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/13 06:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-14T06:40:36+0000\'\u003e14\\/Mar\\/13 06:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Few more comments about the patch: \\n\\n \\n\\t SortedSetDVFacetField:\\n\\t \\n\\t\\t Should it extend SSDVField? It means you will need to construct the BytesRef before you make all the validity checks, but that\'s ok?\\n\\t\\t \\n\\t\\t\\t You could also make all those validity checks in a static toBytesRef(CP) method? \\n\\t\\t \\n\\t\\t \\n\\t\\t You should use FIP.getFacetDelimChar instead of the DEFAULT constant, as an app can override that\\n\\t\\t \\n\\t\\t\\t Also in SortedSetDVReaderState, tests (where it makes sense). \\n\\t\\t\\t Maybe add a test which overrides FIP.getFacetDelimChar and make sure SSDFF uses it instead of the constant? \\n\\t\\t \\n\\t\\t \\n\\t\\t Instead of doing cp &#91;0&#93;  + delim + cp &#91;1&#93;  you can call cp.toString(fip.getFacetDelimChar())?\\n\\t\\t \\n\\t\\t\\t In that regard, if we added BytesRef.append(CharSequence) we could impl CP.toBytesRef(char delim) and save the redundant StringBuilder and String allocations. \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n \\n\\t In TestDemoFacets you do  doc.add(new SortedSetDocValuesFacetField(new CategoryPath(\\\"b\\\", \\\"baz\\\" + FacetIndexingParams.DEFAULT_FACET_DELIM_CHAR + \\\"foo\\\"))) . What\'s the purpose?\\n\\t \\n\\t\\t If facetDelimChar is \'\\/\', this will create a drill-down term b\\/baz\\/foo right? What does this mean in terms of the test? Is this counted as baz\\/foo or baz? (perhaps add a comment in the test what exactly does it test?) \\n\\t \\n\\t \\n \\n\\n\\n \\n\\t In SSDVAccumulator:\\n\\t \\n\\t\\t Should the javadocs say \\\"that uses previously indexed {@link SortedSetDocValuesFacetField}\\\"? Will it really work with any SSDV indexed? \\n\\t\\t In the Aggregator, can u add a meaningful message to UnsupportedOpEx? \\n\\t\\t Regarding the top-K, you do not optimize for now the case where someone asks for \\\"all facets\\\" (i.e. numResults=Integer.MAX_VALUE, or &gt; numOrds). Would you like to handle it in this patch? Look at  DepthOneFacetResultsHandler , which adds all values to a list and sorts it, rather than working w\\/ the PQ.\\n\\t\\t \\n\\t\\t\\t If you don\'t want to handle it now (i.e. if you don\'t think that improves things) then at least construct the PQ with min(numResults, taxo.size). \\n\\t\\t \\n\\t\\t \\n\\t\\t Is this code really preferred over just setting bottomCount to top().value in every iteration? I think that in the common case we should expect more than K facets per dim, and if there are less, then I don\'t think it matters if we do that assignment, vs. always calling q.size().\\n  \\n +           if  (q.size() == request.numResults) {\\n+            bottomCount = ( int ) q.top().value;\\n+             \\/\\/ System .out.println( \\\"     new  bottom=\\\"  + bottomCount);\\n +          }\\n \\n   \\n\\t \\n\\t \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13602861\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13602861&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13602861\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13602861_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13602861_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/13 22:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-14T22:50:23+0000\'\u003e14\\/Mar\\/13 22:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK I folded in all that feedback Shai, thanks!\u003c\\/p\u003e\\n\\n\u003cp\u003eI also improved TestDrillSideways to not always ask for all results\u003cbr\\/\u003e\\n(so we test the topN).\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIn that regard, if we added BytesRef.append(CharSequence) we could impl CP.toBytesRef(char delim) and save the redundant StringBuilder and String allocations.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eHmm, true.  Later...\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIn TestDemoFacets you do doc.add(new SortedSetDocValuesFacetField(new CategoryPath(\\\"b\\\", \\\"baz\\\" + FacetIndexingParams.DEFAULT_FACET_DELIM_CHAR + \\\"foo\\\"))). What\'s the purpose?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI want to assert that the \u003cb\u003elabel\u003c\\/b\u003e is allowed to use the delimiter;\u003cbr\\/\u003e\\nonly the dimension is not allowed to.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eInstead of doing cp\u003cspan class=\\\"error\\\"\u003e&#91;0&#93;\u003c\\/span\u003e + delim + cp\u003cspan class=\\\"error\\\"\u003e&#91;1&#93;\u003c\\/span\u003e you can call cp.toString(fip.getFacetDelimChar())&gt;\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI can\'t ... because CP.toString gets angry about the delim in the\u003cbr\\/\u003e\\nlabel when in fact this is fine.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIn the Aggregator, can u add a meaningful message to UnsupportedOpEx?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI changed this to a no-op and left a comment.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIs this code really preferred over just setting bottomCount to top().value in every iteration?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think that\'s wrong, i.e you can only apply the bottomCount check once\u003cbr\\/\u003e\\nthe queue is full?  (Unless I pre-fill with sentinels ... which feels\u003cbr\\/\u003e\\nlike too much optimizing).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13602861_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13602861_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/13 22:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-14T22:50:23+0000\'\u003e14\\/Mar\\/13 22:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK I folded in all that feedback Shai, thanks! \\n\\n I also improved TestDrillSideways to not always ask for all results \\n(so we test the topN). \\n\\n  In that regard, if we added BytesRef.append(CharSequence) we could impl CP.toBytesRef(char delim) and save the redundant StringBuilder and String allocations.  \\n\\n Hmm, true.  Later... \\n\\n  In TestDemoFacets you do doc.add(new SortedSetDocValuesFacetField(new CategoryPath(\\\"b\\\", \\\"baz\\\" + FacetIndexingParams.DEFAULT_FACET_DELIM_CHAR + \\\"foo\\\"))). What\'s the purpose?  \\n\\n I want to assert that the  label  is allowed to use the delimiter; \\nonly the dimension is not allowed to. \\n\\n  Instead of doing cp &#91;0&#93;  + delim + cp &#91;1&#93;  you can call cp.toString(fip.getFacetDelimChar())&gt;  \\n\\n I can\'t ... because CP.toString gets angry about the delim in the \\nlabel when in fact this is fine. \\n\\n  In the Aggregator, can u add a meaningful message to UnsupportedOpEx?  \\n\\n I changed this to a no-op and left a comment. \\n\\n  Is this code really preferred over just setting bottomCount to top().value in every iteration?  \\n\\n I think that\'s wrong, i.e you can only apply the bottomCount check once \\nthe queue is full?  (Unless I pre-fill with sentinels ... which feels \\nlike too much optimizing).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13603084\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13603084&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13603084\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13603084_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13603084_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/13 03:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-15T03:46:41+0000\'\u003e15\\/Mar\\/13 03:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI can\'t ... because CP.toString gets angry about the delim in the label when in fact this is fine.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIt\'s fine only in this case, since you don\'t support hierarchy right? Then perhaps just drop a comment in the ctor?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eI think that\'s wrong, i.e you can only apply the bottomCount check once\u003cbr\\/\u003e\\nthe queue is full? (Unless I pre-fill with sentinels ... which feels\u003cbr\\/\u003e\\nlike too much optimizing).\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eArgh, you\'re right. I don\'t think it\'s too much optimizing but I\'m not going to argue about it. Your call.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m +1 to commit!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13603084_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13603084_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/13 03:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-15T03:46:41+0000\'\u003e15\\/Mar\\/13 03:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I can\'t ... because CP.toString gets angry about the delim in the label when in fact this is fine.  \\n\\n It\'s fine only in this case, since you don\'t support hierarchy right? Then perhaps just drop a comment in the ctor? \\n\\n \\n I think that\'s wrong, i.e you can only apply the bottomCount check once \\nthe queue is full? (Unless I pre-fill with sentinels ... which feels \\nlike too much optimizing).  \\n\\n Argh, you\'re right. I don\'t think it\'s too much optimizing but I\'m not going to argue about it. Your call. \\n\\n I\'m +1 to commit!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13603299\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13603299&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13603299\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13603299_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13603299_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/13 11:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-15T11:01:36+0000\'\u003e15\\/Mar\\/13 11:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eThen perhaps just drop a comment in the ctor?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eOK I\'ll put a comment where I append w\\/ the delim explaining why I can\'t use CP.toString ...\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks Shai!  I\'ll commit soon...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13603299_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13603299_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/13 11:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-15T11:01:36+0000\'\u003e15\\/Mar\\/13 11:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Then perhaps just drop a comment in the ctor?  \\n\\n OK I\'ll put a comment where I append w\\/ the delim explaining why I can\'t use CP.toString ... \\n\\n Thanks Shai!  I\'ll commit soon...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13603796\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13603796&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13603796\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"commit-tag-bot\\\" id=\\\"commentauthor_13603796_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=commit-tag-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"commit-tag-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Commit Tag Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13603796_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/13 20:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-15T20:17:30+0000\'\u003e15\\/Mar\\/13 20:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003cspan class=\\\"error\\\"\u003e&#91;trunk commit&#93;\u003c\\/span\u003e Michael McCandless\u003cbr\\/\u003e\\n\u003ca href=\\\"http:\\/\\/svn.apache.org\\/viewvc?view=revision&amp;revision=1457092\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/svn.apache.org\\/viewvc?view=revision&amp;revision=1457092\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-4795\\\" title=\\\"Add FacetsCollector based on SortedSetDocValues\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-4795\\\"\u003e\u003cdel\u003eLUCENE-4795\u003c\\/del\u003e\u003c\\/a\u003e: add new facet method to facet from SortedSetDocValues without using taxonomy index\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"commit-tag-bot\\\" id=\\\"commentauthor_13603796_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=commit-tag-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"commit-tag-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Commit Tag Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13603796_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/13 20:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-15T20:17:30+0000\'\u003e15\\/Mar\\/13 20:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     &#91;trunk commit&#93;  Michael McCandless \\n http:\\/\\/svn.apache.org\\/viewvc?view=revision&amp;revision=1457092  \\n\\n   LUCENE-4795  : add new facet method to facet from SortedSetDocValues without using taxonomy index              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13603808\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13603808&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13603808\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"commit-tag-bot\\\" id=\\\"commentauthor_13603808_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=commit-tag-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"commit-tag-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Commit Tag Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13603808_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/13 20:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-15T20:28:44+0000\'\u003e15\\/Mar\\/13 20:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003cspan class=\\\"error\\\"\u003e&#91;branch_4x commit&#93;\u003c\\/span\u003e Michael McCandless\u003cbr\\/\u003e\\n\u003ca href=\\\"http:\\/\\/svn.apache.org\\/viewvc?view=revision&amp;revision=1457095\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/svn.apache.org\\/viewvc?view=revision&amp;revision=1457095\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-4795\\\" title=\\\"Add FacetsCollector based on SortedSetDocValues\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-4795\\\"\u003e\u003cdel\u003eLUCENE-4795\u003c\\/del\u003e\u003c\\/a\u003e: add new facet method to facet from SortedSetDocValues without using taxonomy index\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"commit-tag-bot\\\" id=\\\"commentauthor_13603808_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=commit-tag-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"commit-tag-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Commit Tag Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13603808_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/13 20:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-15T20:28:44+0000\'\u003e15\\/Mar\\/13 20:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     &#91;branch_4x commit&#93;  Michael McCandless \\n http:\\/\\/svn.apache.org\\/viewvc?view=revision&amp;revision=1457095  \\n\\n   LUCENE-4795  : add new facet method to facet from SortedSetDocValues without using taxonomy index              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13604167\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13604167&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13604167\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13604167_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13604167_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Mar\\/13 08:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-16T08:51:54+0000\'\u003e16\\/Mar\\/13 08:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMike, I think it will be good if we also have an example code under demo\\/facet that demonstrates how to use the new field at indexing and search time? Something very similar to SimpleFacetExample, only without the Date\\/ hierarchical facet. This can be done in a separate issue if you prefer.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13604167_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13604167_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Mar\\/13 08:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-16T08:51:54+0000\'\u003e16\\/Mar\\/13 08:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mike, I think it will be good if we also have an example code under demo\\/facet that demonstrates how to use the new field at indexing and search time? Something very similar to SimpleFacetExample, only without the Date\\/ hierarchical facet. This can be done in a separate issue if you prefer.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13604408\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13604408&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13604408\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13604408_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13604408_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Mar\\/13 20:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-16T20:10:49+0000\'\u003e16\\/Mar\\/13 20:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThat\'s a good idea ... I\'ll open a new issue ... we need to get drill-down working first (\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-4840\\\" title=\\\"SortedSetDocValuesFacetField doesn&#39;t work with DrillDownQuery\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-4840\\\"\u003e\u003cdel\u003eLUCENE-4840\u003c\\/del\u003e\u003c\\/a\u003e).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13604408_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13604408_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Mar\\/13 20:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-16T20:10:49+0000\'\u003e16\\/Mar\\/13 20:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    That\'s a good idea ... I\'ll open a new issue ... we need to get drill-down working first (  LUCENE-4840  ).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13653814\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13653814&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13653814\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thetaphi\\\" id=\\\"commentauthor_13653814_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thetaphi\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thetaphi\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Uwe Schindler\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13653814_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/May\\/13 10:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-05-10T10:33:04+0000\'\u003e10\\/May\\/13 10:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eClosed after release.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thetaphi\\\" id=\\\"commentauthor_13653814_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thetaphi\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thetaphi\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Uwe Schindler\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13653814_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/May\\/13 10:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-05-10T10:33:04+0000\'\u003e10\\/May\\/13 10:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Closed after release.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13863474\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4795?focusedCommentId=13863474&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13863474\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13863474_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13863474_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jan\\/14 21:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-06T21:54:55+0000\'\u003e06\\/Jan\\/14 21:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1556045 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\" class=\\\"user-hover\\\" rel=\\\"mikemccand\\\"\u003eMichael McCandless\u003c\\/a\u003e in branch \'dev\\/branches\\/lucene5376\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1556045\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1556045\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-4795\\\" title=\\\"Add FacetsCollector based on SortedSetDocValues\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-4795\\\"\u003e\u003cdel\u003eLUCENE-4795\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-5376\\\" title=\\\"Add a demo search server\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-5376\\\"\u003e\u003cdel\u003eLUCENE-5376\u003c\\/del\u003e\u003c\\/a\u003e: expose SortedSetDocValuesFacets in lucene server\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13863474_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13863474_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jan\\/14 21:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-06T21:54:55+0000\'\u003e06\\/Jan\\/14 21:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1556045 from  Michael McCandless  in branch \'dev\\/branches\\/lucene5376\' \\n[  https:\\/\\/svn.apache.org\\/r1556045  ] \\n\\n   LUCENE-4795  ,   LUCENE-5376  : expose SortedSetDocValuesFacets in lucene server              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516204561067"> 
    <input type="hidden" title="jira.request.server.time" value="581"> 
    <input type="hidden" title="jira.request.id" value="956x7763257x4"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="5"> 
    <input type="hidden" title="db.reads.time.in.ms" value="45"> 
    <input type="hidden" title="db.conns.time.in.ms" value="55"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 956x7763257x4
	          REQUEST TIMESTAMP : [17/Jan/2018:15:56:01 +0000]
	               REQUEST TIME : 0.5810
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 5

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=24, elapsedTotal=45263811, elapsedMin=707609, elapsedMax=17065712, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=28, elapsedTotal=55215823, elapsedMin=765946, elapsedMax=17165651, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
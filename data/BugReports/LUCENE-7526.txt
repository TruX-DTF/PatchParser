<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|189937d5f6322260897e07e1948f360de03fb83b|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"697f4063d2935b\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-7526"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-7526] Improvements to UnifiedHighlighter OffsetStrategies - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-7526] Improvements to UnifiedHighlighter OffsetStrategies - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loadingâ€¦
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-7526">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-7526" href="/jira/browse/LUCENE-7526" id="key-val" rel="13015941">LUCENE-7526</a></li>
                </ol>
                <h1 id="summary-val">Improvements to UnifiedHighlighter OffsetStrategies</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-7526"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-7526/LUCENE-7526.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-7526/LUCENE-7526.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-7526/LUCENE-7526.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-7526/LUCENE-7526.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Resolved</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.</span>">Resolved</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/minor.svg" title="Minor - Minor loss of function, or other problem where easy workaround is present." width="16"> Minor </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+6.4" title="6.4 Minor release after 6.3">6.4</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22modules%2Fhighlighter%22" title="modules/highlighter issues related to highlighter module">modules/highlighter</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-13015941-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310120" class="item"> 
                     <div class="wrap"> 
                      <strong title="Lucene Fields" class="name">Lucene Fields:</strong> 
                      <div id="customfield_12310120-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310120-field"> 
                        <span>New</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>This ticket improves several of the UnifiedHighlighter FieldOffsetStrategies by reducing reliance on creating or re-creating TokenStreams.</p> 
                  <p>The primary changes are as follows:</p> 
                  <ul> 
                   <li>AnalysisOffsetStrategy - split into two offset strategies 
                    <ul> 
                     <li>MemoryIndexOffsetStrategy - the primary analysis mode that utilizes a MemoryIndex for producing Offsets</li> 
                     <li>TokenStreamOffsetStrategy - an offset strategy that avoids creating a MemoryIndex. Can only be used if the query distills down to terms and automata.</li> 
                    </ul> </li> 
                  </ul> 
                  <ul> 
                   <li>TokenStream removal 
                    <ul> 
                     <li>MemoryIndexOffsetStrategy - previously a TokenStream was created to fill the memory index and then once consumed a new one was generated by uninverting the MemoryIndex back into a TokenStream if there were automata (wildcard/mtq queries) involved. Now this is avoided, which should save memory and avoid a second pass over the data.</li> 
                     <li>TermVectorOffsetStrategy - this was refactored in a similar way to avoid generating a TokenStream if automata are involved.</li> 
                     <li>PostingsWithTermVectorsOffsetStrategy - similar refactoring</li> 
                    </ul> </li> 
                  </ul> 
                  <ul> 
                   <li>CompositePostingsEnum - aggregates several underlying PostingsEnums for wildcard/mtq queries. This should improve relevancy by providing unified metrics for a wildcard across all it's term matches</li> 
                  </ul> 
                  <ul> 
                   <li>Added a HighlightFlag for enabling the newly separated TokenStreamOffsetStrategy since it can adversely affect passage relevancy</li> 
                  </ul> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-7526?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-7526?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-7526?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-7526?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12838921" data-issue-id="13015941" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12838921/LUCENE-7526.patch" draggable="true" data-downloadurl="text/plain:LUCENE-7526.patch:https://issues.apache.org/jira/secure/attachment/12838921/LUCENE-7526.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12838921/LUCENE-7526.patch" title="Latest  15/Nov/16 05:44 - David Smiley" draggable="true" data-downloadurl="text/plain:LUCENE-7526.patch:https://issues.apache.org/jira/secure/attachment/12838921/LUCENE-7526.patch">LUCENE-7526.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2016-11-15T05:44:10.316Z">15/Nov/16 05:44</time>
                   </dd>
                   <dd class="attachment-size">
                    94 kB
                   </dd>
                   <dd class="attachment-author">
                    David Smiley
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="links to">
                   links to
                  </dt> 
                  <dd id="remote-60097" data-remote-link-id="60097" class="
                        remote-link                                            "> 
                   <div class="link-content"> 
                    <p> <img src="/jira/images/icons/generic_link_16.png" width="16" height="16" title="Web Link" alt="Web Link"> <span title="GitHub Pull Request #105"> <a href="https://github.com/apache/lucene-solr/pull/105" class="link-title">GitHub Pull Request #105</a> <span class="link-summary"></span> </span> </p> 
                    <ul class="link-snapshot"> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_dsmiley" rel="dsmiley" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;David Smiley&quot;,&quot;emailAddress&quot;:&quot;dsmiley@apache.org&quot;,&quot;username&quot;:&quot;dsmiley&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="dsmiley"></span></span> David Smiley </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_Timothy055" rel="Timothy055" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Timothy M. Rodriguez&quot;,&quot;emailAddress&quot;:&quot;timothy.rodriguez@gmail.com&quot;,&quot;username&quot;:&quot;Timothy055&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="Timothy055"></span></span> Timothy M. Rodriguez </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">4</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="27/Oct/16 19:28"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-10-27T19:28:03+0000">27/Oct/16 19:28</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="09/Apr/17 18:07"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2017-04-09T18:07:48+0000">09/Apr/17 18:07</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="15/Nov/16 21:21"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-11-15T21:21:46+0000">15/Nov/16 21:21</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-7526?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-7526?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-15612996\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15612996&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15612996\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15612996_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15612996_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Oct\\/16 19:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-27T19:49:29+0000\'\u003e27\\/Oct\\/16 19:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePull request forthcoming - I had some more merging work to do with master than I anticipated!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15612996_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15612996_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Oct\\/16 19:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-27T19:49:29+0000\'\u003e27\\/Oct\\/16 19:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Pull request forthcoming - I had some more merging work to do with master than I anticipated!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15615427\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15615427&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15615427\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15615427_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15615427_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 13:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T13:34:20+0000\'\u003e28\\/Oct\\/16 13:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m looking forward to seeing this.  \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eThe summary heading \\\"TokenStream removal\\\" may be confusing to folks... TokenStreams are certainly going to be involved for the Analysis based offset source.  I think you mean that the changes here relating to MultiTermQuery processing will mean that MTQs aren\'t coerced into a TokenStream over the index any more, except for the refactored-out TokenStreamOffsetStrategy.  So this removes many but not all occurrences of TokenStream within the internal API.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15615427_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15615427_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 13:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T13:34:20+0000\'\u003e28\\/Oct\\/16 13:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m looking forward to seeing this.    \\n\\n The summary heading \\\"TokenStream removal\\\" may be confusing to folks... TokenStreams are certainly going to be involved for the Analysis based offset source.  I think you mean that the changes here relating to MultiTermQuery processing will mean that MTQs aren\'t coerced into a TokenStream over the index any more, except for the refactored-out TokenStreamOffsetStrategy.  So this removes many but not all occurrences of TokenStream within the internal API.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616239\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616239&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616239\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616239_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616239_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 19:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T19:03:18+0000\'\u003e28\\/Oct\\/16 19:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGitHub user Timothy055 opened a pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7526\\\" title=\\\"Improvements to UnifiedHighlighter OffsetStrategies\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7526\\\"\u003e\u003cdel\u003eLUCENE-7526\u003c\\/del\u003e\u003c\\/a\u003e Improvements to UnifiedHighlighter OffsetStrategies\u003c\\/p\u003e\\n\\n\u003cp\u003e    Pull request for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7526\\\" title=\\\"Improvements to UnifiedHighlighter OffsetStrategies\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7526\\\"\u003e\u003cdel\u003eLUCENE-7526\u003c\\/del\u003e\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eYou can merge this pull request into a Git repository by running:\u003c\\/p\u003e\\n\\n\u003cp\u003e    $ git pull \u003ca href=\\\"https:\\/\\/github.com\\/Timothy055\\/lucene-solr\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/Timothy055\\/lucene-solr\u003c\\/a\u003e master\u003c\\/p\u003e\\n\\n\u003cp\u003eAlternatively you can review and apply these changes as the patch at:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105.patch\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105.patch\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eTo close this pull request, make a commit to your master\\/trunk branch\u003cbr\\/\u003e\\nwith (at least) the following in the commit message:\u003c\\/p\u003e\\n\\n\u003cp\u003e    This closes #105\u003c\\/p\u003e\\n\\n\u003chr \\/\u003e\\n\u003cp\u003ecommit 02e932c4a6146363680b88f4947a693c6697c955\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-09-01T19:23:50Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Initial fork of PostingsHighlighter for UnifiedHighlighter\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 9d88411b3985a98851384d78d681431dba710e89\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-09-01T23:17:06Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Initial commit of the UnifiedHighlighter for OSS contribution\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit e45e39bc4b07ea33e4423b264c2fefb9aa08777a\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;david.w.smiley@gmail.com&gt;\u003cbr\\/\u003e\\nDate:   2016-09-02T12:45:49Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Fix misc issues; \\\"ant test\\\" now works. (#1)\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 046a28ef31acf4cea7d255bbbb4b827e6a714e3d\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-09-02T20:58:31Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Minor refactoring of the AnalysisFieldHighlighter\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit ccd1a2280abd4b48cfef8122696e5d9cfd12920f\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-03T12:55:20Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    AbstractFieldHighlighter: order methods more sensibly; renamed a couple.\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit d4714a04a3e41d5e95bbe942b275c32ed69b9c2e\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T01:03:29Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Improve javadocs and @lucene.external\\/internal labeling &amp; scope.\u003cbr\\/\u003e\\n    \\\"ant precommit\\\" now passes.\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit e0659f18a59bf2893076da6d7643ff30f2fa5a52\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T01:25:55Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Analysis: remove dubious filter() method\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit ccd7ce707bff2c06da89b31853cca9aecea72008\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T01:44:01Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    getStrictPhraseHelper -&gt; rm \\\"Strict\\\", getHighlightAccuracy -&gt; getFlags, and only call filterExtractedTerms once.\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit ffc2a22c700b8abcbf87673d5d05bb3659d177c9\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;david.w.smiley@gmail.com&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T15:21:08Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    UnifiedHighlighter round 2 (#2)\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eAbstractFieldHighlighter: order methods more sensibly; renamed a couple.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eImprove javadocs and @lucene.external\\/internal labeling &amp; scope.\u003cbr\\/\u003e\\n    \\\"ant precommit\\\" now passes.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eAnalysis: remove dubious filter() method\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003egetStrictPhraseHelper -&gt; rm \\\"Strict\\\", getHighlightAccuracy -&gt; getFlags, and only call filterExtractedTerms once.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003ecommit 5f95e05595db462d3ab5bffc68c2c92f70875072\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T16:12:33Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Refactor: FieldOffsetStrategy\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 86fb6265fbbdb955ead6d4baf944bf708175715e\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T16:21:32Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    stop passing maxPassages into highlightFieldForDoc()\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit f6fd80544eae9fab953b94b1e9346c0883f956eb\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T16:12:33Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Refactor: FieldOffsetStrategy\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit b335a673c2ce45904890c1e9af7cbfda2bd27b0f\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T16:21:32Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    stop passing maxPassages into highlightFieldForDoc()\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 478db9437b92214cbf459f82ba2e3a67c966a150\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T18:29:44Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Rename subclasses of FieldOffsetStrategy.\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit dbf4280755c11420a5032445cd618fadb7444b61\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T18:31:34Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Re-order and harmonize params on methods called by UH.getFieldHighlighter()\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit f0340e27e61dcda2e11992f08ec07a72fad6c24c\u003cbr\\/\u003e\\nAuthor: David Smiley &lt;dsmiley@apache.org&gt;\u003cbr\\/\u003e\\nDate:   2016-09-04T18:53:51Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    FieldHighlighter: harmonize field\\/param order. And don\'t apply maxNoHighlightPasses twice.\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 817f63c1d48fd523c13b9c40a2ae9b8a4047209a\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-09-06T20:43:20Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Merge of renaming changes\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 0f644a4f53c1ed4d41d562848f6fe51a87442a75\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-09-06T20:54:13Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    add visibility tests\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 9171f49e117085e7d086267bb73836831ff07f8e\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-09-07T14:26:59Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    ADd additional extensibility test\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 7ce488147cb811e15cb6e9125a835171157746f2\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-09-28T22:04:15Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Reduce visibility of MultiTermHighlighting to package protected\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 2f08465020448592b0e8750db568ade5a9218267\u003cbr\\/\u003e\\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt;\u003cbr\\/\u003e\\nDate:   2016-10-11T16:44:29Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Initial commit that will use memory index to generate offsets enum if the tokenstream is null\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 357f3dfb9ace4deef20787af19bc2e5a6b4ff61e\u003cbr\\/\u003e\\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt;\u003cbr\\/\u003e\\nDate:   2016-10-11T17:34:51Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Switched analysis offset strategy to not re-build a tokenstream\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 64153d288db5714cdaf3726328557f65c1635610\u003cbr\\/\u003e\\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt;\u003cbr\\/\u003e\\nDate:   2016-10-11T17:42:12Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Switched to using chars ref builder\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit f137779b1e1b7e57c4b78652614a04507b9e09e1\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-10-21T19:07:48Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    minor cleanup\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit ec814f974db6459eba7aa45bf7a4cdae04e6ad6f\u003cbr\\/\u003e\\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt;\u003cbr\\/\u003e\\nDate:   2016-10-21T21:25:57Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    switch to use of a CompositePostingsEnum that wraps the postings of wildcard matches\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 955a1e79b5189492fae2c95da39343c29e1cdb25\u003cbr\\/\u003e\\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt;\u003cbr\\/\u003e\\nDate:   2016-10-21T21:32:48Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    merge conflicts on PhraseHelper rename\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit d35bd1cffd3c6e2aed67aeccfd03959bf855670a\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-10-21T22:13:51Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    minor cleanup of how automata are handled in the FieldOffsetStrategy\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit aa8c92667272e5f397b9566cde05eae7e31bcce5\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-10-24T20:03:08Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    Removed most use of TokenStreams except in pure Analysis\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit db42d6a959ca19a77dee3cc7b09496a21c631bd6\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-10-24T20:08:25Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    simplified some logic to not use continue statements\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit 657c2a70c4d8ec8ef850e9f66b93cf85ec16f636\u003cbr\\/\u003e\\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt;\u003cbr\\/\u003e\\nDate:   2016-10-24T22:56:17Z\u003c\\/p\u003e\\n\\n\u003cp\u003e    split analysis mode into two, moved all offset sources from readers into the FieldOffsetStrategy\u003c\\/p\u003e\\n\\n\u003chr \\/\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616239_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616239_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 19:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T19:03:18+0000\'\u003e28\\/Oct\\/16 19:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    GitHub user Timothy055 opened a pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n       LUCENE-7526   Improvements to UnifiedHighlighter OffsetStrategies \\n\\n     Pull request for   LUCENE-7526   \\n\\n You can merge this pull request into a Git repository by running: \\n\\n     $ git pull  https:\\/\\/github.com\\/Timothy055\\/lucene-solr  master \\n\\n Alternatively you can review and apply these changes as the patch at: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105.patch  \\n\\n To close this pull request, make a commit to your master\\/trunk branch \\nwith (at least) the following in the commit message: \\n\\n     This closes #105 \\n\\n \\n commit 02e932c4a6146363680b88f4947a693c6697c955 \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-09-01T19:23:50Z \\n\\n     Initial fork of PostingsHighlighter for UnifiedHighlighter \\n\\n commit 9d88411b3985a98851384d78d681431dba710e89 \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-09-01T23:17:06Z \\n\\n     Initial commit of the UnifiedHighlighter for OSS contribution \\n\\n commit e45e39bc4b07ea33e4423b264c2fefb9aa08777a \\nAuthor: David Smiley &lt;david.w.smiley@gmail.com&gt; \\nDate:   2016-09-02T12:45:49Z \\n\\n     Fix misc issues; \\\"ant test\\\" now works. (#1) \\n\\n commit 046a28ef31acf4cea7d255bbbb4b827e6a714e3d \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-09-02T20:58:31Z \\n\\n     Minor refactoring of the AnalysisFieldHighlighter \\n\\n commit ccd1a2280abd4b48cfef8122696e5d9cfd12920f \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-03T12:55:20Z \\n\\n     AbstractFieldHighlighter: order methods more sensibly; renamed a couple. \\n\\n commit d4714a04a3e41d5e95bbe942b275c32ed69b9c2e \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T01:03:29Z \\n\\n     Improve javadocs and @lucene.external\\/internal labeling &amp; scope. \\n    \\\"ant precommit\\\" now passes. \\n\\n commit e0659f18a59bf2893076da6d7643ff30f2fa5a52 \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T01:25:55Z \\n\\n     Analysis: remove dubious filter() method \\n\\n commit ccd7ce707bff2c06da89b31853cca9aecea72008 \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T01:44:01Z \\n\\n     getStrictPhraseHelper -&gt; rm \\\"Strict\\\", getHighlightAccuracy -&gt; getFlags, and only call filterExtractedTerms once. \\n\\n commit ffc2a22c700b8abcbf87673d5d05bb3659d177c9 \\nAuthor: David Smiley &lt;david.w.smiley@gmail.com&gt; \\nDate:   2016-09-04T15:21:08Z \\n\\n     UnifiedHighlighter round 2 (#2) \\n\\n \\n\\t AbstractFieldHighlighter: order methods more sensibly; renamed a couple. \\n \\n\\n\\n \\n\\t Improve javadocs and @lucene.external\\/internal labeling &amp; scope. \\n    \\\"ant precommit\\\" now passes. \\n \\n\\n\\n \\n\\t Analysis: remove dubious filter() method \\n \\n\\n\\n \\n\\t getStrictPhraseHelper -&gt; rm \\\"Strict\\\", getHighlightAccuracy -&gt; getFlags, and only call filterExtractedTerms once. \\n \\n\\n\\n commit 5f95e05595db462d3ab5bffc68c2c92f70875072 \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T16:12:33Z \\n\\n     Refactor: FieldOffsetStrategy \\n\\n commit 86fb6265fbbdb955ead6d4baf944bf708175715e \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T16:21:32Z \\n\\n     stop passing maxPassages into highlightFieldForDoc() \\n\\n commit f6fd80544eae9fab953b94b1e9346c0883f956eb \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T16:12:33Z \\n\\n     Refactor: FieldOffsetStrategy \\n\\n commit b335a673c2ce45904890c1e9af7cbfda2bd27b0f \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T16:21:32Z \\n\\n     stop passing maxPassages into highlightFieldForDoc() \\n\\n commit 478db9437b92214cbf459f82ba2e3a67c966a150 \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T18:29:44Z \\n\\n     Rename subclasses of FieldOffsetStrategy. \\n\\n commit dbf4280755c11420a5032445cd618fadb7444b61 \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T18:31:34Z \\n\\n     Re-order and harmonize params on methods called by UH.getFieldHighlighter() \\n\\n commit f0340e27e61dcda2e11992f08ec07a72fad6c24c \\nAuthor: David Smiley &lt;dsmiley@apache.org&gt; \\nDate:   2016-09-04T18:53:51Z \\n\\n     FieldHighlighter: harmonize field\\/param order. And don\'t apply maxNoHighlightPasses twice. \\n\\n commit 817f63c1d48fd523c13b9c40a2ae9b8a4047209a \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-09-06T20:43:20Z \\n\\n     Merge of renaming changes \\n\\n commit 0f644a4f53c1ed4d41d562848f6fe51a87442a75 \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-09-06T20:54:13Z \\n\\n     add visibility tests \\n\\n commit 9171f49e117085e7d086267bb73836831ff07f8e \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-09-07T14:26:59Z \\n\\n     ADd additional extensibility test \\n\\n commit 7ce488147cb811e15cb6e9125a835171157746f2 \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-09-28T22:04:15Z \\n\\n     Reduce visibility of MultiTermHighlighting to package protected \\n\\n commit 2f08465020448592b0e8750db568ade5a9218267 \\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt; \\nDate:   2016-10-11T16:44:29Z \\n\\n     Initial commit that will use memory index to generate offsets enum if the tokenstream is null \\n\\n commit 357f3dfb9ace4deef20787af19bc2e5a6b4ff61e \\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt; \\nDate:   2016-10-11T17:34:51Z \\n\\n     Switched analysis offset strategy to not re-build a tokenstream \\n\\n commit 64153d288db5714cdaf3726328557f65c1635610 \\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt; \\nDate:   2016-10-11T17:42:12Z \\n\\n     Switched to using chars ref builder \\n\\n commit f137779b1e1b7e57c4b78652614a04507b9e09e1 \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-10-21T19:07:48Z \\n\\n     minor cleanup \\n\\n commit ec814f974db6459eba7aa45bf7a4cdae04e6ad6f \\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt; \\nDate:   2016-10-21T21:25:57Z \\n\\n     switch to use of a CompositePostingsEnum that wraps the postings of wildcard matches \\n\\n commit 955a1e79b5189492fae2c95da39343c29e1cdb25 \\nAuthor: Timothy M. Rodriguez &lt;timothy.rodriguez@gmail.com&gt; \\nDate:   2016-10-21T21:32:48Z \\n\\n     merge conflicts on PhraseHelper rename \\n\\n commit d35bd1cffd3c6e2aed67aeccfd03959bf855670a \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-10-21T22:13:51Z \\n\\n     minor cleanup of how automata are handled in the FieldOffsetStrategy \\n\\n commit aa8c92667272e5f397b9566cde05eae7e31bcce5 \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-10-24T20:03:08Z \\n\\n     Removed most use of TokenStreams except in pure Analysis \\n\\n commit db42d6a959ca19a77dee3cc7b09496a21c631bd6 \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-10-24T20:08:25Z \\n\\n     simplified some logic to not use continue statements \\n\\n commit 657c2a70c4d8ec8ef850e9f66b93cf85ec16f636 \\nAuthor: Timothy Rodriguez &lt;trodriguez25@bloomberg.net&gt; \\nDate:   2016-10-24T22:56:17Z \\n\\n     split analysis mode into two, moved all offset sources from readers into the FieldOffsetStrategy \\n\\n              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616294\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616294&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616294\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15616294_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616294_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T19:24:32+0000\'\u003e28\\/Oct\\/16 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.  I\'ve just submitted the pull request.  You\'re right this only removes an additional use of token streams.  In the case of the Analysis strategies a TokenStream is still necessary at least initially to analyze the field.  I\'m glad I got to work on this during the wonderful Boston Hackday event (\u003ca href=\\\"https:\\/\\/github.com\\/flaxsearch\\/london-hackday-2016\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/flaxsearch\\/london-hackday-2016\u003c\\/a\u003e).  Thanks \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e for some tips while there and \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=mbraun688\\\" class=\\\"user-hover\\\" rel=\\\"mbraun688\\\"\u003eMichael Braun\u003c\\/a\u003e for some initial feedback on the pr.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15616294_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616294_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T19:24:32+0000\'\u003e28\\/Oct\\/16 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks  David Smiley   .  I\'ve just submitted the pull request.  You\'re right this only removes an additional use of token streams.  In the case of the Analysis strategies a TokenStream is still necessary at least initially to analyze the field.  I\'m glad I got to work on this during the wonderful Boston Hackday event ( https:\\/\\/github.com\\/flaxsearch\\/london-hackday-2016 ).  Thanks  David Smiley  for some tips while there and  Michael Braun  for some initial feedback on the pr.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616546\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616546&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616546\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616546_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616546_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602404\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602404\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,165 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.PriorityQueue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +final class CompositePostingsEnum extends PostingsEnum {\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    A comment would be helpful to explain the scope\\/purpose.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616546_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616546_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602404  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212; \\n    @@ -0,0 +1,165 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.IOException; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.PriorityQueue; \\n    + \\n    + \\n    +final class CompositePostingsEnum extends PostingsEnum { \\n    &#8212; End diff &#8211; \\n\\n     A comment would be helpful to explain the scope\\/purpose.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616547\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616547&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616547\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616547_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616547_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602210\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602210\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/AnalysisOffsetStrategy.java &#8212;\u003cbr\\/\u003e\\n    @@ -17,174 +17,28 @@\u003cbr\\/\u003e\\n     package org.apache.lucene.search.uhighlight;\u003c\\/p\u003e\\n\\n\u003cp\u003e     import java.io.IOException;\u003cbr\\/\u003e\\n    -import java.util.ArrayList;\u003cbr\\/\u003e\\n    -import java.util.Arrays;\u003cbr\\/\u003e\\n    -import java.util.Collections;\u003cbr\\/\u003e\\n    -import java.util.List;\u003c\\/p\u003e\\n\\n\u003cp\u003e     import org.apache.lucene.analysis.Analyzer;\u003cbr\\/\u003e\\n    -import org.apache.lucene.analysis.FilteringTokenFilter;\u003cbr\\/\u003e\\n     import org.apache.lucene.analysis.TokenStream;\u003cbr\\/\u003e\\n    -import org.apache.lucene.analysis.tokenattributes.CharTermAttribute;\u003cbr\\/\u003e\\n    -import org.apache.lucene.index.IndexReader;\u003cbr\\/\u003e\\n    -import org.apache.lucene.index.LeafReader;\u003cbr\\/\u003e\\n    -import org.apache.lucene.index.Terms;\u003cbr\\/\u003e\\n    -import org.apache.lucene.index.memory.MemoryIndex;\u003cbr\\/\u003e\\n    -import org.apache.lucene.search.spans.SpanQuery;\u003cbr\\/\u003e\\n     import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    -import org.apache.lucene.util.automaton.Automata;\u003cbr\\/\u003e\\n     import org.apache.lucene.util.automaton.CharacterRunAutomaton;\u003c\\/p\u003e\\n\\n\u003cp\u003e    +public abstract class AnalysisOffsetStrategy extends FieldOffsetStrategy {\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    All public classes need a javadoc comment.  Remember lucene.internal for this one.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616547_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616547_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602210  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/AnalysisOffsetStrategy.java &#8212; \\n    @@ -17,174 +17,28 @@ \\n     package org.apache.lucene.search.uhighlight; \\n\\n      import java.io.IOException; \\n    -import java.util.ArrayList; \\n    -import java.util.Arrays; \\n    -import java.util.Collections; \\n    -import java.util.List; \\n\\n      import org.apache.lucene.analysis.Analyzer; \\n    -import org.apache.lucene.analysis.FilteringTokenFilter; \\n     import org.apache.lucene.analysis.TokenStream; \\n    -import org.apache.lucene.analysis.tokenattributes.CharTermAttribute; \\n    -import org.apache.lucene.index.IndexReader; \\n    -import org.apache.lucene.index.LeafReader; \\n    -import org.apache.lucene.index.Terms; \\n    -import org.apache.lucene.index.memory.MemoryIndex; \\n    -import org.apache.lucene.search.spans.SpanQuery; \\n     import org.apache.lucene.util.BytesRef; \\n    -import org.apache.lucene.util.automaton.Automata; \\n     import org.apache.lucene.util.automaton.CharacterRunAutomaton; \\n\\n     +public abstract class AnalysisOffsetStrategy extends FieldOffsetStrategy { \\n    &#8212; End diff &#8211; \\n\\n     All public classes need a javadoc comment.  Remember lucene.internal for this one.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616548\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616548&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616548\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616548_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616548_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85603812\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85603812\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,165 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.PriorityQueue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +final class CompositePostingsEnum extends PostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  private static final int NO_MORE_POSITIONS = -2;\u003cbr\\/\u003e\\n    +  private final BytesRef term;\u003cbr\\/\u003e\\n    +  private final int freq;\u003cbr\\/\u003e\\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  \\/**\u003cbr\\/\u003e\\n    +   * This class is used to ensure we don\'t over iterate the underlying\u003cbr\\/\u003e\\n    +   * postings enum by keeping track of the position relative to the\u003cbr\\/\u003e\\n    +   * frequency.\u003cbr\\/\u003e\\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum\u003cbr\\/\u003e\\n    +   * but it would have to delegate most methods and it seemed easier\u003cbr\\/\u003e\\n    +   * to just wrap the tweaked method.\u003cbr\\/\u003e\\n    +   *\\/\u003cbr\\/\u003e\\n    +  private static final class BoundsCheckingPostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private final PostingsEnum postingsEnum;\u003cbr\\/\u003e\\n    +    private final int freq;\u003cbr\\/\u003e\\n    +    private int position;\u003cbr\\/\u003e\\n    +    private int nextPosition;\u003cbr\\/\u003e\\n    +    private int positionInc = 1;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private int startOffset;\u003cbr\\/\u003e\\n    +    private int endOffset;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    BoundsCheckingPostingsEnum(PostingsEnum postingsEnum) throws IOException \u003c\\/p\u003e\\n{\\n    +      this.postingsEnum = postingsEnum;\\n    +      this.freq = postingsEnum.freq();\\n    +      nextPosition = postingsEnum.nextPosition();\\n    +      position = nextPosition;\\n    +      startOffset = postingsEnum.startOffset();\\n    +      endOffset = postingsEnum.endOffset();\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    private boolean hasMorePositions() throws IOException \u003c\\/p\u003e\\n{\\n    +      return positionInc &lt; freq;\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    \\/**\u003cbr\\/\u003e\\n    +     * Returns the next position of the underlying postings enum unless\u003cbr\\/\u003e\\n    +     * it cannot iterate further and returns NO_MORE_POSITIONS;\u003cbr\\/\u003e\\n    +     * @return\u003cbr\\/\u003e\\n    +     * @throws IOException\u003cbr\\/\u003e\\n    +     *\\/\u003cbr\\/\u003e\\n    +    private int nextPosition() throws IOException {\u003cbr\\/\u003e\\n    +      position = nextPosition;\u003cbr\\/\u003e\\n    +      startOffset = postingsEnum.startOffset();\u003cbr\\/\u003e\\n    +      endOffset = postingsEnum.endOffset();\u003cbr\\/\u003e\\n    +      if (hasMorePositions()) \u003c\\/p\u003e\\n{\\n    +        positionInc++;\\n    +        nextPosition = postingsEnum.nextPosition();\\n    +      }\\n\u003cp\u003e else \u003c\\/p\u003e\\n{\\n    +        nextPosition = NO_MORE_POSITIONS;\\n    +      }\\n\u003cp\u003e    +      return position;\u003cbr\\/\u003e\\n    +    }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  CompositePostingsEnum(BytesRef term, List&lt;PostingsEnum&gt; postingsEnums) throws IOException {\u003cbr\\/\u003e\\n    +    this.term = term;\u003cbr\\/\u003e\\n    +    queue = new PriorityQueue&lt;BoundsCheckingPostingsEnum&gt;(postingsEnums.size()) {\u003cbr\\/\u003e\\n    +      @Override\u003cbr\\/\u003e\\n    +      protected boolean lessThan(BoundsCheckingPostingsEnum a, BoundsCheckingPostingsEnum b) {\u003cbr\\/\u003e\\n    +        return a.position &lt; b.position;\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    In the event the positions are equal (e.g. two terms a the same position in which the wildcard matches both), we might want to fall-back on startOffset then endOffset?  Or maybe simply ignore position altogether and just do offsets, so then you needn\'t even track the position?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616548_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616548_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85603812  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212; \\n    @@ -0,0 +1,165 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.IOException; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.PriorityQueue; \\n    + \\n    + \\n    +final class CompositePostingsEnum extends PostingsEnum { \\n    + \\n    +  private static final int NO_MORE_POSITIONS = -2; \\n    +  private final BytesRef term; \\n    +  private final int freq; \\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue; \\n    + \\n    + \\n    +  \\/** \\n    +   * This class is used to ensure we don\'t over iterate the underlying \\n    +   * postings enum by keeping track of the position relative to the \\n    +   * frequency. \\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum \\n    +   * but it would have to delegate most methods and it seemed easier \\n    +   * to just wrap the tweaked method. \\n    +   *\\/ \\n    +  private static final class BoundsCheckingPostingsEnum { \\n    + \\n    + \\n    +    private final PostingsEnum postingsEnum; \\n    +    private final int freq; \\n    +    private int position; \\n    +    private int nextPosition; \\n    +    private int positionInc = 1; \\n    + \\n    +    private int startOffset; \\n    +    private int endOffset; \\n    + \\n    +    BoundsCheckingPostingsEnum(PostingsEnum postingsEnum) throws IOException  \\n{\\n    +      this.postingsEnum = postingsEnum;\\n    +      this.freq = postingsEnum.freq();\\n    +      nextPosition = postingsEnum.nextPosition();\\n    +      position = nextPosition;\\n    +      startOffset = postingsEnum.startOffset();\\n    +      endOffset = postingsEnum.endOffset();\\n    +    }\\n     + \\n    +    private boolean hasMorePositions() throws IOException  \\n{\\n    +      return positionInc &lt; freq;\\n    +    }\\n     + \\n    +    \\/** \\n    +     * Returns the next position of the underlying postings enum unless \\n    +     * it cannot iterate further and returns NO_MORE_POSITIONS; \\n    +     * @return \\n    +     * @throws IOException \\n    +     *\\/ \\n    +    private int nextPosition() throws IOException { \\n    +      position = nextPosition; \\n    +      startOffset = postingsEnum.startOffset(); \\n    +      endOffset = postingsEnum.endOffset(); \\n    +      if (hasMorePositions())  \\n{\\n    +        positionInc++;\\n    +        nextPosition = postingsEnum.nextPosition();\\n    +      }\\n  else  \\n{\\n    +        nextPosition = NO_MORE_POSITIONS;\\n    +      }\\n     +      return position; \\n    +    } \\n    + \\n    +  } \\n    + \\n    +  CompositePostingsEnum(BytesRef term, List&lt;PostingsEnum&gt; postingsEnums) throws IOException { \\n    +    this.term = term; \\n    +    queue = new PriorityQueue&lt;BoundsCheckingPostingsEnum&gt;(postingsEnums.size()) { \\n    +      @Override \\n    +      protected boolean lessThan(BoundsCheckingPostingsEnum a, BoundsCheckingPostingsEnum b) { \\n    +        return a.position &lt; b.position; \\n    &#8212; End diff &#8211; \\n\\n     In the event the positions are equal (e.g. two terms a the same position in which the wildcard matches both), we might want to fall-back on startOffset then endOffset?  Or maybe simply ignore position altogether and just do offsets, so then you needn\'t even track the position?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616549\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616549&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616549\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616549_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616549_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85607262\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85607262\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/TokenStreamOffsetStrategy.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,60 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.Closeable;\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.Collections;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.analysis.Analyzer;\u003cbr\\/\u003e\\n    +import org.apache.lucene.analysis.TokenStream;\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.IndexReader;\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.automaton.CharacterRunAutomaton;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +public class TokenStreamOffsetStrategy extends AnalysisOffsetStrategy {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  private static final BytesRef[] ZERO_LEN_BYTES_REF_ARRAY = new BytesRef\u003cspan class=\\\"error\\\"\u003e&#91;0&#93;\u003c\\/span\u003e;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  public TokenStreamOffsetStrategy(String field, BytesRef[] terms, PhraseHelper phraseHelper, CharacterRunAutomaton[] automata, Analyzer indexAnalyzer) \u003c\\/p\u003e\\n{\\n    +    super(field, terms, phraseHelper, automata, indexAnalyzer);\\n    +    this.automata = convertTermsToAutomata(terms, automata);\\n    +    this.terms = ZERO_LEN_BYTES_REF_ARRAY;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException {\u003cbr\\/\u003e\\n    +    TokenStream tokenStream = tokenStream(content);\u003cbr\\/\u003e\\n    +    PostingsEnum mtqPostingsEnum = MultiTermHighlighting.getDocsEnum(tokenStream, automata);\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    I think there\'s a case to be made in moving ` MultiTermHighlighting.getDocsEnum` into this class, to thus keep the TokenStream aspect more isolated?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616549_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616549_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85607262  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/TokenStreamOffsetStrategy.java &#8212; \\n    @@ -0,0 +1,60 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.Closeable; \\n    +import java.io.IOException; \\n    +import java.util.Collections; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.analysis.Analyzer; \\n    +import org.apache.lucene.analysis.TokenStream; \\n    +import org.apache.lucene.index.IndexReader; \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.automaton.CharacterRunAutomaton; \\n    + \\n    +public class TokenStreamOffsetStrategy extends AnalysisOffsetStrategy { \\n    + \\n    +  private static final BytesRef[] ZERO_LEN_BYTES_REF_ARRAY = new BytesRef &#91;0&#93; ; \\n    + \\n    +  public TokenStreamOffsetStrategy(String field, BytesRef[] terms, PhraseHelper phraseHelper, CharacterRunAutomaton[] automata, Analyzer indexAnalyzer)  \\n{\\n    +    super(field, terms, phraseHelper, automata, indexAnalyzer);\\n    +    this.automata = convertTermsToAutomata(terms, automata);\\n    +    this.terms = ZERO_LEN_BYTES_REF_ARRAY;\\n    +  }\\n     + \\n    +  @Override \\n    +  public List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException { \\n    +    TokenStream tokenStream = tokenStream(content); \\n    +    PostingsEnum mtqPostingsEnum = MultiTermHighlighting.getDocsEnum(tokenStream, automata); \\n    &#8212; End diff &#8211; \\n\\n     I think there\'s a case to be made in moving ` MultiTermHighlighting.getDocsEnum` into this class, to thus keep the TokenStream aspect more isolated?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616550\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616550&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616550\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616550_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616550_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602867\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602867\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,165 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.PriorityQueue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +final class CompositePostingsEnum extends PostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  private static final int NO_MORE_POSITIONS = -2;\u003cbr\\/\u003e\\n    +  private final BytesRef term;\u003cbr\\/\u003e\\n    +  private final int freq;\u003cbr\\/\u003e\\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  \\/**\u003cbr\\/\u003e\\n    +   * This class is used to ensure we don\'t over iterate the underlying\u003cbr\\/\u003e\\n    +   * postings enum by keeping track of the position relative to the\u003cbr\\/\u003e\\n    +   * frequency.\u003cbr\\/\u003e\\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum\u003cbr\\/\u003e\\n    +   * but it would have to delegate most methods and it seemed easier\u003cbr\\/\u003e\\n    +   * to just wrap the tweaked method.\u003cbr\\/\u003e\\n    +   *\\/\u003cbr\\/\u003e\\n    +  private static final class BoundsCheckingPostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private final PostingsEnum postingsEnum;\u003cbr\\/\u003e\\n    +    private final int freq;\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    Instead of holding `freq` and `nextPosition`, why not just `remainingPositions`?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616550_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616550_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85602867  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212; \\n    @@ -0,0 +1,165 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.IOException; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.PriorityQueue; \\n    + \\n    + \\n    +final class CompositePostingsEnum extends PostingsEnum { \\n    + \\n    +  private static final int NO_MORE_POSITIONS = -2; \\n    +  private final BytesRef term; \\n    +  private final int freq; \\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue; \\n    + \\n    + \\n    +  \\/** \\n    +   * This class is used to ensure we don\'t over iterate the underlying \\n    +   * postings enum by keeping track of the position relative to the \\n    +   * frequency. \\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum \\n    +   * but it would have to delegate most methods and it seemed easier \\n    +   * to just wrap the tweaked method. \\n    +   *\\/ \\n    +  private static final class BoundsCheckingPostingsEnum { \\n    + \\n    + \\n    +    private final PostingsEnum postingsEnum; \\n    +    private final int freq; \\n    &#8212; End diff &#8211; \\n\\n     Instead of holding `freq` and `nextPosition`, why not just `remainingPositions`?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616551\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616551&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616551\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616551_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616551_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85608645\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85608645\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/test\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/visibility\\/TestUnifiedHighlighterExtensibility.java &#8212;\u003cbr\\/\u003e\\n    @@ -79,7 +90,7 @@ public void testFieldOffsetStrategyExtensibility() {\u003cbr\\/\u003e\\n       @Test\u003cbr\\/\u003e\\n       public void testUnifiedHighlighterExtensibility() {\u003cbr\\/\u003e\\n         final int maxLength = 1000;\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eUnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(random())){\u003cbr\\/\u003e\\n    +    UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(new Random())){\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    ? why not `random()` ?  This will likely fail precommit.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616551_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616551_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85608645  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/test\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/visibility\\/TestUnifiedHighlighterExtensibility.java &#8212; \\n    @@ -79,7 +90,7 @@ public void testFieldOffsetStrategyExtensibility() { \\n       @Test \\n       public void testUnifiedHighlighterExtensibility() { \\n         final int maxLength = 1000; \\n \\n\\t UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(random())){ \\n    +    UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(new Random())){\\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     ? why not `random()` ?  This will likely fail precommit.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616552\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616552&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616552\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616552_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616552_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85606885\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85606885\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/Passage.java &#8212;\u003cbr\\/\u003e\\n    @@ -40,7 +40,7 @@\u003cbr\\/\u003e\\n         BytesRef matchTerms[] = new BytesRef\u003cspan class=\\\"error\\\"\u003e&#91;8&#93;\u003c\\/span\u003e;\u003cbr\\/\u003e\\n         int numMatches = 0;\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003evoid addMatch(int startOffset, int endOffset, BytesRef term) {\u003cbr\\/\u003e\\n    +    public void addMatch(int startOffset, int endOffset, BytesRef term) {\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    Excellent; now it\'s possible for someone to override `FieldHighlighter.highlightOffsetsEnums()` to make Passages.  But do add @lucene.experimental.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616552_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616552_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85606885  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/Passage.java &#8212; \\n    @@ -40,7 +40,7 @@ \\n         BytesRef matchTerms[] = new BytesRef &#91;8&#93; ; \\n         int numMatches = 0; \\n\\n \\n\\t void addMatch(int startOffset, int endOffset, BytesRef term) { \\n    +    public void addMatch(int startOffset, int endOffset, BytesRef term) {\\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     Excellent; now it\'s possible for someone to override `FieldHighlighter.highlightOffsetsEnums()` to make Passages.  But do add @lucene.experimental.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616553\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616553&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616553\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616553_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616553_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85607859\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85607859\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/UnifiedHighlighter.java &#8212;\u003cbr\\/\u003e\\n    @@ -116,6 +116,8 @@\u003c\\/p\u003e\\n\\n\u003cp\u003e       private boolean defaultHighlightPhrasesStrictly = true; \\/\\/ AKA \\\"accuracy\\\" or \\\"query debugging\\\"\u003c\\/p\u003e\\n\\n\u003cp\u003e    +  private boolean defaultPassageRelevancyOverSpeed = true; \\/\\/Prefer using a memory index\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    Suggest the comment be: For analysis, prefer MemoryIndex approach\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616553_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616553_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85607859  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/UnifiedHighlighter.java &#8212; \\n    @@ -116,6 +116,8 @@ \\n\\n        private boolean defaultHighlightPhrasesStrictly = true; \\/\\/ AKA \\\"accuracy\\\" or \\\"query debugging\\\" \\n\\n     +  private boolean defaultPassageRelevancyOverSpeed = true; \\/\\/Prefer using a memory index \\n    &#8212; End diff &#8211; \\n\\n     Suggest the comment be: For analysis, prefer MemoryIndex approach              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616554\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616554&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616554\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616554_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616554_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85603003\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85603003\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,165 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.PriorityQueue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +final class CompositePostingsEnum extends PostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  private static final int NO_MORE_POSITIONS = -2;\u003cbr\\/\u003e\\n    +  private final BytesRef term;\u003cbr\\/\u003e\\n    +  private final int freq;\u003cbr\\/\u003e\\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  \\/**\u003cbr\\/\u003e\\n    +   * This class is used to ensure we don\'t over iterate the underlying\u003cbr\\/\u003e\\n    +   * postings enum by keeping track of the position relative to the\u003cbr\\/\u003e\\n    +   * frequency.\u003cbr\\/\u003e\\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum\u003cbr\\/\u003e\\n    +   * but it would have to delegate most methods and it seemed easier\u003cbr\\/\u003e\\n    +   * to just wrap the tweaked method.\u003cbr\\/\u003e\\n    +   *\\/\u003cbr\\/\u003e\\n    +  private static final class BoundsCheckingPostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private final PostingsEnum postingsEnum;\u003cbr\\/\u003e\\n    +    private final int freq;\u003cbr\\/\u003e\\n    +    private int position;\u003cbr\\/\u003e\\n    +    private int nextPosition;\u003cbr\\/\u003e\\n    +    private int positionInc = 1;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private int startOffset;\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    Don\'t need these.  They can be fetched on-demand from the head of the queue, easily &amp; cheaply enough.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616554_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616554_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85603003  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212; \\n    @@ -0,0 +1,165 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.IOException; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.PriorityQueue; \\n    + \\n    + \\n    +final class CompositePostingsEnum extends PostingsEnum { \\n    + \\n    +  private static final int NO_MORE_POSITIONS = -2; \\n    +  private final BytesRef term; \\n    +  private final int freq; \\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue; \\n    + \\n    + \\n    +  \\/** \\n    +   * This class is used to ensure we don\'t over iterate the underlying \\n    +   * postings enum by keeping track of the position relative to the \\n    +   * frequency. \\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum \\n    +   * but it would have to delegate most methods and it seemed easier \\n    +   * to just wrap the tweaked method. \\n    +   *\\/ \\n    +  private static final class BoundsCheckingPostingsEnum { \\n    + \\n    + \\n    +    private final PostingsEnum postingsEnum; \\n    +    private final int freq; \\n    +    private int position; \\n    +    private int nextPosition; \\n    +    private int positionInc = 1; \\n    + \\n    +    private int startOffset; \\n    &#8212; End diff &#8211; \\n\\n     Don\'t need these.  They can be fetched on-demand from the head of the queue, easily &amp; cheaply enough.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616555\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616555&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616555\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616555_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616555_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85606333\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85606333\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/FieldOffsetStrategy.java &#8212;\u003cbr\\/\u003e\\n    @@ -65,58 +65,88 @@ public String getField() {\u003cbr\\/\u003e\\n        *\\/\u003cbr\\/\u003e\\n       public abstract List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException;\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eprotected List&lt;OffsetsEnum&gt; createOffsetsEnums(LeafReader leafReader, int doc, TokenStream tokenStream) throws IOException {\u003c\\/li\u003e\\n\\t\u003cli\u003eList&lt;OffsetsEnum&gt; offsetsEnums = createOffsetsEnumsFromReader(leafReader, doc);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (automata.length &gt; 0) {\u003c\\/li\u003e\\n\\t\u003cli\u003eoffsetsEnums.add(createOffsetsEnumFromTokenStream(doc, tokenStream));\u003cbr\\/\u003e\\n    +  protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader leafReader, int doc) throws IOException {\u003cbr\\/\u003e\\n    +    final Terms termsIndex = leafReader.terms(field);\u003cbr\\/\u003e\\n    +    if (termsIndex == null) \\n{\\n    +      return Collections.emptyList();\\n         }\u003c\\/li\u003e\\n\\t\u003cli\u003ereturn offsetsEnums;\u003c\\/li\u003e\\n\\t\u003cli\u003e}\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eprotected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader atomicReader, int doc) throws IOException {\u003cbr\\/\u003e\\n         \\/\\/ For strict positions, get a Map of term to Spans:\u003cbr\\/\u003e\\n         \\/\\/    note: ScriptPhraseHelper.NONE does the right thing for these method calls\u003cbr\\/\u003e\\n         final Map&lt;BytesRef, Spans&gt; strictPhrasesTermToSpans =\u003c\\/li\u003e\\n\\t\u003cli\u003estrictPhrases.getTermToSpans(atomicReader, doc);\u003cbr\\/\u003e\\n    +        phraseHelper.getTermToSpans(leafReader, doc);\u003cbr\\/\u003e\\n         \\/\\/ Usually simply wraps terms in a List; but if willRewrite() then can be expanded\u003cbr\\/\u003e\\n         final List&lt;BytesRef&gt; sourceTerms =\u003c\\/li\u003e\\n\\t\u003cli\u003estrictPhrases.expandTermsIfRewrite(terms, strictPhrasesTermToSpans);\u003cbr\\/\u003e\\n    +        phraseHelper.expandTermsIfRewrite(terms, strictPhrasesTermToSpans);\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003efinal List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + 1);\u003cbr\\/\u003e\\n    +    final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + automata.length);\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eTerms termsIndex = atomicReader == null || sourceTerms.isEmpty() ? null : atomicReader.terms(field);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (termsIndex != null) {\u003cbr\\/\u003e\\n    +    \\/\\/ Handle sourceTerms:\u003cbr\\/\u003e\\n    +    if (!sourceTerms.isEmpty()) {\u003cbr\\/\u003e\\n           TermsEnum termsEnum = termsIndex.iterator();\\/\\/does not return null\u003cbr\\/\u003e\\n           for (BytesRef term : sourceTerms) {\u003c\\/li\u003e\\n\\t\u003cli\u003eif (!termsEnum.seekExact(term)) \\n{\\n    -          continue; \\/\\/ term not found\\n    -        }\u003c\\/li\u003e\\n\\t\u003cli\u003ePostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (postingsEnum == null) \\n{\\n    -          \\/\\/ no offsets or positions available\\n    -          throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    -        }\u003c\\/li\u003e\\n\\t\u003cli\u003eif (doc != postingsEnum.advance(doc)) { \\/\\/ now it\'s positioned, although may be exhausted\u003c\\/li\u003e\\n\\t\u003cli\u003econtinue;\u003cbr\\/\u003e\\n    +        if (termsEnum.seekExact(term)) {\u003cbr\\/\u003e\\n    +          PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS);\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +          if (postingsEnum == null) \\n{\\n    +            \\/\\/ no offsets or positions available\\n    +            throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    +          }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +          if (doc == postingsEnum.advance(doc)) \u003c\\/p\u003e\\n\u003cdiv class=\\\"error\\\"\u003e\u003cspan class=\\\"error\\\"\u003eUnknown macro: { \\/\\/ now it&#39;s positioned, although may be exhausted    +            postingsEnum = phraseHelper.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));    +            if (postingsEnum != null) {\\n    +              offsetsEnums.add(new OffsetsEnum(term, postingsEnum));\\n    +            }    +          }\u003c\\/span\u003e \u003c\\/div\u003e\\n\u003cp\u003e             }\u003c\\/p\u003e\u003c\\/li\u003e\\n\\t\u003cli\u003epostingsEnum = strictPhrases.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));\u003c\\/li\u003e\\n\\t\u003cli\u003eif (postingsEnum == null) \\n{\\n    -          continue;\\/\\/ completely filtered out\\n    +      }\\n\u003cp\u003e    +    }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    \\/\\/ Handle automata\u003cbr\\/\u003e\\n    +    if (automata.length &gt; 0) \u003c\\/p\u003e\\n{\\n    +      offsetsEnums.addAll(createAutomataOffsetsFromTerms(termsIndex, doc));\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    return offsetsEnums;\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  protected List&lt;OffsetsEnum&gt; createAutomataOffsetsFromTerms(Terms termsIndex, int doc) throws IOException {\u003cbr\\/\u003e\\n    +    Map&lt;CharacterRunAutomaton, List&lt;PostingsEnum&gt;&gt; automataPostings = new IdentityHashMap&lt;&gt;(automata.length);\u003c\\/p\u003e\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    I suggest a parallel array to automata, so that later you can avoid a map lookup on each matching term.  Also, I suggest lazy-initializing the array later... perhaps some wildcards in a disjunction might never match.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616555_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616555_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85606333  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/FieldOffsetStrategy.java &#8212; \\n    @@ -65,58 +65,88 @@ public String getField() { \\n        *\\/ \\n       public abstract List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException; \\n\\n \\n\\t protected List&lt;OffsetsEnum&gt; createOffsetsEnums(LeafReader leafReader, int doc, TokenStream tokenStream) throws IOException { \\n\\t List&lt;OffsetsEnum&gt; offsetsEnums = createOffsetsEnumsFromReader(leafReader, doc); \\n\\t if (automata.length &gt; 0) { \\n\\t offsetsEnums.add(createOffsetsEnumFromTokenStream(doc, tokenStream)); \\n    +  protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader leafReader, int doc) throws IOException { \\n    +    final Terms termsIndex = leafReader.terms(field); \\n    +    if (termsIndex == null) \\n{\\n    +      return Collections.emptyList();\\n         } \\n\\t return offsetsEnums; \\n\\t } \\n \\n\\n\\n \\n\\t protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader atomicReader, int doc) throws IOException { \\n         \\/\\/ For strict positions, get a Map of term to Spans: \\n         \\/\\/    note: ScriptPhraseHelper.NONE does the right thing for these method calls \\n         final Map&lt;BytesRef, Spans&gt; strictPhrasesTermToSpans = \\n\\t strictPhrases.getTermToSpans(atomicReader, doc); \\n    +        phraseHelper.getTermToSpans(leafReader, doc); \\n         \\/\\/ Usually simply wraps terms in a List; but if willRewrite() then can be expanded \\n         final List&lt;BytesRef&gt; sourceTerms = \\n\\t strictPhrases.expandTermsIfRewrite(terms, strictPhrasesTermToSpans); \\n    +        phraseHelper.expandTermsIfRewrite(terms, strictPhrasesTermToSpans); \\n \\n\\n\\n \\n\\t final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + 1); \\n    +    final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + automata.length); \\n \\n\\n\\n \\n\\t Terms termsIndex = atomicReader == null || sourceTerms.isEmpty() ? null : atomicReader.terms(field); \\n\\t if (termsIndex != null) { \\n    +    \\/\\/ Handle sourceTerms: \\n    +    if (!sourceTerms.isEmpty()) { \\n           TermsEnum termsEnum = termsIndex.iterator();\\/\\/does not return null \\n           for (BytesRef term : sourceTerms) { \\n\\t if (!termsEnum.seekExact(term)) \\n{\\n    -          continue; \\/\\/ term not found\\n    -        } \\n\\t PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS); \\n\\t if (postingsEnum == null) \\n{\\n    -          \\/\\/ no offsets or positions available\\n    -          throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    -        } \\n\\t if (doc != postingsEnum.advance(doc)) { \\/\\/ now it\'s positioned, although may be exhausted \\n\\t continue; \\n    +        if (termsEnum.seekExact(term)) { \\n    +          PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS); \\n    + \\n    +          if (postingsEnum == null) \\n{\\n    +            \\/\\/ no offsets or positions available\\n    +            throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    +          }\\n     + \\n    +          if (doc == postingsEnum.advance(doc))  \\n  Unknown macro: { \\/\\/ now it&#39;s positioned, although may be exhausted    +            postingsEnum = phraseHelper.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));    +            if (postingsEnum != null) {\\n    +              offsetsEnums.add(new OffsetsEnum(term, postingsEnum));\\n    +            }    +          }   \\n              }  \\n\\t postingsEnum = strictPhrases.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term)); \\n\\t if (postingsEnum == null) \\n{\\n    -          continue;\\/\\/ completely filtered out\\n    +      }\\n     +    } \\n    + \\n    +    \\/\\/ Handle automata \\n    +    if (automata.length &gt; 0)  \\n{\\n    +      offsetsEnums.addAll(createAutomataOffsetsFromTerms(termsIndex, doc));\\n    +    }\\n     + \\n    +    return offsetsEnums; \\n    +  } \\n    + \\n    +  protected List&lt;OffsetsEnum&gt; createAutomataOffsetsFromTerms(Terms termsIndex, int doc) throws IOException { \\n    +    Map&lt;CharacterRunAutomaton, List&lt;PostingsEnum&gt;&gt; automataPostings = new IdentityHashMap&lt;&gt;(automata.length); \\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     I suggest a parallel array to automata, so that later you can avoid a map lookup on each matching term.  Also, I suggest lazy-initializing the array later... perhaps some wildcards in a disjunction might never match.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616556\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616556&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616556\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616556_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616556_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85604667\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85604667\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,165 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.PriorityQueue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +final class CompositePostingsEnum extends PostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  private static final int NO_MORE_POSITIONS = -2;\u003cbr\\/\u003e\\n    +  private final BytesRef term;\u003cbr\\/\u003e\\n    +  private final int freq;\u003cbr\\/\u003e\\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  \\/**\u003cbr\\/\u003e\\n    +   * This class is used to ensure we don\'t over iterate the underlying\u003cbr\\/\u003e\\n    +   * postings enum by keeping track of the position relative to the\u003cbr\\/\u003e\\n    +   * frequency.\u003cbr\\/\u003e\\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum\u003cbr\\/\u003e\\n    +   * but it would have to delegate most methods and it seemed easier\u003cbr\\/\u003e\\n    +   * to just wrap the tweaked method.\u003cbr\\/\u003e\\n    +   *\\/\u003cbr\\/\u003e\\n    +  private static final class BoundsCheckingPostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private final PostingsEnum postingsEnum;\u003cbr\\/\u003e\\n    +    private final int freq;\u003cbr\\/\u003e\\n    +    private int position;\u003cbr\\/\u003e\\n    +    private int nextPosition;\u003cbr\\/\u003e\\n    +    private int positionInc = 1;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private int startOffset;\u003cbr\\/\u003e\\n    +    private int endOffset;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    BoundsCheckingPostingsEnum(PostingsEnum postingsEnum) throws IOException \u003c\\/p\u003e\\n{\\n    +      this.postingsEnum = postingsEnum;\\n    +      this.freq = postingsEnum.freq();\\n    +      nextPosition = postingsEnum.nextPosition();\\n    +      position = nextPosition;\\n    +      startOffset = postingsEnum.startOffset();\\n    +      endOffset = postingsEnum.endOffset();\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    private boolean hasMorePositions() throws IOException \u003c\\/p\u003e\\n{\\n    +      return positionInc &lt; freq;\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    \\/**\u003cbr\\/\u003e\\n    +     * Returns the next position of the underlying postings enum unless\u003cbr\\/\u003e\\n    +     * it cannot iterate further and returns NO_MORE_POSITIONS;\u003cbr\\/\u003e\\n    +     * @return\u003cbr\\/\u003e\\n    +     * @throws IOException\u003cbr\\/\u003e\\n    +     *\\/\u003cbr\\/\u003e\\n    +    private int nextPosition() throws IOException {\u003cbr\\/\u003e\\n    +      position = nextPosition;\u003cbr\\/\u003e\\n    +      startOffset = postingsEnum.startOffset();\u003cbr\\/\u003e\\n    +      endOffset = postingsEnum.endOffset();\u003cbr\\/\u003e\\n    +      if (hasMorePositions()) \u003c\\/p\u003e\\n{\\n    +        positionInc++;\\n    +        nextPosition = postingsEnum.nextPosition();\\n    +      }\\n\u003cp\u003e else \u003c\\/p\u003e\\n{\\n    +        nextPosition = NO_MORE_POSITIONS;\\n    +      }\\n\u003cp\u003e    +      return position;\u003cbr\\/\u003e\\n    +    }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  CompositePostingsEnum(BytesRef term, List&lt;PostingsEnum&gt; postingsEnums) throws IOException {\u003cbr\\/\u003e\\n    +    this.term = term;\u003cbr\\/\u003e\\n    +    queue = new PriorityQueue&lt;BoundsCheckingPostingsEnum&gt;(postingsEnums.size()) {\u003cbr\\/\u003e\\n    +      @Override\u003cbr\\/\u003e\\n    +      protected boolean lessThan(BoundsCheckingPostingsEnum a, BoundsCheckingPostingsEnum b) \u003c\\/p\u003e\\n{\\n    +        return a.position &lt; b.position;\\n    +      }\\n\u003cp\u003e    +    };\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    int freqAdd = 0;\u003cbr\\/\u003e\\n    +    for (PostingsEnum postingsEnum : postingsEnums) \u003c\\/p\u003e\\n{\\n    +      queue.add(new BoundsCheckingPostingsEnum(postingsEnum));\\n    +      freqAdd += postingsEnum.freq();\\n    +    }\\n\u003cp\u003e    +    freq = freqAdd;\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int freq() throws IOException \u003c\\/p\u003e\\n{\\n    +    return freq;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int nextPosition() throws IOException {\u003cbr\\/\u003e\\n    +    int position = NO_MORE_POSITIONS;\u003cbr\\/\u003e\\n    +    while (queue.size() &gt;= 1) {\u003cbr\\/\u003e\\n    +      queue.top().nextPosition();\u003cbr\\/\u003e\\n    +      queue.updateTop(); \\/\\/the new position may be behind another postingsEnum in the queue\u003cbr\\/\u003e\\n    +      position = queue.top().position;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +      if (position == NO_MORE_POSITIONS) \u003c\\/p\u003e\\n{\\n    +        queue.pop(); \\/\\/this postingsEnum is consumed, let\'s get rid of it\\n    +      }\\n\u003cp\u003e else \u003c\\/p\u003e\\n{\\n    +        break; \\/\\/we got a new position\\n    +      }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    }\u003cbr\\/\u003e\\n    +    return position;\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int startOffset() throws IOException \u003c\\/p\u003e\\n{\\n    +    return queue.top().startOffset;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int endOffset() throws IOException \u003c\\/p\u003e\\n{\\n    +    return queue.top().endOffset;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public BytesRef getPayload() throws IOException \u003c\\/p\u003e\\n{\\n    +    \\/\\/The UnifiedHighlighter depends on the payload for a wildcard\\n    +    \\/\\/being the term representing it\\n    +    return term;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int docID() {\u003cbr\\/\u003e\\n    +    return queue.top().postingsEnum.docID();\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    I think this one should be held in a field of CompositePostingsEnum initialized in constructor?  Not a big deal though, since I don\'t think the highlighter is going to call this, let alone sometime after positions are exhausted (which would trigger an NPE in this case).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616556_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616556_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T20:57:46+0000\'\u003e28\\/Oct\\/16 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85604667  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212; \\n    @@ -0,0 +1,165 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.IOException; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.PriorityQueue; \\n    + \\n    + \\n    +final class CompositePostingsEnum extends PostingsEnum { \\n    + \\n    +  private static final int NO_MORE_POSITIONS = -2; \\n    +  private final BytesRef term; \\n    +  private final int freq; \\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue; \\n    + \\n    + \\n    +  \\/** \\n    +   * This class is used to ensure we don\'t over iterate the underlying \\n    +   * postings enum by keeping track of the position relative to the \\n    +   * frequency. \\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum \\n    +   * but it would have to delegate most methods and it seemed easier \\n    +   * to just wrap the tweaked method. \\n    +   *\\/ \\n    +  private static final class BoundsCheckingPostingsEnum { \\n    + \\n    + \\n    +    private final PostingsEnum postingsEnum; \\n    +    private final int freq; \\n    +    private int position; \\n    +    private int nextPosition; \\n    +    private int positionInc = 1; \\n    + \\n    +    private int startOffset; \\n    +    private int endOffset; \\n    + \\n    +    BoundsCheckingPostingsEnum(PostingsEnum postingsEnum) throws IOException  \\n{\\n    +      this.postingsEnum = postingsEnum;\\n    +      this.freq = postingsEnum.freq();\\n    +      nextPosition = postingsEnum.nextPosition();\\n    +      position = nextPosition;\\n    +      startOffset = postingsEnum.startOffset();\\n    +      endOffset = postingsEnum.endOffset();\\n    +    }\\n     + \\n    +    private boolean hasMorePositions() throws IOException  \\n{\\n    +      return positionInc &lt; freq;\\n    +    }\\n     + \\n    +    \\/** \\n    +     * Returns the next position of the underlying postings enum unless \\n    +     * it cannot iterate further and returns NO_MORE_POSITIONS; \\n    +     * @return \\n    +     * @throws IOException \\n    +     *\\/ \\n    +    private int nextPosition() throws IOException { \\n    +      position = nextPosition; \\n    +      startOffset = postingsEnum.startOffset(); \\n    +      endOffset = postingsEnum.endOffset(); \\n    +      if (hasMorePositions())  \\n{\\n    +        positionInc++;\\n    +        nextPosition = postingsEnum.nextPosition();\\n    +      }\\n  else  \\n{\\n    +        nextPosition = NO_MORE_POSITIONS;\\n    +      }\\n     +      return position; \\n    +    } \\n    + \\n    +  } \\n    + \\n    +  CompositePostingsEnum(BytesRef term, List&lt;PostingsEnum&gt; postingsEnums) throws IOException { \\n    +    this.term = term; \\n    +    queue = new PriorityQueue&lt;BoundsCheckingPostingsEnum&gt;(postingsEnums.size()) { \\n    +      @Override \\n    +      protected boolean lessThan(BoundsCheckingPostingsEnum a, BoundsCheckingPostingsEnum b)  \\n{\\n    +        return a.position &lt; b.position;\\n    +      }\\n     +    }; \\n    + \\n    +    int freqAdd = 0; \\n    +    for (PostingsEnum postingsEnum : postingsEnums)  \\n{\\n    +      queue.add(new BoundsCheckingPostingsEnum(postingsEnum));\\n    +      freqAdd += postingsEnum.freq();\\n    +    }\\n     +    freq = freqAdd; \\n    +  } \\n    + \\n    +  @Override \\n    +  public int freq() throws IOException  \\n{\\n    +    return freq;\\n    +  }\\n     + \\n    +  @Override \\n    +  public int nextPosition() throws IOException { \\n    +    int position = NO_MORE_POSITIONS; \\n    +    while (queue.size() &gt;= 1) { \\n    +      queue.top().nextPosition(); \\n    +      queue.updateTop(); \\/\\/the new position may be behind another postingsEnum in the queue \\n    +      position = queue.top().position; \\n    + \\n    +      if (position == NO_MORE_POSITIONS)  \\n{\\n    +        queue.pop(); \\/\\/this postingsEnum is consumed, let\'s get rid of it\\n    +      }\\n  else  \\n{\\n    +        break; \\/\\/we got a new position\\n    +      }\\n     + \\n    +    } \\n    +    return position; \\n    +  } \\n    + \\n    +  @Override \\n    +  public int startOffset() throws IOException  \\n{\\n    +    return queue.top().startOffset;\\n    +  }\\n     + \\n    +  @Override \\n    +  public int endOffset() throws IOException  \\n{\\n    +    return queue.top().endOffset;\\n    +  }\\n     + \\n    +  @Override \\n    +  public BytesRef getPayload() throws IOException  \\n{\\n    +    \\/\\/The UnifiedHighlighter depends on the payload for a wildcard\\n    +    \\/\\/being the term representing it\\n    +    return term;\\n    +  }\\n     + \\n    +  @Override \\n    +  public int docID() { \\n    +    return queue.top().postingsEnum.docID(); \\n    &#8212; End diff &#8211; \\n\\n     I think this one should be held in a field of CompositePostingsEnum initialized in constructor?  Not a big deal though, since I don\'t think the highlighter is going to call this, let alone sometime after positions are exhausted (which would trigger an NPE in this case).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616577\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616577&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616577\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15616577_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616577_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:04:54+0000\'\u003e28\\/Oct\\/16 21:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIt seems the ASF\'s GitHub -&gt; JIRA comment integration doesn\'t incorporate overall review comments (i.e. comments not attached to a line number).  Please look in GH for that.\u003c\\/p\u003e\\n\\n\u003cp\u003eAfter a round of edits or two, I\'ll run the benchmarks to see how this fairs.  I expect it\'ll be a little slower for the analysis case when no phrases are present due to the change of default to prefer MemoryIndex for the benefit of better passage relevancy (now a toggle\'able option).  Hopefully very little.  If the difference seems imperceptible then there\'s a case for dropping the TokenStreamOffsetStrategy along with some quirks related to it, which would be nice in terms of code maintenance.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15616577_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616577_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:04:54+0000\'\u003e28\\/Oct\\/16 21:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    It seems the ASF\'s GitHub -&gt; JIRA comment integration doesn\'t incorporate overall review comments (i.e. comments not attached to a line number).  Please look in GH for that. \\n\\n After a round of edits or two, I\'ll run the benchmarks to see how this fairs.  I expect it\'ll be a little slower for the analysis case when no phrases are present due to the change of default to prefer MemoryIndex for the benefit of better passage relevancy (now a toggle\'able option).  Hopefully very little.  If the difference seems imperceptible then there\'s a case for dropping the TokenStreamOffsetStrategy along with some quirks related to it, which would be nice in terms of code maintenance.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616611\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616611&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616611\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616611_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616611_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:16:10+0000\'\u003e28\\/Oct\\/16 21:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85611673\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85611673\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,165 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.PriorityQueue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +final class CompositePostingsEnum extends PostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  private static final int NO_MORE_POSITIONS = -2;\u003cbr\\/\u003e\\n    +  private final BytesRef term;\u003cbr\\/\u003e\\n    +  private final int freq;\u003cbr\\/\u003e\\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  \\/**\u003cbr\\/\u003e\\n    +   * This class is used to ensure we don\'t over iterate the underlying\u003cbr\\/\u003e\\n    +   * postings enum by keeping track of the position relative to the\u003cbr\\/\u003e\\n    +   * frequency.\u003cbr\\/\u003e\\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum\u003cbr\\/\u003e\\n    +   * but it would have to delegate most methods and it seemed easier\u003cbr\\/\u003e\\n    +   * to just wrap the tweaked method.\u003cbr\\/\u003e\\n    +   *\\/\u003cbr\\/\u003e\\n    +  private static final class BoundsCheckingPostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private final PostingsEnum postingsEnum;\u003cbr\\/\u003e\\n    +    private final int freq;\u003cbr\\/\u003e\\n    +    private int position;\u003cbr\\/\u003e\\n    +    private int nextPosition;\u003cbr\\/\u003e\\n    +    private int positionInc = 1;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private int startOffset;\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    I thought the same, but unfortunately there\'s no way to check the current position of the underlying PostingsEnum before calling nextPosition.  Since we call nextPosition the PostingsEnum has moved on before the highlighter calls startOffset or endOffset.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616611_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616611_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:16:10+0000\'\u003e28\\/Oct\\/16 21:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85611673  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212; \\n    @@ -0,0 +1,165 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.IOException; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.PriorityQueue; \\n    + \\n    + \\n    +final class CompositePostingsEnum extends PostingsEnum { \\n    + \\n    +  private static final int NO_MORE_POSITIONS = -2; \\n    +  private final BytesRef term; \\n    +  private final int freq; \\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue; \\n    + \\n    + \\n    +  \\/** \\n    +   * This class is used to ensure we don\'t over iterate the underlying \\n    +   * postings enum by keeping track of the position relative to the \\n    +   * frequency. \\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum \\n    +   * but it would have to delegate most methods and it seemed easier \\n    +   * to just wrap the tweaked method. \\n    +   *\\/ \\n    +  private static final class BoundsCheckingPostingsEnum { \\n    + \\n    + \\n    +    private final PostingsEnum postingsEnum; \\n    +    private final int freq; \\n    +    private int position; \\n    +    private int nextPosition; \\n    +    private int positionInc = 1; \\n    + \\n    +    private int startOffset; \\n    &#8212; End diff &#8211; \\n\\n     I thought the same, but unfortunately there\'s no way to check the current position of the underlying PostingsEnum before calling nextPosition.  Since we call nextPosition the PostingsEnum has moved on before the highlighter calls startOffset or endOffset.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616618\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616618&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616618\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616618_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616618_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:18:16+0000\'\u003e28\\/Oct\\/16 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85611978\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85611978\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,165 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.PriorityQueue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +final class CompositePostingsEnum extends PostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  private static final int NO_MORE_POSITIONS = -2;\u003cbr\\/\u003e\\n    +  private final BytesRef term;\u003cbr\\/\u003e\\n    +  private final int freq;\u003cbr\\/\u003e\\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  \\/**\u003cbr\\/\u003e\\n    +   * This class is used to ensure we don\'t over iterate the underlying\u003cbr\\/\u003e\\n    +   * postings enum by keeping track of the position relative to the\u003cbr\\/\u003e\\n    +   * frequency.\u003cbr\\/\u003e\\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum\u003cbr\\/\u003e\\n    +   * but it would have to delegate most methods and it seemed easier\u003cbr\\/\u003e\\n    +   * to just wrap the tweaked method.\u003cbr\\/\u003e\\n    +   *\\/\u003cbr\\/\u003e\\n    +  private static final class BoundsCheckingPostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private final PostingsEnum postingsEnum;\u003cbr\\/\u003e\\n    +    private final int freq;\u003cbr\\/\u003e\\n    +    private int position;\u003cbr\\/\u003e\\n    +    private int nextPosition;\u003cbr\\/\u003e\\n    +    private int positionInc = 1;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private int startOffset;\u003cbr\\/\u003e\\n    +    private int endOffset;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    BoundsCheckingPostingsEnum(PostingsEnum postingsEnum) throws IOException \u003c\\/p\u003e\\n{\\n    +      this.postingsEnum = postingsEnum;\\n    +      this.freq = postingsEnum.freq();\\n    +      nextPosition = postingsEnum.nextPosition();\\n    +      position = nextPosition;\\n    +      startOffset = postingsEnum.startOffset();\\n    +      endOffset = postingsEnum.endOffset();\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    private boolean hasMorePositions() throws IOException \u003c\\/p\u003e\\n{\\n    +      return positionInc &lt; freq;\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    \\/**\u003cbr\\/\u003e\\n    +     * Returns the next position of the underlying postings enum unless\u003cbr\\/\u003e\\n    +     * it cannot iterate further and returns NO_MORE_POSITIONS;\u003cbr\\/\u003e\\n    +     * @return\u003cbr\\/\u003e\\n    +     * @throws IOException\u003cbr\\/\u003e\\n    +     *\\/\u003cbr\\/\u003e\\n    +    private int nextPosition() throws IOException {\u003cbr\\/\u003e\\n    +      position = nextPosition;\u003cbr\\/\u003e\\n    +      startOffset = postingsEnum.startOffset();\u003cbr\\/\u003e\\n    +      endOffset = postingsEnum.endOffset();\u003cbr\\/\u003e\\n    +      if (hasMorePositions()) \u003c\\/p\u003e\\n{\\n    +        positionInc++;\\n    +        nextPosition = postingsEnum.nextPosition();\\n    +      }\\n\u003cp\u003e else \u003c\\/p\u003e\\n{\\n    +        nextPosition = NO_MORE_POSITIONS;\\n    +      }\\n\u003cp\u003e    +      return position;\u003cbr\\/\u003e\\n    +    }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  CompositePostingsEnum(BytesRef term, List&lt;PostingsEnum&gt; postingsEnums) throws IOException {\u003cbr\\/\u003e\\n    +    this.term = term;\u003cbr\\/\u003e\\n    +    queue = new PriorityQueue&lt;BoundsCheckingPostingsEnum&gt;(postingsEnums.size()) {\u003cbr\\/\u003e\\n    +      @Override\u003cbr\\/\u003e\\n    +      protected boolean lessThan(BoundsCheckingPostingsEnum a, BoundsCheckingPostingsEnum b) \u003c\\/p\u003e\\n{\\n    +        return a.position &lt; b.position;\\n    +      }\\n\u003cp\u003e    +    };\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    int freqAdd = 0;\u003cbr\\/\u003e\\n    +    for (PostingsEnum postingsEnum : postingsEnums) \u003c\\/p\u003e\\n{\\n    +      queue.add(new BoundsCheckingPostingsEnum(postingsEnum));\\n    +      freqAdd += postingsEnum.freq();\\n    +    }\\n\u003cp\u003e    +    freq = freqAdd;\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int freq() throws IOException \u003c\\/p\u003e\\n{\\n    +    return freq;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int nextPosition() throws IOException {\u003cbr\\/\u003e\\n    +    int position = NO_MORE_POSITIONS;\u003cbr\\/\u003e\\n    +    while (queue.size() &gt;= 1) {\u003cbr\\/\u003e\\n    +      queue.top().nextPosition();\u003cbr\\/\u003e\\n    +      queue.updateTop(); \\/\\/the new position may be behind another postingsEnum in the queue\u003cbr\\/\u003e\\n    +      position = queue.top().position;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +      if (position == NO_MORE_POSITIONS) \u003c\\/p\u003e\\n{\\n    +        queue.pop(); \\/\\/this postingsEnum is consumed, let\'s get rid of it\\n    +      }\\n\u003cp\u003e else \u003c\\/p\u003e\\n{\\n    +        break; \\/\\/we got a new position\\n    +      }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    }\u003cbr\\/\u003e\\n    +    return position;\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int startOffset() throws IOException \u003c\\/p\u003e\\n{\\n    +    return queue.top().startOffset;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int endOffset() throws IOException \u003c\\/p\u003e\\n{\\n    +    return queue.top().endOffset;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public BytesRef getPayload() throws IOException \u003c\\/p\u003e\\n{\\n    +    \\/\\/The UnifiedHighlighter depends on the payload for a wildcard\\n    +    \\/\\/being the term representing it\\n    +    return term;\\n    +  }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +  @Override\u003cbr\\/\u003e\\n    +  public int docID() {\u003cbr\\/\u003e\\n    +    return queue.top().postingsEnum.docID();\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    K\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616618_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616618_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:18:16+0000\'\u003e28\\/Oct\\/16 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85611978  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212; \\n    @@ -0,0 +1,165 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.IOException; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.PriorityQueue; \\n    + \\n    + \\n    +final class CompositePostingsEnum extends PostingsEnum { \\n    + \\n    +  private static final int NO_MORE_POSITIONS = -2; \\n    +  private final BytesRef term; \\n    +  private final int freq; \\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue; \\n    + \\n    + \\n    +  \\/** \\n    +   * This class is used to ensure we don\'t over iterate the underlying \\n    +   * postings enum by keeping track of the position relative to the \\n    +   * frequency. \\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum \\n    +   * but it would have to delegate most methods and it seemed easier \\n    +   * to just wrap the tweaked method. \\n    +   *\\/ \\n    +  private static final class BoundsCheckingPostingsEnum { \\n    + \\n    + \\n    +    private final PostingsEnum postingsEnum; \\n    +    private final int freq; \\n    +    private int position; \\n    +    private int nextPosition; \\n    +    private int positionInc = 1; \\n    + \\n    +    private int startOffset; \\n    +    private int endOffset; \\n    + \\n    +    BoundsCheckingPostingsEnum(PostingsEnum postingsEnum) throws IOException  \\n{\\n    +      this.postingsEnum = postingsEnum;\\n    +      this.freq = postingsEnum.freq();\\n    +      nextPosition = postingsEnum.nextPosition();\\n    +      position = nextPosition;\\n    +      startOffset = postingsEnum.startOffset();\\n    +      endOffset = postingsEnum.endOffset();\\n    +    }\\n     + \\n    +    private boolean hasMorePositions() throws IOException  \\n{\\n    +      return positionInc &lt; freq;\\n    +    }\\n     + \\n    +    \\/** \\n    +     * Returns the next position of the underlying postings enum unless \\n    +     * it cannot iterate further and returns NO_MORE_POSITIONS; \\n    +     * @return \\n    +     * @throws IOException \\n    +     *\\/ \\n    +    private int nextPosition() throws IOException { \\n    +      position = nextPosition; \\n    +      startOffset = postingsEnum.startOffset(); \\n    +      endOffset = postingsEnum.endOffset(); \\n    +      if (hasMorePositions())  \\n{\\n    +        positionInc++;\\n    +        nextPosition = postingsEnum.nextPosition();\\n    +      }\\n  else  \\n{\\n    +        nextPosition = NO_MORE_POSITIONS;\\n    +      }\\n     +      return position; \\n    +    } \\n    + \\n    +  } \\n    + \\n    +  CompositePostingsEnum(BytesRef term, List&lt;PostingsEnum&gt; postingsEnums) throws IOException { \\n    +    this.term = term; \\n    +    queue = new PriorityQueue&lt;BoundsCheckingPostingsEnum&gt;(postingsEnums.size()) { \\n    +      @Override \\n    +      protected boolean lessThan(BoundsCheckingPostingsEnum a, BoundsCheckingPostingsEnum b)  \\n{\\n    +        return a.position &lt; b.position;\\n    +      }\\n     +    }; \\n    + \\n    +    int freqAdd = 0; \\n    +    for (PostingsEnum postingsEnum : postingsEnums)  \\n{\\n    +      queue.add(new BoundsCheckingPostingsEnum(postingsEnum));\\n    +      freqAdd += postingsEnum.freq();\\n    +    }\\n     +    freq = freqAdd; \\n    +  } \\n    + \\n    +  @Override \\n    +  public int freq() throws IOException  \\n{\\n    +    return freq;\\n    +  }\\n     + \\n    +  @Override \\n    +  public int nextPosition() throws IOException { \\n    +    int position = NO_MORE_POSITIONS; \\n    +    while (queue.size() &gt;= 1) { \\n    +      queue.top().nextPosition(); \\n    +      queue.updateTop(); \\/\\/the new position may be behind another postingsEnum in the queue \\n    +      position = queue.top().position; \\n    + \\n    +      if (position == NO_MORE_POSITIONS)  \\n{\\n    +        queue.pop(); \\/\\/this postingsEnum is consumed, let\'s get rid of it\\n    +      }\\n  else  \\n{\\n    +        break; \\/\\/we got a new position\\n    +      }\\n     + \\n    +    } \\n    +    return position; \\n    +  } \\n    + \\n    +  @Override \\n    +  public int startOffset() throws IOException  \\n{\\n    +    return queue.top().startOffset;\\n    +  }\\n     + \\n    +  @Override \\n    +  public int endOffset() throws IOException  \\n{\\n    +    return queue.top().endOffset;\\n    +  }\\n     + \\n    +  @Override \\n    +  public BytesRef getPayload() throws IOException  \\n{\\n    +    \\/\\/The UnifiedHighlighter depends on the payload for a wildcard\\n    +    \\/\\/being the term representing it\\n    +    return term;\\n    +  }\\n     + \\n    +  @Override \\n    +  public int docID() { \\n    +    return queue.top().postingsEnum.docID(); \\n    &#8212; End diff &#8211; \\n\\n     K              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616620\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616620&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616620\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616620_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616620_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:18:32+0000\'\u003e28\\/Oct\\/16 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85612011\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85612011\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/AnalysisOffsetStrategy.java &#8212;\u003cbr\\/\u003e\\n    @@ -17,174 +17,28 @@\u003cbr\\/\u003e\\n     package org.apache.lucene.search.uhighlight;\u003c\\/p\u003e\\n\\n\u003cp\u003e     import java.io.IOException;\u003cbr\\/\u003e\\n    -import java.util.ArrayList;\u003cbr\\/\u003e\\n    -import java.util.Arrays;\u003cbr\\/\u003e\\n    -import java.util.Collections;\u003cbr\\/\u003e\\n    -import java.util.List;\u003c\\/p\u003e\\n\\n\u003cp\u003e     import org.apache.lucene.analysis.Analyzer;\u003cbr\\/\u003e\\n    -import org.apache.lucene.analysis.FilteringTokenFilter;\u003cbr\\/\u003e\\n     import org.apache.lucene.analysis.TokenStream;\u003cbr\\/\u003e\\n    -import org.apache.lucene.analysis.tokenattributes.CharTermAttribute;\u003cbr\\/\u003e\\n    -import org.apache.lucene.index.IndexReader;\u003cbr\\/\u003e\\n    -import org.apache.lucene.index.LeafReader;\u003cbr\\/\u003e\\n    -import org.apache.lucene.index.Terms;\u003cbr\\/\u003e\\n    -import org.apache.lucene.index.memory.MemoryIndex;\u003cbr\\/\u003e\\n    -import org.apache.lucene.search.spans.SpanQuery;\u003cbr\\/\u003e\\n     import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    -import org.apache.lucene.util.automaton.Automata;\u003cbr\\/\u003e\\n     import org.apache.lucene.util.automaton.CharacterRunAutomaton;\u003c\\/p\u003e\\n\\n\u003cp\u003e    +public abstract class AnalysisOffsetStrategy extends FieldOffsetStrategy {\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    Thanks\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616620_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616620_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:18:32+0000\'\u003e28\\/Oct\\/16 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85612011  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/AnalysisOffsetStrategy.java &#8212; \\n    @@ -17,174 +17,28 @@ \\n     package org.apache.lucene.search.uhighlight; \\n\\n      import java.io.IOException; \\n    -import java.util.ArrayList; \\n    -import java.util.Arrays; \\n    -import java.util.Collections; \\n    -import java.util.List; \\n\\n      import org.apache.lucene.analysis.Analyzer; \\n    -import org.apache.lucene.analysis.FilteringTokenFilter; \\n     import org.apache.lucene.analysis.TokenStream; \\n    -import org.apache.lucene.analysis.tokenattributes.CharTermAttribute; \\n    -import org.apache.lucene.index.IndexReader; \\n    -import org.apache.lucene.index.LeafReader; \\n    -import org.apache.lucene.index.Terms; \\n    -import org.apache.lucene.index.memory.MemoryIndex; \\n    -import org.apache.lucene.search.spans.SpanQuery; \\n     import org.apache.lucene.util.BytesRef; \\n    -import org.apache.lucene.util.automaton.Automata; \\n     import org.apache.lucene.util.automaton.CharacterRunAutomaton; \\n\\n     +public abstract class AnalysisOffsetStrategy extends FieldOffsetStrategy { \\n    &#8212; End diff &#8211; \\n\\n     Thanks              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616638\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616638&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616638\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616638_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616638_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:26:34+0000\'\u003e28\\/Oct\\/16 21:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85613130\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85613130\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/FieldOffsetStrategy.java &#8212;\u003cbr\\/\u003e\\n    @@ -65,58 +65,88 @@ public String getField() {\u003cbr\\/\u003e\\n        *\\/\u003cbr\\/\u003e\\n       public abstract List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException;\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eprotected List&lt;OffsetsEnum&gt; createOffsetsEnums(LeafReader leafReader, int doc, TokenStream tokenStream) throws IOException {\u003c\\/li\u003e\\n\\t\u003cli\u003eList&lt;OffsetsEnum&gt; offsetsEnums = createOffsetsEnumsFromReader(leafReader, doc);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (automata.length &gt; 0) {\u003c\\/li\u003e\\n\\t\u003cli\u003eoffsetsEnums.add(createOffsetsEnumFromTokenStream(doc, tokenStream));\u003cbr\\/\u003e\\n    +  protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader leafReader, int doc) throws IOException {\u003cbr\\/\u003e\\n    +    final Terms termsIndex = leafReader.terms(field);\u003cbr\\/\u003e\\n    +    if (termsIndex == null) \\n{\\n    +      return Collections.emptyList();\\n         }\u003c\\/li\u003e\\n\\t\u003cli\u003ereturn offsetsEnums;\u003c\\/li\u003e\\n\\t\u003cli\u003e}\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eprotected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader atomicReader, int doc) throws IOException {\u003cbr\\/\u003e\\n         \\/\\/ For strict positions, get a Map of term to Spans:\u003cbr\\/\u003e\\n         \\/\\/    note: ScriptPhraseHelper.NONE does the right thing for these method calls\u003cbr\\/\u003e\\n         final Map&lt;BytesRef, Spans&gt; strictPhrasesTermToSpans =\u003c\\/li\u003e\\n\\t\u003cli\u003estrictPhrases.getTermToSpans(atomicReader, doc);\u003cbr\\/\u003e\\n    +        phraseHelper.getTermToSpans(leafReader, doc);\u003cbr\\/\u003e\\n         \\/\\/ Usually simply wraps terms in a List; but if willRewrite() then can be expanded\u003cbr\\/\u003e\\n         final List&lt;BytesRef&gt; sourceTerms =\u003c\\/li\u003e\\n\\t\u003cli\u003estrictPhrases.expandTermsIfRewrite(terms, strictPhrasesTermToSpans);\u003cbr\\/\u003e\\n    +        phraseHelper.expandTermsIfRewrite(terms, strictPhrasesTermToSpans);\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003efinal List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + 1);\u003cbr\\/\u003e\\n    +    final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + automata.length);\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eTerms termsIndex = atomicReader == null || sourceTerms.isEmpty() ? null : atomicReader.terms(field);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (termsIndex != null) {\u003cbr\\/\u003e\\n    +    \\/\\/ Handle sourceTerms:\u003cbr\\/\u003e\\n    +    if (!sourceTerms.isEmpty()) {\u003cbr\\/\u003e\\n           TermsEnum termsEnum = termsIndex.iterator();\\/\\/does not return null\u003cbr\\/\u003e\\n           for (BytesRef term : sourceTerms) {\u003c\\/li\u003e\\n\\t\u003cli\u003eif (!termsEnum.seekExact(term)) \\n{\\n    -          continue; \\/\\/ term not found\\n    -        }\u003c\\/li\u003e\\n\\t\u003cli\u003ePostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (postingsEnum == null) \\n{\\n    -          \\/\\/ no offsets or positions available\\n    -          throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    -        }\u003c\\/li\u003e\\n\\t\u003cli\u003eif (doc != postingsEnum.advance(doc)) { \\/\\/ now it\'s positioned, although may be exhausted\u003c\\/li\u003e\\n\\t\u003cli\u003econtinue;\u003cbr\\/\u003e\\n    +        if (termsEnum.seekExact(term)) {\u003cbr\\/\u003e\\n    +          PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS);\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +          if (postingsEnum == null) \\n{\\n    +            \\/\\/ no offsets or positions available\\n    +            throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    +          }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +          if (doc == postingsEnum.advance(doc)) \u003c\\/p\u003e\\n\u003cdiv class=\\\"error\\\"\u003e\u003cspan class=\\\"error\\\"\u003eUnknown macro: { \\/\\/ now it&#39;s positioned, although may be exhausted    +            postingsEnum = phraseHelper.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));    +            if (postingsEnum != null) {\\n    +              offsetsEnums.add(new OffsetsEnum(term, postingsEnum));\\n    +            }    +          }\u003c\\/span\u003e \u003c\\/div\u003e\\n\u003cp\u003e             }\u003c\\/p\u003e\u003c\\/li\u003e\\n\\t\u003cli\u003epostingsEnum = strictPhrases.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));\u003c\\/li\u003e\\n\\t\u003cli\u003eif (postingsEnum == null) \\n{\\n    -          continue;\\/\\/ completely filtered out\\n    +      }\\n\u003cp\u003e    +    }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    \\/\\/ Handle automata\u003cbr\\/\u003e\\n    +    if (automata.length &gt; 0) \u003c\\/p\u003e\\n{\\n    +      offsetsEnums.addAll(createAutomataOffsetsFromTerms(termsIndex, doc));\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    return offsetsEnums;\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  protected List&lt;OffsetsEnum&gt; createAutomataOffsetsFromTerms(Terms termsIndex, int doc) throws IOException {\u003cbr\\/\u003e\\n    +    Map&lt;CharacterRunAutomaton, List&lt;PostingsEnum&gt;&gt; automataPostings = new IdentityHashMap&lt;&gt;(automata.length);\u003c\\/p\u003e\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    One minor problem with that was that the code would not longer by type-safe because of the lack of generic arrays in java.  I wouldn\'t be able to do `List&lt;PostingsEnum&gt;[]` = new ArrayList&lt;PostingsEnum&gt;\u003cspan class=\\\"error\\\"\u003e&#91;automata.length&#93;\u003c\\/span\u003e;` but could do `List&lt;PostingsEnum&gt;[]` = new ArrayList\u003cspan class=\\\"error\\\"\u003e&#91;automata.length&#93;\u003c\\/span\u003e;` with unchecked casts.  Seem worth it?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616638_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616638_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:26:34+0000\'\u003e28\\/Oct\\/16 21:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85613130  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/FieldOffsetStrategy.java &#8212; \\n    @@ -65,58 +65,88 @@ public String getField() { \\n        *\\/ \\n       public abstract List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException; \\n\\n \\n\\t protected List&lt;OffsetsEnum&gt; createOffsetsEnums(LeafReader leafReader, int doc, TokenStream tokenStream) throws IOException { \\n\\t List&lt;OffsetsEnum&gt; offsetsEnums = createOffsetsEnumsFromReader(leafReader, doc); \\n\\t if (automata.length &gt; 0) { \\n\\t offsetsEnums.add(createOffsetsEnumFromTokenStream(doc, tokenStream)); \\n    +  protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader leafReader, int doc) throws IOException { \\n    +    final Terms termsIndex = leafReader.terms(field); \\n    +    if (termsIndex == null) \\n{\\n    +      return Collections.emptyList();\\n         } \\n\\t return offsetsEnums; \\n\\t } \\n \\n\\n\\n \\n\\t protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader atomicReader, int doc) throws IOException { \\n         \\/\\/ For strict positions, get a Map of term to Spans: \\n         \\/\\/    note: ScriptPhraseHelper.NONE does the right thing for these method calls \\n         final Map&lt;BytesRef, Spans&gt; strictPhrasesTermToSpans = \\n\\t strictPhrases.getTermToSpans(atomicReader, doc); \\n    +        phraseHelper.getTermToSpans(leafReader, doc); \\n         \\/\\/ Usually simply wraps terms in a List; but if willRewrite() then can be expanded \\n         final List&lt;BytesRef&gt; sourceTerms = \\n\\t strictPhrases.expandTermsIfRewrite(terms, strictPhrasesTermToSpans); \\n    +        phraseHelper.expandTermsIfRewrite(terms, strictPhrasesTermToSpans); \\n \\n\\n\\n \\n\\t final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + 1); \\n    +    final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + automata.length); \\n \\n\\n\\n \\n\\t Terms termsIndex = atomicReader == null || sourceTerms.isEmpty() ? null : atomicReader.terms(field); \\n\\t if (termsIndex != null) { \\n    +    \\/\\/ Handle sourceTerms: \\n    +    if (!sourceTerms.isEmpty()) { \\n           TermsEnum termsEnum = termsIndex.iterator();\\/\\/does not return null \\n           for (BytesRef term : sourceTerms) { \\n\\t if (!termsEnum.seekExact(term)) \\n{\\n    -          continue; \\/\\/ term not found\\n    -        } \\n\\t PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS); \\n\\t if (postingsEnum == null) \\n{\\n    -          \\/\\/ no offsets or positions available\\n    -          throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    -        } \\n\\t if (doc != postingsEnum.advance(doc)) { \\/\\/ now it\'s positioned, although may be exhausted \\n\\t continue; \\n    +        if (termsEnum.seekExact(term)) { \\n    +          PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS); \\n    + \\n    +          if (postingsEnum == null) \\n{\\n    +            \\/\\/ no offsets or positions available\\n    +            throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    +          }\\n     + \\n    +          if (doc == postingsEnum.advance(doc))  \\n  Unknown macro: { \\/\\/ now it&#39;s positioned, although may be exhausted    +            postingsEnum = phraseHelper.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));    +            if (postingsEnum != null) {\\n    +              offsetsEnums.add(new OffsetsEnum(term, postingsEnum));\\n    +            }    +          }   \\n              }  \\n\\t postingsEnum = strictPhrases.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term)); \\n\\t if (postingsEnum == null) \\n{\\n    -          continue;\\/\\/ completely filtered out\\n    +      }\\n     +    } \\n    + \\n    +    \\/\\/ Handle automata \\n    +    if (automata.length &gt; 0)  \\n{\\n    +      offsetsEnums.addAll(createAutomataOffsetsFromTerms(termsIndex, doc));\\n    +    }\\n     + \\n    +    return offsetsEnums; \\n    +  } \\n    + \\n    +  protected List&lt;OffsetsEnum&gt; createAutomataOffsetsFromTerms(Terms termsIndex, int doc) throws IOException { \\n    +    Map&lt;CharacterRunAutomaton, List&lt;PostingsEnum&gt;&gt; automataPostings = new IdentityHashMap&lt;&gt;(automata.length); \\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     One minor problem with that was that the code would not longer by type-safe because of the lack of generic arrays in java.  I wouldn\'t be able to do `List&lt;PostingsEnum&gt;[]` = new ArrayList&lt;PostingsEnum&gt; &#91;automata.length&#93; ;` but could do `List&lt;PostingsEnum&gt;[]` = new ArrayList &#91;automata.length&#93; ;` with unchecked casts.  Seem worth it?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616646\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616646&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616646\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616646_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616646_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:31:39+0000\'\u003e28\\/Oct\\/16 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85613814\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85613814\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/FieldOffsetStrategy.java &#8212;\u003cbr\\/\u003e\\n    @@ -65,58 +65,88 @@ public String getField() {\u003cbr\\/\u003e\\n        *\\/\u003cbr\\/\u003e\\n       public abstract List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException;\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eprotected List&lt;OffsetsEnum&gt; createOffsetsEnums(LeafReader leafReader, int doc, TokenStream tokenStream) throws IOException {\u003c\\/li\u003e\\n\\t\u003cli\u003eList&lt;OffsetsEnum&gt; offsetsEnums = createOffsetsEnumsFromReader(leafReader, doc);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (automata.length &gt; 0) {\u003c\\/li\u003e\\n\\t\u003cli\u003eoffsetsEnums.add(createOffsetsEnumFromTokenStream(doc, tokenStream));\u003cbr\\/\u003e\\n    +  protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader leafReader, int doc) throws IOException {\u003cbr\\/\u003e\\n    +    final Terms termsIndex = leafReader.terms(field);\u003cbr\\/\u003e\\n    +    if (termsIndex == null) \\n{\\n    +      return Collections.emptyList();\\n         }\u003c\\/li\u003e\\n\\t\u003cli\u003ereturn offsetsEnums;\u003c\\/li\u003e\\n\\t\u003cli\u003e}\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eprotected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader atomicReader, int doc) throws IOException {\u003cbr\\/\u003e\\n         \\/\\/ For strict positions, get a Map of term to Spans:\u003cbr\\/\u003e\\n         \\/\\/    note: ScriptPhraseHelper.NONE does the right thing for these method calls\u003cbr\\/\u003e\\n         final Map&lt;BytesRef, Spans&gt; strictPhrasesTermToSpans =\u003c\\/li\u003e\\n\\t\u003cli\u003estrictPhrases.getTermToSpans(atomicReader, doc);\u003cbr\\/\u003e\\n    +        phraseHelper.getTermToSpans(leafReader, doc);\u003cbr\\/\u003e\\n         \\/\\/ Usually simply wraps terms in a List; but if willRewrite() then can be expanded\u003cbr\\/\u003e\\n         final List&lt;BytesRef&gt; sourceTerms =\u003c\\/li\u003e\\n\\t\u003cli\u003estrictPhrases.expandTermsIfRewrite(terms, strictPhrasesTermToSpans);\u003cbr\\/\u003e\\n    +        phraseHelper.expandTermsIfRewrite(terms, strictPhrasesTermToSpans);\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003efinal List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + 1);\u003cbr\\/\u003e\\n    +    final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + automata.length);\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eTerms termsIndex = atomicReader == null || sourceTerms.isEmpty() ? null : atomicReader.terms(field);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (termsIndex != null) {\u003cbr\\/\u003e\\n    +    \\/\\/ Handle sourceTerms:\u003cbr\\/\u003e\\n    +    if (!sourceTerms.isEmpty()) {\u003cbr\\/\u003e\\n           TermsEnum termsEnum = termsIndex.iterator();\\/\\/does not return null\u003cbr\\/\u003e\\n           for (BytesRef term : sourceTerms) {\u003c\\/li\u003e\\n\\t\u003cli\u003eif (!termsEnum.seekExact(term)) \\n{\\n    -          continue; \\/\\/ term not found\\n    -        }\u003c\\/li\u003e\\n\\t\u003cli\u003ePostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (postingsEnum == null) \\n{\\n    -          \\/\\/ no offsets or positions available\\n    -          throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    -        }\u003c\\/li\u003e\\n\\t\u003cli\u003eif (doc != postingsEnum.advance(doc)) { \\/\\/ now it\'s positioned, although may be exhausted\u003c\\/li\u003e\\n\\t\u003cli\u003econtinue;\u003cbr\\/\u003e\\n    +        if (termsEnum.seekExact(term)) {\u003cbr\\/\u003e\\n    +          PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS);\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +          if (postingsEnum == null) \\n{\\n    +            \\/\\/ no offsets or positions available\\n    +            throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    +          }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +          if (doc == postingsEnum.advance(doc)) \u003c\\/p\u003e\\n\u003cdiv class=\\\"error\\\"\u003e\u003cspan class=\\\"error\\\"\u003eUnknown macro: { \\/\\/ now it&#39;s positioned, although may be exhausted    +            postingsEnum = phraseHelper.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));    +            if (postingsEnum != null) {\\n    +              offsetsEnums.add(new OffsetsEnum(term, postingsEnum));\\n    +            }    +          }\u003c\\/span\u003e \u003c\\/div\u003e\\n\u003cp\u003e             }\u003c\\/p\u003e\u003c\\/li\u003e\\n\\t\u003cli\u003epostingsEnum = strictPhrases.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));\u003c\\/li\u003e\\n\\t\u003cli\u003eif (postingsEnum == null) \\n{\\n    -          continue;\\/\\/ completely filtered out\\n    +      }\\n\u003cp\u003e    +    }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    \\/\\/ Handle automata\u003cbr\\/\u003e\\n    +    if (automata.length &gt; 0) \u003c\\/p\u003e\\n{\\n    +      offsetsEnums.addAll(createAutomataOffsetsFromTerms(termsIndex, doc));\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    return offsetsEnums;\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  protected List&lt;OffsetsEnum&gt; createAutomataOffsetsFromTerms(Terms termsIndex, int doc) throws IOException {\u003cbr\\/\u003e\\n    +    Map&lt;CharacterRunAutomaton, List&lt;PostingsEnum&gt;&gt; automataPostings = new IdentityHashMap&lt;&gt;(automata.length);\u003c\\/p\u003e\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    How about List&lt;List&lt;PostingsEnum&gt;&gt; that should give better locality without lose of type safety?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616646_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616646_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:31:39+0000\'\u003e28\\/Oct\\/16 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85613814  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/FieldOffsetStrategy.java &#8212; \\n    @@ -65,58 +65,88 @@ public String getField() { \\n        *\\/ \\n       public abstract List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException; \\n\\n \\n\\t protected List&lt;OffsetsEnum&gt; createOffsetsEnums(LeafReader leafReader, int doc, TokenStream tokenStream) throws IOException { \\n\\t List&lt;OffsetsEnum&gt; offsetsEnums = createOffsetsEnumsFromReader(leafReader, doc); \\n\\t if (automata.length &gt; 0) { \\n\\t offsetsEnums.add(createOffsetsEnumFromTokenStream(doc, tokenStream)); \\n    +  protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader leafReader, int doc) throws IOException { \\n    +    final Terms termsIndex = leafReader.terms(field); \\n    +    if (termsIndex == null) \\n{\\n    +      return Collections.emptyList();\\n         } \\n\\t return offsetsEnums; \\n\\t } \\n \\n\\n\\n \\n\\t protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader atomicReader, int doc) throws IOException { \\n         \\/\\/ For strict positions, get a Map of term to Spans: \\n         \\/\\/    note: ScriptPhraseHelper.NONE does the right thing for these method calls \\n         final Map&lt;BytesRef, Spans&gt; strictPhrasesTermToSpans = \\n\\t strictPhrases.getTermToSpans(atomicReader, doc); \\n    +        phraseHelper.getTermToSpans(leafReader, doc); \\n         \\/\\/ Usually simply wraps terms in a List; but if willRewrite() then can be expanded \\n         final List&lt;BytesRef&gt; sourceTerms = \\n\\t strictPhrases.expandTermsIfRewrite(terms, strictPhrasesTermToSpans); \\n    +        phraseHelper.expandTermsIfRewrite(terms, strictPhrasesTermToSpans); \\n \\n\\n\\n \\n\\t final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + 1); \\n    +    final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + automata.length); \\n \\n\\n\\n \\n\\t Terms termsIndex = atomicReader == null || sourceTerms.isEmpty() ? null : atomicReader.terms(field); \\n\\t if (termsIndex != null) { \\n    +    \\/\\/ Handle sourceTerms: \\n    +    if (!sourceTerms.isEmpty()) { \\n           TermsEnum termsEnum = termsIndex.iterator();\\/\\/does not return null \\n           for (BytesRef term : sourceTerms) { \\n\\t if (!termsEnum.seekExact(term)) \\n{\\n    -          continue; \\/\\/ term not found\\n    -        } \\n\\t PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS); \\n\\t if (postingsEnum == null) \\n{\\n    -          \\/\\/ no offsets or positions available\\n    -          throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    -        } \\n\\t if (doc != postingsEnum.advance(doc)) { \\/\\/ now it\'s positioned, although may be exhausted \\n\\t continue; \\n    +        if (termsEnum.seekExact(term)) { \\n    +          PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS); \\n    + \\n    +          if (postingsEnum == null) \\n{\\n    +            \\/\\/ no offsets or positions available\\n    +            throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    +          }\\n     + \\n    +          if (doc == postingsEnum.advance(doc))  \\n  Unknown macro: { \\/\\/ now it&#39;s positioned, although may be exhausted    +            postingsEnum = phraseHelper.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));    +            if (postingsEnum != null) {\\n    +              offsetsEnums.add(new OffsetsEnum(term, postingsEnum));\\n    +            }    +          }   \\n              }  \\n\\t postingsEnum = strictPhrases.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term)); \\n\\t if (postingsEnum == null) \\n{\\n    -          continue;\\/\\/ completely filtered out\\n    +      }\\n     +    } \\n    + \\n    +    \\/\\/ Handle automata \\n    +    if (automata.length &gt; 0)  \\n{\\n    +      offsetsEnums.addAll(createAutomataOffsetsFromTerms(termsIndex, doc));\\n    +    }\\n     + \\n    +    return offsetsEnums; \\n    +  } \\n    + \\n    +  protected List&lt;OffsetsEnum&gt; createAutomataOffsetsFromTerms(Terms termsIndex, int doc) throws IOException { \\n    +    Map&lt;CharacterRunAutomaton, List&lt;PostingsEnum&gt;&gt; automataPostings = new IdentityHashMap&lt;&gt;(automata.length); \\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     How about List&lt;List&lt;PostingsEnum&gt;&gt; that should give better locality without lose of type safety?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616654\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616654&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616654\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616654_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616654_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:35:30+0000\'\u003e28\\/Oct\\/16 21:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85614277\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85614277\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/test\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/visibility\\/TestUnifiedHighlighterExtensibility.java &#8212;\u003cbr\\/\u003e\\n    @@ -79,7 +90,7 @@ public void testFieldOffsetStrategyExtensibility() {\u003cbr\\/\u003e\\n       @Test\u003cbr\\/\u003e\\n       public void testUnifiedHighlighterExtensibility() {\u003cbr\\/\u003e\\n         final int maxLength = 1000;\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eUnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(random())){\u003cbr\\/\u003e\\n    +    UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(new Random())){\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    fixed\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616654_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616654_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:35:30+0000\'\u003e28\\/Oct\\/16 21:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85614277  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/test\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/visibility\\/TestUnifiedHighlighterExtensibility.java &#8212; \\n    @@ -79,7 +90,7 @@ public void testFieldOffsetStrategyExtensibility() { \\n       @Test \\n       public void testUnifiedHighlighterExtensibility() { \\n         final int maxLength = 1000; \\n \\n\\t UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(random())){ \\n    +    UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(new Random())){\\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     fixed              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616710\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616710&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616710\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616710_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616710_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:53:49+0000\'\u003e28\\/Oct\\/16 21:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85616651\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85616651\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/test\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/visibility\\/TestUnifiedHighlighterExtensibility.java &#8212;\u003cbr\\/\u003e\\n    @@ -79,7 +90,7 @@ public void testFieldOffsetStrategyExtensibility() {\u003cbr\\/\u003e\\n       @Test\u003cbr\\/\u003e\\n       public void testUnifiedHighlighterExtensibility() {\u003cbr\\/\u003e\\n         final int maxLength = 1000;\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eUnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(random())){\u003cbr\\/\u003e\\n    +    UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(new Random())){\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    I recall now why I changed it.  I started getting this error and figured it was a change elsewhere: java.lang.IllegalStateException: No context information for thread: Thread\u003cspan class=\\\"error\\\"\u003e&#91;id=1, name=main, state=RUNNABLE, group=main&#93;\u003c\\/span\u003e. Is this thread running under a class com.carrotsearch.randomizedtesting.RandomizedRunner runner context? Add @RunWith(class com.carrotsearch.randomizedtesting.RandomizedRunner.class) to your test class. Make sure your code accesses random contexts within @BeforeClass and @AfterClass boundary (for example, static test class initializers are not permitted to access random contexts).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616710_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616710_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:53:49+0000\'\u003e28\\/Oct\\/16 21:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85616651  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/test\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/visibility\\/TestUnifiedHighlighterExtensibility.java &#8212; \\n    @@ -79,7 +90,7 @@ public void testFieldOffsetStrategyExtensibility() { \\n       @Test \\n       public void testUnifiedHighlighterExtensibility() { \\n         final int maxLength = 1000; \\n \\n\\t UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(random())){ \\n    +    UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(new Random())){\\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     I recall now why I changed it.  I started getting this error and figured it was a change elsewhere: java.lang.IllegalStateException: No context information for thread: Thread &#91;id=1, name=main, state=RUNNABLE, group=main&#93; . Is this thread running under a class com.carrotsearch.randomizedtesting.RandomizedRunner runner context? Add @RunWith(class com.carrotsearch.randomizedtesting.RandomizedRunner.class) to your test class. Make sure your code accesses random contexts within @BeforeClass and @AfterClass boundary (for example, static test class initializers are not permitted to access random contexts).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616715\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616715&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616715\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616715_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616715_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:55:43+0000\'\u003e28\\/Oct\\/16 21:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85616894\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85616894\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/test\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/visibility\\/TestUnifiedHighlighterExtensibility.java &#8212;\u003cbr\\/\u003e\\n    @@ -79,7 +90,7 @@ public void testFieldOffsetStrategyExtensibility() {\u003cbr\\/\u003e\\n       @Test\u003cbr\\/\u003e\\n       public void testUnifiedHighlighterExtensibility() {\u003cbr\\/\u003e\\n         final int maxLength = 1000;\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eUnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(random())){\u003cbr\\/\u003e\\n    +    UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(new Random())){\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    I\'m a bit confused.  What I should I change?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616715_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616715_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:55:43+0000\'\u003e28\\/Oct\\/16 21:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85616894  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/test\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/visibility\\/TestUnifiedHighlighterExtensibility.java &#8212; \\n    @@ -79,7 +90,7 @@ public void testFieldOffsetStrategyExtensibility() { \\n       @Test \\n       public void testUnifiedHighlighterExtensibility() { \\n         final int maxLength = 1000; \\n \\n\\t UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(random())){ \\n    +    UnifiedHighlighter uh = new UnifiedHighlighter(null, new MockAnalyzer(new Random())){\\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     I\'m a bit confused.  What I should I change?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616723\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616723&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616723\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616723_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616723_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:59:47+0000\'\u003e28\\/Oct\\/16 21:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    I\'ve pushed some more changes now.  Still taking a look at what we might be able to do further with CompositePostingsEnum\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616723_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616723_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 21:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T21:59:47+0000\'\u003e28\\/Oct\\/16 21:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     I\'ve pushed some more changes now.  Still taking a look at what we might be able to do further with CompositePostingsEnum              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616738\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616738&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616738\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616738_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616738_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 22:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T22:08:09+0000\'\u003e28\\/Oct\\/16 22:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85618489\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85618489\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212;\u003cbr\\/\u003e\\n    @@ -0,0 +1,165 @@\u003cbr\\/\u003e\\n    +\\/*\u003cbr\\/\u003e\\n    + * Licensed to the Apache Software Foundation (ASF) under one or more\u003cbr\\/\u003e\\n    + * contributor license agreements.  See the NOTICE file distributed with\u003cbr\\/\u003e\\n    + * this work for additional information regarding copyright ownership.\u003cbr\\/\u003e\\n    + * The ASF licenses this file to You under the Apache License, Version 2.0\u003cbr\\/\u003e\\n    + * (the \\\"License\\\"); you may not use this file except in compliance with\u003cbr\\/\u003e\\n    + * the License.  You may obtain a copy of the License at\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + *     \u003ca href=\\\"http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0\u003c\\/a\u003e\u003cbr\\/\u003e\\n    + *\u003cbr\\/\u003e\\n    + * Unless required by applicable law or agreed to in writing, software\u003cbr\\/\u003e\\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\u003cbr\\/\u003e\\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\u003cbr\\/\u003e\\n    + * See the License for the specific language governing permissions and\u003cbr\\/\u003e\\n    + * limitations under the License.\u003cbr\\/\u003e\\n    + *\\/\u003cbr\\/\u003e\\n    +package org.apache.lucene.search.uhighlight;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import java.io.IOException;\u003cbr\\/\u003e\\n    +import java.util.List;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +import org.apache.lucene.index.PostingsEnum;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.BytesRef;\u003cbr\\/\u003e\\n    +import org.apache.lucene.util.PriorityQueue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +final class CompositePostingsEnum extends PostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  private static final int NO_MORE_POSITIONS = -2;\u003cbr\\/\u003e\\n    +  private final BytesRef term;\u003cbr\\/\u003e\\n    +  private final int freq;\u003cbr\\/\u003e\\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue;\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  \\/**\u003cbr\\/\u003e\\n    +   * This class is used to ensure we don\'t over iterate the underlying\u003cbr\\/\u003e\\n    +   * postings enum by keeping track of the position relative to the\u003cbr\\/\u003e\\n    +   * frequency.\u003cbr\\/\u003e\\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum\u003cbr\\/\u003e\\n    +   * but it would have to delegate most methods and it seemed easier\u003cbr\\/\u003e\\n    +   * to just wrap the tweaked method.\u003cbr\\/\u003e\\n    +   *\\/\u003cbr\\/\u003e\\n    +  private static final class BoundsCheckingPostingsEnum {\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    private final PostingsEnum postingsEnum;\u003cbr\\/\u003e\\n    +    private final int freq;\u003cbr\\/\u003e\\n    &#8212; End diff &#8211;\u003c\\/p\u003e\\n\\n\u003cp\u003e    Hmm, did you mean to calculate freq dynamically in the method and just use a remainingPositions count as walking over the postings? Instead of re-computing it\'s cached in the constructor, but if we modified it, the freq count would change as the postings were iterated.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616738_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616738_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 22:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T22:08:09+0000\'\u003e28\\/Oct\\/16 22:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85618489  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/CompositePostingsEnum.java &#8212; \\n    @@ -0,0 +1,165 @@ \\n    +\\/* \\n    + * Licensed to the Apache Software Foundation (ASF) under one or more \\n    + * contributor license agreements.  See the NOTICE file distributed with \\n    + * this work for additional information regarding copyright ownership. \\n    + * The ASF licenses this file to You under the Apache License, Version 2.0 \\n    + * (the \\\"License\\\"); you may not use this file except in compliance with \\n    + * the License.  You may obtain a copy of the License at \\n    + * \\n    + *      http:\\/\\/www.apache.org\\/licenses\\/LICENSE-2.0  \\n    + * \\n    + * Unless required by applicable law or agreed to in writing, software \\n    + * distributed under the License is distributed on an \\\"AS IS\\\" BASIS, \\n    + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. \\n    + * See the License for the specific language governing permissions and \\n    + * limitations under the License. \\n    + *\\/ \\n    +package org.apache.lucene.search.uhighlight; \\n    + \\n    +import java.io.IOException; \\n    +import java.util.List; \\n    + \\n    +import org.apache.lucene.index.PostingsEnum; \\n    +import org.apache.lucene.util.BytesRef; \\n    +import org.apache.lucene.util.PriorityQueue; \\n    + \\n    + \\n    +final class CompositePostingsEnum extends PostingsEnum { \\n    + \\n    +  private static final int NO_MORE_POSITIONS = -2; \\n    +  private final BytesRef term; \\n    +  private final int freq; \\n    +  private final PriorityQueue&lt;BoundsCheckingPostingsEnum&gt; queue; \\n    + \\n    + \\n    +  \\/** \\n    +   * This class is used to ensure we don\'t over iterate the underlying \\n    +   * postings enum by keeping track of the position relative to the \\n    +   * frequency. \\n    +   * Ideally this would\'ve been an implementation of a PostingsEnum \\n    +   * but it would have to delegate most methods and it seemed easier \\n    +   * to just wrap the tweaked method. \\n    +   *\\/ \\n    +  private static final class BoundsCheckingPostingsEnum { \\n    + \\n    + \\n    +    private final PostingsEnum postingsEnum; \\n    +    private final int freq; \\n    &#8212; End diff &#8211; \\n\\n     Hmm, did you mean to calculate freq dynamically in the method and just use a remainingPositions count as walking over the postings? Instead of re-computing it\'s cached in the constructor, but if we modified it, the freq count would change as the postings were iterated.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15616778\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15616778&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15616778\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616778_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616778_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 22:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T22:22:29+0000\'\u003e28\\/Oct\\/16 22:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on a diff in the pull request:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85619786\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85619786\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/FieldOffsetStrategy.java &#8212;\u003cbr\\/\u003e\\n    @@ -65,58 +65,88 @@ public String getField() {\u003cbr\\/\u003e\\n        *\\/\u003cbr\\/\u003e\\n       public abstract List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException;\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eprotected List&lt;OffsetsEnum&gt; createOffsetsEnums(LeafReader leafReader, int doc, TokenStream tokenStream) throws IOException {\u003c\\/li\u003e\\n\\t\u003cli\u003eList&lt;OffsetsEnum&gt; offsetsEnums = createOffsetsEnumsFromReader(leafReader, doc);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (automata.length &gt; 0) {\u003c\\/li\u003e\\n\\t\u003cli\u003eoffsetsEnums.add(createOffsetsEnumFromTokenStream(doc, tokenStream));\u003cbr\\/\u003e\\n    +  protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader leafReader, int doc) throws IOException {\u003cbr\\/\u003e\\n    +    final Terms termsIndex = leafReader.terms(field);\u003cbr\\/\u003e\\n    +    if (termsIndex == null) \\n{\\n    +      return Collections.emptyList();\\n         }\u003c\\/li\u003e\\n\\t\u003cli\u003ereturn offsetsEnums;\u003c\\/li\u003e\\n\\t\u003cli\u003e}\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eprotected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader atomicReader, int doc) throws IOException {\u003cbr\\/\u003e\\n         \\/\\/ For strict positions, get a Map of term to Spans:\u003cbr\\/\u003e\\n         \\/\\/    note: ScriptPhraseHelper.NONE does the right thing for these method calls\u003cbr\\/\u003e\\n         final Map&lt;BytesRef, Spans&gt; strictPhrasesTermToSpans =\u003c\\/li\u003e\\n\\t\u003cli\u003estrictPhrases.getTermToSpans(atomicReader, doc);\u003cbr\\/\u003e\\n    +        phraseHelper.getTermToSpans(leafReader, doc);\u003cbr\\/\u003e\\n         \\/\\/ Usually simply wraps terms in a List; but if willRewrite() then can be expanded\u003cbr\\/\u003e\\n         final List&lt;BytesRef&gt; sourceTerms =\u003c\\/li\u003e\\n\\t\u003cli\u003estrictPhrases.expandTermsIfRewrite(terms, strictPhrasesTermToSpans);\u003cbr\\/\u003e\\n    +        phraseHelper.expandTermsIfRewrite(terms, strictPhrasesTermToSpans);\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003efinal List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + 1);\u003cbr\\/\u003e\\n    +    final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + automata.length);\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eTerms termsIndex = atomicReader == null || sourceTerms.isEmpty() ? null : atomicReader.terms(field);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (termsIndex != null) {\u003cbr\\/\u003e\\n    +    \\/\\/ Handle sourceTerms:\u003cbr\\/\u003e\\n    +    if (!sourceTerms.isEmpty()) {\u003cbr\\/\u003e\\n           TermsEnum termsEnum = termsIndex.iterator();\\/\\/does not return null\u003cbr\\/\u003e\\n           for (BytesRef term : sourceTerms) {\u003c\\/li\u003e\\n\\t\u003cli\u003eif (!termsEnum.seekExact(term)) \\n{\\n    -          continue; \\/\\/ term not found\\n    -        }\u003c\\/li\u003e\\n\\t\u003cli\u003ePostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS);\u003c\\/li\u003e\\n\\t\u003cli\u003eif (postingsEnum == null) \\n{\\n    -          \\/\\/ no offsets or positions available\\n    -          throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    -        }\u003c\\/li\u003e\\n\\t\u003cli\u003eif (doc != postingsEnum.advance(doc)) { \\/\\/ now it\'s positioned, although may be exhausted\u003c\\/li\u003e\\n\\t\u003cli\u003econtinue;\u003cbr\\/\u003e\\n    +        if (termsEnum.seekExact(term)) {\u003cbr\\/\u003e\\n    +          PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS);\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +          if (postingsEnum == null) \\n{\\n    +            \\/\\/ no offsets or positions available\\n    +            throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    +          }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +          if (doc == postingsEnum.advance(doc)) \u003c\\/p\u003e\\n\u003cdiv class=\\\"error\\\"\u003e\u003cspan class=\\\"error\\\"\u003eUnknown macro: { \\/\\/ now it&#39;s positioned, although may be exhausted    +            postingsEnum = phraseHelper.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));    +            if (postingsEnum != null) {\\n    +              offsetsEnums.add(new OffsetsEnum(term, postingsEnum));\\n    +            }    +          }\u003c\\/span\u003e \u003c\\/div\u003e\\n\u003cp\u003e             }\u003c\\/p\u003e\u003c\\/li\u003e\\n\\t\u003cli\u003epostingsEnum = strictPhrases.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));\u003c\\/li\u003e\\n\\t\u003cli\u003eif (postingsEnum == null) \\n{\\n    -          continue;\\/\\/ completely filtered out\\n    +      }\\n\u003cp\u003e    +    }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +    \\/\\/ Handle automata\u003cbr\\/\u003e\\n    +    if (automata.length &gt; 0) \u003c\\/p\u003e\\n{\\n    +      offsetsEnums.addAll(createAutomataOffsetsFromTerms(termsIndex, doc));\\n    +    }\\n\u003cp\u003e    +\u003cbr\\/\u003e\\n    +    return offsetsEnums;\u003cbr\\/\u003e\\n    +  }\u003cbr\\/\u003e\\n    +\u003cbr\\/\u003e\\n    +  protected List&lt;OffsetsEnum&gt; createAutomataOffsetsFromTerms(Terms termsIndex, int doc) throws IOException {\u003cbr\\/\u003e\\n    +    Map&lt;CharacterRunAutomaton, List&lt;PostingsEnum&gt;&gt; automataPostings = new IdentityHashMap&lt;&gt;(automata.length);\u003c\\/p\u003e\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\\t\u003cli\u003eEnd diff &#8211;\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e    Pushed that for now to see what you think.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15616778_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15616778_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Oct\\/16 22:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-28T22:22:29+0000\'\u003e28\\/Oct\\/16 22:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on a diff in the pull request: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105#discussion_r85619786  \\n\\n     &#8212; Diff: lucene\\/highlighter\\/src\\/java\\/org\\/apache\\/lucene\\/search\\/uhighlight\\/FieldOffsetStrategy.java &#8212; \\n    @@ -65,58 +65,88 @@ public String getField() { \\n        *\\/ \\n       public abstract List&lt;OffsetsEnum&gt; getOffsetsEnums(IndexReader reader, int docId, String content) throws IOException; \\n\\n \\n\\t protected List&lt;OffsetsEnum&gt; createOffsetsEnums(LeafReader leafReader, int doc, TokenStream tokenStream) throws IOException { \\n\\t List&lt;OffsetsEnum&gt; offsetsEnums = createOffsetsEnumsFromReader(leafReader, doc); \\n\\t if (automata.length &gt; 0) { \\n\\t offsetsEnums.add(createOffsetsEnumFromTokenStream(doc, tokenStream)); \\n    +  protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader leafReader, int doc) throws IOException { \\n    +    final Terms termsIndex = leafReader.terms(field); \\n    +    if (termsIndex == null) \\n{\\n    +      return Collections.emptyList();\\n         } \\n\\t return offsetsEnums; \\n\\t } \\n \\n\\n\\n \\n\\t protected List&lt;OffsetsEnum&gt; createOffsetsEnumsFromReader(LeafReader atomicReader, int doc) throws IOException { \\n         \\/\\/ For strict positions, get a Map of term to Spans: \\n         \\/\\/    note: ScriptPhraseHelper.NONE does the right thing for these method calls \\n         final Map&lt;BytesRef, Spans&gt; strictPhrasesTermToSpans = \\n\\t strictPhrases.getTermToSpans(atomicReader, doc); \\n    +        phraseHelper.getTermToSpans(leafReader, doc); \\n         \\/\\/ Usually simply wraps terms in a List; but if willRewrite() then can be expanded \\n         final List&lt;BytesRef&gt; sourceTerms = \\n\\t strictPhrases.expandTermsIfRewrite(terms, strictPhrasesTermToSpans); \\n    +        phraseHelper.expandTermsIfRewrite(terms, strictPhrasesTermToSpans); \\n \\n\\n\\n \\n\\t final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + 1); \\n    +    final List&lt;OffsetsEnum&gt; offsetsEnums = new ArrayList&lt;&gt;(sourceTerms.size() + automata.length); \\n \\n\\n\\n \\n\\t Terms termsIndex = atomicReader == null || sourceTerms.isEmpty() ? null : atomicReader.terms(field); \\n\\t if (termsIndex != null) { \\n    +    \\/\\/ Handle sourceTerms: \\n    +    if (!sourceTerms.isEmpty()) { \\n           TermsEnum termsEnum = termsIndex.iterator();\\/\\/does not return null \\n           for (BytesRef term : sourceTerms) { \\n\\t if (!termsEnum.seekExact(term)) \\n{\\n    -          continue; \\/\\/ term not found\\n    -        } \\n\\t PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS); \\n\\t if (postingsEnum == null) \\n{\\n    -          \\/\\/ no offsets or positions available\\n    -          throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    -        } \\n\\t if (doc != postingsEnum.advance(doc)) { \\/\\/ now it\'s positioned, although may be exhausted \\n\\t continue; \\n    +        if (termsEnum.seekExact(term)) { \\n    +          PostingsEnum postingsEnum = termsEnum.postings(null, PostingsEnum.OFFSETS); \\n    + \\n    +          if (postingsEnum == null) \\n{\\n    +            \\/\\/ no offsets or positions available\\n    +            throw new IllegalArgumentException(\\\"field \'\\\" + field + \\\"\' was indexed without offsets, cannot highlight\\\");\\n    +          }\\n     + \\n    +          if (doc == postingsEnum.advance(doc))  \\n  Unknown macro: { \\/\\/ now it&#39;s positioned, although may be exhausted    +            postingsEnum = phraseHelper.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term));    +            if (postingsEnum != null) {\\n    +              offsetsEnums.add(new OffsetsEnum(term, postingsEnum));\\n    +            }    +          }   \\n              }  \\n\\t postingsEnum = strictPhrases.filterPostings(term, postingsEnum, strictPhrasesTermToSpans.get(term)); \\n\\t if (postingsEnum == null) \\n{\\n    -          continue;\\/\\/ completely filtered out\\n    +      }\\n     +    } \\n    + \\n    +    \\/\\/ Handle automata \\n    +    if (automata.length &gt; 0)  \\n{\\n    +      offsetsEnums.addAll(createAutomataOffsetsFromTerms(termsIndex, doc));\\n    +    }\\n     + \\n    +    return offsetsEnums; \\n    +  } \\n    + \\n    +  protected List&lt;OffsetsEnum&gt; createAutomataOffsetsFromTerms(Terms termsIndex, int doc) throws IOException { \\n    +    Map&lt;CharacterRunAutomaton, List&lt;PostingsEnum&gt;&gt; automataPostings = new IdentityHashMap&lt;&gt;(automata.length); \\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t End diff &#8211; \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n     Pushed that for now to see what you think.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15618320\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15618320&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15618320\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15618320_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15618320_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/16 15:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-29T15:46:28+0000\'\u003e29\\/Oct\\/16 15:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    I don\'t think there\'s a way to avoid keeping the position state, unfortunately.  The reason is that we can move one of the postings enums to the next position, but then realize the next position for that term is behind the position for a different term (and postings enum) that also matches the wildcard.  Then we\'ll update the top and switch to the next postings enum (by offset now), but once it\'s exhausted or we switch back to the previous one from interleaving the position is lost.  :\\/  An alternative to avoid this would be to change PostingsEnum to allow fetching of the currentPosition, then nearly all the house keeping would go away.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15618320_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15618320_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/16 15:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-29T15:46:28+0000\'\u003e29\\/Oct\\/16 15:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     I don\'t think there\'s a way to avoid keeping the position state, unfortunately.  The reason is that we can move one of the postings enums to the next position, but then realize the next position for that term is behind the position for a different term (and postings enum) that also matches the wildcard.  Then we\'ll update the top and switch to the next postings enum (by offset now), but once it\'s exhausted or we switch back to the previous one from interleaving the position is lost.  :\\/  An alternative to avoid this would be to change PostingsEnum to allow fetching of the currentPosition, then nearly all the house keeping would go away.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15618483\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15618483&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15618483\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15618483_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15618483_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/16 17:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-29T17:42:25+0000\'\u003e29\\/Oct\\/16 17:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    I started playing with a bit and realized the same thing.  It looks straight-forward but it\'s deceptively more complicated.  Then it hit me &#8211; lets not try to return the correct position at all!  A \\\"normal\\\" PostingsEnum should but this one is \u003cem\u003eonly\u003c\\/em\u003e used for offsets.  So always return -1 &#8211; we can get away with it for this internal use.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15618483_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15618483_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/16 17:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-29T17:42:25+0000\'\u003e29\\/Oct\\/16 17:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     I started playing with a bit and realized the same thing.  It looks straight-forward but it\'s deceptively more complicated.  Then it hit me &#8211; lets not try to return the correct position at all!  A \\\"normal\\\" PostingsEnum should but this one is  only  used for offsets.  So always return -1 &#8211; we can get away with it for this internal use.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15618647\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15618647&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15618647\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15618647_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15618647_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/16 19:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-29T19:58:50+0000\'\u003e29\\/Oct\\/16 19:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    Hmm, clever! But not sure I find it very clean though.  I feel like that can lead to trouble down the road if code ever expects the offsets to be ordered.  If we went that route we wouldn\'t even need the priority queue though.  Btw, I MultiTermHighlighting is nearly gone except for one method that is used in the UnifiedHighlighter and MemoryIndexOffsetStrategy for extracting automata from a query.  Any ideas on good ways to move it? Perhaps the UnifiedHighlighter should do all automata extraction and pass that in? \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15618647_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15618647_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/16 19:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-29T19:58:50+0000\'\u003e29\\/Oct\\/16 19:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     Hmm, clever! But not sure I find it very clean though.  I feel like that can lead to trouble down the road if code ever expects the offsets to be ordered.  If we went that route we wouldn\'t even need the priority queue though.  Btw, I MultiTermHighlighting is nearly gone except for one method that is used in the UnifiedHighlighter and MemoryIndexOffsetStrategy for extracting automata from a query.  Any ideas on good ways to move it? Perhaps the UnifiedHighlighter should do all automata extraction and pass that in?               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15619010\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15619010&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15619010\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15619010_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15619010_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Oct\\/16 01:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-30T01:09:32+0000\'\u003e30\\/Oct\\/16 01:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    Check it out: \u003ca href=\\\"https:\\/\\/github.com\\/dsmiley\\/lucene-solr\\/commit\\/50e2ea89c7eb15c863aa6e04e14fd32085ee85bd\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/dsmiley\\/lucene-solr\\/commit\\/50e2ea89c7eb15c863aa6e04e14fd32085ee85bd\u003c\\/a\u003e\u003cbr\\/\u003e\\n    Remember this is a package-private class internal to the UnifiedHighlighter.  Not completely implementing an interface if the caller won\'t care is okay.\u003c\\/p\u003e\\n\\n\u003cp\u003e    RE MultiTermHighlighting: I think it\'s fine as-is.  The UH class is very long to adopt this &#8211; too long as it is IMO.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15619010_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15619010_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Oct\\/16 01:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-10-30T01:09:32+0000\'\u003e30\\/Oct\\/16 01:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     Check it out:  https:\\/\\/github.com\\/dsmiley\\/lucene-solr\\/commit\\/50e2ea89c7eb15c863aa6e04e14fd32085ee85bd  \\n    Remember this is a package-private class internal to the UnifiedHighlighter.  Not completely implementing an interface if the caller won\'t care is okay. \\n\\n     RE MultiTermHighlighting: I think it\'s fine as-is.  The UH class is very long to adopt this &#8211; too long as it is IMO.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15628823\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15628823&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15628823\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628823_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628823_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:37:14+0000\'\u003e02\\/Nov\\/16 12:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    Hmm, I know we\'re already knowingly breaking the PostingsEnum contract, but rather than throwing a IllegaStateException, maybe we could still return positions, they just happen to be unordered, that way when the final position is exhausted we return -1 as the sentinel value still?  Otherwise, I\'m good with this, I\'ll merge in.  Btw, we\'ve seen other needs for something like a CompositePostingsEnum that abstracts over a set of terms, but since this is still internal, dropping the house-keeping will also make this code do less. We can always try to cross that bridge later.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628823_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628823_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:37:14+0000\'\u003e02\\/Nov\\/16 12:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     Hmm, I know we\'re already knowingly breaking the PostingsEnum contract, but rather than throwing a IllegaStateException, maybe we could still return positions, they just happen to be unordered, that way when the final position is exhausted we return -1 as the sentinel value still?  Otherwise, I\'m good with this, I\'ll merge in.  Btw, we\'ve seen other needs for something like a CompositePostingsEnum that abstracts over a set of terms, but since this is still internal, dropping the house-keeping will also make this code do less. We can always try to cross that bridge later.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15628844\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15628844&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15628844\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628844_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628844_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:43:33+0000\'\u003e02\\/Nov\\/16 12:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    Forget it, you can\'t do that because the next position on one enum might be -1, but there\'s more enums left in the queue so the user of this class could inadvertently terminate early if looking for -1.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628844_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628844_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:43:33+0000\'\u003e02\\/Nov\\/16 12:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     Forget it, you can\'t do that because the next position on one enum might be -1, but there\'s more enums left in the queue so the user of this class could inadvertently terminate early if looking for -1.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15628847\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15628847&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15628847\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628847_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628847_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:44:01+0000\'\u003e02\\/Nov\\/16 12:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    Merged your commit.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628847_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628847_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:44:01+0000\'\u003e02\\/Nov\\/16 12:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     Merged your commit.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15628861\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15628861&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15628861\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628861_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628861_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:48:12+0000\'\u003e02\\/Nov\\/16 12:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003cem\u003e(I wrote this as you made your last comments, but rather than delete it I\'ll comment any way)\u003c\\/em\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    The documentation for `PostingsEnum.nextPosition()` states that calling it more than `freq()` times is undefined.  Thus it\'s quite valid to throw an IllegalStateException.\u003c\\/p\u003e\\n\\n\u003cp\u003e    &gt; Btw, we\'ve seen other needs for something like a CompositePostingsEnum that abstracts over a set of terms, but since this is still internal, dropping the house-keeping will also make this code do less. \u003c\\/p\u003e\\n\\n\u003cp\u003e    I don\'t think I quite get what you\'re saying.  By \\\"other needs\\\" do you mean Bloomberg internally?  If so, how would that relate this this one inside the UH?  Are you advocating a general purpose Multi-PosrtingsEnum?  On the latter... a highlighter wouldn\'t be where to introduce such a thing.  There is a `org.apache.lucene.index.MultiPostingsEnum` which I looked at while at the Lucene hackday code sprint as it got my curiosity.  Unfortunately, it doesn\'t seem quite general purpose enough for us to use &#8211; it demands a MultiTermsEnum parent.  Perhaps that could be improved to be useful without demanding a MultiTermsEnum parent... but that seems like a separate issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628861_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628861_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:48:12+0000\'\u003e02\\/Nov\\/16 12:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n      (I wrote this as you made your last comments, but rather than delete it I\'ll comment any way)  \\n\\n     The documentation for `PostingsEnum.nextPosition()` states that calling it more than `freq()` times is undefined.  Thus it\'s quite valid to throw an IllegalStateException. \\n\\n     &gt; Btw, we\'ve seen other needs for something like a CompositePostingsEnum that abstracts over a set of terms, but since this is still internal, dropping the house-keeping will also make this code do less.  \\n\\n     I don\'t think I quite get what you\'re saying.  By \\\"other needs\\\" do you mean Bloomberg internally?  If so, how would that relate this this one inside the UH?  Are you advocating a general purpose Multi-PosrtingsEnum?  On the latter... a highlighter wouldn\'t be where to introduce such a thing.  There is a `org.apache.lucene.index.MultiPostingsEnum` which I looked at while at the Lucene hackday code sprint as it got my curiosity.  Unfortunately, it doesn\'t seem quite general purpose enough for us to use &#8211; it demands a MultiTermsEnum parent.  Perhaps that could be improved to be useful without demanding a MultiTermsEnum parent... but that seems like a separate issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15628874\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15628874&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15628874\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628874_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628874_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:53:08+0000\'\u003e02\\/Nov\\/16 12:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    Fair enough on both ends.  And yes, we have seen a potential use case for a unified view over terms.  I\'ll take a look at MultiPostingsEnum and see if we can use that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628874_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628874_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 12:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T12:53:08+0000\'\u003e02\\/Nov\\/16 12:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     Fair enough on both ends.  And yes, we have seen a potential use case for a unified view over terms.  I\'ll take a look at MultiPostingsEnum and see if we can use that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15628983\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15628983&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15628983\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628983_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628983_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 13:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T13:31:39+0000\'\u003e02\\/Nov\\/16 13:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user dsmiley commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    Nevermind on `MultiPostingsEnum`.  MPE assumes the PostingsEnum are for a disjoint set of documents &#8211; i.e. each PostingsEnum matches documents disjoint from the others.  This makes sense given it\'s use for a single view over multiple segments.  In our case we want what might be called a MultiPositionsPostingsEnum or MultiOffsetsPostingsEnum or \\\"Composite\\\" instead of \\\"Multi\\\" (synonymous, really).  We merge the positions (yet we don\'t care about the actual position #s; it\'s the other stuff we expose per-position).  BTW my code you merged had a \\\"nocommit\\\" to consider changing the class name.  \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15628983_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15628983_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 13:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T13:31:39+0000\'\u003e02\\/Nov\\/16 13:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user dsmiley commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     Nevermind on `MultiPostingsEnum`.  MPE assumes the PostingsEnum are for a disjoint set of documents &#8211; i.e. each PostingsEnum matches documents disjoint from the others.  This makes sense given it\'s use for a single view over multiple segments.  In our case we want what might be called a MultiPositionsPostingsEnum or MultiOffsetsPostingsEnum or \\\"Composite\\\" instead of \\\"Multi\\\" (synonymous, really).  We merge the positions (yet we don\'t care about the actual position #s; it\'s the other stuff we expose per-position).  BTW my code you merged had a \\\"nocommit\\\" to consider changing the class name.                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15629097\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15629097&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15629097\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15629097_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15629097_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 14:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T14:15:37+0000\'\u003e02\\/Nov\\/16 14:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 commented on the issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e    Ah, missed that.  Fixed\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15629097_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15629097_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/16 14:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-02T14:15:37+0000\'\u003e02\\/Nov\\/16 14:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 commented on the issue: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105  \\n\\n     Ah, missed that.  Fixed              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15660328\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15660328&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15660328\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15660328_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15660328_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/16 21:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-12T21:40:10+0000\'\u003e12\\/Nov\\/16 21:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'ve merged with the changes from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7544\\\" title=\\\"UnifiedHighlighter should allow extension for custom query types\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7544\\\"\u003e\u003cdel\u003eLUCENE-7544\u003c\\/del\u003e\u003c\\/a\u003e and also ran some benchmarks. (Thanks \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e for the fix on \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7546\\\" title=\\\"Rename uses of people.apache.org to home.apache.org\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7546\\\"\u003e\u003cdel\u003eLUCENE-7546\u003c\\/del\u003e\u003c\\/a\u003e!)\u003c\\/p\u003e\\n\\n\u003cp\u003eOriginal:\u003c\\/p\u003e\\n\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003eImpl\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eTerms\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003ePhrases\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eWildcards\u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e(search)\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e1.14\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e1.43\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2.44\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eSH_A\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e7.36\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e7.49\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e16.37\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_A\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e5.32\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4.55\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e9.24\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eSH_V\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4.12\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4.42\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e8.47\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eFVH_V\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.46\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2.98\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e7.13\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_V\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.7\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.45\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e6.61\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003ePH_P\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.76\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.45\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e9.6\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_P\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.34\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2.91\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e9.33\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_PV\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.26\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2.8\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e6.72\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eWith improvements from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7526\\\" title=\\\"Improvements to UnifiedHighlighter OffsetStrategies\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7526\\\"\u003e\u003cdel\u003eLUCENE-7526\u003c\\/del\u003e\u003c\\/a\u003e:\u003c\\/p\u003e\\n\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003eImpl\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eTerms\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003ePhrases\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eWildcards\u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e(search)\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e1.18\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e1.38\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2.52\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eSH_A\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e7.98\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e7.53\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e16.62\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_A\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e5.46\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4.6\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e9.43\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eSH_V\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4.13\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4.42\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e8.26\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eFVH_V\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.45\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.05\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e6.93\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_V\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.79\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.43\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e6.62\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003ePH_P\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.82\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.47\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e9.4\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_P\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.33\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.03\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e9.46\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_PV\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e3.24\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2.81\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e6.92\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eIf you disable the new option to prefer passage relevancy over speed you\'ll get the following for analysis:\u003c\\/p\u003e\\n\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003eImpl\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eTerms\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003ePhrases\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eWildcards\u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e(search)\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e1.1\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e1.43\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2.44\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eUH_A\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e5.31\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4.66\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e9.14\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eI wasn\'t able to get very consistent times with the benchmarks, but it looks like the changes keep close performance while simplifying the code and improving relevancy in the Analysis case (unless preferPassageRelevancyOverSpeed is disabled).  If that option is disabled the timings line up pretty closely with the originals, providing a minor speed boost. There should also be a memory savings by avoiding re-creation of TokenStreams, but that was difficult to measure, but could prove beneficial if there is memory pressure.\u003c\\/p\u003e\\n\\n\u003cp\u003eI performed these benchmark on a machine with the following configuration:\u003c\\/p\u003e\\n\\n\u003cp\u003eProcessor: AMD Phenom II X4 960T 3.0GHz\u003cbr\\/\u003e\\nMemory: 24GB DDR3\u003cbr\\/\u003e\\nDisk: Crucial CT256MX SSD\u003cbr\\/\u003e\\nOS: Windows 10\u003cbr\\/\u003e\\nJava: Java HotSpot(TM) 64-Bit Server VM (build 25.25-b02, mixed mode)\u003c\\/p\u003e\\n\\n\u003cp\u003eAll versions of the benchmarks incorporated above included the changes from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7544\\\" title=\\\"UnifiedHighlighter should allow extension for custom query types\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7544\\\"\u003e\u003cdel\u003eLUCENE-7544\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e It looks like my older processor took significantly longer to highlight across the board than in your initial run for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7438\\\" title=\\\"UnifiedHighlighter\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7438\\\"\u003e\u003cdel\u003eLUCENE-7438\u003c\\/del\u003e\u003c\\/a\u003e.  I\'d be curious how this set of changes performs on your machine now.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15660328_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15660328_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/16 21:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-12T21:40:10+0000\'\u003e12\\/Nov\\/16 21:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'ve merged with the changes from   LUCENE-7544   and also ran some benchmarks. (Thanks  David Smiley  for the fix on   LUCENE-7546  !) \\n\\n Original: \\n\\n \\n  \\n \\n Impl \\n Terms \\n Phrases \\n Wildcards \\n \\n \\n (search) \\n 1.14 \\n 1.43 \\n 2.44 \\n \\n \\n SH_A \\n 7.36 \\n 7.49 \\n 16.37 \\n \\n \\n UH_A \\n 5.32 \\n 4.55 \\n 9.24 \\n \\n \\n SH_V \\n 4.12 \\n 4.42 \\n 8.47 \\n \\n \\n FVH_V \\n 3.46 \\n 2.98 \\n 7.13 \\n \\n \\n UH_V \\n 3.7 \\n 3.45 \\n 6.61 \\n \\n \\n PH_P \\n 3.76 \\n 3.45 \\n 9.6 \\n \\n \\n UH_P \\n 3.34 \\n 2.91 \\n 9.33 \\n \\n \\n UH_PV \\n 3.26 \\n 2.8 \\n 6.72 \\n \\n  \\n \\n\\n\\n With improvements from   LUCENE-7526  : \\n\\n \\n  \\n \\n Impl \\n Terms \\n Phrases \\n Wildcards \\n \\n \\n (search) \\n 1.18 \\n 1.38 \\n 2.52 \\n \\n \\n SH_A \\n 7.98 \\n 7.53 \\n 16.62 \\n \\n \\n UH_A \\n 5.46 \\n 4.6 \\n 9.43 \\n \\n \\n SH_V \\n 4.13 \\n 4.42 \\n 8.26 \\n \\n \\n FVH_V \\n 3.45 \\n 3.05 \\n 6.93 \\n \\n \\n UH_V \\n 3.79 \\n 3.43 \\n 6.62 \\n \\n \\n PH_P \\n 3.82 \\n 3.47 \\n 9.4 \\n \\n \\n UH_P \\n 3.33 \\n 3.03 \\n 9.46 \\n \\n \\n UH_PV \\n 3.24 \\n 2.81 \\n 6.92 \\n \\n  \\n \\n\\n\\n If you disable the new option to prefer passage relevancy over speed you\'ll get the following for analysis: \\n\\n \\n  \\n \\n Impl \\n Terms \\n Phrases \\n Wildcards \\n \\n \\n (search) \\n 1.1 \\n 1.43 \\n 2.44 \\n \\n \\n UH_A \\n 5.31 \\n 4.66 \\n 9.14 \\n \\n  \\n \\n\\n\\n I wasn\'t able to get very consistent times with the benchmarks, but it looks like the changes keep close performance while simplifying the code and improving relevancy in the Analysis case (unless preferPassageRelevancyOverSpeed is disabled).  If that option is disabled the timings line up pretty closely with the originals, providing a minor speed boost. There should also be a memory savings by avoiding re-creation of TokenStreams, but that was difficult to measure, but could prove beneficial if there is memory pressure. \\n\\n I performed these benchmark on a machine with the following configuration: \\n\\n Processor: AMD Phenom II X4 960T 3.0GHz \\nMemory: 24GB DDR3 \\nDisk: Crucial CT256MX SSD \\nOS: Windows 10 \\nJava: Java HotSpot(TM) 64-Bit Server VM (build 25.25-b02, mixed mode) \\n\\n All versions of the benchmarks incorporated above included the changes from   LUCENE-7544  . \\n\\n  David Smiley  It looks like my older processor took significantly longer to highlight across the board than in your initial run for   LUCENE-7438  .  I\'d be curious how this set of changes performs on your machine now.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15660330\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15660330&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15660330\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15660330_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15660330_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/16 21:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-12T21:41:07+0000\'\u003e12\\/Nov\\/16 21:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOther than that, I think this code is in good shape for committing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15660330_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15660330_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/16 21:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-12T21:41:07+0000\'\u003e12\\/Nov\\/16 21:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Other than that, I think this code is in good shape for committing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15662505\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15662505&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15662505\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15662505_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15662505_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Nov\\/16 01:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-14T01:47:44+0000\'\u003e14\\/Nov\\/16 01:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRE Benchmarks:\u003c\\/p\u003e\\n\\n\u003cp\u003eYeah it seems hard to get consistency. I even upped the iterations counts to 2000 (from 500) and saw more variability than I\'d like.  Nonetheless your analysis looks good to me; it\'s how I would sum up my observations today.\u003c\\/p\u003e\\n\\n\u003cp\u003eI ran my benchmarks with \\\"-Xms4G -Xmx4G -XX:NewRatio=1\\\" (to reduce the effects of GC).  My machine is a MacBook Pro Retina \\\"Late 2013\\\", 2 GHz i7, 8GB RAM.  This index is on an external spinning disk but there is no disk activity after warm-up because it\'s all in the O.S. Cache.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs I looked over things carefully, I made a few more changes; all pretty minor.  A few were in reaction to \\\"ant precommit\\\". \u003ca href=\\\"https:\\/\\/github.com\\/dsmiley\\/lucene-solr\\/commits\\/uh_Tim\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/dsmiley\\/lucene-solr\\/commits\\/uh_Tim\u003c\\/a\u003e &#8211; the test &amp; some javadoc issues.  I also did a little bit of refactoring I hope you\'ll be good with.  In a couple cases I merely moved a method up or down so that the code flows top to bottom better.  Regarding Passage: I\'ll create a separate issue expressly for making Passage usable by anyone customizing the highlighter.  It\'s not as simple as addMatch being public; there are other methods.  \u003c\\/p\u003e\\n\\n\u003cp\u003e\u003cem\u003eWhat\'s there now is in good shape for committing.\u003c\\/em\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eA couple ideas occurred to me; \u003cem\u003efeel free to punt to another issue or never\u003c\\/em\u003e:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eMultiValueTokenStream isn\'t needed for MemoryIndexOffsetStrategy, albeit with a change to loop over content.split(separatorChar).  MemoryIndex.addField is overloaded to take the position increment gap.  Then, MultiValueTokenStream could move to an inner class of TokenStreamOffsetStrategy, and it wouldn\'t generally be used (as it\'s no longer by default).  That\'d be nice &#8211; keeping the complexity over there, and it\'s a bit of a hack too.\u003c\\/li\u003e\\n\\t\u003cli\u003eWe had made OffsetsEnum &amp; TokenStreamPostingsEnum implement Closeable to ameliorate the ramifications of the text analysis code throwing an exception, i.e. due to a bug.  The only beneficiary of this now is TokenStreamOffsetStrategy, which isn\'t the default anymore. It could be removed to simplify things.  But then again, perhaps it could be useful for those implementing custom OffsetStrategies.  I guess it should stay; there\'s very little to this after all.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eProposed CHANGES.txt in \\\"Improvements\\\":\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eEnhanced UnifiedHighlighter\'s passage relevancy for queries with wildcards and sometimes just terms. Added shouldPreferPassageRelevancyOverSpeed() which can be overridden to return false to eek out more speed in some cases. (Tim Rodriguez, David Smiley)\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15662505_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15662505_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Nov\\/16 01:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-14T01:47:44+0000\'\u003e14\\/Nov\\/16 01:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    RE Benchmarks: \\n\\n Yeah it seems hard to get consistency. I even upped the iterations counts to 2000 (from 500) and saw more variability than I\'d like.  Nonetheless your analysis looks good to me; it\'s how I would sum up my observations today. \\n\\n I ran my benchmarks with \\\"-Xms4G -Xmx4G -XX:NewRatio=1\\\" (to reduce the effects of GC).  My machine is a MacBook Pro Retina \\\"Late 2013\\\", 2 GHz i7, 8GB RAM.  This index is on an external spinning disk but there is no disk activity after warm-up because it\'s all in the O.S. Cache. \\n\\n As I looked over things carefully, I made a few more changes; all pretty minor.  A few were in reaction to \\\"ant precommit\\\".  https:\\/\\/github.com\\/dsmiley\\/lucene-solr\\/commits\\/uh_Tim  &#8211; the test &amp; some javadoc issues.  I also did a little bit of refactoring I hope you\'ll be good with.  In a couple cases I merely moved a method up or down so that the code flows top to bottom better.  Regarding Passage: I\'ll create a separate issue expressly for making Passage usable by anyone customizing the highlighter.  It\'s not as simple as addMatch being public; there are other methods.   \\n\\n  What\'s there now is in good shape for committing.  \\n\\n A couple ideas occurred to me;  feel free to punt to another issue or never : \\n \\n\\t MultiValueTokenStream isn\'t needed for MemoryIndexOffsetStrategy, albeit with a change to loop over content.split(separatorChar).  MemoryIndex.addField is overloaded to take the position increment gap.  Then, MultiValueTokenStream could move to an inner class of TokenStreamOffsetStrategy, and it wouldn\'t generally be used (as it\'s no longer by default).  That\'d be nice &#8211; keeping the complexity over there, and it\'s a bit of a hack too. \\n\\t We had made OffsetsEnum &amp; TokenStreamPostingsEnum implement Closeable to ameliorate the ramifications of the text analysis code throwing an exception, i.e. due to a bug.  The only beneficiary of this now is TokenStreamOffsetStrategy, which isn\'t the default anymore. It could be removed to simplify things.  But then again, perhaps it could be useful for those implementing custom OffsetStrategies.  I guess it should stay; there\'s very little to this after all. \\n \\n\\n\\n Proposed CHANGES.txt in \\\"Improvements\\\": \\n \\n\\t Enhanced UnifiedHighlighter\'s passage relevancy for queries with wildcards and sometimes just terms. Added shouldPreferPassageRelevancyOverSpeed() which can be overridden to return false to eek out more speed in some cases. (Tim Rodriguez, David Smiley) \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15665317\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15665317&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15665317\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15665317_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15665317_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Nov\\/16 23:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-14T23:03:35+0000\'\u003e14\\/Nov\\/16 23:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAdded the proposed changes.  I\'m on the fence around the refactor for MultiValueTokenStream, I\'d much prefer to get rid of it completely if we could.  But for now having some symmetry between the two impls seems worthwhile to me?  I\'d like to punt on that one.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"Timothy055\\\" id=\\\"commentauthor_15665317_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=Timothy055\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"Timothy055\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Timothy M. Rodriguez\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15665317_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Nov\\/16 23:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-14T23:03:35+0000\'\u003e14\\/Nov\\/16 23:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Added the proposed changes.  I\'m on the fence around the refactor for MultiValueTokenStream, I\'d much prefer to get rid of it completely if we could.  But for now having some symmetry between the two impls seems worthwhile to me?  I\'d like to punt on that one.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15666181\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15666181&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15666181\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15666181_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15666181_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Nov\\/16 05:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-15T05:44:10+0000\'\u003e15\\/Nov\\/16 05:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI understand RE MultiValueTokenStream.  I was motivated by considering highlighting a TokenStream without a MemoryIndex resulted in some complexity in various places (not introduced here, I mean pre-existing); some of it is addressed with this patch, and others still linger.  Another hack that could move is the getPayoad() returning the Term.  If this offset strategy returned a subclassed OffsetEnum, that quirk could be better isolated.  Any way; let that be for another day.\u003c\\/p\u003e\\n\\n\u003cp\u003eAttached is the patch delta from master.  I\'ll commit tomorrow night.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15666181_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15666181_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Nov\\/16 05:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-15T05:44:10+0000\'\u003e15\\/Nov\\/16 05:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I understand RE MultiValueTokenStream.  I was motivated by considering highlighting a TokenStream without a MemoryIndex resulted in some complexity in various places (not introduced here, I mean pre-existing); some of it is addressed with this patch, and others still linger.  Another hack that could move is the getPayoad() returning the Term.  If this offset strategy returned a subclassed OffsetEnum, that quirk could be better isolated.  Any way; let that be for another day. \\n\\n Attached is the patch delta from master.  I\'ll commit tomorrow night.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15668354\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15668354&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15668354\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15668354_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15668354_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Nov\\/16 21:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-15T21:17:07+0000\'\u003e15\\/Nov\\/16 21:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 7af454ad767c3a0364757d6fcf55bff9f063febe in lucene-solr\'s branch refs\\/heads\\/master from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=7af454a\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=7af454a\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7526\\\" title=\\\"Improvements to UnifiedHighlighter OffsetStrategies\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7526\\\"\u003e\u003cdel\u003eLUCENE-7526\u003c\\/del\u003e\u003c\\/a\u003e: UnifiedHighlighter: enhance MTQ passage relevancy. TokenStreamFromTermVector isn\'t used by the UH anymore. Refactor AnalysisOffsetStrategy into TokenStream and MemoryIndex strategies, and related refactorings from that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15668354_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15668354_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Nov\\/16 21:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-15T21:17:07+0000\'\u003e15\\/Nov\\/16 21:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 7af454ad767c3a0364757d6fcf55bff9f063febe in lucene-solr\'s branch refs\\/heads\\/master from  David Smiley  \\n[  https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=7af454a  ] \\n\\n   LUCENE-7526  : UnifiedHighlighter: enhance MTQ passage relevancy. TokenStreamFromTermVector isn\'t used by the UH anymore. Refactor AnalysisOffsetStrategy into TokenStream and MemoryIndex strategies, and related refactorings from that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15668358\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15668358&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15668358\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15668358_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15668358_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Nov\\/16 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-15T21:18:37+0000\'\u003e15\\/Nov\\/16 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 0790c34cc555ec9aaaab09cae04da6e61f465cfc in lucene-solr\'s branch refs\\/heads\\/branch_6x from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=0790c34\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=0790c34\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-7526\\\" title=\\\"Improvements to UnifiedHighlighter OffsetStrategies\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-7526\\\"\u003e\u003cdel\u003eLUCENE-7526\u003c\\/del\u003e\u003c\\/a\u003e: UnifiedHighlighter: enhance MTQ passage relevancy. TokenStreamFromTermVector isn\'t used by the UH anymore. Refactor AnalysisOffsetStrategy into TokenStream and MemoryIndex strategies, and related refactorings from that.\u003c\\/p\u003e\\n\\n\u003cp\u003e(cherry picked from commit 7af454a)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15668358_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15668358_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Nov\\/16 21:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-15T21:18:37+0000\'\u003e15\\/Nov\\/16 21:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 0790c34cc555ec9aaaab09cae04da6e61f465cfc in lucene-solr\'s branch refs\\/heads\\/branch_6x from  David Smiley  \\n[  https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=0790c34  ] \\n\\n   LUCENE-7526  : UnifiedHighlighter: enhance MTQ passage relevancy. TokenStreamFromTermVector isn\'t used by the UH anymore. Refactor AnalysisOffsetStrategy into TokenStream and MemoryIndex strategies, and related refactorings from that. \\n\\n (cherry picked from commit 7af454a)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15668378\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15668378&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15668378\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15668378_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15668378_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Nov\\/16 21:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-15T21:21:47+0000\'\u003e15\\/Nov\\/16 21:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted. Thanks Tim and thanks \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=mbraun688\\\" class=\\\"user-hover\\\" rel=\\\"mbraun688\\\"\u003eMichael Braun\u003c\\/a\u003e for some internal code reviewing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_15668378_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15668378_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Nov\\/16 21:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-15T21:21:47+0000\'\u003e15\\/Nov\\/16 21:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed. Thanks Tim and thanks  Michael Braun  for some internal code reviewing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15962205\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-7526?focusedCommentId=15962205&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15962205\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15962205_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15962205_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/17 18:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-04-09T18:07:48+0000\'\u003e09\\/Apr\\/17 18:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGithub user Timothy055 closed the pull request at:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ca href=\\\"https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105\u003c\\/a\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"githubbot\\\" id=\\\"commentauthor_15962205_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=githubbot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"githubbot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF GitHub Bot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15962205_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/17 18:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-04-09T18:07:48+0000\'\u003e09\\/Apr\\/17 18:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Github user Timothy055 closed the pull request at: \\n\\n      https:\\/\\/github.com\\/apache\\/lucene-solr\\/pull\\/105               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516206808842"> 
    <input type="hidden" title="jira.request.server.time" value="606"> 
    <input type="hidden" title="jira.request.id" value="993x7857948x8"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="8"> 
    <input type="hidden" title="db.reads.time.in.ms" value="47"> 
    <input type="hidden" title="db.conns.time.in.ms" value="55"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 993x7857948x8
	          REQUEST TIMESTAMP : [17/Jan/2018:16:33:28 +0000]
	               REQUEST TIME : 0.6060
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 8

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=22, elapsedTotal=47392736, elapsedMin=548257, elapsedMax=13072265, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=26, elapsedTotal=55970537, elapsedMin=574864, elapsedMax=13134592, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
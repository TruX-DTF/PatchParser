<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|2588604364ad0be274c91fa39e3190899198df05|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"a6e2b856fc25a0\"";
WRM._unparsedData["project-id"]="12310230";
WRM._unparsedData["project-key"]="\"SOLR\"";
WRM._unparsedData["project-name"]="\"Solr\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310230";
WRM._unparsedData["projectKey"]="\"SOLR\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="SOLR-2564"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[SOLR-2564] Integrating grouping module into Solr 4.0 - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[SOLR-2564] Integrating grouping module into Solr 4.0 - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loadingâ€¦
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/SOLR" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-2564">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310230" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Solr'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310230&amp;avatarId=22151"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/SOLR">Solr</a></li>
                 <li><a class="issue-link" data-issue-key="SOLR-2564" href="/jira/browse/SOLR-2564" id="key-val" rel="12508884">SOLR-2564</a></li>
                </ol>
                <h1 id="summary-val">Integrating grouping module into Solr 4.0</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-2564"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/SOLR-2564/SOLR-2564.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/SOLR-2564/SOLR-2564.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/SOLR-2564/SOLR-2564.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/SOLR-2564/SOLR-2564.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/blocker.svg" title="Blocker - Blocks development and/or testing work, production could not run" width="16"> Blocker </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+SOLR+AND+fixVersion+%3D+4.0-ALPHA" title="4.0-ALPHA Alpha release of 4.x series">4.0-ALPHA</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12508884-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>Since work on grouping module is going well. I think it is time to wire this up in Solr.<br> Besides the current grouping features Solr provides, Solr will then also support second pass caching and total count based on groups.</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/SOLR-2564?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/SOLR-2564?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/SOLR-2564?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/SOLR-2564?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12481404" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12481404/LUCENE-2564.patch" draggable="true" data-downloadurl="text/plain:LUCENE-2564.patch:https://issues.apache.org/jira/secure/attachment/12481404/LUCENE-2564.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12481404/LUCENE-2564.patch" title="Latest  03/Jun/11 20:39 - Michael McCandless" draggable="true" data-downloadurl="text/plain:LUCENE-2564.patch:https://issues.apache.org/jira/secure/attachment/12481404/LUCENE-2564.patch">LUCENE-2564.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-03T20:39:11.299Z">03/Jun/11 20:39</time>
                   </dd>
                   <dd class="attachment-size">
                    61 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12483352" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12483352/SOLR-2564_performance_loss_fix.patch" draggable="true" data-downloadurl="text/plain:SOLR-2564_performance_loss_fix.patch:https://issues.apache.org/jira/secure/attachment/12483352/SOLR-2564_performance_loss_fix.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12483352/SOLR-2564_performance_loss_fix.patch" title="Latest  21/Jun/11 21:26 - Yonik Seeley" draggable="true" data-downloadurl="text/plain:SOLR-2564_performance_loss_fix.patch:https://issues.apache.org/jira/secure/attachment/12483352/SOLR-2564_performance_loss_fix.patch">SOLR-2564_performance_loss_fix.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-21T21:26:25.434Z">21/Jun/11 21:26</time>
                   </dd>
                   <dd class="attachment-size">
                    5 kB
                   </dd>
                   <dd class="attachment-author">
                    Yonik Seeley
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12482302" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12482302/SOLR-2564.patch" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12482302/SOLR-2564.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12482302/SOLR-2564.patch" title="Latest  12/Jun/11 15:47 - Martijn van Groningen" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12482302/SOLR-2564.patch">SOLR-2564.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-12T15:47:06.127Z">12/Jun/11 15:47</time>
                   </dd>
                   <dd class="attachment-size">
                    79 kB
                   </dd>
                   <dd class="attachment-author">
                    Martijn van Groningen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12482149" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12482149/SOLR-2564.patch" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12482149/SOLR-2564.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12482149/SOLR-2564.patch" title=" 11/Jun/11 14:45 - Martijn van Groningen" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12482149/SOLR-2564.patch">SOLR-2564.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-11T14:45:42.036Z">11/Jun/11 14:45</time>
                   </dd>
                   <dd class="attachment-size">
                    79 kB
                   </dd>
                   <dd class="attachment-author">
                    Martijn van Groningen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12481797" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12481797/SOLR-2564.patch" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481797/SOLR-2564.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12481797/SOLR-2564.patch" title=" 08/Jun/11 11:02 - Martijn van Groningen" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481797/SOLR-2564.patch">SOLR-2564.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-08T11:02:06.015Z">08/Jun/11 11:02</time>
                   </dd>
                   <dd class="attachment-size">
                    75 kB
                   </dd>
                   <dd class="attachment-author">
                    Martijn van Groningen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12481526" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12481526/SOLR-2564.patch" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481526/SOLR-2564.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12481526/SOLR-2564.patch" title=" 05/Jun/11 23:28 - Martijn van Groningen" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481526/SOLR-2564.patch">SOLR-2564.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-05T23:28:34.391Z">05/Jun/11 23:28</time>
                   </dd>
                   <dd class="attachment-size">
                    68 kB
                   </dd>
                   <dd class="attachment-author">
                    Martijn van Groningen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12481447" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12481447/SOLR-2564.patch" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481447/SOLR-2564.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12481447/SOLR-2564.patch" title=" 04/Jun/11 10:42 - Martijn van Groningen" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481447/SOLR-2564.patch">SOLR-2564.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-04T10:42:22.642Z">04/Jun/11 10:42</time>
                   </dd>
                   <dd class="attachment-size">
                    63 kB
                   </dd>
                   <dd class="attachment-author">
                    Martijn van Groningen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12481282" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12481282/SOLR-2564.patch" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481282/SOLR-2564.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12481282/SOLR-2564.patch" title=" 02/Jun/11 21:10 - Martijn van Groningen" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481282/SOLR-2564.patch">SOLR-2564.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-02T21:10:11.820Z">02/Jun/11 21:10</time>
                   </dd>
                   <dd class="attachment-size">
                    62 kB
                   </dd>
                   <dd class="attachment-author">
                    Martijn van Groningen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12481011" data-issue-id="12508884" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12481011/SOLR-2564.patch" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481011/SOLR-2564.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12481011/SOLR-2564.patch" title=" 31/May/11 23:13 - Martijn van Groningen" draggable="true" data-downloadurl="text/plain:SOLR-2564.patch:https://issues.apache.org/jira/secure/attachment/12481011/SOLR-2564.patch">SOLR-2564.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-05-31T23:13:09.341Z">31/May/11 23:13</time>
                   </dd>
                   <dd class="attachment-size">
                    60 kB
                   </dd>
                   <dd class="attachment-author">
                    Martijn van Groningen
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="is blocked by">
                   is blocked by
                  </dt> 
                  <dd id="internal-12507229_10032"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="LUCENE-3099: Grouping module should allow subclasses to set the group key per document"> <a href="/jira/browse/LUCENE-3099" data-issue-key="LUCENE-3099" class="issue-link link-title resolution">LUCENE-3099</a> <span class="link-summary">Grouping module should allow subclasses to set the group key per document</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="is depended upon by">
                   is depended upon by
                  </dt> 
                  <dd id="internal-12509497_10001"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="SOLR-2577: Give option for &quot;spellcheck.collateExtendedResults&quot; w/Grouping to return #-of-Grouped-Hits"> <a href="/jira/browse/SOLR-2577" data-issue-key="SOLR-2577" class="issue-link link-title">SOLR-2577</a> <span class="link-summary">Give option for "spellcheck.collateExtendedResults" w/Grouping to return #-of-Grouped-Hits</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/minor.svg" width="16" height="16" title="Minor - Minor loss of function, or other problem where easy workaround is present." alt="Minor - Minor loss of function, or other problem where easy workaround is present."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_martijn.v.groningen" rel="martijn.v.groningen" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Martijn van Groningen&quot;,&quot;emailAddress&quot;:&quot;martijn.v.groningen@gmail.com&quot;,&quot;username&quot;:&quot;martijn.v.groningen&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="martijn.v.groningen"></span></span> Martijn van Groningen </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_martijn.v.groningen" rel="martijn.v.groningen" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Martijn van Groningen&quot;,&quot;emailAddress&quot;:&quot;martijn.v.groningen@gmail.com&quot;,&quot;username&quot;:&quot;martijn.v.groningen&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="martijn.v.groningen"></span></span> Martijn van Groningen </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">3</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="31/May/11 23:10"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2011-05-31T23:10:06+0000">31/May/11 23:10</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="10/May/13 10:39"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2013-05-10T10:39:21+0000">10/May/13 10:39</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="17/Jun/11 21:31"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2011-06-17T21:31:50+0000">17/Jun/11 21:31</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-2564?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/SOLR-2564?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-13041892\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13041892&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13041892\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13041892_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13041892_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/11 23:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-05-31T23:13:09+0000\'\u003e31\\/May\\/11 23:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Martijn van Groningen - 31\\/May\\/11 23:15\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eInitial patch. All tests, but the random test pass. The goal is that all existing grouping test must pass without any changes to the TestGroupingSearch class.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis patch also includes collectors for function queries.\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3099\\\" title=\\\"Grouping module should allow subclasses to set the group key per document\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3099\\\"\u003e\u003cdel\u003eLUCENE-3099\u003c\\/del\u003e\u003c\\/a\u003e must be applied first before using the patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13041892_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13041892_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/11 23:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-05-31T23:13:09+0000\'\u003e31\\/May\\/11 23:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Martijn van Groningen - 31\\/May\\/11 23:15\\\"\u003eedited\u003c\\/span\u003e                   Initial patch. All tests, but the random test pass. The goal is that all existing grouping test must pass without any changes to the TestGroupingSearch class. \\n\\n This patch also includes collectors for function queries. \\n\\n   LUCENE-3099   must be applied first before using the patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13043048\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13043048&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13043048\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13043048_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13043048_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jun\\/11 21:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-02T21:10:11+0000\'\u003e02\\/Jun\\/11 21:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAdded updated patch. All tests are passing now. I think that when \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3099\\\" title=\\\"Grouping module should allow subclasses to set the group key per document\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3099\\\"\u003e\u003cdel\u003eLUCENE-3099\u003c\\/del\u003e\u003c\\/a\u003e is committed, this patch can also be committed.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso\\u00A0included a small fix to the CachingCollector. During replaying the scorer is only set once. This must be done for every segment. This fix resolves that issue\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13043048_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13043048_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jun\\/11 21:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-02T21:10:11+0000\'\u003e02\\/Jun\\/11 21:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Added updated patch. All tests are passing now. I think that when   LUCENE-3099   is committed, this patch can also be committed. \\n\\n Also\\u00A0included a small fix to the CachingCollector. During replaying the scorer is only set once. This must be done for every segment. This fix resolves that issue              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044028\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044028&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044028\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044028_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044028_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 20:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T20:39:11+0000\'\u003e03\\/Jun\\/11 20:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\\n\u003cp\u003ePatch looks great!\u003c\\/p\u003e\\n\\n\u003cp\u003eAttached new patch with minor fixes:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eI had to fixup Solr\'s common-build.xml (it was referencing\u003cbr\\/\u003e\\n    lucene\\/contrib\\/grouping from 3.x).  After that all tests pass.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eFixed jdocs for GroupParams.GROUP_CACHE (we now default to true\u003cbr\\/\u003e\\n    not false, right?)\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI think GroupParams.GROUP_FACETS (group.docSet request param) is\u003cbr\\/\u003e\\nunused?  Should we remove it?  (This is for when we do \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e, I\u003cbr\\/\u003e\\nthink?)\u003c\\/p\u003e\\n\\n\u003cp\u003eSo this cutover improves Solr trunk grouping\'s impl by adding option\u003cbr\\/\u003e\\nto get total group count (group.totalCount request param) and using\u003cbr\\/\u003e\\nthe CachingCollector for fast replaying of hits for 2nd pass collector\u003cbr\\/\u003e\\n(adds group.cache\\/group.cache.maxSizeMB request params).  The\u003cbr\\/\u003e\\ndouble-RAM issue is fixed, thanks to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3099\\\" title=\\\"Grouping module should allow subclasses to set the group key per document\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3099\\\"\u003e\u003cdel\u003eLUCENE-3099\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo I think this is ready to be committed!!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044028_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044028_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 20:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T20:39:11+0000\'\u003e03\\/Jun\\/11 20:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                   \\n Patch looks great! \\n\\n Attached new patch with minor fixes: \\n\\n \\n\\t I had to fixup Solr\'s common-build.xml (it was referencing \\n    lucene\\/contrib\\/grouping from 3.x).  After that all tests pass. \\n \\n\\n\\n \\n\\t Fixed jdocs for GroupParams.GROUP_CACHE (we now default to true \\n    not false, right?) \\n \\n\\n\\n I think GroupParams.GROUP_FACETS (group.docSet request param) is \\nunused?  Should we remove it?  (This is for when we do   LUCENE-3097  , I \\nthink?) \\n\\n So this cutover improves Solr trunk grouping\'s impl by adding option \\nto get total group count (group.totalCount request param) and using \\nthe CachingCollector for fast replaying of hits for 2nd pass collector \\n(adds group.cache\\/group.cache.maxSizeMB request params).  The \\ndouble-RAM issue is fixed, thanks to   LUCENE-3099  . \\n\\n So I think this is ready to be committed!!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044043\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044043&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044043\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044043_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044043_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 20:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T20:55:28+0000\'\u003e03\\/Jun\\/11 20:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eFixed jdocs for GroupParams.GROUP_CACHE (we now default to true not false, right?)\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eYes we do.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eI think GroupParams.GROUP_FACETS (group.docSet request param) is\u003cbr\\/\u003e\\nunused? Should we remove it? (This is for when we do \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e, I\u003cbr\\/\u003e\\nthink?)\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI \'reserved\' this parameter for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e. Should we keep it? Once \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e is committed, I will quickly integrate it into Solr.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044043_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044043_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 20:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T20:55:28+0000\'\u003e03\\/Jun\\/11 20:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Fixed jdocs for GroupParams.GROUP_CACHE (we now default to true not false, right?)  \\n Yes we do. \\n\\n \\n I think GroupParams.GROUP_FACETS (group.docSet request param) is \\nunused? Should we remove it? (This is for when we do   LUCENE-3097  , I \\nthink?)  \\n I \'reserved\' this parameter for   LUCENE-3097  . Should we keep it? Once   LUCENE-3097   is committed, I will quickly integrate it into Solr.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044080\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044080&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044080\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044080_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044080_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 21:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T21:53:51+0000\'\u003e03\\/Jun\\/11 21:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI haven\'t been following this... I took a quick look at the patch, and at first blush it\'s hard to tell what changes are cleanup and what changes are cut-over.\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003ein the QueryComponent, why the change to set the GET_SCORES flag based on the sort(s)?\u003c\\/li\u003e\\n\\t\u003cli\u003eI\'m not a fan of this new style for matching request parameters to enums... solr does a \u003cb\u003elot\u003c\\/b\u003e of lookups on a typical request, and a switch to this style everywhere could definitely have an impact (the whole upper-casing the request param so we can match it to the enum name).\u003c\\/li\u003e\\n\\t\u003cli\u003e\\\"Accuracy\\\" seems a bit mis-named?  It seems to imply an accuracy trade-off, but both methods are 100% accurate here, they just do different things to serve different usecases.  At least the name doesn\'t seem to have made it\'s way into the external API though.\u003c\\/li\u003e\\n\\t\u003cli\u003eThe parameter \\\"group.totalCount\\\" I would expect to return the total count of something, not control the pre\\/post faceting thing?  (or are the comments just wrong?)  If it\'s to return the number of groups, then perhaps the name should be \\\"group.groupCount\\\" as totalCount is unit-less.\u003c\\/li\u003e\\n\\t\u003cli\u003eWhat does \\\"group.docSet\\\" do?  The comments don\'t quite make sense to me, but the param suggests it\'s sort of like group.totalCount?\u003c\\/li\u003e\\n\\t\u003cli\u003eI\'m not sure we should default group.cache to true... there\'s a downside to the memory usage, and it\'s fragile: things may be working just fine, and the user may add a few more documents to the index and then the limit is hit and it just stops working (but still consumes much memory and extra log warnings per request).\u003c\\/li\u003e\\n\\t\u003cli\u003ein the interest of reducing the number of parameters, we could dump group.cache and have a single group.cacheMB parameter that uses 0 as no cache, -1 as maximum needed (solr uses -1 in this manner in other places too), and other values as literal number of MB (which I\'d discourage people from using personally).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044080_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044080_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 21:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T21:53:51+0000\'\u003e03\\/Jun\\/11 21:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I haven\'t been following this... I took a quick look at the patch, and at first blush it\'s hard to tell what changes are cleanup and what changes are cut-over. \\n\\n \\n\\t in the QueryComponent, why the change to set the GET_SCORES flag based on the sort(s)? \\n\\t I\'m not a fan of this new style for matching request parameters to enums... solr does a  lot  of lookups on a typical request, and a switch to this style everywhere could definitely have an impact (the whole upper-casing the request param so we can match it to the enum name). \\n\\t \\\"Accuracy\\\" seems a bit mis-named?  It seems to imply an accuracy trade-off, but both methods are 100% accurate here, they just do different things to serve different usecases.  At least the name doesn\'t seem to have made it\'s way into the external API though. \\n\\t The parameter \\\"group.totalCount\\\" I would expect to return the total count of something, not control the pre\\/post faceting thing?  (or are the comments just wrong?)  If it\'s to return the number of groups, then perhaps the name should be \\\"group.groupCount\\\" as totalCount is unit-less. \\n\\t What does \\\"group.docSet\\\" do?  The comments don\'t quite make sense to me, but the param suggests it\'s sort of like group.totalCount? \\n\\t I\'m not sure we should default group.cache to true... there\'s a downside to the memory usage, and it\'s fragile: things may be working just fine, and the user may add a few more documents to the index and then the limit is hit and it just stops working (but still consumes much memory and extra log warnings per request). \\n\\t in the interest of reducing the number of parameters, we could dump group.cache and have a single group.cacheMB parameter that uses 0 as no cache, -1 as maximum needed (solr uses -1 in this manner in other places too), and other values as literal number of MB (which I\'d discourage people from using personally). \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044095\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044095&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044095\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044095_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044095_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 22:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T22:24:07+0000\'\u003e03\\/Jun\\/11 22:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFYI: there\'s a nocommit in there misspelled as \\\"No commit\\\"\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044095_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044095_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 22:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T22:24:07+0000\'\u003e03\\/Jun\\/11 22:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    FYI: there\'s a nocommit in there misspelled as \\\"No commit\\\"              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044122\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044122&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044122\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044122_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044122_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 23:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T23:21:41+0000\'\u003e03\\/Jun\\/11 23:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIn QueryComponent, is it possible to remove this?\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e+        \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (limitDefault &lt; 0) {\\n+          limitDefault = searcher.maxDoc();\\n+        }\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eIt wasn\'t necessary before, and there are advantages to preserving information (like the fact that someone said \\\"no limit\\\" vs a specific number) until as late as possible.  That was previously handled by getMax() in Grouping.java, and I still see it being called... so it should be OK?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044122_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044122_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jun\\/11 23:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-03T23:21:41+0000\'\u003e03\\/Jun\\/11 23:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    In QueryComponent, is it possible to remove this? \\n  \\n +         if  (limitDefault &lt; 0) {\\n+          limitDefault = searcher.maxDoc();\\n+        }\\n \\n  \\n\\n It wasn\'t necessary before, and there are advantages to preserving information (like the fact that someone said \\\"no limit\\\" vs a specific number) until as late as possible.  That was previously handled by getMax() in Grouping.java, and I still see it being called... so it should be OK?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044187\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044187&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044187\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"billnbell\\\" id=\\\"commentauthor_13044187_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=billnbell\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"billnbell\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bill Bell\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044187_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 03:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T03:52:41+0000\'\u003e04\\/Jun\\/11 03:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDo we have a group.facet = after ? I still like the old collapse component better because it had the collapse.facet=after.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think there is another ticket, but not sure if it is being worked on?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"billnbell\\\" id=\\\"commentauthor_13044187_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=billnbell\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"billnbell\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bill Bell\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044187_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 03:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T03:52:41+0000\'\u003e04\\/Jun\\/11 03:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Do we have a group.facet = after ? I still like the old collapse component better because it had the collapse.facet=after. \\n\\n I think there is another ticket, but not sure if it is being worked on?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044253\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044253&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044253\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044253_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044253_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 10:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T10:15:39+0000\'\u003e04\\/Jun\\/11 10:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI haven\'t been following this... \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThank you for the review Yonik!\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI took a quick look at the patch, and at first blush it\'s hard to tell what changes are cleanup and what changes are cut-over.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIt\'s definitely a big refactoring.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ein the QueryComponent, why the change to set the GET_SCORES flag based on the sort(s)?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI assume this is because if you sort or groupSort by a Sort that\u003cbr\\/\u003e\\ncontains SortField.SCORE, you need a scorer.  Not sure why Solr trunk\u003cbr\\/\u003e\\ngets away with not doing this, though... Martijn do you know?  Oh, and\u003cbr\\/\u003e\\nlikely because the CachingCollector needs to know up front if scores\u003cbr\\/\u003e\\nare needed.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI\'m not a fan of this new style for matching request parameters to enums... solr does a lot of lookups on a typical request, and a switch to this style everywhere could definitely have an impact (the whole upper-casing the request param so we can match it to the enum name).\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThe .upper() calls (twice per request, only if the request has\u003cbr\\/\u003e\\ngroup=true) are negligible here (true, other situations might be\u003cbr\\/\u003e\\ndifferent, though we should fix them to lookup\\/check once).\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd, this approach gives us strong checking of the enum fields.\u003cbr\\/\u003e\\nContrast that with what\'s on trunk now:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e  String format = params.get(GroupParams.GROUP_FORMAT);\\n  Grouping.Format defaultFormat = \\\"simple\\\".equals(format) ? Grouping.Format.Simple : Grouping.Format.Grouped; \\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eIf you have a typo in \\\"simple\\\", you\'ll unexpectedly get\u003cbr\\/\u003e\\nGrouping.Format.Grouped.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think we should strongly check all of our request params?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003e\\\"Accuracy\\\" seems a bit mis-named? It seems to imply an accuracy trade-off, but both methods are 100% accurate here, they just do different things to serve different usecases. At least the name doesn\'t seem to have made it\'s way into the external API though.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe parameter \\\"group.totalCount\\\" I would expect to return the total count of something, not control the pre\\/post faceting thing? (or are the comments just wrong?) If it\'s to return the number of groups, then perhaps the name should be \\\"group.groupCount\\\" as totalCount is unit-less.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI agree.  This setting just controls what the \\\"total hit count\\\" should\u003cbr\\/\u003e\\ncount &#8211; unique groups vs docs.\u003c\\/p\u003e\\n\\n\u003cp\u003eHow about TotalCount.GROUPS and TotalCount.DOCS?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eWhat does \\\"group.docSet\\\" do? The comments don\'t quite make sense to me, but the param suggests it\'s sort of like group.totalCount?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think we should remove this from this patch (see my comment above &#8211;\u003cbr\\/\u003e\\nit applies to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e).\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ein the interest of reducing the number of parameters, we could dump group.cache and have a single group.cacheMB parameter that uses 0 as no cache, -1 as maximum needed (solr uses -1 in this manner in other places too), and other values as literal number of MB (which I\'d discourage people from using personally).\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1, that makes sense.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI\'m not sure we should default group.cache to true... there\'s a downside to the memory usage, and it\'s fragile: things may be working just fine, and the user may add a few more documents to the index and then the limit is hit and it just stops working (but still consumes much memory and extra log warnings per request).\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eEnabling caching can make a huge improvement in QPS, especially for\u003cbr\\/\u003e\\nqueries that are costly to execute but don\'t match too many docs.\u003c\\/p\u003e\\n\\n\u003cp\u003eMaybe instead of a fixed MB we could make it a percentage of the\u003cbr\\/\u003e\\nmaxDoc?  This would make it less fragile..  So you could say you\'re\u003cbr\\/\u003e\\nwilling to cache up to 50% of the total docs in the index.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eFYI: there\'s a nocommit in there misspelled as \\\"No commit\\\"\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eMartijn can you fix this one...?  And in general try to spell it as\u003cbr\\/\u003e\\n\\\"nocommit\\\" \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e This is what our build catches.  (And, fear not, you\'re\u003cbr\\/\u003e\\nnot the only person to have trouble spelling nocommit!!).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044253_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044253_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 10:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T10:15:39+0000\'\u003e04\\/Jun\\/11 10:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I haven\'t been following this...   \\n\\n Thank you for the review Yonik! \\n\\n  I took a quick look at the patch, and at first blush it\'s hard to tell what changes are cleanup and what changes are cut-over.  \\n\\n It\'s definitely a big refactoring. \\n\\n  in the QueryComponent, why the change to set the GET_SCORES flag based on the sort(s)?  \\n\\n I assume this is because if you sort or groupSort by a Sort that \\ncontains SortField.SCORE, you need a scorer.  Not sure why Solr trunk \\ngets away with not doing this, though... Martijn do you know?  Oh, and \\nlikely because the CachingCollector needs to know up front if scores \\nare needed. \\n\\n  I\'m not a fan of this new style for matching request parameters to enums... solr does a lot of lookups on a typical request, and a switch to this style everywhere could definitely have an impact (the whole upper-casing the request param so we can match it to the enum name).  \\n\\n The .upper() calls (twice per request, only if the request has \\ngroup=true) are negligible here (true, other situations might be \\ndifferent, though we should fix them to lookup\\/check once). \\n\\n And, this approach gives us strong checking of the enum fields. \\nContrast that with what\'s on trunk now: \\n\\n  \\n   String format = params.get(GroupParams.GROUP_FORMAT);\\n  Grouping.Format defaultFormat = \\\"simple\\\".equals(format) ? Grouping.Format.Simple : Grouping.Format.Grouped; \\n \\n  \\n\\n If you have a typo in \\\"simple\\\", you\'ll unexpectedly get \\nGrouping.Format.Grouped. \\n\\n I think we should strongly check all of our request params? \\n\\n \\n \\\"Accuracy\\\" seems a bit mis-named? It seems to imply an accuracy trade-off, but both methods are 100% accurate here, they just do different things to serve different usecases. At least the name doesn\'t seem to have made it\'s way into the external API though. \\n\\n The parameter \\\"group.totalCount\\\" I would expect to return the total count of something, not control the pre\\/post faceting thing? (or are the comments just wrong?) If it\'s to return the number of groups, then perhaps the name should be \\\"group.groupCount\\\" as totalCount is unit-less.  \\n\\n I agree.  This setting just controls what the \\\"total hit count\\\" should \\ncount &#8211; unique groups vs docs. \\n\\n How about TotalCount.GROUPS and TotalCount.DOCS? \\n\\n  What does \\\"group.docSet\\\" do? The comments don\'t quite make sense to me, but the param suggests it\'s sort of like group.totalCount?  \\n\\n I think we should remove this from this patch (see my comment above &#8211; \\nit applies to   LUCENE-3097  ). \\n\\n  in the interest of reducing the number of parameters, we could dump group.cache and have a single group.cacheMB parameter that uses 0 as no cache, -1 as maximum needed (solr uses -1 in this manner in other places too), and other values as literal number of MB (which I\'d discourage people from using personally).  \\n\\n +1, that makes sense. \\n\\n  I\'m not sure we should default group.cache to true... there\'s a downside to the memory usage, and it\'s fragile: things may be working just fine, and the user may add a few more documents to the index and then the limit is hit and it just stops working (but still consumes much memory and extra log warnings per request).  \\n\\n Enabling caching can make a huge improvement in QPS, especially for \\nqueries that are costly to execute but don\'t match too many docs. \\n\\n Maybe instead of a fixed MB we could make it a percentage of the \\nmaxDoc?  This would make it less fragile..  So you could say you\'re \\nwilling to cache up to 50% of the total docs in the index. \\n\\n  FYI: there\'s a nocommit in there misspelled as \\\"No commit\\\"  \\n\\n Martijn can you fix this one...?  And in general try to spell it as \\n\\\"nocommit\\\"   This is what our build catches.  (And, fear not, you\'re \\nnot the only person to have trouble spelling nocommit!!).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044255\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044255&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044255\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044255_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044255_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 10:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T10:17:46+0000\'\u003e04\\/Jun\\/11 10:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eDo we have a group.facet = after ? I still like the old collapse component better because it had the collapse.facet=after.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think there is another ticket, but not sure if it is being worked on?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eNo, not in this issue.  This issue is just about cutting Solr over to the grouping module.\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e is the issue for post-grouping facet counts.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044255_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044255_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 10:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T10:17:46+0000\'\u003e04\\/Jun\\/11 10:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n Do we have a group.facet = after ? I still like the old collapse component better because it had the collapse.facet=after. \\n\\n I think there is another ticket, but not sure if it is being worked on?  \\n No, not in this issue.  This issue is just about cutting Solr over to the grouping module. \\n\\n   LUCENE-3097   is the issue for post-grouping facet counts.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044263\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044263&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044263\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044263_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044263_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 10:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T10:42:22+0000\'\u003e04\\/Jun\\/11 10:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Yonik,\u003c\\/p\u003e\\n\\n\u003cp\u003eIt is good to know that you took a look at the patch!\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ein the QueryComponent, why the change to set the GET_SCORES flag based on the sort(s)?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eYes I did this because I used to set Grouping.needScores with this flag. The needScores I also used whether to indicate if the scores need to be cached. However I have changed this in the updated patch and basically this check isn\'t done with setting GET_SCORES flag. \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI\'m not a fan of this new style for matching request parameters to enums...\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eWe can choose to leave out the upper-casing. Solr users would then need make sure that parameter options are spelled correctly. Would that be allright? \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003e\\\"Accuracy\\\" seems a bit mis-named?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eMaybe another name is more descriptive. Maybe style or method?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eThe parameter \\\"group.totalCount\\\" I would expect to return the total count of something, not control the pre\\/post faceting thing?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eThe jdoc is mixed up with group.docSet. I also think that group.groupCount is a better name. I changed this in the new patch \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eWhat does \\\"group.docSet\\\" do?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eCurrently nothing. I plan to use it when I finish \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e. Basically it will decide whether the docset (for FacetComponent and StatsComponent) is based on plain documents or groups. Since you can have more than one Command (Field \\/ Function \\/ Query), it will then select the first CommandField or CommandFunction. I\'m not sure how we should handle multiple command when having more than one command. \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI\'m not sure we should default group.cache to true\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eThe query time can really be reduced with this option, but yes it requires more memory. If the cache collector threshold is met they array is immediately set to null during the search, so gc might be able to clean it up during the search. Also Solr users get a message in the response. Somehow I forget to move that from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-2524\\\" title=\\\"Adding grouping to Solr 3x\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-2524\\\"\u003e\u003cdel\u003eSOLR-2524\u003c\\/del\u003e\u003c\\/a\u003e, but it is in the updated patch now.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ewe could dump group.cache and have a single group.cacheMB parameter that uses 0 as no cache, -1 as maximum needed (solr uses -1 in this manner in other places too)\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eMakes sense, grouping then at least consistent with the rest of Solr. I made it default to -1 for now.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eFYI: there\'s a nocommit in there misspelled as \\\"No commit\\\"\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI have removed that.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eIt wasn\'t necessary before, and there are advantages to preserving information (like the fact that someone said \\\"no limit\\\" vs a specific number) until as late as possible. That was previously handled by getMax() in Grouping.java, and I still see it being called... so it should be OK?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI\'ve removed this if statement and made sure that getMax(...) is used wherever it is needed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044263_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044263_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 10:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T10:42:22+0000\'\u003e04\\/Jun\\/11 10:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Yonik, \\n\\n It is good to know that you took a look at the patch! \\n\\n  in the QueryComponent, why the change to set the GET_SCORES flag based on the sort(s)?  \\n Yes I did this because I used to set Grouping.needScores with this flag. The needScores I also used whether to indicate if the scores need to be cached. However I have changed this in the updated patch and basically this check isn\'t done with setting GET_SCORES flag.  \\n\\n  I\'m not a fan of this new style for matching request parameters to enums...  \\n We can choose to leave out the upper-casing. Solr users would then need make sure that parameter options are spelled correctly. Would that be allright?  \\n\\n  \\\"Accuracy\\\" seems a bit mis-named?  \\n Maybe another name is more descriptive. Maybe style or method? \\n\\n  The parameter \\\"group.totalCount\\\" I would expect to return the total count of something, not control the pre\\/post faceting thing?  \\n The jdoc is mixed up with group.docSet. I also think that group.groupCount is a better name. I changed this in the new patch  \\n\\n  What does \\\"group.docSet\\\" do?  \\n Currently nothing. I plan to use it when I finish   LUCENE-3097  . Basically it will decide whether the docset (for FacetComponent and StatsComponent) is based on plain documents or groups. Since you can have more than one Command (Field \\/ Function \\/ Query), it will then select the first CommandField or CommandFunction. I\'m not sure how we should handle multiple command when having more than one command.  \\n\\n  I\'m not sure we should default group.cache to true  \\n The query time can really be reduced with this option, but yes it requires more memory. If the cache collector threshold is met they array is immediately set to null during the search, so gc might be able to clean it up during the search. Also Solr users get a message in the response. Somehow I forget to move that from   SOLR-2524  , but it is in the updated patch now. \\n\\n  we could dump group.cache and have a single group.cacheMB parameter that uses 0 as no cache, -1 as maximum needed (solr uses -1 in this manner in other places too)  \\n Makes sense, grouping then at least consistent with the rest of Solr. I made it default to -1 for now. \\n\\n  FYI: there\'s a nocommit in there misspelled as \\\"No commit\\\"  \\n I have removed that. \\n\\n \\n It wasn\'t necessary before, and there are advantages to preserving information (like the fact that someone said \\\"no limit\\\" vs a specific number) until as late as possible. That was previously handled by getMax() in Grouping.java, and I still see it being called... so it should be OK?  \\n I\'ve removed this if statement and made sure that getMax(...) is used wherever it is needed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044267\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044267&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044267\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044267_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044267_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 11:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T11:00:41+0000\'\u003e04\\/Jun\\/11 11:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eHow about TotalCount.GROUPS and TotalCount.DOCS?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003e+1 I think we can with that name for the total counts. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044267_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044267_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 11:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T11:00:41+0000\'\u003e04\\/Jun\\/11 11:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     How about TotalCount.GROUPS and TotalCount.DOCS?  \\n +1 I think we can with that name for the total counts.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044283\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044283&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044283\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044283_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044283_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 12:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T12:39:39+0000\'\u003e04\\/Jun\\/11 12:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eWe can choose to leave out the upper-casing. Solr users would then need make sure that parameter options are spelled correctly. Would that be allright?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIt seems like \\\"typically\\\" the request param values must be lower-case?\u003cbr\\/\u003e\\n(Which I think is good...).\u003c\\/p\u003e\\n\\n\u003cp\u003eSo, maybe... we make an exception to enum casing (normally ALL CAPS)\u003cbr\\/\u003e\\nand use lowercase for enums that corresopnd to valid values for\u003cbr\\/\u003e\\nrequest params?  Then we can just do .valueOf() directly, and we get\u003cbr\\/\u003e\\nthe strong checking to catch mis-spellings.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044283_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044283_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 12:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T12:39:39+0000\'\u003e04\\/Jun\\/11 12:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     We can choose to leave out the upper-casing. Solr users would then need make sure that parameter options are spelled correctly. Would that be allright?  \\n\\n It seems like \\\"typically\\\" the request param values must be lower-case? \\n(Which I think is good...). \\n\\n So, maybe... we make an exception to enum casing (normally ALL CAPS) \\nand use lowercase for enums that corresopnd to valid values for \\nrequest params?  Then we can just do .valueOf() directly, and we get \\nthe strong checking to catch mis-spellings.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044322\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044322&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044322\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044322_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044322_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 16:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T16:08:37+0000\'\u003e04\\/Jun\\/11 16:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eSo, maybe... we make an exception to enum casing (normally ALL CAPS) and use lowercase for enums that corresopnd to valid values for request params? \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1 - seems like a good tradeoff, and the fact that it\'s scoped by the classname still makes it stand out.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044322_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044322_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jun\\/11 16:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-04T16:08:37+0000\'\u003e04\\/Jun\\/11 16:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     So, maybe... we make an exception to enum casing (normally ALL CAPS) and use lowercase for enums that corresopnd to valid values for request params?   \\n\\n +1 - seems like a good tradeoff, and the fact that it\'s scoped by the classname still makes it stand out.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044535\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044535&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044535\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044535_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044535_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Jun\\/11 14:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-05T14:11:48+0000\'\u003e05\\/Jun\\/11 14:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for theupdate Martijn, it\'s looking good.\u003c\\/p\u003e\\n\\n\u003cp\u003eJust a note that the following optimization will no longer be valid once we have \\\"post collapse faceting\\\" or whatever we\'re calling it, or\u003cbr\\/\u003e\\nwhen we have an option to return the total number of groups.\u003cbr\\/\u003e\\nBut hopefully our random testing will catch that in the future.\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e    \u003cspan class=\\\"code-keyword\\\"\u003eprotected\u003c\\/span\u003e Collector createFirstPassCollector() \u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e IOException {\\n      \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ Ok we don\'t want groups, but \u003cspan class=\\\"code-keyword\\\"\u003edo\u003c\\/span\u003e want a total count\\n\u003c\\/span\u003e      \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (actualGroupsToFind &lt;= 0) {\\n        fallBackCollector = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e TotalHitCountCollector();\\n        \u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e fallBackCollector;\\n      }\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eHowever I have changed this in the updated patch and basically this check isn\'t done with setting GET_SCORES flag.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThanks... GET_SCORES does have a different meaning: scores must be returned to the caller (which can still be false even if scores are used for sorting)\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI also think that group.groupCount is a better name.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003egroupCount is now GROUPED or UNGROUPED, and is used to set \\\"Accuracy\\\" (more on that later \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/wink.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003cbr\\/\u003e\\nSeems like this parameter should be a boolean that says if the total number of groups should be returned?\u003cbr\\/\u003e\\nIf true, we can add a \\\"ngroups\\\" or \\\"groupCount\\\" element at the same level as \\\"matches\\\".  We should probably just name the parameter the same thing as the variable that gets returned... i.e. group.ngroups=true would cause \\\"ngroups\\\" to be populated (or groupCount if we decide that\'s a better name).\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eMaybe another name is more descriptive. Maybe style or method?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003e\\\"method\\\" should probably be reserved for the algorithm used for collapsing (as we do for faceting).\u003c\\/p\u003e\\n\\n\u003cp\u003eBackground for others: This feature has been called many things like \\\"post collapse faceting\\\", etc.  But it\'s really much more than that.  Normal grouping simply groups documents and presents them in a different way, but does \u003cb\u003enot\u003c\\/b\u003e change what documents match the base query + filters.  The other use-case is more like field collapsing and does change what documents match (basically, only the first documents in each group, up to limit, \\\"match\\\").\u003c\\/p\u003e\\n\\n\u003cp\u003eMaybe just use a word from the original name for this whole feature... \\\"group.collapse=true\\\"?\u003c\\/p\u003e\\n\\n\u003cp\u003eThere are some other interesting semantics to work out for group.collapse=true, such as if the collapsing happens before or after filters are applied.  Perhaps either could make sense depending on the use case?  Here\'s one use case I can think of: using field collapsing for only showing the latest version of a document.  In this case, one would only want collapsing to apply to the base query (with filtering happening after that) because you don\'t want to get into the position of having a filter that filters out the most recent version of a document and thus shows an older version.\u003c\\/p\u003e\\n\\n\u003cp\u003eHowever for now if it\'s easier, we could treat group.collapse=true to apply to the base query and all filters, and handle the use case I mentioned above via a qparser in the future.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044535_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044535_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Jun\\/11 14:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-05T14:11:48+0000\'\u003e05\\/Jun\\/11 14:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for theupdate Martijn, it\'s looking good. \\n\\n Just a note that the following optimization will no longer be valid once we have \\\"post collapse faceting\\\" or whatever we\'re calling it, or \\nwhen we have an option to return the total number of groups. \\nBut hopefully our random testing will catch that in the future. \\n\\n  \\n      protected  Collector createFirstPassCollector()  throws  IOException {\\n       \\/\\/ Ok we don\'t want groups, but  do  want a total count\\n        if  (actualGroupsToFind &lt;= 0) {\\n        fallBackCollector =  new  TotalHitCountCollector();\\n         return  fallBackCollector;\\n      }\\n \\n  \\n\\n  However I have changed this in the updated patch and basically this check isn\'t done with setting GET_SCORES flag.  \\n\\n Thanks... GET_SCORES does have a different meaning: scores must be returned to the caller (which can still be false even if scores are used for sorting) \\n\\n  I also think that group.groupCount is a better name.  \\n\\n groupCount is now GROUPED or UNGROUPED, and is used to set \\\"Accuracy\\\" (more on that later   \\nSeems like this parameter should be a boolean that says if the total number of groups should be returned? \\nIf true, we can add a \\\"ngroups\\\" or \\\"groupCount\\\" element at the same level as \\\"matches\\\".  We should probably just name the parameter the same thing as the variable that gets returned... i.e. group.ngroups=true would cause \\\"ngroups\\\" to be populated (or groupCount if we decide that\'s a better name). \\n\\n  Maybe another name is more descriptive. Maybe style or method?  \\n \\\"method\\\" should probably be reserved for the algorithm used for collapsing (as we do for faceting). \\n\\n Background for others: This feature has been called many things like \\\"post collapse faceting\\\", etc.  But it\'s really much more than that.  Normal grouping simply groups documents and presents them in a different way, but does  not  change what documents match the base query + filters.  The other use-case is more like field collapsing and does change what documents match (basically, only the first documents in each group, up to limit, \\\"match\\\"). \\n\\n Maybe just use a word from the original name for this whole feature... \\\"group.collapse=true\\\"? \\n\\n There are some other interesting semantics to work out for group.collapse=true, such as if the collapsing happens before or after filters are applied.  Perhaps either could make sense depending on the use case?  Here\'s one use case I can think of: using field collapsing for only showing the latest version of a document.  In this case, one would only want collapsing to apply to the base query (with filtering happening after that) because you don\'t want to get into the position of having a filter that filters out the most recent version of a document and thus shows an older version. \\n\\n However for now if it\'s easier, we could treat group.collapse=true to apply to the base query and all filters, and handle the use case I mentioned above via a qparser in the future.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044573\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044573&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044573\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044573_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044573_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Jun\\/11 16:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-05T16:36:10+0000\'\u003e05\\/Jun\\/11 16:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003egroupCount is now GROUPED or UNGROUPED, and is used to set \\\"Accuracy\\\" (more on that later \u003cbr\\/\u003e\\nSeems like this parameter should be a boolean that says if the total number of groups should be returned?\u003cbr\\/\u003e\\nIf true, we can add a \\\"ngroups\\\" or \\\"groupCount\\\" element at the same level as \\\"matches\\\". We should probably just name the parameter the same thing as the variable that gets returned... i.e. group.ngroups=true would cause \\\"ngroups\\\" to be populated (or groupCount if we decide that\'s a better name).\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI like that. I\'ll update the patch soon, so it includes ngroups together with matches, if group.ngroups=true is specified. \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003e\\\"method\\\" should probably be reserved for the algorithm used for collapsing (as we do for faceting).\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eMaybe we can use this for letting the user choose one of the Term|Block|Function|*GroupCollectors. The collectors define the way how groups are created.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eHowever for now if it\'s easier, we could treat group.collapse=true to apply to the base query and all filters, and handle the use case I mentioned above via a qparser in the future\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI agree let\'s commit this first and then start to enhance the collapse feature. The group.collapse should be included when \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e is finished which shouldn\'t take that long! \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044573_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044573_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Jun\\/11 16:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-05T16:36:10+0000\'\u003e05\\/Jun\\/11 16:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n groupCount is now GROUPED or UNGROUPED, and is used to set \\\"Accuracy\\\" (more on that later  \\nSeems like this parameter should be a boolean that says if the total number of groups should be returned? \\nIf true, we can add a \\\"ngroups\\\" or \\\"groupCount\\\" element at the same level as \\\"matches\\\". We should probably just name the parameter the same thing as the variable that gets returned... i.e. group.ngroups=true would cause \\\"ngroups\\\" to be populated (or groupCount if we decide that\'s a better name).  \\n I like that. I\'ll update the patch soon, so it includes ngroups together with matches, if group.ngroups=true is specified.  \\n\\n  \\\"method\\\" should probably be reserved for the algorithm used for collapsing (as we do for faceting).  \\n Maybe we can use this for letting the user choose one of the Term|Block|Function|*GroupCollectors. The collectors define the way how groups are created. \\n\\n  However for now if it\'s easier, we could treat group.collapse=true to apply to the base query and all filters, and handle the use case I mentioned above via a qparser in the future  \\n I agree let\'s commit this first and then start to enhance the collapse feature. The group.collapse should be included when   LUCENE-3097   is finished which shouldn\'t take that long!               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044647\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044647&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044647\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044647_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044647_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Jun\\/11 23:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-05T23:28:34+0000\'\u003e05\\/Jun\\/11 23:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached an updated patch.\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eRenamed group.groupCount to group.ngroups\u003c\\/li\u003e\\n\\t\u003cli\u003eWhen group.ngroups=true ngroups is added with matches in the response.\u003c\\/li\u003e\\n\\t\u003cli\u003eIncluded group.ngroups option into random testing. (all grouping tests succeed)\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044647_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044647_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Jun\\/11 23:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-05T23:28:34+0000\'\u003e05\\/Jun\\/11 23:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached an updated patch. \\n \\n\\t Renamed group.groupCount to group.ngroups \\n\\t When group.ngroups=true ngroups is added with matches in the response. \\n\\t Included group.ngroups option into random testing. (all grouping tests succeed) \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044820\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044820&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044820\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044820_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044820_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 12:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T12:43:40+0000\'\u003e06\\/Jun\\/11 12:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch looks great Martijn!\u003c\\/p\u003e\\n\\n\u003cp\u003eOnly thing I noticed is cacheSizeMB is computed incorrectly from\u003cbr\\/\u003e\\nmaxDoc (for the -1 case), because that\'s all int math I think?  Ie\u003cbr\\/\u003e\\nit\'ll be truncated from eg 13.7 MB -&gt; 13.  But: why not just use\u003cbr\\/\u003e\\nDouble.MAX_VALUE?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044820_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044820_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 12:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T12:43:40+0000\'\u003e06\\/Jun\\/11 12:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch looks great Martijn! \\n\\n Only thing I noticed is cacheSizeMB is computed incorrectly from \\nmaxDoc (for the -1 case), because that\'s all int math I think?  Ie \\nit\'ll be truncated from eg 13.7 MB -&gt; 13.  But: why not just use \\nDouble.MAX_VALUE?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044821\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044821&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044821\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044821_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044821_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 12:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T12:44:51+0000\'\u003e06\\/Jun\\/11 12:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eThe other use-case is more like field collapsing and does change what documents match (basically, only the first documents in each group, up to limit, \\\"match\\\").\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI\'m not sure it\'s that simple, ie that we can so cleanly model\u003cbr\\/\u003e\\ncollapsing as reducing the docs to consider and then running faceting\u003cbr\\/\u003e\\non that reduced set.\u003c\\/p\u003e\\n\\n\u003cp\u003eEG, the use case of getting correct facet counts for a field that has\u003cbr\\/\u003e\\ndifferent values within the group, can\'t be handled by this approach?\u003cbr\\/\u003e\\nThis is the count=2 for size=S in my example at\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097?focusedCommentId=13038605&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13038605\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097?focusedCommentId=13038605&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13038605\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eI think to do that properly, the faceting impl needs to see all docs\u003cbr\\/\u003e\\nin the group, not just the \\\"lead doc\\\" per group.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think another way to visualize\\/model this that we really need to be\u003cbr\\/\u003e\\nable to configure \\\"which field counts\\\" (ID_FIELD) for the schema.\u003cbr\\/\u003e\\nThis field would then decide all counts &#8211; total \\\"hit count\\\", facet\u003cbr\\/\u003e\\ncounts, etc., ie each of these counts is count(unique(ID_FIELD)) of\u003cbr\\/\u003e\\nthe docs falling in that facet\\/result set.  The default is Lucene\'s docid,\u003cbr\\/\u003e\\nbut the app should be able to state any other ID_FIELD.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044821_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044821_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 12:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T12:44:51+0000\'\u003e06\\/Jun\\/11 12:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     The other use-case is more like field collapsing and does change what documents match (basically, only the first documents in each group, up to limit, \\\"match\\\").  \\n\\n I\'m not sure it\'s that simple, ie that we can so cleanly model \\ncollapsing as reducing the docs to consider and then running faceting \\non that reduced set. \\n\\n EG, the use case of getting correct facet counts for a field that has \\ndifferent values within the group, can\'t be handled by this approach? \\nThis is the count=2 for size=S in my example at \\n https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097?focusedCommentId=13038605&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13038605  \\n\\n I think to do that properly, the faceting impl needs to see all docs \\nin the group, not just the \\\"lead doc\\\" per group. \\n\\n I think another way to visualize\\/model this that we really need to be \\nable to configure \\\"which field counts\\\" (ID_FIELD) for the schema. \\nThis field would then decide all counts &#8211; total \\\"hit count\\\", facet \\ncounts, etc., ie each of these counts is count(unique(ID_FIELD)) of \\nthe docs falling in that facet\\/result set.  The default is Lucene\'s docid, \\nbut the app should be able to state any other ID_FIELD.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044867\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044867&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044867\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044867_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044867_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 14:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T14:18:37+0000\'\u003e06\\/Jun\\/11 14:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003e&gt; The other use-case is more like field collapsing and does change what documents match (basically, only the first documents in each group, up to limit, \\\"match\\\").\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI\'m not sure it\'s that simple, ie that we can so cleanly model collapsing as reducing the docs to consider and then running faceting on that reduced set.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI \u003cb\u003ethink\u003c\\/b\u003e that\'s what was actually implemented in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-236\\\" title=\\\"Field collapsing\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-236\\\"\u003e\u003cdel\u003eSOLR-236\u003c\\/del\u003e\u003c\\/a\u003e IIRC, and what some people seem to be asking for.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eEG, the use case of getting correct facet counts for a field that has different values within the group, can\'t be handled by this approach?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWell, correct is a matter of context \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/wink.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e (for example, some have called the facet counts for the current grouping implementation \\\"incorrect\\\" because it didn\'t happen to match their use case).  Looking at the original description in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e, it seems you\'re talking about Martijn\'s 3rd method, while I was talking about the 2nd.  But maybe some people that were originally advocating for #2, really wanted #3?\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13044867_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044867_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 14:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T14:18:37+0000\'\u003e06\\/Jun\\/11 14:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     &gt; The other use-case is more like field collapsing and does change what documents match (basically, only the first documents in each group, up to limit, \\\"match\\\").  \\n\\n  I\'m not sure it\'s that simple, ie that we can so cleanly model collapsing as reducing the docs to consider and then running faceting on that reduced set.  \\n\\n I  think  that\'s what was actually implemented in   SOLR-236   IIRC, and what some people seem to be asking for. \\n\\n  EG, the use case of getting correct facet counts for a field that has different values within the group, can\'t be handled by this approach?  \\n\\n Well, correct is a matter of context   (for example, some have called the facet counts for the current grouping implementation \\\"incorrect\\\" because it didn\'t happen to match their use case).  Looking at the original description in   LUCENE-3097  , it seems you\'re talking about Martijn\'s 3rd method, while I was talking about the 2nd.  But maybe some people that were originally advocating for #2, really wanted #3? \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044927\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044927&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044927\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044927_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044927_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 16:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T16:03:01+0000\'\u003e06\\/Jun\\/11 16:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think a good criteria for \\\"correct\\\" is if you were to click through on the facet (ie, take the current query and add a filter on facet field = facet value), would the hit count you see match the facet count you were just looking at?\u003c\\/p\u003e\\n\\n\u003cp\u003eIe, drill down should be \\\"consistent\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eBoth approaches will give the same facets counts if the field never varies within the group (ie, the field \\\"belongs\\\" to the \\\"parent\\\" docs); it\'s only \\\"child\\\" fields where you need faceting to be aware of the groups, so for apps that never display facets on child fields, only computing facets on the group heads will work.\u003c\\/p\u003e\\n\\n\u003cp\u003eI suspect doc blocks will be the only practical way to implement faceting on child fields efficiently.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13044927_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044927_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 16:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T16:03:01+0000\'\u003e06\\/Jun\\/11 16:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think a good criteria for \\\"correct\\\" is if you were to click through on the facet (ie, take the current query and add a filter on facet field = facet value), would the hit count you see match the facet count you were just looking at? \\n\\n Ie, drill down should be \\\"consistent\\\". \\n\\n Both approaches will give the same facets counts if the field never varies within the group (ie, the field \\\"belongs\\\" to the \\\"parent\\\" docs); it\'s only \\\"child\\\" fields where you need faceting to be aware of the groups, so for apps that never display facets on child fields, only computing facets on the group heads will work. \\n\\n I suspect doc blocks will be the only practical way to implement faceting on child fields efficiently.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13044940\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13044940&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13044940\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044940_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044940_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 16:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T16:23:22+0000\'\u003e06\\/Jun\\/11 16:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eBut: why not just use Double.MAX_VALUE?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eYes, I should have used that and I\'ll change that. I thought that the size was initially used to create the underline array. But it isn\'t! The array inside the caching collector initially starts with a length 128 and grows when needed.\u003c\\/p\u003e\\n\\n\u003cp\u003eHow I\'ve currently implemented \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e is that it will only get the most relevant document of each group. In terms of \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-236\\\" title=\\\"Field collapsing\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-236\\\"\u003e\u003cdel\u003eSOLR-236\u003c\\/del\u003e\u003c\\/a\u003e that is the same as using collapse.threshold=1. I think what Yonik means is increasing the threshold so more documents and up in the docset, that eventually is used by the facet component. Increasing this threshold also means setting when to start to collapse. So when setting the collapse.threshold=3 this means that from the 4th document the collapsing starts. I think that the whole collaps.threshold feature doesn\'t scale very well. \u003c\\/p\u003e\\n\\n\u003cp\u003eAnyway, I think when we go wire the 2nd method (\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e) into Solr, we should first make it work for the most relevant group documents.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13044940_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13044940_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 16:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T16:23:22+0000\'\u003e06\\/Jun\\/11 16:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     But: why not just use Double.MAX_VALUE?  \\n Yes, I should have used that and I\'ll change that. I thought that the size was initially used to create the underline array. But it isn\'t! The array inside the caching collector initially starts with a length 128 and grows when needed. \\n\\n How I\'ve currently implemented   LUCENE-3097   is that it will only get the most relevant document of each group. In terms of   SOLR-236   that is the same as using collapse.threshold=1. I think what Yonik means is increasing the threshold so more documents and up in the docset, that eventually is used by the facet component. Increasing this threshold also means setting when to start to collapse. So when setting the collapse.threshold=3 this means that from the 4th document the collapsing starts. I think that the whole collaps.threshold feature doesn\'t scale very well.  \\n\\n Anyway, I think when we go wire the 2nd method (  LUCENE-3097  ) into Solr, we should first make it work for the most relevant group documents.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13045002\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13045002&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13045002\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13045002_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045002_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 18:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T18:25:28+0000\'\u003e06\\/Jun\\/11 18:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eBrowsing around this a bit more... the existing solr code selected the string based collectors for any ValueSource of StrFieldSource.  This patch resorts to exact getClass() checks against string and text fields which won\'t match in as many cases (either derived fields, or user custom fields that don\'t derive from either of the these field types)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13045002_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045002_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 18:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T18:25:28+0000\'\u003e06\\/Jun\\/11 18:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Browsing around this a bit more... the existing solr code selected the string based collectors for any ValueSource of StrFieldSource.  This patch resorts to exact getClass() checks against string and text fields which won\'t match in as many cases (either derived fields, or user custom fields that don\'t derive from either of the these field types)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13045027\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13045027&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13045027\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13045027_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045027_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 18:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T18:53:28+0000\'\u003e06\\/Jun\\/11 18:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'ve been checking out the performance, and it generally seems fine.  But of course we normally short circuit based on comparators and often don\'t get beyond that... so to exercise &amp; isolate the rest of the code, I tried a worst-case scenario where the short circuit wouldn\'t work (sort=\u003cem\u003edocid\u003c\\/em\u003e desc) and solr trunk with this patch is ~16% slower than without it.  Any ideas what the problem might be?\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003ehttp:\u003cspan class=\\\"code-comment\\\"\u003e\\/\\/localhost:8983\\/solr\\/select?q=*:*&amp;sort=_docid_ desc&amp;group=\u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e&amp;group.cacheMB=0&amp;group.field=single1000_i\u003c\\/span\u003e\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eNote: the single1000_i field is a single valued int field with 1000 unique values\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13045027_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045027_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 18:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T18:53:28+0000\'\u003e06\\/Jun\\/11 18:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'ve been checking out the performance, and it generally seems fine.  But of course we normally short circuit based on comparators and often don\'t get beyond that... so to exercise &amp; isolate the rest of the code, I tried a worst-case scenario where the short circuit wouldn\'t work (sort= docid  desc) and solr trunk with this patch is ~16% slower than without it.  Any ideas what the problem might be? \\n\\n  \\n http: \\/\\/localhost:8983\\/solr\\/select?q=*:*&amp;sort=_docid_ desc&amp;group= true &amp;group.cacheMB=0&amp;group.field=single1000_i \\n \\n  \\n\\n Note: the single1000_i field is a single valued int field with 1000 unique values              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13045079\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13045079&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13045079\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13045079_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045079_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 20:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T20:35:33+0000\'\u003e06\\/Jun\\/11 20:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHmmm.  Was this with or without caching?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13045079_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045079_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 20:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T20:35:33+0000\'\u003e06\\/Jun\\/11 20:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hmmm.  Was this with or without caching?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13045087\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13045087&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13045087\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13045087_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045087_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 20:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T20:46:55+0000\'\u003e06\\/Jun\\/11 20:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis was without caching to put them on an even footing (and given that the base query was all docs, caching would be slower anyway).  The URL above was the actual one used to test.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13045087_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045087_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Jun\\/11 20:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-06T20:46:55+0000\'\u003e06\\/Jun\\/11 20:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This was without caching to put them on an even footing (and given that the base query was all docs, caching would be slower anyway).  The URL above was the actual one used to test.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13045898\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13045898&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13045898\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13045898_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045898_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 11:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T11:02:06+0000\'\u003e08\\/Jun\\/11 11:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached a new patch that should select the term based collectors now more often:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eIn the case of grouping by function and the value source is StrFieldValueSource.\u003c\\/li\u003e\\n\\t\u003cli\u003eAll field types that produce a StrFieldValueSource (in getValueSource) use now the term based collectors. So any custom field type can now also be supported. Both TextField and StrField produce a StrFieldValueSource. I\'m not if this is the right approach, but it was the most easy way to implement.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13045898_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045898_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 11:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T11:02:06+0000\'\u003e08\\/Jun\\/11 11:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached a new patch that should select the term based collectors now more often: \\n \\n\\t In the case of grouping by function and the value source is StrFieldValueSource. \\n\\t All field types that produce a StrFieldValueSource (in getValueSource) use now the term based collectors. So any custom field type can now also be supported. Both TextField and StrField produce a StrFieldValueSource. I\'m not if this is the right approach, but it was the most easy way to implement. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13045904\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13045904&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13045904\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13045904_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045904_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 11:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T11:12:10+0000\'\u003e08\\/Jun\\/11 11:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Martijn van Groningen - 08\\/Jun\\/11 11:12\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eI\'ve been checking out the performance, and it generally seems fine. But of course we normally short circuit based on comparators and often don\'t get beyond that... so to exercise &amp; isolate the rest of the code, I tried a worst-case scenario where the short circuit wouldn\'t work (sort=docid desc) and solr trunk with this patch is ~16% slower than without it. Any ideas what the problem might be?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWhat might be the problem is that the trunk is using (Grouping.java 589):\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003eSearchGroup smallest = orderedGroups.pollLast();\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eWhilst the AbstractFirstPassGroupingCollector (line 217) is using:\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e\u003cspan class=\\\"code-keyword\\\"\u003efinal\u003c\\/span\u003e CollectedSearchGroup&lt;GROUP_VALUE_TYPE&gt; bottomGroup = orderedGroups.last();\\norderedGroups.remove(bottomGroup);\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eThe above also happen around line 271.\u003c\\/p\u003e\\n\\n\u003cp\u003eI haven\'t checked this out, but I think it is the most likely explanation between those two implementations. Retrieving the bottom group will be done in almost all cases when the short circuit doesn\'t work \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13045904_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045904_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 11:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T11:12:10+0000\'\u003e08\\/Jun\\/11 11:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Martijn van Groningen - 08\\/Jun\\/11 11:12\\\"\u003eedited\u003c\\/span\u003e                   \\n I\'ve been checking out the performance, and it generally seems fine. But of course we normally short circuit based on comparators and often don\'t get beyond that... so to exercise &amp; isolate the rest of the code, I tried a worst-case scenario where the short circuit wouldn\'t work (sort=docid desc) and solr trunk with this patch is ~16% slower than without it. Any ideas what the problem might be?  \\n\\n What might be the problem is that the trunk is using (Grouping.java 589): \\n  \\n SearchGroup smallest = orderedGroups.pollLast();\\n \\n  \\n\\n Whilst the AbstractFirstPassGroupingCollector (line 217) is using: \\n  \\n  final  CollectedSearchGroup&lt;GROUP_VALUE_TYPE&gt; bottomGroup = orderedGroups.last();\\norderedGroups.remove(bottomGroup);\\n \\n  \\n The above also happen around line 271. \\n\\n I haven\'t checked this out, but I think it is the most likely explanation between those two implementations. Retrieving the bottom group will be done in almost all cases when the short circuit doesn\'t work               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13045920\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13045920&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13045920\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13045920_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045920_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 12:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T12:23:46+0000\'\u003e08\\/Jun\\/11 12:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAh, good call Martijn - it must be that pollLast was replaced with two map operations.\u003cbr\\/\u003e\\nToo bad Lucene isn\'t on Java6 yet!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13045920_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045920_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 12:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T12:23:46+0000\'\u003e08\\/Jun\\/11 12:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Ah, good call Martijn - it must be that pollLast was replaced with two map operations. \\nToo bad Lucene isn\'t on Java6 yet!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13045924\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13045924&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13045924\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13045924_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045924_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 12:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T12:27:07+0000\'\u003e08\\/Jun\\/11 12:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ejust send an email to the dev list... lots of people will +1, uwe will -1, but I dont see why this is any issue for 4.0\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13045924_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13045924_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 12:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T12:27:07+0000\'\u003e08\\/Jun\\/11 12:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    just send an email to the dev list... lots of people will +1, uwe will -1, but I dont see why this is any issue for 4.0              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046002\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046002&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046002\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046002_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046002_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 15:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T15:17:59+0000\'\u003e08\\/Jun\\/11 15:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAhh nice catch Martijn!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046002_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046002_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 15:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T15:17:59+0000\'\u003e08\\/Jun\\/11 15:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Ahh nice catch Martijn!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046072\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046072&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046072\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046072_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046072_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 16:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T16:58:09+0000\'\u003e08\\/Jun\\/11 16:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think we should decouple the \\\"should Lucene require Java 6\\\" (which I expect to be an..... involved, discussion) from making progress here?\u003c\\/p\u003e\\n\\n\u003cp\u003eMy feeling is we should still commit this.  The 16% slowdown is on a very synthetic case (MatchAllDocsQuery, sorting by reversed docID, grouping by random int field)... unless we also see unacceptable slowdowns in more realistic cases?  Also, net\\/net the user should see a speedup, typically, since caching is enabled by default.\u003c\\/p\u003e\\n\\n\u003cp\u003eWe should still open an issue to cutover this code back to the pollLast once we can use Java 6 code.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnother option is to allow the grouping module (separately from Lucene core) to use Java 6 code.... but even that could be \\\"involved\\\" \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eYonik, how do you create the index used for this test?  Somehow you generate an int field w\\/ random 1000 unique values &#8211; do you have a client-side script you use to create random docs in Solr?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046072_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046072_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 16:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T16:58:09+0000\'\u003e08\\/Jun\\/11 16:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think we should decouple the \\\"should Lucene require Java 6\\\" (which I expect to be an..... involved, discussion) from making progress here? \\n\\n My feeling is we should still commit this.  The 16% slowdown is on a very synthetic case (MatchAllDocsQuery, sorting by reversed docID, grouping by random int field)... unless we also see unacceptable slowdowns in more realistic cases?  Also, net\\/net the user should see a speedup, typically, since caching is enabled by default. \\n\\n We should still open an issue to cutover this code back to the pollLast once we can use Java 6 code. \\n\\n Another option is to allow the grouping module (separately from Lucene core) to use Java 6 code.... but even that could be \\\"involved\\\"   \\n\\n Yonik, how do you create the index used for this test?  Somehow you generate an int field w\\/ random 1000 unique values &#8211; do you have a client-side script you use to create random docs in Solr?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046091\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046091&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046091\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13046091_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046091_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 17:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T17:22:31+0000\'\u003e08\\/Jun\\/11 17:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eAnother option is to allow the grouping module (separately from Lucene core) to use Java 6 code\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eYonik, how do you create the index used for this test? Somehow you generate an int field w\\/ random 1000 unique values \\u2013 do you have a client-side script you use to create random docs in Solr?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI have some CSV files laying around that I reuse for ad-hoc testing of a lot of stuff.  They were created with a simple python script.\u003cbr\\/\u003e\\nThen I simply index with\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003eURL=http:\u003cspan class=\\\"code-comment\\\"\u003e\\/\\/localhost:8983\\/solr\\n\u003c\\/span\u003ecurl \u003cspan class=\\\"code-quote\\\"\u003e\\\"$URL\\/update\\/csv?stream.url=file:\\/tmp\\/test.csv&amp;overwrite=\u003cspan class=\\\"code-keyword\\\"\u003efalse\u003c\\/span\u003e&amp;commit=\u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e\\\"\u003c\\/span\u003e\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eIt was also my first reaction to think that this is a very synthetic case that people are unlikely to hit... until I thought about dates.  Indexing everything in date order is a pretty common thing to do, and so is sorting by date - which hits the exact same case.  Queries of \u003cb\u003e:\u003c\\/b\u003e and simple filter queries on type, etc, also tend to be pretty common (i.e. full-text relevance\\/performance actually isn\'t an important feature for some users).\u003c\\/p\u003e\\n\\n\u003cp\u003eHow complex must queries be for caching to generate a net benefit under load? I haven\'t tried to test this myself.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13046091_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046091_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 17:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T17:22:31+0000\'\u003e08\\/Jun\\/11 17:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Another option is to allow the grouping module (separately from Lucene core) to use Java 6 code  \\n\\n +1 \\n\\n  Yonik, how do you create the index used for this test? Somehow you generate an int field w\\/ random 1000 unique values \\u2013 do you have a client-side script you use to create random docs in Solr?  \\n\\n I have some CSV files laying around that I reuse for ad-hoc testing of a lot of stuff.  They were created with a simple python script. \\nThen I simply index with \\n  \\n URL=http: \\/\\/localhost:8983\\/solr\\n curl  \\\"$URL\\/update\\/csv?stream.url=file:\\/tmp\\/test.csv&amp;overwrite= false &amp;commit= true \\\" \\n \\n  \\n\\n It was also my first reaction to think that this is a very synthetic case that people are unlikely to hit... until I thought about dates.  Indexing everything in date order is a pretty common thing to do, and so is sorting by date - which hits the exact same case.  Queries of  :  and simple filter queries on type, etc, also tend to be pretty common (i.e. full-text relevance\\/performance actually isn\'t an important feature for some users). \\n\\n How complex must queries be for caching to generate a net benefit under load? I haven\'t tried to test this myself.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046103\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046103&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046103\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13046103_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046103_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 17:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T17:42:03+0000\'\u003e08\\/Jun\\/11 17:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eAnother option is to allow the grouping module (separately from Lucene core) to use Java 6 code.... but even that could be \\\"involved\\\" \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003ePersonally I am against parts of the code being java 6 and other parts being java 5. we already have this situation today (the solr part is java 6, everyhting else is java 5).\u003c\\/p\u003e\\n\\n\u003cp\u003eCome on, its a major version, lets just cut over everything to java 6. Java 5 isn\'t even supported by oracle anymore, so why the hell do we support it?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13046103_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046103_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 17:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T17:42:03+0000\'\u003e08\\/Jun\\/11 17:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n Another option is to allow the grouping module (separately from Lucene core) to use Java 6 code.... but even that could be \\\"involved\\\"   \\n\\n Personally I am against parts of the code being java 6 and other parts being java 5. we already have this situation today (the solr part is java 6, everyhting else is java 5). \\n\\n Come on, its a major version, lets just cut over everything to java 6. Java 5 isn\'t even supported by oracle anymore, so why the hell do we support it?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046105\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046105&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046105\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ryantxu\\\" id=\\\"commentauthor_13046105_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ryantxu\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ryantxu\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ryan McKinley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046105_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 17:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T17:52:47+0000\'\u003e08\\/Jun\\/11 17:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eJava 5 isn\'t even supported by oracle anymore, so why the hell do we support it?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1  (though this discussion should happen elsewhere)\u003c\\/p\u003e\\n\\n\u003cp\u003eIf the 16% slowdown is worst case and under \'normal\' use it would be equivolent\\/faster, i say lets move forward with that and push for java6 in a different issue.  Having a java6 version of lucene module (in solr?) seems like an mess.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ryantxu\\\" id=\\\"commentauthor_13046105_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ryantxu\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ryantxu\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ryan McKinley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046105_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 17:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T17:52:47+0000\'\u003e08\\/Jun\\/11 17:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Java 5 isn\'t even supported by oracle anymore, so why the hell do we support it?  \\n\\n +1  (though this discussion should happen elsewhere) \\n\\n If the 16% slowdown is worst case and under \'normal\' use it would be equivolent\\/faster, i say lets move forward with that and push for java6 in a different issue.  Having a java6 version of lucene module (in solr?) seems like an mess. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046106\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046106&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046106\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ehatcher\\\" id=\\\"commentauthor_13046106_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ehatcher\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ehatcher\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erik Hatcher\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046106_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 17:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T17:54:24+0000\'\u003e08\\/Jun\\/11 17:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eJust for grins, here\'s a Ruby script that\'ll do it (provided you have the solr-ruby gem installed):\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003erequire \u003cspan class=\\\"code-quote\\\"\u003e\'solr\'\u003c\\/span\u003e\\nsolr = Solr::Connection.\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e\\n1.upto(1000) {|i| solr.add(:id=&gt;i, :single1000_i=&gt;i)}\\nsolr.commit\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ehatcher\\\" id=\\\"commentauthor_13046106_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ehatcher\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ehatcher\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erik Hatcher\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046106_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 17:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T17:54:24+0000\'\u003e08\\/Jun\\/11 17:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Just for grins, here\'s a Ruby script that\'ll do it (provided you have the solr-ruby gem installed): \\n\\n  \\n require  \'solr\' \\nsolr = Solr::Connection. new \\n1.upto(1000) {|i| solr.add(:id=&gt;i, :single1000_i=&gt;i)}\\nsolr.commit\\n \\n               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046125\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046125&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046125\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13046125_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046125_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T18:34:41+0000\'\u003e08\\/Jun\\/11 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eIf the 16% slowdown is worst case\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eActually, the worst case is twice as slow due to unneeded caching of a simple query.  Luckily this can be configured... but I still question the default, which can lead to surprisingly huge memory use (think up to a field cache entry or more allocated per-request).  One advantage to the dual-pass approach by default in the first place was avoiding surprisingly large memory usage by default (which can degrade less gracefully by causing OOM exceptions as people try to crank up the number of request threads).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13046125_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046125_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T18:34:41+0000\'\u003e08\\/Jun\\/11 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     If the 16% slowdown is worst case  \\n\\n Actually, the worst case is twice as slow due to unneeded caching of a simple query.  Luckily this can be configured... but I still question the default, which can lead to surprisingly huge memory use (think up to a field cache entry or more allocated per-request).  One advantage to the dual-pass approach by default in the first place was avoiding surprisingly large memory usage by default (which can degrade less gracefully by causing OOM exceptions as people try to crank up the number of request threads).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046150\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046150&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046150\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046150_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046150_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 19:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T19:25:52+0000\'\u003e08\\/Jun\\/11 19:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eActually, the worst case is twice as slow due to unneeded caching of a simple query.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eSorry, what do you mean here?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ebut I still question the default, which can lead to surprisingly huge memory use (think up to a field cache entry or more allocated per-request).\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI agree; -1 is a dangerous default.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut I think caching should still default to on, just limited as a pctg\u003cbr\\/\u003e\\nof the number of docs in the index.  Ie, by default we will cache the\u003cbr\\/\u003e\\nresult set if it\'s less than 20% (say) of total docs in your index.\u003cbr\\/\u003e\\nElse we fallback to 2-pass.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think this matches how Solr handles caching filters now?  Ie, filter\u003cbr\\/\u003e\\ncache evicts by total filter count and not net MB right, I think?  So\u003cbr\\/\u003e\\nthat if you have more docs in your index you\'ll spending more RAM on\u003cbr\\/\u003e\\nthe caching...\u003c\\/p\u003e\\n\\n\u003cp\u003eCostly queries that return a smallish result set can see big gains\u003cbr\\/\u003e\\nfrom the caching.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046150_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046150_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jun\\/11 19:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-08T19:25:52+0000\'\u003e08\\/Jun\\/11 19:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Actually, the worst case is twice as slow due to unneeded caching of a simple query.  \\n\\n Sorry, what do you mean here? \\n\\n  but I still question the default, which can lead to surprisingly huge memory use (think up to a field cache entry or more allocated per-request).  \\n\\n I agree; -1 is a dangerous default. \\n\\n But I think caching should still default to on, just limited as a pctg \\nof the number of docs in the index.  Ie, by default we will cache the \\nresult set if it\'s less than 20% (say) of total docs in your index. \\nElse we fallback to 2-pass. \\n\\n I think this matches how Solr handles caching filters now?  Ie, filter \\ncache evicts by total filter count and not net MB right, I think?  So \\nthat if you have more docs in your index you\'ll spending more RAM on \\nthe caching... \\n\\n Costly queries that return a smallish result set can see big gains \\nfrom the caching.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046707\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046707&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046707\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13046707_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046707_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jun\\/11 17:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-09T17:56:22+0000\'\u003e09\\/Jun\\/11 17:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003e&gt; Actually, the worst case is twice as slow due to unneeded caching of a simple query.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cblockquote\u003e\u003cp\u003eSorry, what do you mean here?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThe worst case with this patch as a whole (due to the caching by default).\u003cbr\\/\u003e\\nThis type of query is twice as slow:\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003ehttp:\u003cspan class=\\\"code-comment\\\"\u003e\\/\\/localhost:8983\\/solr\\/select?q=*:*&amp;group=\u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e&amp;group.field=single1000_i\u003c\\/span\u003e\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eWhich led to me wondering about how complex queries must be before the caching is a win.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13046707_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046707_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jun\\/11 17:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-09T17:56:22+0000\'\u003e09\\/Jun\\/11 17:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     &gt; Actually, the worst case is twice as slow due to unneeded caching of a simple query.  \\n  Sorry, what do you mean here?  \\n\\n The worst case with this patch as a whole (due to the caching by default). \\nThis type of query is twice as slow: \\n  \\n http: \\/\\/localhost:8983\\/solr\\/select?q=*:*&amp;group= true &amp;group.field=single1000_i \\n \\n  \\n\\n Which led to me wondering about how complex queries must be before the caching is a win. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046766\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046766&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046766\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046766_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046766_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jun\\/11 19:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-09T19:29:19+0000\'\u003e09\\/Jun\\/11 19:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAhh, I see.  Could we turn off caching if the query is instanceof AllDocsQuery?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046766_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046766_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jun\\/11 19:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-09T19:29:19+0000\'\u003e09\\/Jun\\/11 19:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Ahh, I see.  Could we turn off caching if the query is instanceof AllDocsQuery?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046845\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046845&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046845\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13046845_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046845_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jun\\/11 22:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-09T22:01:52+0000\'\u003e09\\/Jun\\/11 22:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eBut I think caching should still default to on, just limited as a pctg\u003cbr\\/\u003e\\nof the number of docs in the index. Ie, by default we will cache the\u003cbr\\/\u003e\\nresult set if it\'s less than 20% (say) of total docs in your index.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eMaybe instead of specifying a maximum size for the second pass cache, we could specify it with a percentage (0 till 100) relative from maxdoc. In this case when the index grows in number of documents the cache is still used for a lot of queries (depending on the specified percentage). So if we go with this maybe group.cacheMB should be renamed to group.cache.percentage. The default can then be something like 20. Any thoughts about this?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13046845_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046845_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jun\\/11 22:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-09T22:01:52+0000\'\u003e09\\/Jun\\/11 22:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n But I think caching should still default to on, just limited as a pctg \\nof the number of docs in the index. Ie, by default we will cache the \\nresult set if it\'s less than 20% (say) of total docs in your index.  \\n Maybe instead of specifying a maximum size for the second pass cache, we could specify it with a percentage (0 till 100) relative from maxdoc. In this case when the index grows in number of documents the cache is still used for a lot of queries (depending on the specified percentage). So if we go with this maybe group.cacheMB should be renamed to group.cache.percentage. The default can then be something like 20. Any thoughts about this?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13046911\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13046911&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13046911\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046911_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046911_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jun\\/11 23:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-09T23:14:11+0000\'\u003e09\\/Jun\\/11 23:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e+1\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13046911_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13046911_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Jun\\/11 23:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-09T23:14:11+0000\'\u003e09\\/Jun\\/11 23:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    +1              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13047352\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13047352&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13047352\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_13047352_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13047352_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jun\\/11 18:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-10T18:23:51+0000\'\u003e10\\/Jun\\/11 18:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMarking this issue as a blocker for Solr 4.0 per McCandless comment in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-2524\\\" title=\\\"Adding grouping to Solr 3x\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-2524\\\"\u003e\u003cdel\u003eSOLR-2524\u003c\\/del\u003e\u003c\\/a\u003e...\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eThat said, the plan is definitely to get Solr 4.0 cutover to the\u003cbr\\/\u003e\\ngrouping module; it\'s just a matter of time. I don\'t think we should\u003cbr\\/\u003e\\nship 4.0 until we\'ve done so.\u003c\\/p\u003e\u003c\\/blockquote\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_13047352_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13047352_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jun\\/11 18:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-10T18:23:51+0000\'\u003e10\\/Jun\\/11 18:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Marking this issue as a blocker for Solr 4.0 per McCandless comment in   SOLR-2524  ... \\n\\n \\n That said, the plan is definitely to get Solr 4.0 cutover to the \\ngrouping module; it\'s just a matter of time. I don\'t think we should \\nship 4.0 until we\'ve done so.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13047478\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13047478&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13047478\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13047478_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13047478_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jun\\/11 21:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-10T21:36:16+0000\'\u003e10\\/Jun\\/11 21:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHmm, I think this only needs to be a 4.0 blocker if we commit \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-2524\\\" title=\\\"Adding grouping to Solr 3x\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-2524\\\"\u003e\u003cdel\u003eSOLR-2524\u003c\\/del\u003e\u003c\\/a\u003e (3.x Solr grouping) first.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut at this point, since we are close on this issue, it looks like we should hold \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-2524\\\" title=\\\"Adding grouping to Solr 3x\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-2524\\\"\u003e\u003cdel\u003eSOLR-2524\u003c\\/del\u003e\u003c\\/a\u003e until we commit this, then backport &amp; commit to 3.x.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13047478_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13047478_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jun\\/11 21:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-10T21:36:16+0000\'\u003e10\\/Jun\\/11 21:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hmm, I think this only needs to be a 4.0 blocker if we commit   SOLR-2524   (3.x Solr grouping) first. \\n\\n But at this point, since we are close on this issue, it looks like we should hold   SOLR-2524   until we commit this, then backport &amp; commit to 3.x.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13047917\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13047917&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13047917\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13047917_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13047917_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jun\\/11 14:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-11T14:45:42+0000\'\u003e11\\/Jun\\/11 14:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAdded updated patch.\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eThe caching behaviour is now controlled by group.cache.percent=\u003cspan class=\\\"error\\\"\u003e&#91;0-100&#93;\u003c\\/span\u003e. This percentage is relative to maxdoc. A value of 0 will disable group caching and the default is 20.\u003c\\/li\u003e\\n\\t\u003cli\u003eAdded hits to\\u00A0log as requested in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-2337\\\" title=\\\"Solr needs hits= added to the log when using grouping \\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-2337\\\"\u003e\u003cdel\u003eSOLR-2337\u003c\\/del\u003e\u003c\\/a\u003e. This will add hits also when group.main is not true.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13047917_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13047917_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jun\\/11 14:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-11T14:45:42+0000\'\u003e11\\/Jun\\/11 14:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Added updated patch. \\n \\n\\t The caching behaviour is now controlled by group.cache.percent= &#91;0-100&#93; . This percentage is relative to maxdoc. A value of 0 will disable group caching and the default is 20. \\n\\t Added hits to\\u00A0log as requested in   SOLR-2337  . This will add hits also when group.main is not true. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13047918\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13047918&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13047918\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13047918_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13047918_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jun\\/11 14:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-11T14:48:46+0000\'\u003e11\\/Jun\\/11 14:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eit looks like we should hold \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-2524\\\" title=\\\"Adding grouping to Solr 3x\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-2524\\\"\u003e\u003cdel\u003eSOLR-2524\u003c\\/del\u003e\u003c\\/a\u003e until we commit this, then backport &amp; commit to 3.x.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI agree with that. Also most of the discussion takes place in this issue. \u003c\\/p\u003e\\n\\n\u003cp\u003eI think we\'re getting close to commit this issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13047918_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13047918_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jun\\/11 14:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-11T14:48:46+0000\'\u003e11\\/Jun\\/11 14:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     it looks like we should hold   SOLR-2524   until we commit this, then backport &amp; commit to 3.x.  \\n I agree with that. Also most of the discussion takes place in this issue.  \\n\\n I think we\'re getting close to commit this issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13048307\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13048307&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13048307\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13048307_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13048307_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Jun\\/11 12:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-12T12:09:52+0000\'\u003e12\\/Jun\\/11 12:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch looks great Martijn... only thing pending (I think?) is to perhaps disable caching collector when the query is MatchAllDocsQuery instance, since we know cache only hurts perf in this case.\u003c\\/p\u003e\\n\\n\u003cp\u003eElse, +1 to commit!  I don\'t think we should hold this pending the Java 1.6 discussion.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13048307_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13048307_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Jun\\/11 12:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-12T12:09:52+0000\'\u003e12\\/Jun\\/11 12:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch looks great Martijn... only thing pending (I think?) is to perhaps disable caching collector when the query is MatchAllDocsQuery instance, since we know cache only hurts perf in this case. \\n\\n Else, +1 to commit!  I don\'t think we should hold this pending the Java 1.6 discussion.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13048358\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13048358&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13048358\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13048358_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13048358_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Jun\\/11 15:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-12T15:40:38+0000\'\u003e12\\/Jun\\/11 15:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAfter some more testing I think it is better to disable the group cache by default.\u003cbr\\/\u003e\\nHere are my small test results on a index of 30M documents. Test were produced on a low end machine.\u003c\\/p\u003e\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003eQuery type\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eQuery\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eNr of matches\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eSearch time with caching\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003eSearch time without caching\u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eTerm query\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003ecountry:es\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e24270711\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2564\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e2261\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eBoolean query\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003ecountry:es OR country:tr\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e25951654\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4014 \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e4170\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eFuzzy query\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003eregion:riviera~0.001\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e977043\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e146\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e189\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eWildcard query\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003eregion:r*\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e1608781\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e177\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e190\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003eComplexer boolean query\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003eregion:r* OR region:riveria~0.0001 OR country:es OR country:tr\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e27582783\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e5328\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e7289\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\u003cp\u003eSo I think that we can conclude from here is that the group cache work well for boolean, wildcard and fuzzy queries.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13048358_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13048358_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Jun\\/11 15:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-12T15:40:38+0000\'\u003e12\\/Jun\\/11 15:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    After some more testing I think it is better to disable the group cache by default. \\nHere are my small test results on a index of 30M documents. Test were produced on a low end machine. \\n \\n  \\n \\n Query type \\n Query \\n Nr of matches \\n Search time with caching \\n Search time without caching \\n \\n \\n Term query \\n country:es \\n 24270711 \\n 2564 \\n 2261 \\n \\n \\n Boolean query \\n country:es OR country:tr \\n 25951654 \\n 4014  \\n 4170 \\n \\n \\n Fuzzy query \\n region:riviera~0.001 \\n 977043 \\n 146 \\n 189 \\n \\n \\n Wildcard query \\n region:r* \\n 1608781 \\n 177 \\n 190 \\n \\n \\n Complexer boolean query \\n region:r* OR region:riveria~0.0001 OR country:es OR country:tr \\n 27582783 \\n 5328 \\n 7289 \\n \\n  \\n \\n\\n So I think that we can conclude from here is that the group cache work well for boolean, wildcard and fuzzy queries.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13048360\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13048360&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13048360\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13048360_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13048360_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Jun\\/11 15:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-12T15:47:06+0000\'\u003e12\\/Jun\\/11 15:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Martijn van Groningen - 12\\/Jun\\/11 15:47\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached an update version of the patch.\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eThe group.cache.percent defaults now to 0, which disables the grouping cache.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13048360_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13048360_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Jun\\/11 15:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-12T15:47:06+0000\'\u003e12\\/Jun\\/11 15:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Martijn van Groningen - 12\\/Jun\\/11 15:47\\\"\u003eedited\u003c\\/span\u003e                   Attached an update version of the patch. \\n \\n\\t The group.cache.percent defaults now to 0, which disables the grouping cache. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13050677\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13050677&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13050677\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13050677_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13050677_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Jun\\/11 19:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-16T19:44:40+0000\'\u003e16\\/Jun\\/11 19:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI also did some performance tests with the following query on random data in the example schema:\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003ehttp:\u003cspan class=\\\"code-comment\\\"\u003e\\/\\/localhost:8983\\/solr\\/select?q=*:*&amp;sort=_docid_ desc&amp;group=\u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e&amp;group.cacheMB=0&amp;group.field=single1000_i\u003c\\/span\u003e\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eThe field single1000_i had 1000 distinct values and the index has in total 100000 documents.\u003c\\/p\u003e\\n\\n\u003cp\u003eI ran this query on the following Solr setups:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eLast nights nightly build.\u003c\\/li\u003e\\n\\t\u003cli\u003eSolr build with this patch as it is.\u003c\\/li\u003e\\n\\t\u003cli\u003eSolr build with this patch and the necessary changes in AbstractFirstPassGroupingCollector so that pollLast was used in all cases.\u003cbr\\/\u003e\\nDuring my tests I noticed that differences between the first and the second setups was neglectable smal, but the the last Solr setup was on average 32% faster than the two other setups. So moving to the Java6\'s pollLast() method has definitely a positive impact on performance!\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI also think that this patch is ready to be committed and that the pollLast should be added when Lucene or the grouping module is java 6. (I prefer the first option) I\'ll commit it in the coming day or so.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13050677_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13050677_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Jun\\/11 19:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-16T19:44:40+0000\'\u003e16\\/Jun\\/11 19:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I also did some performance tests with the following query on random data in the example schema: \\n  \\n http: \\/\\/localhost:8983\\/solr\\/select?q=*:*&amp;sort=_docid_ desc&amp;group= true &amp;group.cacheMB=0&amp;group.field=single1000_i  \\n  \\n The field single1000_i had 1000 distinct values and the index has in total 100000 documents. \\n\\n I ran this query on the following Solr setups: \\n \\n\\t Last nights nightly build. \\n\\t Solr build with this patch as it is. \\n\\t Solr build with this patch and the necessary changes in AbstractFirstPassGroupingCollector so that pollLast was used in all cases. \\nDuring my tests I noticed that differences between the first and the second setups was neglectable smal, but the the last Solr setup was on average 32% faster than the two other setups. So moving to the Java6\'s pollLast() method has definitely a positive impact on performance! \\n \\n\\n\\n I also think that this patch is ready to be committed and that the pollLast should be added when Lucene or the grouping module is java 6. (I prefer the first option) I\'ll commit it in the coming day or so.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13051335\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13051335&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13051335\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13051335_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13051335_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Jun\\/11 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-17T21:31:50+0000\'\u003e17\\/Jun\\/11 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted in revision 1137037\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13051335_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13051335_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Jun\\/11 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-17T21:31:50+0000\'\u003e17\\/Jun\\/11 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed in revision 1137037              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13052492\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13052492&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13052492\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"matteo.melli\\\" id=\\\"commentauthor_13052492_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=matteo.melli\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"matteo.melli\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Matteo Melli\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13052492_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jun\\/11 11:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-21T11:38:54+0000\'\u003e21\\/Jun\\/11 11:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi there,\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m testing this functionality into my project and found what I think it\'s a bug. The revision I\'m working on is 1137889.\u003c\\/p\u003e\\n\\n\u003cp\u003eI could reproduce the bug with a really simple index (the column is of type solr.String):\u003c\\/p\u003e\\n\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003e Col1 \u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 1 \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 2 \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 3 \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eThe bug appear when I try to do a query with grouping mixing parameters start (with a value greather than 0) and group.main=true:\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"http:\\/\\/localhost:8983\\/solr\\/test\\/select\\/?q=*:*&amp;start=1&amp;group=true&amp;group.field=Col1&amp;group.main=true\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/localhost:8983\\/solr\\/test\\/select\\/?q=*:*&amp;start=1&amp;group=true&amp;group.field=Col1&amp;group.main=true\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eThe error trace is:\u003c\\/p\u003e\\n\\n\u003cp\u003eJun 21, 2011 1:32:10 PM org.apache.solr.common.SolrException log\u003cbr\\/\u003e\\nSEVERE: java.lang.ArrayIndexOutOfBoundsException: 3\u003cbr\\/\u003e\\n\\tat org.apache.solr.search.DocSlice$1.nextDoc(DocSlice.java:119)\u003cbr\\/\u003e\\n\\tat org.apache.solr.response.TextResponseWriter.writeDocuments(TextResponseWriter.java:247)\u003cbr\\/\u003e\\n\\tat org.apache.solr.response.TextResponseWriter.writeVal(TextResponseWriter.java:153)\u003cbr\\/\u003e\\n\\tat org.apache.solr.response.XMLWriter.writeResponse(XMLWriter.java:111)\u003cbr\\/\u003e\\n\\tat org.apache.solr.response.XMLResponseWriter.write(XMLResponseWriter.java:37)\u003cbr\\/\u003e\\n\\tat org.apache.solr.servlet.SolrDispatchFilter.writeResponse(SolrDispatchFilter.java:340)\u003cbr\\/\u003e\\n\\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:261)\u003cbr\\/\u003e\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:242)\u003cbr\\/\u003e\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\u003c\\/p\u003e\\n\\n\u003cp\u003eThe problem does not appear without group.main=true so this may be a related bug to that option.\u003c\\/p\u003e\\n\\n\u003cp\u003ePS: I was not sure if there where to open a bug since the version affected is still in development. Anyway sorry for any inconvenient.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"matteo.melli\\\" id=\\\"commentauthor_13052492_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=matteo.melli\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"matteo.melli\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Matteo Melli\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13052492_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jun\\/11 11:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-21T11:38:54+0000\'\u003e21\\/Jun\\/11 11:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi there, \\n\\n I\'m testing this functionality into my project and found what I think it\'s a bug. The revision I\'m working on is 1137889. \\n\\n I could reproduce the bug with a really simple index (the column is of type solr.String): \\n\\n \\n  \\n \\n  Col1  \\n \\n \\n  1  \\n \\n \\n  2  \\n \\n \\n  3  \\n \\n  \\n \\n\\n\\n The bug appear when I try to do a query with grouping mixing parameters start (with a value greather than 0) and group.main=true: \\n\\n  http:\\/\\/localhost:8983\\/solr\\/test\\/select\\/?q=*:*&amp;start=1&amp;group=true&amp;group.field=Col1&amp;group.main=true  \\n\\n The error trace is: \\n\\n Jun 21, 2011 1:32:10 PM org.apache.solr.common.SolrException log \\nSEVERE: java.lang.ArrayIndexOutOfBoundsException: 3 \\n\\tat org.apache.solr.search.DocSlice$1.nextDoc(DocSlice.java:119) \\n\\tat org.apache.solr.response.TextResponseWriter.writeDocuments(TextResponseWriter.java:247) \\n\\tat org.apache.solr.response.TextResponseWriter.writeVal(TextResponseWriter.java:153) \\n\\tat org.apache.solr.response.XMLWriter.writeResponse(XMLWriter.java:111) \\n\\tat org.apache.solr.response.XMLResponseWriter.write(XMLResponseWriter.java:37) \\n\\tat org.apache.solr.servlet.SolrDispatchFilter.writeResponse(SolrDispatchFilter.java:340) \\n\\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:261) \\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:242) \\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208) \\n\\n The problem does not appear without group.main=true so this may be a related bug to that option. \\n\\n PS: I was not sure if there where to open a bug since the version affected is still in development. Anyway sorry for any inconvenient.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13052850\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13052850&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13052850\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13052850_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13052850_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jun\\/11 21:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-21T21:26:25+0000\'\u003e21\\/Jun\\/11 21:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere\'s a simple patch that fixes the performance we lost when Solr cut over to the modules implementation (due to the fact that modules are on Java5 and Solr is on Java6).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13052850_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13052850_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jun\\/11 21:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-21T21:26:25+0000\'\u003e21\\/Jun\\/11 21:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here\'s a simple patch that fixes the performance we lost when Solr cut over to the modules implementation (due to the fact that modules are on Java5 and Solr is on Java6).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13052856\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13052856&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13052856\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13052856_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13052856_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jun\\/11 21:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-21T21:33:24+0000\'\u003e21\\/Jun\\/11 21:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e+1 thats a really good solution, fixes the issue and we can still table the java5\\/java6 stuff for later.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13052856_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13052856_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jun\\/11 21:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-21T21:33:24+0000\'\u003e21\\/Jun\\/11 21:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    +1 thats a really good solution, fixes the issue and we can still table the java5\\/java6 stuff for later.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13052857\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13052857&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13052857\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13052857_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13052857_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jun\\/11 21:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-21T21:33:32+0000\'\u003e21\\/Jun\\/11 21:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThat fix looks great Yonik!  Let the subclass use Java 6 only code...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13052857_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13052857_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jun\\/11 21:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-21T21:33:32+0000\'\u003e21\\/Jun\\/11 21:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    That fix looks great Yonik!  Let the subclass use Java 6 only code...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13063231\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13063231&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13063231\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13063231_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13063231_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/11 09:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-11T09:08:12+0000\'\u003e11\\/Jul\\/11 09:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSince Lucene is now also Java 6 we can just change the code in AbstractFirstPassGroupingCollector and the TermFirstPassGroupingCollectorJava6 in grouping.java is no longer needed, right?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13063231_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13063231_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/11 09:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-11T09:08:12+0000\'\u003e11\\/Jul\\/11 09:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Since Lucene is now also Java 6 we can just change the code in AbstractFirstPassGroupingCollector and the TermFirstPassGroupingCollectorJava6 in grouping.java is no longer needed, right?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13063244\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13063244&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13063244\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"simonw\\\" id=\\\"commentauthor_13063244_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=simonw\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"simonw\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Simon Willnauer\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13063244_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/11 09:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-11T09:34:32+0000\'\u003e11\\/Jul\\/11 09:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eSince Lucene is now also Java 6 we can just change the code in AbstractFirstPassGroupingCollector and the TermFirstPassGroupingCollectorJava6 in grouping.java is no longer needed, right?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eyes thats right\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"simonw\\\" id=\\\"commentauthor_13063244_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=simonw\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"simonw\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Simon Willnauer\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13063244_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/11 09:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-11T09:34:32+0000\'\u003e11\\/Jul\\/11 09:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Since Lucene is now also Java 6 we can just change the code in AbstractFirstPassGroupingCollector and the TermFirstPassGroupingCollectorJava6 in grouping.java is no longer needed, right?  \\n yes thats right              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13063272\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13063272&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13063272\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13063272_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13063272_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/11 10:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-11T10:32:56+0000\'\u003e11\\/Jul\\/11 10:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Matteo, I can also confirm the bug and only happens when group.main=true. I also think that this error occurs on 3x code base. I\'ll provide a fix for this issue soon.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13063272_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13063272_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/11 10:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-11T10:32:56+0000\'\u003e11\\/Jul\\/11 10:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Matteo, I can also confirm the bug and only happens when group.main=true. I also think that this error occurs on 3x code base. I\'ll provide a fix for this issue soon.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13063342\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-2564?focusedCommentId=13063342&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13063342\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13063342_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13063342_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/11 13:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-11T13:48:49+0000\'\u003e11\\/Jul\\/11 13:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'ve fixed the issue and added a test that triggered the exception.\u003cbr\\/\u003e\\nFixed in trunk in revision 1145173\u003cbr\\/\u003e\\nFixed in 3x branch in revision 1145176\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"martijn.v.groningen\\\" id=\\\"commentauthor_13063342_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=martijn.v.groningen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"martijn.v.groningen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Martijn van Groningen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13063342_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/11 13:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-11T13:48:49+0000\'\u003e11\\/Jul\\/11 13:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'ve fixed the issue and added a test that triggered the exception. \\nFixed in trunk in revision 1145173 \\nFixed in 3x branch in revision 1145176              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310230";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/SOLR\\/summary\\\" title=\\\"Solr\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310230&amp;avatarId=22151\\\" alt=\\\"Solr\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/SOLR\\/summary\\\" title=\\\"Solr\\\"\u003eSolr\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516213603681"> 
    <input type="hidden" title="jira.request.server.time" value="717"> 
    <input type="hidden" title="jira.request.id" value="1106x8089633x2"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="3"> 
    <input type="hidden" title="db.reads.time.in.ms" value="78"> 
    <input type="hidden" title="db.conns.time.in.ms" value="89"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 1106x8089633x2
	          REQUEST TIMESTAMP : [17/Jan/2018:18:26:43 +0000]
	               REQUEST TIME : 0.7170
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 3

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=28, elapsedTotal=78159838, elapsedMin=642774, elapsedMax=33161893, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=32, elapsedTotal=89726192, elapsedMin=703295, elapsedMax=33317084, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|9abce1dd6575299e964ce362a99d1ce836a920d2|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"78a79cf269b987\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-4062"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-4062] More fine-grained control over the packed integer implementation that is chosen - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-4062] More fine-grained control over the packed integer implementation that is chosen - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loadingâ€¦
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-4062">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-4062" href="/jira/browse/LUCENE-4062" id="key-val" rel="12556002">LUCENE-4062</a></li>
                </ol>
                <h1 id="summary-val">More fine-grained control over the packed integer implementation that is chosen</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-4062"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-4062/LUCENE-4062.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-4062/LUCENE-4062.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-4062/LUCENE-4062.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-4062/LUCENE-4062.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/minor.svg" title="Minor - Minor loss of function, or other problem where easy workaround is present." width="16"> Minor </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+4.0-ALPHA" title="4.0-ALPHA Alpha release of the 4.x series">4.0-ALPHA</a>, <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+6.0" title="6.0 Major release after 5.5">6.0</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22core%2Fother%22" title="core/other issues related to any code under core. Usage of this document is discouraged. Please create (or ask for) a proper component.">core/other</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <ul class="labels" id="labels-12556002-value"> 
                     <li><a class="lozenge" href="/jira/issues/?jql=labels+%3D+performance" title="performance"><span>performance</span></a></li> 
                    </ul> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310120" class="item"> 
                     <div class="wrap"> 
                      <strong title="Lucene Fields" class="name">Lucene Fields:</strong> 
                      <div id="customfield_12310120-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310120-field"> 
                        <span>New</span>, 
                        <span>Patch Available</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>In order to save space, Lucene has two main PackedInts.Mutable implentations, one that is very fast and is based on a byte/short/integer/long array (Direct*) and another one which packs bits in a memory-efficient manner (Packed*).</p> 
                  <p>The packed implementation tends to be much slower than the direct one, which discourages some Lucene components to use it. On the other hand, if you store 21 bits integers in a Direct32, this is a space loss of (32-21)/32=35%.</p> 
                  <p>If you accept to trade some space for speed, you could store 3 of these 21 bits integers in a long, resulting in an overhead of 1/3 bit per value. One advantage of this approach is that you never need to read more than one block to read or write a value, so this can be significantly faster than Packed32 and Packed64 which always need to read/write two blocks in order to avoid costly branches.</p> 
                  <p>I ran some tests, and for 10000000 21 bits values, this implementation takes less than 2% more space and has 44% faster writes and 30% faster reads. The 12 bits version (5 values per block) has the same performance improvement and a 6% memory overhead compared to the packed implementation.</p> 
                  <p>In order to select the best implementation for a given integer size, I wrote the <tt>PackedInts.getMutable(valueCount, bitsPerValue, acceptableOverheadPerValue)</tt> method. This method select the fastest implementation that has less than <tt>acceptableOverheadPerValue</tt> wasted bits per value. For example, if you accept an overhead of 20% (<tt>acceptableOverheadPerValue = 0.2f * bitsPerValue</tt>), which is pretty reasonable, here is what implementations would be selected:</p> 
                  <ul> 
                   <li>1: Packed64SingleBlock1</li> 
                   <li>2: Packed64SingleBlock2</li> 
                   <li>3: Packed64SingleBlock3</li> 
                   <li>4: Packed64SingleBlock4</li> 
                   <li>5: Packed64SingleBlock5</li> 
                   <li>6: Packed64SingleBlock6</li> 
                   <li>7: Direct8</li> 
                   <li>8: Direct8</li> 
                   <li>9: Packed64SingleBlock9</li> 
                   <li>10: Packed64SingleBlock10</li> 
                   <li>11: Packed64SingleBlock12</li> 
                   <li>12: Packed64SingleBlock12</li> 
                   <li>13: Packed64</li> 
                   <li>14: Direct16</li> 
                   <li>15: Direct16</li> 
                   <li>16: Direct16</li> 
                   <li>17: Packed64</li> 
                   <li>18: Packed64SingleBlock21</li> 
                   <li>19: Packed64SingleBlock21</li> 
                   <li>20: Packed64SingleBlock21</li> 
                   <li>21: Packed64SingleBlock21</li> 
                   <li>22: Packed64</li> 
                   <li>23: Packed64</li> 
                   <li>24: Packed64</li> 
                   <li>25: Packed64</li> 
                   <li>26: Packed64</li> 
                   <li>27: Direct32</li> 
                   <li>28: Direct32</li> 
                   <li>29: Direct32</li> 
                   <li>30: Direct32</li> 
                   <li>31: Direct32</li> 
                   <li>32: Direct32</li> 
                   <li>33: Packed64</li> 
                   <li>34: Packed64</li> 
                   <li>35: Packed64</li> 
                   <li>36: Packed64</li> 
                   <li>37: Packed64</li> 
                   <li>38: Packed64</li> 
                   <li>39: Packed64</li> 
                   <li>40: Packed64</li> 
                   <li>41: Packed64</li> 
                   <li>42: Packed64</li> 
                   <li>43: Packed64</li> 
                   <li>44: Packed64</li> 
                   <li>45: Packed64</li> 
                   <li>46: Packed64</li> 
                   <li>47: Packed64</li> 
                   <li>48: Packed64</li> 
                   <li>49: Packed64</li> 
                   <li>50: Packed64</li> 
                   <li>51: Packed64</li> 
                   <li>52: Packed64</li> 
                   <li>53: Packed64</li> 
                   <li>54: Direct64</li> 
                   <li>55: Direct64</li> 
                   <li>56: Direct64</li> 
                   <li>57: Direct64</li> 
                   <li>58: Direct64</li> 
                   <li>59: Direct64</li> 
                   <li>60: Direct64</li> 
                   <li>61: Direct64</li> 
                   <li>62: Direct64</li> 
                  </ul> 
                  <p>Under 32 bits per value, only 13, 17 and 22-26 bits per value would still choose the slower Packed64 implementation. Allowing a 50% overhead would prevent the packed implementation to be selected for bits per value under 32. Allowing an overhead of 32 bits per value would make sure that a Direct* implementation is always selected.</p> 
                  <p>Next steps would be to:</p> 
                  <ul> 
                   <li>make lucene components use this <tt>getMutable</tt> method and let users decide what trade-off better suits them,</li> 
                   <li>write a Packed32SingleBlock implementation if necessary (I didn't do it because I have no 32-bits computer to test the performance improvements).</li> 
                  </ul> 
                  <p>I think this would allow more fine-grained control over the speed/space trade-off, what do you think?</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-4062?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-4062?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-4062?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-4062?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12529060" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12529060/LUCENE-4062.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12529060/LUCENE-4062.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12529060/LUCENE-4062.patch" title="Latest  24/May/12 12:58 - Adrien Grand" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12529060/LUCENE-4062.patch">LUCENE-4062.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-05-24T12:58:12.067Z">24/May/12 12:58</time>
                   </dd>
                   <dd class="attachment-size">
                    89 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12528615" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12528615/LUCENE-4062.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12528615/LUCENE-4062.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12528615/LUCENE-4062.patch" title=" 22/May/12 16:17 - Adrien Grand" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12528615/LUCENE-4062.patch">LUCENE-4062.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-05-22T16:17:10.575Z">22/May/12 16:17</time>
                   </dd>
                   <dd class="attachment-size">
                    74 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12528429" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12528429/LUCENE-4062.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12528429/LUCENE-4062.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12528429/LUCENE-4062.patch" title=" 21/May/12 14:05 - Adrien Grand" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12528429/LUCENE-4062.patch">LUCENE-4062.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-05-21T14:05:45.295Z">21/May/12 14:05</time>
                   </dd>
                   <dd class="attachment-size">
                    61 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12528421" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12528421/LUCENE-4062.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12528421/LUCENE-4062.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12528421/LUCENE-4062.patch" title=" 21/May/12 13:23 - Adrien Grand" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12528421/LUCENE-4062.patch">LUCENE-4062.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-05-21T13:23:32.563Z">21/May/12 13:23</time>
                   </dd>
                   <dd class="attachment-size">
                    61 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12527640" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12527640/LUCENE-4062.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12527640/LUCENE-4062.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12527640/LUCENE-4062.patch" title=" 16/May/12 15:49 - Adrien Grand" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12527640/LUCENE-4062.patch">LUCENE-4062.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-05-16T15:49:45.724Z">16/May/12 15:49</time>
                   </dd>
                   <dd class="attachment-size">
                    44 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12527629" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12527629/LUCENE-4062.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12527629/LUCENE-4062.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12527629/LUCENE-4062.patch" title=" 16/May/12 14:35 - Adrien Grand" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12527629/LUCENE-4062.patch">LUCENE-4062.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-05-16T14:35:27.546Z">16/May/12 14:35</time>
                   </dd>
                   <dd class="attachment-size">
                    38 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12527599" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12527599/LUCENE-4062.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12527599/LUCENE-4062.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12527599/LUCENE-4062.patch" title=" 16/May/12 09:59 - Adrien Grand" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062.patch:https://issues.apache.org/jira/secure/attachment/12527599/LUCENE-4062.patch">LUCENE-4062.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-05-16T09:59:21.811Z">16/May/12 09:59</time>
                   </dd>
                   <dd class="attachment-size">
                    13 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12532111" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12532111/LUCENE-4062-2.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062-2.patch:https://issues.apache.org/jira/secure/attachment/12532111/LUCENE-4062-2.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12532111/LUCENE-4062-2.patch" title="Latest  14/Jun/12 16:20 - Adrien Grand" draggable="true" data-downloadurl="text/x-patch:LUCENE-4062-2.patch:https://issues.apache.org/jira/secure/attachment/12532111/LUCENE-4062-2.patch">LUCENE-4062-2.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-14T16:20:03.987Z">14/Jun/12 16:20</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12533631" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533631/measurements_te_graphs.pdf" draggable="true" data-downloadurl="application/pdf:measurements_te_graphs.pdf:https://issues.apache.org/jira/secure/attachment/12533631/measurements_te_graphs.pdf" file-preview-id="12533631" file-preview-title="measurements_te_graphs.pdf" file-preview-type="document"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-pdf" title="PDF File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533631/measurements_te_graphs.pdf" title="Latest  27/Jun/12 09:44 - Toke Eskildsen" draggable="true" data-downloadurl="application/pdf:measurements_te_graphs.pdf:https://issues.apache.org/jira/secure/attachment/12533631/measurements_te_graphs.pdf" file-preview-id="12533631" file-preview-title="measurements_te_graphs.pdf" file-preview-type="document">measurements_te_graphs.pdf</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-27T09:44:08.491Z">27/Jun/12 09:44</time>
                   </dd>
                   <dd class="attachment-size">
                    57 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12533632" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533632/measurements_te_i7.txt" draggable="true" data-downloadurl="text/plain:measurements_te_i7.txt:https://issues.apache.org/jira/secure/attachment/12533632/measurements_te_i7.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533632/measurements_te_i7.txt" title="Latest  27/Jun/12 09:44 - Toke Eskildsen" draggable="true" data-downloadurl="text/plain:measurements_te_i7.txt:https://issues.apache.org/jira/secure/attachment/12533632/measurements_te_i7.txt">measurements_te_i7.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-27T09:44:08.527Z">27/Jun/12 09:44</time>
                   </dd>
                   <dd class="attachment-size">
                    131 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12533633" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533633/measurements_te_p4.txt" draggable="true" data-downloadurl="text/plain:measurements_te_p4.txt:https://issues.apache.org/jira/secure/attachment/12533633/measurements_te_p4.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533633/measurements_te_p4.txt" title="Latest  27/Jun/12 09:44 - Toke Eskildsen" draggable="true" data-downloadurl="text/plain:measurements_te_p4.txt:https://issues.apache.org/jira/secure/attachment/12533633/measurements_te_p4.txt">measurements_te_p4.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-27T09:44:08.537Z">27/Jun/12 09:44</time>
                   </dd>
                   <dd class="attachment-size">
                    128 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12533634" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533634/measurements_te_xeon.txt" draggable="true" data-downloadurl="text/plain:measurements_te_xeon.txt:https://issues.apache.org/jira/secure/attachment/12533634/measurements_te_xeon.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533634/measurements_te_xeon.txt" title="Latest  27/Jun/12 09:44 - Toke Eskildsen" draggable="true" data-downloadurl="text/plain:measurements_te_xeon.txt:https://issues.apache.org/jira/secure/attachment/12533634/measurements_te_xeon.txt">measurements_te_xeon.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-27T09:44:08.549Z">27/Jun/12 09:44</time>
                   </dd>
                   <dd class="attachment-size">
                    132 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12533598" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533598/Packed64calc.java" draggable="true" data-downloadurl="text/x-java:Packed64calc.java:https://issues.apache.org/jira/secure/attachment/12533598/Packed64calc.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533598/Packed64calc.java" title="Latest  27/Jun/12 03:03 - Toke Eskildsen" draggable="true" data-downloadurl="text/x-java:Packed64calc.java:https://issues.apache.org/jira/secure/attachment/12533598/Packed64calc.java">Packed64calc.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-27T03:03:51.652Z">27/Jun/12 03:03</time>
                   </dd>
                   <dd class="attachment-size">
                    9 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12533826" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533826/Packed64SingleBlock.java" draggable="true" data-downloadurl="text/x-java:Packed64SingleBlock.java:https://issues.apache.org/jira/secure/attachment/12533826/Packed64SingleBlock.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533826/Packed64SingleBlock.java" title="Latest  28/Jun/12 13:00 - Adrien Grand" draggable="true" data-downloadurl="text/x-java:Packed64SingleBlock.java:https://issues.apache.org/jira/secure/attachment/12533826/Packed64SingleBlock.java">Packed64SingleBlock.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-28T13:00:40.541Z">28/Jun/12 13:00</time>
                   </dd>
                   <dd class="attachment-size">
                    12 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12533990" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533990/Packed64Strategy.java" draggable="true" data-downloadurl="text/x-java:Packed64Strategy.java:https://issues.apache.org/jira/secure/attachment/12533990/Packed64Strategy.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533990/Packed64Strategy.java" title="Latest  29/Jun/12 14:38 - Toke Eskildsen" draggable="true" data-downloadurl="text/x-java:Packed64Strategy.java:https://issues.apache.org/jira/secure/attachment/12533990/Packed64Strategy.java">Packed64Strategy.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-29T14:38:36.740Z">29/Jun/12 14:38</time>
                   </dd>
                   <dd class="attachment-size">
                    14 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12534475" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12534475/PackedIntsBenchmark.java" draggable="true" data-downloadurl="text/x-java:PackedIntsBenchmark.java:https://issues.apache.org/jira/secure/attachment/12534475/PackedIntsBenchmark.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12534475/PackedIntsBenchmark.java" title="Latest  02/Jul/12 23:00 - Toke Eskildsen" draggable="true" data-downloadurl="text/x-java:PackedIntsBenchmark.java:https://issues.apache.org/jira/secure/attachment/12534475/PackedIntsBenchmark.java">PackedIntsBenchmark.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-07-02T23:00:18.402Z">02/Jul/12 23:00</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12533991" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533991/PackedIntsBenchmark.java" draggable="true" data-downloadurl="text/x-java:PackedIntsBenchmark.java:https://issues.apache.org/jira/secure/attachment/12533991/PackedIntsBenchmark.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533991/PackedIntsBenchmark.java" title=" 29/Jun/12 14:38 - Toke Eskildsen" draggable="true" data-downloadurl="text/x-java:PackedIntsBenchmark.java:https://issues.apache.org/jira/secure/attachment/12533991/PackedIntsBenchmark.java">PackedIntsBenchmark.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-29T14:38:36.761Z">29/Jun/12 14:38</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12533599" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12533599/PackedIntsBenchmark.java" draggable="true" data-downloadurl="text/x-java:PackedIntsBenchmark.java:https://issues.apache.org/jira/secure/attachment/12533599/PackedIntsBenchmark.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12533599/PackedIntsBenchmark.java" title=" 27/Jun/12 03:03 - Toke Eskildsen" draggable="true" data-downloadurl="text/x-java:PackedIntsBenchmark.java:https://issues.apache.org/jira/secure/attachment/12533599/PackedIntsBenchmark.java">PackedIntsBenchmark.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-27T03:03:51.720Z">27/Jun/12 03:03</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12532181" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12532181/PackedIntsBenchmark.java" draggable="true" data-downloadurl="text/x-java:PackedIntsBenchmark.java:https://issues.apache.org/jira/secure/attachment/12532181/PackedIntsBenchmark.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12532181/PackedIntsBenchmark.java" title=" 15/Jun/12 10:20 - Adrien Grand" draggable="true" data-downloadurl="text/x-java:PackedIntsBenchmark.java:https://issues.apache.org/jira/secure/attachment/12532181/PackedIntsBenchmark.java">PackedIntsBenchmark.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-06-15T10:20:18.503Z">15/Jun/12 10:20</time>
                   </dd>
                   <dd class="attachment-size">
                    6 kB
                   </dd>
                   <dd class="attachment-author">
                    Adrien Grand
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12534476" data-issue-id="12556002" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12534476/PackedZero.java" draggable="true" data-downloadurl="text/x-java:PackedZero.java:https://issues.apache.org/jira/secure/attachment/12534476/PackedZero.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12534476/PackedZero.java" title="Latest  02/Jul/12 23:00 - Toke Eskildsen" draggable="true" data-downloadurl="text/x-java:PackedZero.java:https://issues.apache.org/jira/secure/attachment/12534476/PackedZero.java">PackedZero.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2012-07-02T23:00:18.411Z">02/Jul/12 23:00</time>
                   </dd>
                   <dd class="attachment-size">
                    1 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="view-subtasks" class="module toggle-wrap">
               <div id="view-subtasks_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="subtask-view-options" class="aui-list-section aui-first aui-last">
                     <li class="aui-list-item"><a id="subtasks-show-all" href="/jira/browse/LUCENE-4062?subTaskView=all#issuetable" class="aui-list-checked aui-checked aui-list-item-link" title="Show All"><span>Show All</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-show-open" href="/jira/browse/LUCENE-4062?subTaskView=unresolved#issuetable" class="aui-list-checked aui-list-item-link" title="Show Open"><span>Show Open</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-bulk-operation" href="/jira/issue/bulkedit/BulkEdit1!default.jspa?reset=true&amp;searchParent=LUCENE-4062" class="aui-list-checked aui-list-item-link" title="Bulk operation"><span>Bulk operation</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-open-issue-navigator" href="/jira/issues/?jql=parent%3DLUCENE-4062" class="aui-list-checked aui-list-item-link" title="Open issue navigator"><span>Open issue navigator</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Sub-Tasks</h2>
               </div>
               <div class="mod-content">
                <div class="mod-content intform subtask-table-container"> 
                 <issuetable-web-component> 
                  <table id="issuetable"> 
                   <tbody>
                    <tr id="issuerow12596163" rel="12596163" data-issuekey="LUCENE-4171" class="issuerow"> 
                     <td class="stsequence">
                      <div rel="0" class="subtask-done">
                       1.
                      </div> </td> 
                     <td class="stsummary"><a class="issue-link" data-issue-key="LUCENE-4171" href="/jira/browse/LUCENE-4171">Performance improvements to Packed64</a></td> 
                     <td class="issuetype"> <a class="issue-link" data-issue-key="LUCENE-4171" href="/jira/browse/LUCENE-4171"> <img src="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" height="16" width="16" border="0" align="absmiddle" alt="Sub-task" title="Sub-task - The sub-task of the issue"> </a> </td> 
                     <td class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </td> 
                     <td class="assignee"> <span class="tinylink"><a class="user-hover" rel="jpountz" id="assignee_jpountz" href="/jira/secure/ViewProfile.jspa?name=jpountz">Adrien Grand</a></span> </td> 
                     <td class="progress">
                      <table id="tt_dpb_graph_outer_LUCENE-4171" cellpadding="0" cellspacing="0"> 
                       <tbody>
                        <tr> 
                         <td class="tt_graph_percentage"> <p id="tt_dpb_percent_LUCENE-4171">0%</p> </td> 
                         <td style="width:100%"> 
                          <table id="tt_dpb_graph_inner_LUCENE-4171" style="width:100%;" cellpadding="0" cellspacing="0"> 
                           <tbody>
                            <tr class="tt_graph"> 
                             <td> 
                              <table class="tt_graph" id="tt_dpb_graph_orig_LUCENE-4171" cellpadding="0" cellspacing="0" style="margin-bottom: 2px;"> 
                               <tbody>
                                <tr class="tt_graph"> 
                                 <td style="width:100%; background-color:#89afd7;"> <img src="/jira/images/border/spacer.gif" class="hideOnPrint" title="Original Estimate - 4h" alt="Original Estimate - 4h"> </td> 
                                </tr> 
                               </tbody>
                              </table> </td> 
                            </tr> 
                            <tr> 
                             <td> 
                              <table class="tt_graph" id="tt_dpb_graph_progress_LUCENE-4171" cellpadding="0" cellspacing="0"> 
                               <tbody>
                                <tr class="tt_graph"> 
                                 <td style="width:100%; background-color:#ec8e00; border:0; font-size:0;"> <img src="/jira/images/border/spacer.gif" class="hideOnPrint" title="Remaining Estimate - 4h" alt="Remaining Estimate - 4h"> </td> 
                                </tr> 
                               </tbody>
                              </table> </td> 
                            </tr> 
                           </tbody>
                          </table> </td> 
                        </tr> 
                       </tbody>
                      </table> </td> 
                    </tr> 
                   </tbody> 
                  </table> 
                 </issuetable-web-component> 
                 <div class="end-of-stable-message"></div> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_jpountz" rel="jpountz" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Adrien Grand&quot;,&quot;emailAddress&quot;:&quot;jpountz@gmail.com&quot;,&quot;username&quot;:&quot;jpountz&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="jpountz"></span></span> Adrien Grand </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_jpountz" rel="jpountz" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Adrien Grand&quot;,&quot;emailAddress&quot;:&quot;jpountz@gmail.com&quot;,&quot;username&quot;:&quot;jpountz&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="jpountz"></span></span> Adrien Grand </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">5</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="16/May/12 09:57"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2012-05-16T09:57:03+0000">16/May/12 09:57</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="09/May/16 18:33"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-05-09T18:33:53+0000">09/May/16 18:33</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="19/Jun/12 13:08"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2012-06-19T13:08:58+0000">19/Jun/12 13:08</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="timetrackingmodule" class="module toggle-wrap">
               <div id="timetrackingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Time Tracking</h2>
               </div>
               <div class="mod-content"> 
                <div id="tt_info_aggregate"> 
                 <div id="tt_aggregate_table_info" class="tt_inner"> 
                  <dl> 
                   <dt id="tt_aggregate_text_orig" class="tt_text" title="Original Estimate - 4h">
                     Estimated: 
                   </dt> 
                   <dd class="tt_graph"> 
                    <table id="tt_aggregate_graph_orig" cellspacing="0" cellpadding="0" class="tt_graph"> 
                     <tbody>
                      <tr class="tt_graph"> 
                       <td style="width:100%; background-color:#89afd7"> <img src="/jira/images/border/spacer.gif" style="height:10px; width:100%; border-width:0" class="hideOnPrint" title="Original Estimate - 4h" alt="Original Estimate - 4h"> </td> 
                      </tr> 
                     </tbody>
                    </table> 
                   </dd> 
                   <dd id="tt_aggregate_values_orig" class="tt_values" title="Original Estimate - 4h">
                     4h 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt id="tt_aggregate_text_remain" class="tt_text" title="Remaining Estimate - 4h">
                     Remaining: 
                   </dt> 
                   <dd class="tt_graph"> 
                    <table id="tt_aggregate_graph_remain" cellspacing="0" cellpadding="0" class="tt_graph"> 
                     <tbody>
                      <tr class="tt_graph"> 
                       <td style="width:100%; background-color:#ec8e00"> <img src="/jira/images/border/spacer.gif" style="height:10px; width:100%; border-width:0" class="hideOnPrint" title="Remaining Estimate - 4h" alt="Remaining Estimate - 4h"> </td> 
                      </tr> 
                     </tbody>
                    </table> 
                   </dd> 
                   <dd id="tt_aggregate_values_remain" class="tt_values" title="Remaining Estimate - 4h">
                     4h 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt id="tt_aggregate_text_spent" class="tt_text" title="Time Spent - Not Specified">
                     Logged: 
                   </dt> 
                   <dd class="tt_graph"> 
                    <table id="tt_aggregate_graph_spent" cellspacing="0" cellpadding="0" class="tt_graph"> 
                     <tbody>
                      <tr class="tt_graph"> 
                       <td style="width:100%; background-color:#cccccc"> <img src="/jira/images/border/spacer.gif" style="height:10px; width:100%; border-width:0" class="hideOnPrint" title="Time Spent - Not Specified" alt="Time Spent - Not Specified"> </td> 
                      </tr> 
                     </tbody>
                    </table> 
                   </dd> 
                   <dd id="tt_aggregate_values_spent" class="tt_values" title="Time Spent - Not Specified">
                     Not Specified 
                   </dd> 
                  </dl> 
                 </div> 
                </div> 
                <div id="tt_info_single" style="display:none;"> 
                 <div id="tt_single_table_info" class="tt_inner"> 
                  <h4>Not Specified</h4> 
                 </div> 
                </div> 
                <div id="tt_include_subtasks" title="Include sub-tasks in the time tracking information"> 
                 <input id="cb_include_subtasks" type="checkbox" checked="CHECKED">
                 <label for="cb_include_subtasks">Include sub-tasks</label> 
                </div> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4062?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-4062?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-13276630\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276630&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276630\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276630_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276630_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 09:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T09:59:21+0000\'\u003e16\\/May\\/12 09:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere is the patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276630_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276630_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 09:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T09:59:21+0000\'\u003e16\\/May\\/12 09:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here is the patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13276656\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276656&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276656\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13276656_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276656_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 10:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T10:53:03+0000\'\u003e16\\/May\\/12 10:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis is a great idea!  I don\'t think it\'s necessary to create a Packed32SingleBlock right now ... this (Packed64SingleBlock) is already a great improvement.  We can do it later...\u003c\\/p\u003e\\n\\n\u003cp\u003eSomehow we need to fix the fasterButMoreRAM places (FieldCache, DocValues) to make use of this; maybe we change them from a boolean to the float acceptableOverhead instead?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13276656_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276656_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 10:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T10:53:03+0000\'\u003e16\\/May\\/12 10:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This is a great idea!  I don\'t think it\'s necessary to create a Packed32SingleBlock right now ... this (Packed64SingleBlock) is already a great improvement.  We can do it later... \\n\\n Somehow we need to fix the fasterButMoreRAM places (FieldCache, DocValues) to make use of this; maybe we change them from a boolean to the float acceptableOverhead instead?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13276688\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276688&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276688\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276688_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276688_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 12:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T12:14:27+0000\'\u003e16\\/May\\/12 12:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Mike, thanks for your quick feedback.\u003c\\/p\u003e\\n\\n\u003cp\u003eAgreed on Packed32SingleBlock. Regarding \u003ctt\u003efasterButMoreRAM\u003c\\/tt\u003e\\/\u003ctt\u003eroundFixedSize\u003c\\/tt\u003e, the \u003ctt\u003eacceptableOverhead\u003c\\/tt\u003e parameter currently is in bits per value. However I think most use-cases would be more interested in the overhead ratio than in its absolute value. So I think they should take a float \u003ctt\u003eacceptableOverheadRatio\u003c\\/tt\u003e and call \u003ctt\u003egetMutable(valueCount, bitsPerValue, bitsPerValue * acceptableOverheadRatio)\u003c\\/tt\u003e. I\'m interested in doing this, would you like me to include these changes in the patch or does it deserve a separate commit?\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276688_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276688_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 12:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T12:14:27+0000\'\u003e16\\/May\\/12 12:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Mike, thanks for your quick feedback. \\n\\n Agreed on Packed32SingleBlock. Regarding  fasterButMoreRAM \\/ roundFixedSize , the  acceptableOverhead  parameter currently is in bits per value. However I think most use-cases would be more interested in the overhead ratio than in its absolute value. So I think they should take a float  acceptableOverheadRatio  and call  getMutable(valueCount, bitsPerValue, bitsPerValue * acceptableOverheadRatio) . I\'m interested in doing this, would you like me to include these changes in the patch or does it deserve a separate commit? \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13276692\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276692&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276692\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13276692_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276692_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 12:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T12:20:22+0000\'\u003e16\\/May\\/12 12:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Adrien,\u003c\\/p\u003e\\n\\n\u003cp\u003eI think we should do the cutover as part of this issue, so yes, please, take a stab at that!\u003c\\/p\u003e\\n\\n\u003cp\u003eI agree the overhead should be measured in %tg not as bits-per-value.  Maybe we also have public constants for the two extremes (zero overhead but possibly slow; super-fast but possibly lots of overhead)?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13276692_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276692_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 12:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T12:20:22+0000\'\u003e16\\/May\\/12 12:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Adrien, \\n\\n I think we should do the cutover as part of this issue, so yes, please, take a stab at that! \\n\\n I agree the overhead should be measured in %tg not as bits-per-value.  Maybe we also have public constants for the two extremes (zero overhead but possibly slow; super-fast but possibly lots of overhead)?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13276695\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276695&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276695\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13276695_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276695_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 12:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T12:25:53+0000\'\u003e16\\/May\\/12 12:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCan we also move the concrete impls (eg Packed64SingleBlock21) either as static inner classes inside Packed64SingleBlock, or as separate source files?  Thanks.  We\'ve had trouble w\\/ multiple classes in a single java source file in the past...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13276695_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276695_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 12:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T12:25:53+0000\'\u003e16\\/May\\/12 12:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Can we also move the concrete impls (eg Packed64SingleBlock21) either as static inner classes inside Packed64SingleBlock, or as separate source files?  Thanks.  We\'ve had trouble w\\/ multiple classes in a single java source file in the past...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13276698\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276698&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276698\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13276698_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276698_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 12:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T12:31:09+0000\'\u003e16\\/May\\/12 12:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs a quick test I temporarily forced the PackedInts impl to always use Packed64SingleBlock when possible and all tests passed!  Good \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13276698_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276698_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 12:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T12:31:09+0000\'\u003e16\\/May\\/12 12:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As a quick test I temporarily forced the PackedInts impl to always use Packed64SingleBlock when possible and all tests passed!  Good                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13276769\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276769&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276769\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276769_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276769_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 14:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T14:35:27+0000\'\u003e16\\/May\\/12 14:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI added the changes we discussed in the patch, replacing fasterButMoreRam=true by PackedInts.FAST and fasterButMoreRam=false by PackedInts.DEFAULT = 20%. All Lucene tests passed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276769_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276769_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 14:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T14:35:27+0000\'\u003e16\\/May\\/12 14:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I added the changes we discussed in the patch, replacing fasterButMoreRam=true by PackedInts.FAST and fasterButMoreRam=false by PackedInts.DEFAULT = 20%. All Lucene tests passed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13276824\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276824&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276824\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276824_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276824_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 15:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T15:49:45+0000\'\u003e16\\/May\\/12 15:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch with improved performance when bitsPerValue is close (depending on the acceptable overhead) to 24 or 48. The two new implementations store values on three contiguous blocks (byte and short) and have very close performance to the Direct* implementations. Their maximum capacity is lower (by a factor 3) so \u003ctt\u003ePackedInts.getMutable\u003c\\/tt\u003e decides whether they should be selected based on valueCount. All tests still pass.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276824_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276824_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 15:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T15:49:45+0000\'\u003e16\\/May\\/12 15:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch with improved performance when bitsPerValue is close (depending on the acceptable overhead) to 24 or 48. The two new implementations store values on three contiguous blocks (byte and short) and have very close performance to the Direct* implementations. Their maximum capacity is lower (by a factor 3) so  PackedInts.getMutable  decides whether they should be selected based on valueCount. All tests still pass.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13276855\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13276855&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13276855\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276855_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276855_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 16:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T16:23:37+0000\'\u003e16\\/May\\/12 16:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMike, I just noticed that I should have updated the PackedInts#getReader method as well but I have no time to work on this issue until next week. I will try to finish this patch next monday.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13276855_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13276855_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 16:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T16:23:37+0000\'\u003e16\\/May\\/12 16:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mike, I just noticed that I should have updated the PackedInts#getReader method as well but I have no time to work on this issue until next week. I will try to finish this patch next monday.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13277244\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13277244&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13277244\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13277244_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13277244_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 23:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T23:08:29+0000\'\u003e16\\/May\\/12 23:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNew patch looks great (but yeah we should do getReader too...)!  I like the new impls for 24\\/48 cases.  Thanks Adrien!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13277244_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13277244_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/May\\/12 23:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-16T23:08:29+0000\'\u003e16\\/May\\/12 23:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    New patch looks great (but yeah we should do getReader too...)!  I like the new impls for 24\\/48 cases.  Thanks Adrien!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13280137\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13280137&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13280137\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13280137_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13280137_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/12 13:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-21T13:23:32+0000\'\u003e21\\/May\\/12 13:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNew patch with updated getReader method. All tests still pass.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13280137_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13280137_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/12 13:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-21T13:23:32+0000\'\u003e21\\/May\\/12 13:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    New patch with updated getReader method. All tests still pass.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13280162\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13280162&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13280162\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13280162_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13280162_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/12 14:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-21T14:05:45+0000\'\u003e21\\/May\\/12 14:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated javadocs (there were still a few references to `fasterButMoreRam`).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13280162_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13280162_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/12 14:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-21T14:05:45+0000\'\u003e21\\/May\\/12 14:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated javadocs (there were still a few references to `fasterButMoreRam`).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13280616\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13280616&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13280616\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13280616_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13280616_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/12 23:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-21T23:27:16+0000\'\u003e21\\/May\\/12 23:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Adrien!\u003c\\/p\u003e\\n\\n\u003cp\u003eHmm I\'m seeing some tests failing with this patch (eg TestRollingUpdates).  I haven\'t tried to track it down...\u003c\\/p\u003e\\n\\n\u003cp\u003eThis new copyData worries me: I don\'t think, at read time, we should be rewriting all packed ints?  I think we should sort that out at write time and then reading just use whatever reader can best decode what was written?  Also, it seems like the logic may be broken?  Eg it uses Direct16 when bitsPerValue is &lt; Short.SIZE?  (Same for Direct32)... maybe the if cases are just swapped...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13280616_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13280616_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/12 23:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-21T23:27:16+0000\'\u003e21\\/May\\/12 23:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Adrien! \\n\\n Hmm I\'m seeing some tests failing with this patch (eg TestRollingUpdates).  I haven\'t tried to track it down... \\n\\n This new copyData worries me: I don\'t think, at read time, we should be rewriting all packed ints?  I think we should sort that out at write time and then reading just use whatever reader can best decode what was written?  Also, it seems like the logic may be broken?  Eg it uses Direct16 when bitsPerValue is &lt; Short.SIZE?  (Same for Direct32)... maybe the if cases are just swapped...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281071\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281071&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281071\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281071_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281071_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/May\\/12 16:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-22T16:17:10+0000\'\u003e22\\/May\\/12 16:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOh right, cases are swapped, I uploaded the wrong patch. Here is a correct version.\u003c\\/p\u003e\\n\\n\u003cp\u003eI guess there are two options:\u003cbr\\/\u003e\\n 1. always writing the most compact form to disk and deserializing it in a fast \u003ctt\u003ePackedInts.Mutable\u003c\\/tt\u003e implementation (depending on acceptableOverheadRatio),\u003cbr\\/\u003e\\n 2. writing a possibly aligned version on disk (depending on acceptableOverheadRatio) and then selecting the fastest PackedInts.Mutable implementation that exactly matches bitsPerValue (with no padding bits).\u003c\\/p\u003e\\n\\n\u003cp\u003eA third option could be to write padding bits (\u003ctt\u003ePacked64SingleBlock\u003c\\/tt\u003e subclasses may have such padding bits) as well, but I really dislike the fact that the on-disk format is implementation-dependent.\u003c\\/p\u003e\\n\\n\u003cp\u003eOption 1 is likely to make deserialization slower since some decoding might occur (the copyData method) but on the other hand, option 2 would prevent us from using implementations that add padding bits (such as Packed64SingleBlock21 which has one padding bit every 3 21-bits integers or Packed64SingleBlock12 which has 4 padding bits every 5 12-bits integers but not Packed64SingleBlock\u003c\\/p\u003e\\n{1,2,4} since 64%{1,2,4}\\n\u003cp\u003e=0).\u003c\\/p\u003e\\n\\n\u003cp\u003eI initially chose option 1 because I think it is nice to have Packed64SingleBlock21 when bitsPerValue is close to 21, since it might be significantly faster than Packed64.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn order to know how slower deserialization is (option 1), I ran a micro-benchmark which:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eloads a PackedInts.Reader from a ByteArrayDataInput,\u003c\\/li\u003e\\n\\t\u003cli\u003eperforms n random reads on the reader.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eHere is the code for the micro-benchmark in case you would like to run it.\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e valueCount = 10000000;\\n\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e bitsPerValue = 21;\\n\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e[] offsets = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e[valueCount];\\nRandom random = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Random();\\n\u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e i = 0; i &lt; valueCount; ++i) {\\n  offsets[i] = random.nextInt(valueCount);\\n}\\n\u003cspan class=\\\"code-object\\\"\u003ebyte\u003c\\/span\u003e[] bytes = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003ebyte\u003c\\/span\u003e[valueCount * 4];\\nDataOutput out = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e ByteArrayDataOutput(bytes);\\nPackedInts.Writer writer = PackedInts.getWriter(out, valueCount, bitsPerValue);\\n\u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e i = 0; i &lt; valueCount; ++i) {\\n  writer.add(random.nextInt(1 &lt;&lt; bitsPerValue));\\n}\\nwriter.finish();\\n\u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e i = 0; i &lt; 50; ++i) {\\n  \u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e start = \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.nanoTime();\\n  DataInput in = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e ByteArrayDataInput(bytes);\\n  PackedInts.Reader reader = PackedInts.getReader(in, 0f); \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ Packed64\\n\u003c\\/span\u003e  \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ PackedInts.Reader reader = PackedInts.getReader(in, 0.1f); \\/\\/ Packed64SingleBlock\\n\u003c\\/span\u003e  \u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e j = 0, n = valueCount; j &lt; n; ++j) {\\n    reader.get(offsets[j]);\\n  }\\n  \u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e end = \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.nanoTime();\\n  \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.out.println(end - start);\\n}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eI ran this microbenchmark for bitsPerValue=21 and valueCount in (1 000 000, 10 000 000). The loading time (n = 0) is 2x to 3x slower with Packed64SingleBlock21. However, as soon as you perform valueCount\\/4 or more random reads (n &gt;= valueCount\\/4), the total time is better for Packed64SingleBlock21. When n=valueCount, the total time is even 2x better for Packed64SingleBlock21.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe loading overhead doesn\'t seem too bad.\u003c\\/p\u003e\\n\\n\u003cp\u003eHowever I guess that some people might still be more interested in the loading time than in the query time (for write-intensive applications), but in this case they could still request a reader in its compact form (Packed 64 or Direct* when bitsPerValue is 8, 16, 32 or 64). If they want to be sure to have a fast reader too, they could also make sure that they used 8, 16, 32 or 64 as the bitsPerValue parameter of \u003ctt\u003ePackedInts.getWriter\u003c\\/tt\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eMike, what do you think?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281071_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281071_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/May\\/12 16:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-22T16:17:10+0000\'\u003e22\\/May\\/12 16:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Oh right, cases are swapped, I uploaded the wrong patch. Here is a correct version. \\n\\n I guess there are two options: \\n 1. always writing the most compact form to disk and deserializing it in a fast  PackedInts.Mutable  implementation (depending on acceptableOverheadRatio), \\n 2. writing a possibly aligned version on disk (depending on acceptableOverheadRatio) and then selecting the fastest PackedInts.Mutable implementation that exactly matches bitsPerValue (with no padding bits). \\n\\n A third option could be to write padding bits ( Packed64SingleBlock  subclasses may have such padding bits) as well, but I really dislike the fact that the on-disk format is implementation-dependent. \\n\\n Option 1 is likely to make deserialization slower since some decoding might occur (the copyData method) but on the other hand, option 2 would prevent us from using implementations that add padding bits (such as Packed64SingleBlock21 which has one padding bit every 3 21-bits integers or Packed64SingleBlock12 which has 4 padding bits every 5 12-bits integers but not Packed64SingleBlock \\n{1,2,4} since 64%{1,2,4}\\n =0). \\n\\n I initially chose option 1 because I think it is nice to have Packed64SingleBlock21 when bitsPerValue is close to 21, since it might be significantly faster than Packed64. \\n\\n In order to know how slower deserialization is (option 1), I ran a micro-benchmark which: \\n \\n\\t loads a PackedInts.Reader from a ByteArrayDataInput, \\n\\t performs n random reads on the reader. \\n \\n\\n\\n Here is the code for the micro-benchmark in case you would like to run it. \\n  \\n  int  valueCount = 10000000;\\n int  bitsPerValue = 21;\\n int [] offsets =  new   int [valueCount];\\nRandom random =  new  Random();\\n for  ( int  i = 0; i &lt; valueCount; ++i) {\\n  offsets[i] = random.nextInt(valueCount);\\n}\\n byte [] bytes =  new   byte [valueCount * 4];\\nDataOutput out =  new  ByteArrayDataOutput(bytes);\\nPackedInts.Writer writer = PackedInts.getWriter(out, valueCount, bitsPerValue);\\n for  ( int  i = 0; i &lt; valueCount; ++i) {\\n  writer.add(random.nextInt(1 &lt;&lt; bitsPerValue));\\n}\\nwriter.finish();\\n for  ( int  i = 0; i &lt; 50; ++i) {\\n   long  start =  System .nanoTime();\\n  DataInput in =  new  ByteArrayDataInput(bytes);\\n  PackedInts.Reader reader = PackedInts.getReader(in, 0f);  \\/\\/ Packed64\\n    \\/\\/ PackedInts.Reader reader = PackedInts.getReader(in, 0.1f); \\/\\/ Packed64SingleBlock\\n    for  ( int  j = 0, n = valueCount; j &lt; n; ++j) {\\n    reader.get(offsets[j]);\\n  }\\n   long  end =  System .nanoTime();\\n   System .out.println(end - start);\\n}\\n \\n  \\n\\n I ran this microbenchmark for bitsPerValue=21 and valueCount in (1 000 000, 10 000 000). The loading time (n = 0) is 2x to 3x slower with Packed64SingleBlock21. However, as soon as you perform valueCount\\/4 or more random reads (n &gt;= valueCount\\/4), the total time is better for Packed64SingleBlock21. When n=valueCount, the total time is even 2x better for Packed64SingleBlock21. \\n\\n The loading overhead doesn\'t seem too bad. \\n\\n However I guess that some people might still be more interested in the loading time than in the query time (for write-intensive applications), but in this case they could still request a reader in its compact form (Packed 64 or Direct* when bitsPerValue is 8, 16, 32 or 64). If they want to be sure to have a fast reader too, they could also make sure that they used 8, 16, 32 or 64 as the bitsPerValue parameter of  PackedInts.getWriter . \\n\\n Mike, what do you think?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281188\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281188&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281188\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13281188_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281188_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/May\\/12 20:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-22T20:19:47+0000\'\u003e22\\/May\\/12 20:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Adrien. I wrote back to dev list, don\'t know if you caught that &#8211; the benchmark could probably be improved by calculating something off reader.get() because otherwise it\'s a pure read without side effects and can be removed by the jit (or at least optimized in unpredictable ways). A rolling sum or something will probably do.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13281188_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281188_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/May\\/12 20:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-22T20:19:47+0000\'\u003e22\\/May\\/12 20:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Adrien. I wrote back to dev list, don\'t know if you caught that &#8211; the benchmark could probably be improved by calculating something off reader.get() because otherwise it\'s a pure read without side effects and can be removed by the jit (or at least optimized in unpredictable ways). A rolling sum or something will probably do.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281211\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281211&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281211\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281211_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281211_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/May\\/12 21:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-22T21:01:49+0000\'\u003e22\\/May\\/12 21:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGood catch, David. I modified the code to perform a rolling sum and the results are actually a little different. Packed64SingleBlock21 is now faster than Packed64 when n&gt;=valueCount (instead of valueCount\\/4).\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281211_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281211_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/May\\/12 21:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-22T21:01:49+0000\'\u003e22\\/May\\/12 21:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Good catch, David. I modified the code to perform a rolling sum and the results are actually a little different. Packed64SingleBlock21 is now faster than Packed64 when n&gt;=valueCount (instead of valueCount\\/4). \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281442\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281442&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281442\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13281442_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281442_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 07:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T07:42:57+0000\'\u003e23\\/May\\/12 07:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYou didn\'t attach the updated benchmark &#8211; I didn\'t say it explicitly but you should do something with the resulting value (jit optimizer is quite smart \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/wink.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e. A field store (write the result to a field) should do the trick. So is System.out.println of course...\u003c\\/p\u003e\\n\\n\u003cp\u003eAll this may sound paranoid but really isn\'t. This is a source of many problems with microbenchmarks &#8211; the compiler just throws away (or optimizes loops\\/ branches) in a way that doesn\'t happen later on in real code. My recent favorite example of such a problem in real life code (it\'s a bug in jdk) is this one:\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"http:\\/\\/hg.openjdk.java.net\\/jdk8\\/tl\\/jdk\\/rev\\/332bebb463d1\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/hg.openjdk.java.net\\/jdk8\\/tl\\/jdk\\/rev\\/332bebb463d1\u003c\\/a\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13281442_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281442_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 07:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T07:42:57+0000\'\u003e23\\/May\\/12 07:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    You didn\'t attach the updated benchmark &#8211; I didn\'t say it explicitly but you should do something with the resulting value (jit optimizer is quite smart  . A field store (write the result to a field) should do the trick. So is System.out.println of course... \\n\\n All this may sound paranoid but really isn\'t. This is a source of many problems with microbenchmarks &#8211; the compiler just throws away (or optimizes loops\\/ branches) in a way that doesn\'t happen later on in real code. My recent favorite example of such a problem in real life code (it\'s a bug in jdk) is this one: \\n\\n  http:\\/\\/hg.openjdk.java.net\\/jdk8\\/tl\\/jdk\\/rev\\/332bebb463d1               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281460\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281460&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281460\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281460_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281460_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 08:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T08:46:47+0000\'\u003e23\\/May\\/12 08:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi David. Thanks for the link, it\'s very interesting!\u003c\\/p\u003e\\n\\n\u003cp\u003eI added a print statement to make sure that the sum is actually computed. Here is the code (for values of n &gt; valueCount, just modify the k loop):\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e valueCount = 10000000;\\n\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e bitsPerValue = 21;\\n\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e[] offsets = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e[valueCount];\\nRandom random = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e Random();\\n\u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e i = 0; i &lt; valueCount; ++i) {\\n  offsets[i] = random.nextInt(valueCount);\\n}\\n\u003cspan class=\\\"code-object\\\"\u003ebyte\u003c\\/span\u003e[] bytes = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003ebyte\u003c\\/span\u003e[valueCount * 4];\\nDataOutput out = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e ByteArrayDataOutput(bytes);\\nPackedInts.Writer writer = PackedInts.getWriter(out, valueCount, bitsPerValue);\\n\u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e i = 0; i &lt; valueCount; ++i) {\\n  writer.add(random.nextInt(1 &lt;&lt; bitsPerValue));\\n}\\nwriter.finish();\\n\u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e sum = 0L;\\n\u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e i = 0; i &lt; 50; ++i) {\\n  \u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e start = \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.nanoTime();\\n  DataInput in = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e ByteArrayDataInput(bytes);\\n  \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ PackedInts.Reader reader = PackedInts.getReader(in, 0f); \\/\\/ Packed64\\n\u003c\\/span\u003e  PackedInts.Reader reader = PackedInts.getReader(in, 0.1f); \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ Packed64SingleBlock\\n\u003c\\/span\u003e  \u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e k = 0; k &lt; 1; ++k) {\\n      \u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e j = 0, n = valueCount \\/ 2; j &lt; n; ++j) {\\n        sum += reader.get(offsets[j]);\\n      }\\n  }\\n  \u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e end = \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.nanoTime();\\n  \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.out.println(\u003cspan class=\\\"code-quote\\\"\u003e\\\"sum is \\\"\u003c\\/span\u003e + sum);\\n  \u003cspan class=\\\"code-object\\\"\u003eSystem\u003c\\/span\u003e.out.println(end - start);\\n}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eI\'m on a different computer today and n &gt;= valueCount\\/3 is enough to make the benchmark faster with Packed64SingleBlock.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281460_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281460_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 08:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T08:46:47+0000\'\u003e23\\/May\\/12 08:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi David. Thanks for the link, it\'s very interesting! \\n\\n I added a print statement to make sure that the sum is actually computed. Here is the code (for values of n &gt; valueCount, just modify the k loop): \\n\\n  \\n  int  valueCount = 10000000;\\n int  bitsPerValue = 21;\\n int [] offsets =  new   int [valueCount];\\nRandom random =  new  Random();\\n for  ( int  i = 0; i &lt; valueCount; ++i) {\\n  offsets[i] = random.nextInt(valueCount);\\n}\\n byte [] bytes =  new   byte [valueCount * 4];\\nDataOutput out =  new  ByteArrayDataOutput(bytes);\\nPackedInts.Writer writer = PackedInts.getWriter(out, valueCount, bitsPerValue);\\n for  ( int  i = 0; i &lt; valueCount; ++i) {\\n  writer.add(random.nextInt(1 &lt;&lt; bitsPerValue));\\n}\\nwriter.finish();\\n long  sum = 0L;\\n for  ( int  i = 0; i &lt; 50; ++i) {\\n   long  start =  System .nanoTime();\\n  DataInput in =  new  ByteArrayDataInput(bytes);\\n   \\/\\/ PackedInts.Reader reader = PackedInts.getReader(in, 0f); \\/\\/ Packed64\\n   PackedInts.Reader reader = PackedInts.getReader(in, 0.1f);  \\/\\/ Packed64SingleBlock\\n    for  ( int  k = 0; k &lt; 1; ++k) {\\n       for  ( int  j = 0, n = valueCount \\/ 2; j &lt; n; ++j) {\\n        sum += reader.get(offsets[j]);\\n      }\\n  }\\n   long  end =  System .nanoTime();\\n   System .out.println( \\\"sum is \\\"  + sum);\\n   System .out.println(end - start);\\n}\\n \\n  \\n\\n I\'m on a different computer today and n &gt;= valueCount\\/3 is enough to make the benchmark faster with Packed64SingleBlock.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281751\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281751&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281751\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13281751_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281751_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 17:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T17:48:50+0000\'\u003e23\\/May\\/12 17:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eA third option could be to write padding bits (Packed64SingleBlock subclasses may have such padding bits) as well, but I really dislike the fact that the on-disk format is implementation-dependent.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eActually, I think we should stop specializing based on 32 bit vs 64\u003cbr\\/\u003e\\nbit JRE, and always use the impls backed by long[] (Packed64*).  Then, I\u003cbr\\/\u003e\\nthink it\'s fine if we write the long[] image (with padding bits)\u003cbr\\/\u003e\\ndirectly to disk?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13281751_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281751_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 17:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T17:48:50+0000\'\u003e23\\/May\\/12 17:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     A third option could be to write padding bits (Packed64SingleBlock subclasses may have such padding bits) as well, but I really dislike the fact that the on-disk format is implementation-dependent.  \\n\\n Actually, I think we should stop specializing based on 32 bit vs 64 \\nbit JRE, and always use the impls backed by long[] (Packed64*).  Then, I \\nthink it\'s fine if we write the long[] image (with padding bits) \\ndirectly to disk?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281793\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281793&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281793\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281793_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281793_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 18:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T18:42:17+0000\'\u003e23\\/May\\/12 18:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMike, I am not sure how we should do it. For 21-bits values how would the reader know whether it should use a Packed64SingleBlock21 or a Packed64? Should we add a flag to the data stream in order to know what implementation serialized the integers?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281793_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281793_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 18:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T18:42:17+0000\'\u003e23\\/May\\/12 18:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Mike, I am not sure how we should do it. For 21-bits values how would the reader know whether it should use a Packed64SingleBlock21 or a Packed64? Should we add a flag to the data stream in order to know what implementation serialized the integers?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281797\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281797&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281797\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13281797_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281797_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 18:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T18:46:06+0000\'\u003e23\\/May\\/12 18:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eShould we add a flag to the data stream in order to know what implementation serialized the integers?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think so?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13281797_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281797_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 18:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T18:46:06+0000\'\u003e23\\/May\\/12 18:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Should we add a flag to the data stream in order to know what implementation serialized the integers?  \\n\\n I think so?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281805\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281805&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281805\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281805_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281805_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 19:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T19:01:01+0000\'\u003e23\\/May\\/12 19:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIsn\'t it a problem to break compatibility? Or should we use special (&gt; 64) values of bitsPerValue so that current trunk indexes will still work after the patch is applied?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13281805_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281805_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 19:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T19:01:01+0000\'\u003e23\\/May\\/12 19:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Isn\'t it a problem to break compatibility? Or should we use special (&gt; 64) values of bitsPerValue so that current trunk indexes will still work after the patch is applied?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13281814\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13281814&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13281814\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13281814_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281814_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 19:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T19:14:22+0000\'\u003e23\\/May\\/12 19:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eIsn\'t it a problem to break compatibility? \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIt isn\'t.\u003c\\/p\u003e\\n\\n\u003cp\u003e3x indices never store packed ints ... so we are only breaking doc values in 4.0, and we are allowed (for only a bit more time!) to break 4.0\'s index format.  So we should just break it and not pollute 4.0\'s sources with false back compat code...\u003c\\/p\u003e\\n\\n\u003cp\u003eSeparately, if somehow we did need to preserve back compat for packed ints file format... we should use the version in the codec header to accomplish that (ie, we don\'t have to stuff version information inside the bitsPerValue).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13281814_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13281814_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/May\\/12 19:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-23T19:14:22+0000\'\u003e23\\/May\\/12 19:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Isn\'t it a problem to break compatibility?   \\n\\n It isn\'t. \\n\\n 3x indices never store packed ints ... so we are only breaking doc values in 4.0, and we are allowed (for only a bit more time!) to break 4.0\'s index format.  So we should just break it and not pollute 4.0\'s sources with false back compat code... \\n\\n Separately, if somehow we did need to preserve back compat for packed ints file format... we should use the version in the codec header to accomplish that (ie, we don\'t have to stuff version information inside the bitsPerValue).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13282480\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13282480&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13282480\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13282480_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13282480_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/May\\/12 12:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-24T12:58:12+0000\'\u003e24\\/May\\/12 12:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNew patch. I added a VInt flag to the streams generated by writers so that the readers can know how to parse the stream. All tests passed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13282480_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13282480_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/May\\/12 12:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-24T12:58:12+0000\'\u003e24\\/May\\/12 12:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    New patch. I added a VInt flag to the streams generated by writers so that the readers can know how to parse the stream. All tests passed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13283593\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13283593&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13283593\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13283593_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13283593_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/May\\/12 16:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-25T16:51:04+0000\'\u003e25\\/May\\/12 16:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Adrien, this looks great!  I\'ll commit soon...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13283593_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13283593_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/May\\/12 16:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-25T16:51:04+0000\'\u003e25\\/May\\/12 16:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Adrien, this looks great!  I\'ll commit soon...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13283655\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13283655&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13283655\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13283655_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13283655_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/May\\/12 18:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-25T18:10:13+0000\'\u003e25\\/May\\/12 18:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Adrien!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13283655_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13283655_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/May\\/12 18:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-05-25T18:10:13+0000\'\u003e25\\/May\\/12 18:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Adrien!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295139\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295139&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295139\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295139_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295139_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jun\\/12 16:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-14T16:20:04+0000\'\u003e14\\/Jun\\/12 16:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have run more tests on \u003ctt\u003ePackedInts\u003c\\/tt\u003e impls over the last days to test their relative performance.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt appears that the specializations in \u003ctt\u003ePacked64SingleBlock\u003c\\/tt\u003e don\'t help much and even hurt performance in some cases. Moreover, replacing the naive bulk operations by a \u003ctt\u003eSystem.arraycopy\u003c\\/tt\u003e in \u003ctt\u003eDirect64\u003c\\/tt\u003e is a big win. (See attached patch.)\u003c\\/p\u003e\\n\\n\u003cp\u003eYou can look at the details of the tests here: \u003ca href=\\\"http:\\/\\/people.apache.org\\/~jpountz\\/packed_ints.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/people.apache.org\\/~jpountz\\/packed_ints.html\u003c\\/a\u003e (contiguous=Packed64, padding=Packed64SingleBlock,3 blocks=Packed*ThreeBlocks,direct=Direct*).\u003c\\/p\u003e\\n\\n\u003cp\u003eThe tests were run on a 64-bit computer (Core 2 Duo E5500) with valueCount=10 000 000. \\\"Memory overhead\\\" is \u003c\\/p\u003e\\n{unused space in bits}\\n\u003cp\u003e\\/\u003c\\/p\u003e\\n{bits per value}\\n\u003cp\u003e while the other charts measure the number of gets\\/sets per second.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe random get\\/set results are very good for the packed versions, probably because they manage to fit much more values into the CPU caches than other impls. The reason why bulk get\\/set is faster when bitsPerValue&gt;32 is that Direct64 uses System.arraycopy instead of naive copy (in a for loop).\u003c\\/p\u003e\\n\\n\u003cp\u003eInterestingly, the different impls have very close random get performance.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295139_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295139_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jun\\/12 16:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-14T16:20:04+0000\'\u003e14\\/Jun\\/12 16:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have run more tests on  PackedInts  impls over the last days to test their relative performance. \\n\\n It appears that the specializations in  Packed64SingleBlock  don\'t help much and even hurt performance in some cases. Moreover, replacing the naive bulk operations by a  System.arraycopy  in  Direct64  is a big win. (See attached patch.) \\n\\n You can look at the details of the tests here:  http:\\/\\/people.apache.org\\/~jpountz\\/packed_ints.html  (contiguous=Packed64, padding=Packed64SingleBlock,3 blocks=Packed*ThreeBlocks,direct=Direct*). \\n\\n The tests were run on a 64-bit computer (Core 2 Duo E5500) with valueCount=10 000 000. \\\"Memory overhead\\\" is  \\n{unused space in bits}\\n \\/ \\n{bits per value}\\n  while the other charts measure the number of gets\\/sets per second. \\n\\n The random get\\/set results are very good for the packed versions, probably because they manage to fit much more values into the CPU caches than other impls. The reason why bulk get\\/set is faster when bitsPerValue&gt;32 is that Direct64 uses System.arraycopy instead of naive copy (in a for loop). \\n\\n Interestingly, the different impls have very close random get performance.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295167\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295167&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295167\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295167_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295167_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jun\\/12 17:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-14T17:09:57+0000\'\u003e14\\/Jun\\/12 17:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWhat\'s on the axes in those plots? System.copyarray is an intrinsic &#8211; it\'ll be much faster than any other loop that doesn\'t eliminate bounds checks (and I think with more complex logic this will not be done).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295167_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295167_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jun\\/12 17:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-14T17:09:57+0000\'\u003e14\\/Jun\\/12 17:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    What\'s on the axes in those plots? System.copyarray is an intrinsic &#8211; it\'ll be much faster than any other loop that doesn\'t eliminate bounds checks (and I think with more complex logic this will not be done).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295176\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295176&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295176\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295176_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295176_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jun\\/12 17:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-14T17:30:24+0000\'\u003e14\\/Jun\\/12 17:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe x axis is the number of bits per value while the y axis is the number of values that are read or written per second. For every bitsPerValue and bit-packing scheme, I took the impl with the lowest working bitsPerValue. (For example, bitsPerValue=19 would give a Direct32, a Packed64(bitsPerValue=19), a Packed8ThreeBlocks(24 bits per value) and a Packed64SingleBlock(bitsPerValue=21)). There are 4 lines because we currently have 4 different bit-packing schemes.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the two first cases, values are read at random offsets while the two bulk tests read\\/write a large number of values sequentially. I didn\'t want to test \u003ctt\u003eSystem.arraycopy\u003c\\/tt\u003e against a naive for-loop, I just noticed that \u003ctt\u003eDirect64\u003c\\/tt\u003e bulk operations didn\'t use \u003ctt\u003earraycopy\u003c\\/tt\u003e, so I fixed that and added a few words about it so that people understand why the throughput increases when bitsPerValue &gt; 32, which is counter-intuitive.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295176_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295176_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jun\\/12 17:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-14T17:30:24+0000\'\u003e14\\/Jun\\/12 17:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The x axis is the number of bits per value while the y axis is the number of values that are read or written per second. For every bitsPerValue and bit-packing scheme, I took the impl with the lowest working bitsPerValue. (For example, bitsPerValue=19 would give a Direct32, a Packed64(bitsPerValue=19), a Packed8ThreeBlocks(24 bits per value) and a Packed64SingleBlock(bitsPerValue=21)). There are 4 lines because we currently have 4 different bit-packing schemes. \\n\\n In the two first cases, values are read at random offsets while the two bulk tests read\\/write a large number of values sequentially. I didn\'t want to test  System.arraycopy  against a naive for-loop, I just noticed that  Direct64  bulk operations didn\'t use  arraycopy , so I fixed that and added a few words about it so that people understand why the throughput increases when bitsPerValue &gt; 32, which is counter-intuitive.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295195\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295195&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295195\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295195_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295195_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jun\\/12 17:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-14T17:57:18+0000\'\u003e14\\/Jun\\/12 17:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOk, thanks - makes sense. Is the code for these benchmarks somewhere? \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295195_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295195_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jun\\/12 17:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-14T17:57:18+0000\'\u003e14\\/Jun\\/12 17:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Ok, thanks - makes sense. Is the code for these benchmarks somewhere?               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295395\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295395&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295395\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13295395_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295395_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 00:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T00:08:09+0000\'\u003e15\\/Jun\\/12 00:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eVery cool graphs!  Somehow you should turn them into a blog post \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13295395_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295395_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 00:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T00:08:09+0000\'\u003e15\\/Jun\\/12 00:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Very cool graphs!  Somehow you should turn them into a blog post                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295569\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295569&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295569\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295569_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295569_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 10:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T10:20:18+0000\'\u003e15\\/Jun\\/12 10:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e@Dawid I attached the file I used to compute these numbers. There is a lot of garbage in the output because I print some stuff to prevent the JVM from doing optimizations.\u003c\\/p\u003e\\n\\n\u003cp\u003e@Mike Yes, I was actually thinking of it too... \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295569_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295569_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 10:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T10:20:18+0000\'\u003e15\\/Jun\\/12 10:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    @Dawid I attached the file I used to compute these numbers. There is a lot of garbage in the output because I print some stuff to prevent the JVM from doing optimizations. \\n\\n @Mike Yes, I was actually thinking of it too...                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295571\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295571&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295571\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295571_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295571_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 10:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T10:24:02+0000\'\u003e15\\/Jun\\/12 10:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI thought about the full cycle you used to produce the pretty graphs \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295571_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295571_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 10:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T10:24:02+0000\'\u003e15\\/Jun\\/12 10:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I thought about the full cycle you used to produce the pretty graphs                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295575\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295575&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295575\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295575_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295575_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 10:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T10:31:33+0000\'\u003e15\\/Jun\\/12 10:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOh, sorry! When the program ends (it takes to lot of time to run), there are 4 sections at the end (SET, GET, BULKSET and BULKGET) that contain a list of arrays (which are actually JSON arrays). To generate the charts, just take the HTML source of \u003ca href=\\\"http:\\/\\/people.apache.org\\/~jpountz\\/packed_ints.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/people.apache.org\\/~jpountz\\/packed_ints.html\u003c\\/a\u003e (which uses Google Charts API \u003ca href=\\\"https:\\/\\/developers.google.com\\/chart\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/developers.google.com\\/chart\\/\u003c\\/a\u003e) and replace the JSON arrays with the ones you just generated (lines 101, 184, 267 and 349). \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295575_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295575_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 10:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T10:31:33+0000\'\u003e15\\/Jun\\/12 10:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Oh, sorry! When the program ends (it takes to lot of time to run), there are 4 sections at the end (SET, GET, BULKSET and BULKGET) that contain a list of arrays (which are actually JSON arrays). To generate the charts, just take the HTML source of  http:\\/\\/people.apache.org\\/~jpountz\\/packed_ints.html  (which uses Google Charts API  https:\\/\\/developers.google.com\\/chart\\/ ) and replace the JSON arrays with the ones you just generated (lines 101, 184, 267 and 349).               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295580\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295580&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295580\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295580_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295580_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 10:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T10:53:39+0000\'\u003e15\\/Jun\\/12 10:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAh, nice. We were using google charts but then switched to this one &#8211; \u003ca href=\\\"http:\\/\\/code.google.com\\/p\\/flot\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/code.google.com\\/p\\/flot\\/\u003c\\/a\u003e. It is nice but of course comes with its own limitations. \u003c\\/p\u003e\\n\\n\u003cp\u003eAs for the benchmark &#8211; you may want to peek at Google Caliper (\u003ca href=\\\"http:\\/\\/code.google.com\\/p\\/caliper\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/code.google.com\\/p\\/caliper\\/\u003c\\/a\u003e) or JUnitBenchmarks (\u003ca href=\\\"http:\\/\\/labs.carrotsearch.com\\/junit-benchmarks.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/labs.carrotsearch.com\\/junit-benchmarks.html\u003c\\/a\u003e) instead of writing your own code for doing warmups, etc. Caliper is nice in that it spawns a separate JVM so you can minimize the influence of code order execution on hotspot optimizations. Just a thought.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295580_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295580_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 10:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T10:53:39+0000\'\u003e15\\/Jun\\/12 10:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Ah, nice. We were using google charts but then switched to this one &#8211;  http:\\/\\/code.google.com\\/p\\/flot\\/ . It is nice but of course comes with its own limitations.  \\n\\n As for the benchmark &#8211; you may want to peek at Google Caliper ( http:\\/\\/code.google.com\\/p\\/caliper\\/ ) or JUnitBenchmarks ( http:\\/\\/labs.carrotsearch.com\\/junit-benchmarks.html ) instead of writing your own code for doing warmups, etc. Caliper is nice in that it spawns a separate JVM so you can minimize the influence of code order execution on hotspot optimizations. Just a thought.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295612\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295612&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295612\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295612_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295612_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 12:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T12:06:08+0000\'\u003e15\\/Jun\\/12 12:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eWe were using google charts but then switched to this one \\u2013 \u003ca href=\\\"http:\\/\\/code.google.com\\/p\\/flot\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/code.google.com\\/p\\/flot\\/\u003c\\/a\u003e.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWhat was your motivation?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eAs for the benchmark \\u2013 you may want to peek at Google Caliper (\u003ca href=\\\"http:\\/\\/code.google.com\\/p\\/caliper\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/code.google.com\\/p\\/caliper\\/\u003c\\/a\u003e) or JUnitBenchmarks (\u003ca href=\\\"http:\\/\\/labs.carrotsearch.com\\/junit-benchmarks.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/labs.carrotsearch.com\\/junit-benchmarks.html\u003c\\/a\u003e)\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThanks for the JUnitBenchmarks link, I didn\'t know it. How does it compare to Caliper?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13295612_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295612_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 12:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T12:06:08+0000\'\u003e15\\/Jun\\/12 12:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     We were using google charts but then switched to this one \\u2013  http:\\/\\/code.google.com\\/p\\/flot\\/ .  \\n\\n What was your motivation? \\n\\n  As for the benchmark \\u2013 you may want to peek at Google Caliper ( http:\\/\\/code.google.com\\/p\\/caliper\\/ ) or JUnitBenchmarks ( http:\\/\\/labs.carrotsearch.com\\/junit-benchmarks.html )  \\n\\n Thanks for the JUnitBenchmarks link, I didn\'t know it. How does it compare to Caliper?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13295630\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13295630&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13295630\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295630_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295630_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 12:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T12:34:03+0000\'\u003e15\\/Jun\\/12 12:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eWhat was your motivation?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eMostly aesthetics. I guess same things can be done with both.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eThanks for the JUnitBenchmarks link, I didn\'t know it. How does it compare to Caliper?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThey\'re different. I wanted something I could use with JUnit (existing toolchains) without much extra overhead. Caliper is more advanced, supports running under different jvms (forks the task), supports cartesian sets of attributes. It\'s nice. I use both from time to time.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dweiss\\\" id=\\\"commentauthor_13295630_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dweiss\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dweiss\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dawid Weiss\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13295630_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/12 12:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-15T12:34:03+0000\'\u003e15\\/Jun\\/12 12:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     What was your motivation?  \\n\\n Mostly aesthetics. I guess same things can be done with both. \\n\\n  Thanks for the JUnitBenchmarks link, I didn\'t know it. How does it compare to Caliper?  \\n\\n They\'re different. I wanted something I could use with JUnit (existing toolchains) without much extra overhead. Caliper is more advanced, supports running under different jvms (forks the task), supports cartesian sets of attributes. It\'s nice. I use both from time to time.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13396747\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13396747&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13396747\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13396747_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13396747_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Jun\\/12 13:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-19T13:08:58+0000\'\u003e19\\/Jun\\/12 13:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted (r1351682 on trunk and r1351698 on branch 4.x). Thanks Mike and Dawid for your comments.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13396747_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13396747_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Jun\\/12 13:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-19T13:08:58+0000\'\u003e19\\/Jun\\/12 13:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed (r1351682 on trunk and r1351698 on branch 4.x). Thanks Mike and Dawid for your comments.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13401924\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13401924&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13401924\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13401924_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13401924_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 03:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T03:03:51+0000\'\u003e27\\/Jun\\/12 03:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI tried running the PackedIntsBenchmark on an i7 processor and I agree on the overall conclusion with regard to the speed, or rather lack of speed, for Packed64. However, my the winners for the different BPVs were not always the same as Adrien observed. I suspect that CPU architecture and memory system, especially caching, plays a very large role here.\u003c\\/p\u003e\\n\\n\u003cp\u003eRe-thinking the no-branching idea for Packed64, it seems that in reality it is slower to perform two memory requests (where the second will most probably be cached) than take the pipeline flush. Therefore I have created Packed64calc (see attachment), which is a full replacement for Packed64.\u003c\\/p\u003e\\n\\n\u003cp\u003eMy own tests shows Packed64calc to be significantly faster than Packed64 and in many cases faster than Packed64SingleBlock. I suspect the latter to be caused either by caching or the fact that Packed64SingleBlock uses division and modulo for set &amp; get. While the modulo can be avoided in Packed64SingleBlock, I never did find a reliable way to bypass the division when I experimented with it.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have attached an updated PackedIntsBenchmark which can be used with Packed64calc and hope that Adrien will take a look.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13401924_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13401924_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 03:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T03:03:51+0000\'\u003e27\\/Jun\\/12 03:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I tried running the PackedIntsBenchmark on an i7 processor and I agree on the overall conclusion with regard to the speed, or rather lack of speed, for Packed64. However, my the winners for the different BPVs were not always the same as Adrien observed. I suspect that CPU architecture and memory system, especially caching, plays a very large role here. \\n\\n Re-thinking the no-branching idea for Packed64, it seems that in reality it is slower to perform two memory requests (where the second will most probably be cached) than take the pipeline flush. Therefore I have created Packed64calc (see attachment), which is a full replacement for Packed64. \\n\\n My own tests shows Packed64calc to be significantly faster than Packed64 and in many cases faster than Packed64SingleBlock. I suspect the latter to be caused either by caching or the fact that Packed64SingleBlock uses division and modulo for set &amp; get. While the modulo can be avoided in Packed64SingleBlock, I never did find a reliable way to bypass the division when I experimented with it. \\n\\n I have attached an updated PackedIntsBenchmark which can be used with Packed64calc and hope that Adrien will take a look.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13402075\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13402075&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13402075\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13402075_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402075_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 09:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T09:12:14+0000\'\u003e27\\/Jun\\/12 09:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for your patch, Toke. All tests seem to pass, I\'ll try to generate graphs for your impl as soon as possible!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13402075_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402075_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 09:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T09:12:14+0000\'\u003e27\\/Jun\\/12 09:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for your patch, Toke. All tests seem to pass, I\'ll try to generate graphs for your impl as soon as possible!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13402089\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13402089&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13402089\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13402089_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402089_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 09:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T09:44:08+0000\'\u003e27\\/Jun\\/12 09:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI ran the test on three different machines. results are attached as measurements*.txt along with a PDF with graphs generated from iteration #6 (which should probably be the mean or max of run 2-5). The setter-graph for the p4 looks extremely strange for Direct, but I tried generating a graph for iteration #5 instead and it looked the same. in the same vein, the Direct performance for the Xeon is suspiciously low, so I wonder if there\'s some freaky JITting happening to the test code.\u003c\\/p\u003e\\n\\n\u003cp\u003eUnfortunately I did not find an AMD machine to test on. For the three tested Intels, it seems that the Packed64calc does perform very well.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13402089_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402089_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 09:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T09:44:08+0000\'\u003e27\\/Jun\\/12 09:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I ran the test on three different machines. results are attached as measurements*.txt along with a PDF with graphs generated from iteration #6 (which should probably be the mean or max of run 2-5). The setter-graph for the p4 looks extremely strange for Direct, but I tried generating a graph for iteration #5 instead and it looked the same. in the same vein, the Direct performance for the Xeon is suspiciously low, so I wonder if there\'s some freaky JITting happening to the test code. \\n\\n Unfortunately I did not find an AMD machine to test on. For the three tested Intels, it seems that the Packed64calc does perform very well.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13402201\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13402201&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13402201\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13402201_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402201_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 12:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T12:56:22+0000\'\u003e27\\/Jun\\/12 12:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Adrien Grand - 27\\/Jun\\/12 12:58\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for sharing your results. Here are mines: \u003ca href=\\\"http:\\/\\/people.apache.org\\/~jpountz\\/packed_ints_calc.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/people.apache.org\\/~jpountz\\/packed_ints_calc.html\u003c\\/a\u003e (E5500 @ 2.80GHz, java 1.7.0_02, hotspot build 22.0-b10). Funny to see those little bumps when the number of bits per value is 8, 16, 32 or 64 (24 as well, although it is smaller)!\u003c\\/p\u003e\\n\\n\u003cp\u003eIt is not clear whether this impl is faster or slower than the single-block impl (or even the 3 blocks impl, I am happily surprised by the read throughput on the intel 4 machine) depending on the hardware. However, this new impl seems to be consistently better than the current Packed64 class so I think we should replace it with your new impl. What do you think? Can you write a patch?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13402201_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402201_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 12:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T12:56:22+0000\'\u003e27\\/Jun\\/12 12:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Adrien Grand - 27\\/Jun\\/12 12:58\\\"\u003eedited\u003c\\/span\u003e                   Thanks for sharing your results. Here are mines:  http:\\/\\/people.apache.org\\/~jpountz\\/packed_ints_calc.html  (E5500 @ 2.80GHz, java 1.7.0_02, hotspot build 22.0-b10). Funny to see those little bumps when the number of bits per value is 8, 16, 32 or 64 (24 as well, although it is smaller)! \\n\\n It is not clear whether this impl is faster or slower than the single-block impl (or even the 3 blocks impl, I am happily surprised by the read throughput on the intel 4 machine) depending on the hardware. However, this new impl seems to be consistently better than the current Packed64 class so I think we should replace it with your new impl. What do you think? Can you write a patch?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13402279\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13402279&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13402279\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13402279_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402279_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 15:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T15:01:52+0000\'\u003e27\\/Jun\\/12 15:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMaking Packed64calc the new Packed64 seems like a safe bet. I\'d be happy to create a patch for it. Should I open a new issue or add the patch here? If I do it here, how do we avoid confusing the original fine-grained-oriented patch from the Packed64 replacement?\u003c\\/p\u003e\\n\\n\u003cp\u003eI think it it hard to see a clear pattern as to which Mutable implementation should be selected for the different size &amp; bpv-requirements, with the current available measurements. I\'ll perform some more experiments with JRE1.6\\/JRE1.7 on different hardware and see if the picture gets clearer.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13402279_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402279_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 15:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T15:01:52+0000\'\u003e27\\/Jun\\/12 15:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Making Packed64calc the new Packed64 seems like a safe bet. I\'d be happy to create a patch for it. Should I open a new issue or add the patch here? If I do it here, how do we avoid confusing the original fine-grained-oriented patch from the Packed64 replacement? \\n\\n I think it it hard to see a clear pattern as to which Mutable implementation should be selected for the different size &amp; bpv-requirements, with the current available measurements. I\'ll perform some more experiments with JRE1.6\\/JRE1.7 on different hardware and see if the picture gets clearer.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13402283\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13402283&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13402283\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13402283_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402283_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 15:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T15:06:00+0000\'\u003e27\\/Jun\\/12 15:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYes, a new issue will make things clearer. Thanks, Toke!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13402283_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13402283_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/12 15:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-27T15:06:00+0000\'\u003e27\\/Jun\\/12 15:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Yes, a new issue will make things clearer. Thanks, Toke!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13403064\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13403064&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13403064\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13403064_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13403064_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/12 12:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-28T12:47:04+0000\'\u003e28\\/Jun\\/12 12:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have tried running the performance test again with different setups. Graphs at \u003ca href=\\\"http:\\/\\/ekot.dk\\/misc\\/packedints\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/ekot.dk\\/misc\\/packedints\\/\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eMost of the tests under JRE 1.7 are still running, but from the single JRE 1.6 vs. JRE 1.7 (at the bottom), it would seem that there is a difference in the performance of Packed64SingleBlock vs. Packed64. Take that with a grain of salt though, as the results from that machine are quite strange (especially for Direct sets).\u003c\\/p\u003e\\n\\n\u003cp\u003eIf the Java version influences which choice is best and if we throw valueCount into the mix (or rather cache utilization, which is very much non-determinable when a Mutable is requested), I am afraid that it will be very hard to auto-recommend a specific implementation.\u003c\\/p\u003e\\n\\n\u003cp\u003eI will update the page and notify here, when more tests has finished.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13403064_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13403064_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/12 12:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-28T12:47:04+0000\'\u003e28\\/Jun\\/12 12:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have tried running the performance test again with different setups. Graphs at  http:\\/\\/ekot.dk\\/misc\\/packedints\\/  \\n\\n Most of the tests under JRE 1.7 are still running, but from the single JRE 1.6 vs. JRE 1.7 (at the bottom), it would seem that there is a difference in the performance of Packed64SingleBlock vs. Packed64. Take that with a grain of salt though, as the results from that machine are quite strange (especially for Direct sets). \\n\\n If the Java version influences which choice is best and if we throw valueCount into the mix (or rather cache utilization, which is very much non-determinable when a Mutable is requested), I am afraid that it will be very hard to auto-recommend a specific implementation. \\n\\n I will update the page and notify here, when more tests has finished.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13403074\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13403074&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13403074\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13403074_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13403074_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/12 13:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-28T13:00:40+0000\'\u003e28\\/Jun\\/12 13:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eVery interesting. Out of curiousity could you try to run the tests on your machines with the attached Packed64SingleBlock.java? It generates sub-classes that might help the JVM optimize some multiplications\\/remainders. I\'d be interested to see what the difference is on your machines (on mine, it is slightly faster than the current Packed64SingleBlock impl).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13403074_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13403074_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/12 13:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-28T13:00:40+0000\'\u003e28\\/Jun\\/12 13:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Very interesting. Out of curiousity could you try to run the tests on your machines with the attached Packed64SingleBlock.java? It generates sub-classes that might help the JVM optimize some multiplications\\/remainders. I\'d be interested to see what the difference is on your machines (on mine, it is slightly faster than the current Packed64SingleBlock impl).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13403941\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13403941&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13403941\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13403941_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13403941_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/12 14:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-29T14:38:36+0000\'\u003e29\\/Jun\\/12 14:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNice trick with the inheritance in Packed64SingleBlock.java. I really helped a lot on the machines I tested with. I tried to use the Strategy Pattern myself, using switch on the final bitsPerValue in set &amp; get, but it seems that Hotspot is not keen on optimizing such a conditional away. I have now used the inheritance method to provide faster implementations in Packed64 for 1, 2, 4, 8, 16, 32 and 64 bpv. Due to the existence of the Direct classes, this is only relevant for 1, 2 &amp; 4 bpv though.\u003c\\/p\u003e\\n\\n\u003cp\u003eSome new measurements at \u003ca href=\\\"http:\\/\\/ekot.dk\\/misc\\/packedints\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/ekot.dk\\/misc\\/packedints\\/\u003c\\/a\u003e with the following implementations:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003econtiguous: The Packed64 that is being reviewed at LYCENE-4171\u003c\\/li\u003e\\n\\t\u003cli\u003epadding: The new Packed64SingleBlock.java with sub-classes\u003c\\/li\u003e\\n\\t\u003cli\u003e3 blocks: As before\u003c\\/li\u003e\\n\\t\u003cli\u003edirect: As before\u003c\\/li\u003e\\n\\t\u003cli\u003eold padding: Packed64SingleBlock.java without sub-classes\u003c\\/li\u003e\\n\\t\u003cli\u003econtiguous strategy: Packed64Strategy.java, which uses sub-classes to optimize for bpv 2^n\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI changed PackedIntsBenchmark to report the highest measured performance from the iterations instead of the mean. The rationale is that the mean is vulnerable to machine load fluxations and GC throughout the whole measurement process.\u003c\\/p\u003e\\n\\n\u003cp\u003eMy observations are that the measurements from atria &amp; pc254, which are relatively old machines, are very similar and fits well with the theory: Padding does give higher or equal performance than Packed64 at all other bpv\'s than 2^n.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe story is not so clear for mars, which is a very fast machine: For the current test case of 10M values, the padding only provides better performance after 18-20 bpv and for some bpv, Packed64 is a bit faster. I suspect that point would be moved if other processes were competing for memory cache. Still pending are measurements from my i7-machine. I hope to add them this evening or tomorrow.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso pending is why the performance of Direct set is so low for mars. It makes no sense: Even if there is some freaky hit for requesting bytes, shorts or ints on that machine, performance should be &gt;= everything else at 64bpv.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen should we stop optimizing? For 1 bpv, a list of booleans would probably be faster, so should we make a PackedBoolean? Similarly, Packed8, Packed16 and Packed32 would also make sense if we were really determined. None of the implementations are hard to make, but it becomes a hassle to update when a new feature is needed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13403941_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13403941_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/12 14:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-29T14:38:36+0000\'\u003e29\\/Jun\\/12 14:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Nice trick with the inheritance in Packed64SingleBlock.java. I really helped a lot on the machines I tested with. I tried to use the Strategy Pattern myself, using switch on the final bitsPerValue in set &amp; get, but it seems that Hotspot is not keen on optimizing such a conditional away. I have now used the inheritance method to provide faster implementations in Packed64 for 1, 2, 4, 8, 16, 32 and 64 bpv. Due to the existence of the Direct classes, this is only relevant for 1, 2 &amp; 4 bpv though. \\n\\n Some new measurements at  http:\\/\\/ekot.dk\\/misc\\/packedints\\/  with the following implementations: \\n \\n\\t contiguous: The Packed64 that is being reviewed at LYCENE-4171 \\n\\t padding: The new Packed64SingleBlock.java with sub-classes \\n\\t 3 blocks: As before \\n\\t direct: As before \\n\\t old padding: Packed64SingleBlock.java without sub-classes \\n\\t contiguous strategy: Packed64Strategy.java, which uses sub-classes to optimize for bpv 2^n \\n \\n\\n\\n I changed PackedIntsBenchmark to report the highest measured performance from the iterations instead of the mean. The rationale is that the mean is vulnerable to machine load fluxations and GC throughout the whole measurement process. \\n\\n My observations are that the measurements from atria &amp; pc254, which are relatively old machines, are very similar and fits well with the theory: Padding does give higher or equal performance than Packed64 at all other bpv\'s than 2^n. \\n\\n The story is not so clear for mars, which is a very fast machine: For the current test case of 10M values, the padding only provides better performance after 18-20 bpv and for some bpv, Packed64 is a bit faster. I suspect that point would be moved if other processes were competing for memory cache. Still pending are measurements from my i7-machine. I hope to add them this evening or tomorrow. \\n\\n Also pending is why the performance of Direct set is so low for mars. It makes no sense: Even if there is some freaky hit for requesting bytes, shorts or ints on that machine, performance should be &gt;= everything else at 64bpv. \\n\\n When should we stop optimizing? For 1 bpv, a list of booleans would probably be faster, so should we make a PackedBoolean? Similarly, Packed8, Packed16 and Packed32 would also make sense if we were really determined. None of the implementations are hard to make, but it becomes a hassle to update when a new feature is needed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13403971\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13403971&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13403971\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13403971_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13403971_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/12 15:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-29T15:31:42+0000\'\u003e29\\/Jun\\/12 15:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis is very interesting!\u003c\\/p\u003e\\n\\n\u003cp\u003eResults computed on mars are very strange so I think we should not take them into account to make decisions...\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eWhen should we stop optimizing?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThis is a relevant question. I think there is no problem going further provided that we have evidence that the changes improve performance in most cases and that the code remains maintainable. For example, it is probably not necessary to work on specialized Packed64 for the 2^n bits cases since there are direct impls for the 8, 16, 32 and 64 bits cases and since the new Packed64SingleBlock impl seems to be as fast for 1, 2 and 4 bits per value.\u003c\\/p\u003e\\n\\n\u003cp\u003eHowever, I think it makes sense to replace Packed64SingleBlock with the inheritance-based impl since it seems faster than the current impl and than Packed64. I will open an issue if the graphs computed on your core i7 computer confirm this trend.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13403971_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13403971_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/12 15:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-29T15:31:42+0000\'\u003e29\\/Jun\\/12 15:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This is very interesting! \\n\\n Results computed on mars are very strange so I think we should not take them into account to make decisions... \\n\\n  When should we stop optimizing?  \\n\\n This is a relevant question. I think there is no problem going further provided that we have evidence that the changes improve performance in most cases and that the code remains maintainable. For example, it is probably not necessary to work on specialized Packed64 for the 2^n bits cases since there are direct impls for the 8, 16, 32 and 64 bits cases and since the new Packed64SingleBlock impl seems to be as fast for 1, 2 and 4 bits per value. \\n\\n However, I think it makes sense to replace Packed64SingleBlock with the inheritance-based impl since it seems faster than the current impl and than Packed64. I will open an issue if the graphs computed on your core i7 computer confirm this trend.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13404234\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13404234&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13404234\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13404234_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13404234_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/12 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-29T21:31:44+0000\'\u003e29\\/Jun\\/12 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Toke Eskildsen - 29\\/Jun\\/12 22:03\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e+1 for replacing the Packed64SingleBlock with the optimized version. It is consistently better.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have updated the charts at \u003ca href=\\\"http:\\/\\/ekot.dk\\/misc\\/packedints\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/ekot.dk\\/misc\\/packedints\\/\u003c\\/a\u003e with i7 measurements. For the three non-i7-based Intel processors, Packed64SingleBlock seems clear-cut for the \\\"Best possible performance without going all-out with Direct\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eI tried running two tests in parallel on te-prime (see \u003ca href=\\\"http:\\/\\/ekot.dk\\/misc\\/packedints\\/te-prime_parallel.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/ekot.dk\\/misc\\/packedints\\/te-prime_parallel.html\u003c\\/a\u003e) and got very consistent results:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eFor set, contiguous strategy is faster than or equal to padded for bpvs 3-12 and 16-21 (with bpv 1 and 2 being hard to measure). Since padded only supports bpv 1-10, 12, 16, 21 &amp; 32 with non-conforming bpvs rounded up, this effectively means that there is zero gain in using padded over contiguous with regard to set on that machine.\u003c\\/li\u003e\\n\\t\u003cli\u003eFor get, the picture is nearly the same, except for bpv 17-21 where contiguous is slower than padded (observed in process 2 as well as the single-thread run). The difference is less than 10% though. The same pattern, although noisier, can be seen on mars.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eMy preliminary conclusion for i7-processors is thus that Packed64Strategy is the right choice for \\\"Best possible performance without going all-out with Direct\\\". I am getting very curious about the untested AMD architecture now.\u003c\\/p\u003e\\n\\n\u003cp\u003eA by-product of the te-prime parallel test is that the amount of cache seems to matter little when it comes to selecting the most fitting implementation. Thank $diety for small favors.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13404234_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13404234_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/12 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-29T21:31:44+0000\'\u003e29\\/Jun\\/12 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Toke Eskildsen - 29\\/Jun\\/12 22:03\\\"\u003eedited\u003c\\/span\u003e                   +1 for replacing the Packed64SingleBlock with the optimized version. It is consistently better. \\n\\n I have updated the charts at  http:\\/\\/ekot.dk\\/misc\\/packedints\\/  with i7 measurements. For the three non-i7-based Intel processors, Packed64SingleBlock seems clear-cut for the \\\"Best possible performance without going all-out with Direct\\\". \\n\\n I tried running two tests in parallel on te-prime (see  http:\\/\\/ekot.dk\\/misc\\/packedints\\/te-prime_parallel.html ) and got very consistent results: \\n \\n\\t For set, contiguous strategy is faster than or equal to padded for bpvs 3-12 and 16-21 (with bpv 1 and 2 being hard to measure). Since padded only supports bpv 1-10, 12, 16, 21 &amp; 32 with non-conforming bpvs rounded up, this effectively means that there is zero gain in using padded over contiguous with regard to set on that machine. \\n\\t For get, the picture is nearly the same, except for bpv 17-21 where contiguous is slower than padded (observed in process 2 as well as the single-thread run). The difference is less than 10% though. The same pattern, although noisier, can be seen on mars. \\n \\n\\n\\n My preliminary conclusion for i7-processors is thus that Packed64Strategy is the right choice for \\\"Best possible performance without going all-out with Direct\\\". I am getting very curious about the untested AMD architecture now. \\n\\n A by-product of the te-prime parallel test is that the amount of cache seems to matter little when it comes to selecting the most fitting implementation. Thank $diety for small favors.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13404629\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13404629&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13404629\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13404629_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13404629_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/12 21:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-30T21:21:44+0000\'\u003e30\\/Jun\\/12 21:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Toke Eskildsen - 01\\/Jul\\/12 11:06\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnother angle on the auto-selection problem: Packed64SingleBlock supports 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 21, 32 as bpv\'s. The Direct-classes handles 8, 16 &amp; 32 bpv and with the inheritance-trick, Packed64 handles 1, 2 &amp; 4 exactly as Packed64SingleBlock. This leaves us with 3, 5, 6, 7, 9, 10, 12 and 21 bpv as \\\"unique\\\" implementations. In the hope of getting a better overview, I tried making bar-charts with those bps\'s: \u003ca href=\\\"http:\\/\\/ekot.dk\\/misc\\/packedints\\/padding.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/ekot.dk\\/misc\\/packedints\\/padding.html\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eAgain, it would be illuminating to get measurements from an older as well as a newer AMD machine. I also hope to get the time to run the test on another i7-machine to see if the trend from te-prime and mars can be confirmed, but I am leaving for vacation on Tuesday. As of now, the most fitting implementation depends on the machine and since the choice of implementation affects the persistence format, I find this problematic. It is not optimal for a heterogeneous distributed setup.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13404629_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13404629_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/12 21:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-06-30T21:21:44+0000\'\u003e30\\/Jun\\/12 21:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Toke Eskildsen - 01\\/Jul\\/12 11:06\\\"\u003eedited\u003c\\/span\u003e                   Another angle on the auto-selection problem: Packed64SingleBlock supports 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 21, 32 as bpv\'s. The Direct-classes handles 8, 16 &amp; 32 bpv and with the inheritance-trick, Packed64 handles 1, 2 &amp; 4 exactly as Packed64SingleBlock. This leaves us with 3, 5, 6, 7, 9, 10, 12 and 21 bpv as \\\"unique\\\" implementations. In the hope of getting a better overview, I tried making bar-charts with those bps\'s:  http:\\/\\/ekot.dk\\/misc\\/packedints\\/padding.html  \\n\\n Again, it would be illuminating to get measurements from an older as well as a newer AMD machine. I also hope to get the time to run the test on another i7-machine to see if the trend from te-prime and mars can be confirmed, but I am leaving for vacation on Tuesday. As of now, the most fitting implementation depends on the machine and since the choice of implementation affects the persistence format, I find this problematic. It is not optimal for a heterogeneous distributed setup.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13404801\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13404801&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13404801\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13404801_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13404801_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Jul\\/12 20:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-01T20:41:50+0000\'\u003e01\\/Jul\\/12 20:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe graphs are updated with data from my i7 desktop machine. The data looks a lot like the measurements from the other two i7-machines.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13404801_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13404801_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Jul\\/12 20:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-01T20:41:50+0000\'\u003e01\\/Jul\\/12 20:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The graphs are updated with data from my i7 desktop machine. The data looks a lot like the measurements from the other two i7-machines.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13405004\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13405004&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13405004\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13405004_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13405004_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jul\\/12 11:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-02T11:10:15+0000\'\u003e02\\/Jul\\/12 11:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for your graphs, Toke. It is very interesting to see how the different impls compare on various computers!\u003c\\/p\u003e\\n\\n\u003cp\u003eI created \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-4184\\\" title=\\\"Replace o.a.l.u.packed.Packed64SingleBlock with an inheritance-based impl\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-4184\\\"\u003e\u003cdel\u003eLUCENE-4184\u003c\\/del\u003e\u003c\\/a\u003e to replace Packed64SingleBlock with the inheritance-based impl.\u003c\\/p\u003e\\n\\n\u003cp\u003eInitially, I chose valueCount=10,000,000 because it sounded like a reasonable segment size and because it would yield a lot of cache misses on my 2M-cache CPU (when bitsPerValue &gt;= 4 at least). Given Mars and your i7 machines have big CPU caches, I\'d be interested to know whether graphs still have the same shape with valueCount=100,000,000 for example.\u003c\\/p\u003e\\n\\n\u003cp\u003eOtherwise, I am a little bit reluctant to try to improve the impl selection routine used in \u003ctt\u003ePackedInts.getMutable\u003c\\/tt\u003e given how different results are based on the arch, unless we manage to find some clear (and easily accessible from Java) patterns that make an impl faster than another.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13405004_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13405004_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jul\\/12 11:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-02T11:10:15+0000\'\u003e02\\/Jul\\/12 11:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for your graphs, Toke. It is very interesting to see how the different impls compare on various computers! \\n\\n I created   LUCENE-4184   to replace Packed64SingleBlock with the inheritance-based impl. \\n\\n Initially, I chose valueCount=10,000,000 because it sounded like a reasonable segment size and because it would yield a lot of cache misses on my 2M-cache CPU (when bitsPerValue &gt;= 4 at least). Given Mars and your i7 machines have big CPU caches, I\'d be interested to know whether graphs still have the same shape with valueCount=100,000,000 for example. \\n\\n Otherwise, I am a little bit reluctant to try to improve the impl selection routine used in  PackedInts.getMutable  given how different results are based on the arch, unless we manage to find some clear (and easily accessible from Java) patterns that make an impl faster than another.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13405418\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13405418&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13405418\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13405418_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13405418_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jul\\/12 23:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-02T23:00:18+0000\'\u003e02\\/Jul\\/12 23:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached improved benchmark that allows for user specified value count, bpv\'s and implementations. Also attached is PackedZero that is a dummy Mutable that is used for measuring the maximum possible throughput.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13405418_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13405418_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jul\\/12 23:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-02T23:00:18+0000\'\u003e02\\/Jul\\/12 23:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached improved benchmark that allows for user specified value count, bpv\'s and implementations. Also attached is PackedZero that is a dummy Mutable that is used for measuring the maximum possible throughput.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13405437\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13405437&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13405437\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13405437_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13405437_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jul\\/12 23:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-02T23:23:30+0000\'\u003e02\\/Jul\\/12 23:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUsing the old benchmark, I\'ve measured performance for 100M values on the i7 server. The graphs are at \u003ca href=\\\"http:\\/\\/ekot.dk\\/misc\\/packedints\\/100m.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/ekot.dk\\/misc\\/packedints\\/100m.html\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eThe \\\"unique\\\" bpvs for padded are 3, 5, 6, 7, 9, 10, 12 and 21. Rounding up to nearest valid bpv extends these to 3, 5, 6, 7, 9-12 and 17-21. For the set method on the i7 server, padding is slower than contiguous for all of these bpvs. For the get method, padding is a smidgen faster for 17-21 bpvs. These results mirrors the 10M test on the i7 laptop.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have started measurement with 100M values on the i7 laptop, but I am running out of time. I expect to check back in 1-2 weeks. Note that I have uploaded a version of PackedIntsBenchmark that makes it easy to experiment with different valueCounts and bpvs.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13405437_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13405437_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Jul\\/12 23:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-02T23:23:30+0000\'\u003e02\\/Jul\\/12 23:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Using the old benchmark, I\'ve measured performance for 100M values on the i7 server. The graphs are at  http:\\/\\/ekot.dk\\/misc\\/packedints\\/100m.html  \\n\\n The \\\"unique\\\" bpvs for padded are 3, 5, 6, 7, 9, 10, 12 and 21. Rounding up to nearest valid bpv extends these to 3, 5, 6, 7, 9-12 and 17-21. For the set method on the i7 server, padding is slower than contiguous for all of these bpvs. For the get method, padding is a smidgen faster for 17-21 bpvs. These results mirrors the 10M test on the i7 laptop. \\n\\n I have started measurement with 100M values on the i7 laptop, but I am running out of time. I expect to check back in 1-2 weeks. Note that I have uploaded a version of PackedIntsBenchmark that makes it easy to experiment with different valueCounts and bpvs.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13405457\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13405457&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13405457\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13405457_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13405457_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jul\\/12 00:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-03T00:04:04+0000\'\u003e03\\/Jul\\/12 00:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks, Toke! Really strange how the direct impl remains the slowest one at setting values...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_13405457_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13405457_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jul\\/12 00:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-03T00:04:04+0000\'\u003e03\\/Jul\\/12 00:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks, Toke! Really strange how the direct impl remains the slowest one at setting values...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13409056\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-4062?focusedCommentId=13409056&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13409056\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13409056_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13409056_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jul\\/12 20:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-08T20:06:29+0000\'\u003e08\\/Jul\\/12 20:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOne solution later and the mystery is still there: Tricking the JVM to request the old memory value before setting the new one in Direct64 does increase its speed to the expected level on the i7 server mars:\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003estatic\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e MASK = 0L;\\n  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e void set(\u003cspan class=\\\"code-keyword\\\"\u003efinal\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e index, \u003cspan class=\\\"code-keyword\\\"\u003efinal\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e value) {\\n    values[index] = values[index] &amp; MASK | value;\\n  }\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eI am guessing it somehow triggers either a pre-fetch of the relevant 4K page in main memory or marks the cache as hotter and thus delaying cache flush. Alas, I am not a hardware guy and this is a bit beyond me.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnyway, the solution is not usable as it slows execution on other machines. I can get access to another i7 server of the same generation, but it is identical to mars so I doubt the results would be different. Unless someone steps up with another current-generation i7 server to test on, I think we should file this under pixies.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso unresolved, but more relevant, is the question about auto-selection of Mutable implementation. Based on the data so far, the current auto-selector will result in sub-optimal selection on i7-machines. Without a reliable architecture detection, another way of viewing the issue is whether to optimize the selector towards older machines (padded) or newer (contiguous).\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ve looked around for a way to determine the CPU and cache size, but so far it seems that the only fairly reliable way is to determine the OS, then call some platform-specific native code and parse the output. Besides the ugliness of this solution, I guess it gets disqualified for the extra needed permissions from the security manager.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13409056_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13409056_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jul\\/12 20:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-07-08T20:06:29+0000\'\u003e08\\/Jul\\/12 20:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    One solution later and the mystery is still there: Tricking the JVM to request the old memory value before setting the new one in Direct64 does increase its speed to the expected level on the i7 server mars: \\n  \\n    public   static   long  MASK = 0L;\\n   public  void set( final   int  index,  final   long  value) {\\n    values[index] = values[index] &amp; MASK | value;\\n  }\\n \\n  \\n I am guessing it somehow triggers either a pre-fetch of the relevant 4K page in main memory or marks the cache as hotter and thus delaying cache flush. Alas, I am not a hardware guy and this is a bit beyond me. \\n\\n Anyway, the solution is not usable as it slows execution on other machines. I can get access to another i7 server of the same generation, but it is identical to mars so I doubt the results would be different. Unless someone steps up with another current-generation i7 server to test on, I think we should file this under pixies. \\n\\n Also unresolved, but more relevant, is the question about auto-selection of Mutable implementation. Based on the data so far, the current auto-selector will result in sub-optimal selection on i7-machines. Without a reliable architecture detection, another way of viewing the issue is whether to optimize the selector towards older machines (padded) or newer (contiguous). \\n\\n I\'ve looked around for a way to determine the CPU and cache size, but so far it seems that the only fairly reliable way is to determine the OS, then call some platform-specific native code and parse the output. Besides the ugliness of this solution, I guess it gets disqualified for the extra needed permissions from the security manager.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516204129978"> 
    <input type="hidden" title="jira.request.server.time" value="374"> 
    <input type="hidden" title="jira.request.id" value="948x7746912x9"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="6"> 
    <input type="hidden" title="db.reads.time.in.ms" value="87"> 
    <input type="hidden" title="db.conns.time.in.ms" value="103"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 948x7746912x9
	          REQUEST TIMESTAMP : [17/Jan/2018:15:48:49 +0000]
	               REQUEST TIME : 0.3740
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 6

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=21, elapsedTotal=87955178, elapsedMin=470132, elapsedMax=36259954, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=25, elapsedTotal=103169276, elapsedMin=496362, elapsedMax=36312126, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
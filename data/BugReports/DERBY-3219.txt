<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|c05e7a8b4815c9ec3ebe7a57486f263e8aef7d87|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"80e44053e2874f\"";
WRM._unparsedData["project-id"]="10594";
WRM._unparsedData["project-key"]="\"DERBY\"";
WRM._unparsedData["project-name"]="\"Derby\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="10594";
WRM._unparsedData["projectKey"]="\"DERBY\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="DERBY-3219"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[DERBY-3219] Group by query with many aggregate columns and case statements fails with: ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[DERBY-3219] Group by query with many aggregate columns and case statements fails with: ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loadingâ€¦
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/DERBY" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-3219">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="10594" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Derby'" src="https://issues.apache.org/jira/secure/projectavatar?pid=10594&amp;avatarId=10122"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/DERBY">Derby</a></li>
                 <li><a class="issue-link" data-issue-key="DERBY-3219" href="/jira/browse/DERBY-3219" id="key-val" rel="12382936">DERBY-3219</a></li>
                </ol>
                <h1 id="summary-val">Group by query with many aggregate columns and case statements fails with: ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-3219"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/DERBY-3219/DERBY-3219.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/DERBY-3219/DERBY-3219.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/DERBY-3219/DERBY-3219.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/DERBY-3219/DERBY-3219.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="10.3.1.4 ">10.3.1.4</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.5.1.1" title="10.5.1.1 build: 764942, 14/Apr/09. Voted release: 28/Apr/09. Announced: 1/May/09">10.5.1.1</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+component+%3D+SQL" title="SQL ">SQL</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12382936-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>using the attached database (v10.3) - " select * from pivotview " fails with the stack trace below. A view (pivotview_ok) created on a subset of the columns in pivotview executes fine. Adding one column back into pivotview_ok causes failures most of the time. See attached for view definitions.</p> 
                  <p>2007-11-21 00:58:49.421 GMT Thread<span class="error">[main,5,main]</span> (XID = 2734422), (SESSIONID = 0), (DATABASE = pivotview), (DRDAID = null), Failed Statement is: select * from pivotview<br> ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored<br> at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)<br> at org.apache.derby.impl.store.raw.data.StreamFileContainer.fetchNext(Unknown Source)<br> at org.apache.derby.impl.store.raw.data.StreamFileContainerHandle.fetchNext(Unknown Source)<br> at org.apache.derby.impl.store.access.sort.MergeScan.mergeARow(Unknown Source)<br> at org.apache.derby.impl.store.access.sort.MergeScan.init(Unknown Source)<br> at org.apache.derby.impl.store.access.sort.MergeSort.openSortScan(Unknown Source)<br> at org.apache.derby.impl.store.access.RAMTransaction.openSortScan(Unknown Source)<br> at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.loadSorter(Unknown Source)<br> at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.openCore(Unknown Source)<br> at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source)<br> at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source)<br> at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)<br> at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)<br> at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)<br> at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)<br> at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source)<br> at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source)<br> at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source)<br> at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)<br> at org.apache.derby.impl.tools.ij.Main.go(Unknown Source)<br> at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)<br> at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source)<br> at org.apache.derby.tools.ij.main(Unknown Source)<br> Caused by: java.io.EOFException<br> at java.io.DataInputStream.readBoolean(DataInputStream.java:248)<br> at org.apache.derby.impl.sql.execute.MaxMinAggregator.readExternal(Unknown Source)<br> at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source)<br> at org.apache.derby.iapi.types.UserType.readExternal(Unknown Source)<br> ... 22 more<br> ============= begin nested exception, level (1) ===========<br> java.io.EOFException<br> at java.io.DataInputStream.readBoolean(DataInputStream.java:248)<br> at org.apache.derby.impl.sql.execute.MaxMinAggregator.readExternal(Unknown Source)<br> at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source)<br> at org.apache.derby.iapi.types.UserType.readExternal(Unknown Source)<br> at org.apache.derby.impl.store.raw.data.StreamFileContainer.fetchNext(Unknown Source)<br> at org.apache.derby.impl.store.raw.data.StreamFileContainerHandle.fetchNext(Unknown Source)<br> at org.apache.derby.impl.store.access.sort.MergeScan.mergeARow(Unknown Source)<br> at org.apache.derby.impl.store.access.sort.MergeScan.init(Unknown Source)<br> at org.apache.derby.impl.store.access.sort.MergeSort.openSortScan(Unknown Source)<br> at org.apache.derby.impl.store.access.RAMTransaction.openSortScan(Unknown Source)<br> at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.loadSorter(Unknown Source)<br> at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.openCore(Unknown Source)<br> at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source)<br> at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source)<br> at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)<br> at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)<br> at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)<br> at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)<br> at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source)<br> at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source)<br> at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source)<br> at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)<br> at org.apache.derby.impl.tools.ij.Main.go(Unknown Source)<br> at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)<br> at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source)<br> at org.apache.derby.tools.ij.main(Unknown Source)<br> ============= end nested exception, level (1) ===========<br> Cleanup action completed</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/DERBY-3219?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/DERBY-3219?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/DERBY-3219?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/DERBY-3219?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12382280" data-issue-id="12382936" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12382280/maxminPatch.diff" draggable="true" data-downloadurl="text/x-diff:maxminPatch.diff:https://issues.apache.org/jira/secure/attachment/12382280/maxminPatch.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12382280/maxminPatch.diff" title="Latest  19/May/08 03:45 - Bryan Pendleton" draggable="true" data-downloadurl="text/x-diff:maxminPatch.diff:https://issues.apache.org/jira/secure/attachment/12382280/maxminPatch.diff">maxminPatch.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-05-19T03:45:16.382Z">19/May/08 03:45</time>
                   </dd>
                   <dd class="attachment-size">
                    0.8 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12382282" data-issue-id="12382936" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12382282/patchWithTest.diff" draggable="true" data-downloadurl="text/x-diff:patchWithTest.diff:https://issues.apache.org/jira/secure/attachment/12382282/patchWithTest.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12382282/patchWithTest.diff" title="Latest  19/May/08 04:02 - Bryan Pendleton" draggable="true" data-downloadurl="text/x-diff:patchWithTest.diff:https://issues.apache.org/jira/secure/attachment/12382282/patchWithTest.diff">patchWithTest.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-05-19T04:02:18.059Z">19/May/08 04:02</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12369940" data-issue-id="12382936" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12369940/pivotView.zip" draggable="true" data-downloadurl="application/zip:pivotView.zip:https://issues.apache.org/jira/secure/attachment/12369940/pivotView.zip"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-zip" title="Zip Archive"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12369940/pivotView.zip" title="Latest  21/Nov/07 01:22 - Stan Bradbury" draggable="true" data-downloadurl="application/zip:pivotView.zip:https://issues.apache.org/jira/secure/attachment/12369940/pivotView.zip">pivotView.zip</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2007-11-21T01:22:26.571Z">21/Nov/07 01:22</time>
                   </dd>
                   <dd class="attachment-size">
                    6.58 MB
                   </dd>
                   <dd class="attachment-author">
                    Stan Bradbury
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12382281" data-issue-id="12382936" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12382281/repro.java" draggable="true" data-downloadurl="text/x-java:repro.java:https://issues.apache.org/jira/secure/attachment/12382281/repro.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12382281/repro.java" title="Latest  19/May/08 03:45 - Bryan Pendleton" draggable="true" data-downloadurl="text/x-java:repro.java:https://issues.apache.org/jira/secure/attachment/12382281/repro.java">repro.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-05-19T03:45:16.449Z">19/May/08 03:45</time>
                   </dd>
                   <dd class="attachment-size">
                    1 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12382900" data-issue-id="12382936" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12382900/sanityTest.diff" draggable="true" data-downloadurl="text/x-diff:sanityTest.diff:https://issues.apache.org/jira/secure/attachment/12382900/sanityTest.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12382900/sanityTest.diff" title="Latest  28/May/08 04:27 - Bryan Pendleton" draggable="true" data-downloadurl="text/x-diff:sanityTest.diff:https://issues.apache.org/jira/secure/attachment/12382900/sanityTest.diff">sanityTest.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-05-28T04:27:07.938Z">28/May/08 04:27</time>
                   </dd>
                   <dd class="attachment-size">
                    5 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12383171" data-issue-id="12382936" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12383171/ten_four_patch.diff" draggable="true" data-downloadurl="text/x-patch:ten_four_patch.diff:https://issues.apache.org/jira/secure/attachment/12383171/ten_four_patch.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12383171/ten_four_patch.diff" title="Latest  31/May/08 17:07 - Bryan Pendleton" draggable="true" data-downloadurl="text/x-patch:ten_four_patch.diff:https://issues.apache.org/jira/secure/attachment/12383171/ten_four_patch.diff">ten_four_patch.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-05-31T17:07:45.581Z">31/May/08 17:07</time>
                   </dd>
                   <dd class="attachment-size">
                    5 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12382313" data-issue-id="12382936" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12382313/testWithMemControls.diff" draggable="true" data-downloadurl="application/octet-stream:testWithMemControls.diff:https://issues.apache.org/jira/secure/attachment/12382313/testWithMemControls.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12382313/testWithMemControls.diff" title="Latest  19/May/08 16:44 - Bryan Pendleton" draggable="true" data-downloadurl="application/octet-stream:testWithMemControls.diff:https://issues.apache.org/jira/secure/attachment/12382313/testWithMemControls.diff">testWithMemControls.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-05-19T16:44:56.199Z">19/May/08 16:44</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_bryanpendleton" rel="bryanpendleton" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Bryan Pendleton&quot;,&quot;emailAddress&quot;:&quot;bpendleton.derby@gmail.com&quot;,&quot;username&quot;:&quot;bryanpendleton&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="bryanpendleton"></span></span> Bryan Pendleton </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_stan" rel="stan" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Stan Bradbury&quot;,&quot;emailAddress&quot;:&quot;Stan.Bradbury@gmail.com&quot;,&quot;username&quot;:&quot;stan&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="stan"></span></span> Stan Bradbury </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">1</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">2</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="21/Nov/07 01:16"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2007-11-21T01:16:44+0000">21/Nov/07 01:16</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="22/Jun/17 22:05"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2017-06-22T22:05:29+0000">22/Jun/17 22:05</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="31/May/08 17:08"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2008-05-31T17:08:35+0000">31/May/08 17:08</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3219?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/DERBY-3219?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12544134\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12544134&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12544134\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"stan\\\" id=\\\"commentauthor_12544134_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=stan\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"stan\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Stan Bradbury\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12544134_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Nov\\/07 01:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-21T01:22:26+0000\'\u003e21\\/Nov\\/07 01:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eZipfile contains database and a file with the view definitions.  Note that with this database the test query returns over 2000 rows.  With a smaller set of data (&gt;1000 rows) the PIVOTVIEW query returns without failing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"stan\\\" id=\\\"commentauthor_12544134_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=stan\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"stan\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Stan Bradbury\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12544134_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Nov\\/07 01:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-11-21T01:22:26+0000\'\u003e21\\/Nov\\/07 01:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Zipfile contains database and a file with the view definitions.  Note that with this database the test query returns over 2000 rows.  With a smaller set of data (&gt;1000 rows) the PIVOTVIEW query returns without failing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12553525\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12553525&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12553525\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"gregburrow\\\" id=\\\"commentauthor_12553525_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=gregburrow\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"gregburrow\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Greg Burrow\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12553525_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Dec\\/07 22:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-19T22:46:14+0000\'\u003e19\\/Dec\\/07 22:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI believe the stack trace below is the same issue but the java.io.EOFException occurs at a slightly different location.  Test was run on Derby 10.3.1.4.\u003c\\/p\u003e\\n\\n\u003cp\u003eInternal Exception: java.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\u003cbr\\/\u003e\\nError Code: 20000\u003cbr\\/\u003e\\nCall: SELECT MAX(ID) AS ID, INCALLID, MAX(SEIZEDATE), MAX(SEIZETIME), MAX(SYSTEMTIME), MAX(ORIGCALLEDNUMBER), MAX(ORIGCALLINGNUMBER), MAX(MYRESOURCEGROUP), MAX(THEOTHERRESOURCEGROUP), MAX(ROUTELIST), MAX(RELEASECAUSE), MAX(CALLINGNUMBER), MAX(CALLEDNUMBER), MAX(REDIRECTNUMBER) FROM CDRENTITY WHERE ((ID &gt; 0) AND (DIRECTION LIKE \'1\')) GROUP BY INCALLID ORDER BY ID ASC\u003cbr\\/\u003e\\nQuery: DataReadQuery()\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.exceptions.DatabaseException.sqlException(DatabaseException.java:319)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:566)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.databaseaccess.DatabaseAccessor.executeCall(DatabaseAccessor.java:452)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.threetier.ServerSession.executeCall(ServerSession.java:473)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.queryframework.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:228)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.queryframework.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:214)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.queryframework.DatasourceCallQueryMechanism.executeSelectCall(DatasourceCallQueryMechanism.java:285)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.queryframework.DatasourceCallQueryMechanism.executeSelect(DatasourceCallQueryMechanism.java:267)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.queryframework.DataReadQuery.executeNonCursor(DataReadQuery.java:120)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.queryframework.DataReadQuery.executeDatabaseQuery(DataReadQuery.java:112)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.queryframework.DatabaseQuery.execute(DatabaseQuery.java:628)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.queryframework.DatabaseQuery.executeInUnitOfWork(DatabaseQuery.java:555)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2233)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:952)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:924)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.ejb.cmp3.base.EJBQueryImpl.executeReadQuery(EJBQueryImpl.java:367)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.ejb.cmp3.base.EJBQueryImpl.getResultList(EJBQueryImpl.java:478)\u003cbr\\/\u003e\\n        at com.stratus.emergent.server.database.SupportDbQuery.nativeCdrQuery(SupportDbQuery.java:296)\u003cbr\\/\u003e\\n        at com.stratus.emergent.server.database.SupportDbQuery.nativeFirstCdrQuery(SupportDbQuery.java:391)\u003cbr\\/\u003e\\n        at com.stratus.emergent.server.database.SupportDbQuery.getCdrsClient(SupportDbQuery.java:512)\u003cbr\\/\u003e\\n        at com.stratus.emergent.web.servlet.NewCdrServlet.queryCdrs(NewCdrServlet.java:109)\u003cbr\\/\u003e\\n        at com.stratus.emergent.web.servlet.NewCdrServlet.processRequest(NewCdrServlet.java:86)\u003cbr\\/\u003e\\n        at com.stratus.emergent.web.servlet.NewCdrServlet.doPost(NewCdrServlet.java:153)\u003cbr\\/\u003e\\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:709)\u003cbr\\/\u003e\\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\u003cbr\\/\u003e\\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\u003cbr\\/\u003e\\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\u003cbr\\/\u003e\\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\u003cbr\\/\u003e\\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\u003cbr\\/\u003e\\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\u003cbr\\/\u003e\\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\u003cbr\\/\u003e\\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\u003cbr\\/\u003e\\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\u003cbr\\/\u003e\\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)\u003cbr\\/\u003e\\n        at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\u003cbr\\/\u003e\\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\u003cbr\\/\u003e\\n        at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\u003cbr\\/\u003e\\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\u003cbr\\/\u003e\\n        at java.lang.Thread.run(Thread.java:595)\u003cbr\\/\u003e\\nCaused by: java.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.Util.seeNextException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeQuery(Unknown Source)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.databaseaccess.DatabaseAccessor.executeSelect(DatabaseAccessor.java:726)\u003cbr\\/\u003e\\n        at oracle.toplink.essentials.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:501)\u003cbr\\/\u003e\\n        ... 37 more\u003cbr\\/\u003e\\nCaused by: java.sql.SQLException: Java exception: \': java.io.EOFException\'.\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.Util.javaException(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\u003cbr\\/\u003e\\n        ... 46 more\u003cbr\\/\u003e\\nCaused by: java.io.EOFException\u003cbr\\/\u003e\\n        at java.io.DataInputStream.readBoolean(DataInputStream.java:222)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.sql.execute.MaxMinAggregator.readExternal(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.iapi.types.UserType.readExternal(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.store.raw.data.StreamFileContainer.fetchNext(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.store.raw.data.StreamFileContainerHandle.fetchNext(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.store.access.sort.MergeScan.mergeARow(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.store.access.sort.MergeScan.init(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.store.access.sort.MergeSort.openSortScan(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.store.access.RAMTransaction.openSortScan(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.loadSorter(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.openCore(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.sql.execute.SortResultSet.openCore(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)\u003cbr\\/\u003e\\n        ... 42 more\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"gregburrow\\\" id=\\\"commentauthor_12553525_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=gregburrow\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"gregburrow\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Greg Burrow\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12553525_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Dec\\/07 22:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-12-19T22:46:14+0000\'\u003e19\\/Dec\\/07 22:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I believe the stack trace below is the same issue but the java.io.EOFException occurs at a slightly different location.  Test was run on Derby 10.3.1.4. \\n\\n Internal Exception: java.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored \\nError Code: 20000 \\nCall: SELECT MAX(ID) AS ID, INCALLID, MAX(SEIZEDATE), MAX(SEIZETIME), MAX(SYSTEMTIME), MAX(ORIGCALLEDNUMBER), MAX(ORIGCALLINGNUMBER), MAX(MYRESOURCEGROUP), MAX(THEOTHERRESOURCEGROUP), MAX(ROUTELIST), MAX(RELEASECAUSE), MAX(CALLINGNUMBER), MAX(CALLEDNUMBER), MAX(REDIRECTNUMBER) FROM CDRENTITY WHERE ((ID &gt; 0) AND (DIRECTION LIKE \'1\')) GROUP BY INCALLID ORDER BY ID ASC \\nQuery: DataReadQuery() \\n        at oracle.toplink.essentials.exceptions.DatabaseException.sqlException(DatabaseException.java:319) \\n        at oracle.toplink.essentials.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:566) \\n        at oracle.toplink.essentials.internal.databaseaccess.DatabaseAccessor.executeCall(DatabaseAccessor.java:452) \\n        at oracle.toplink.essentials.threetier.ServerSession.executeCall(ServerSession.java:473) \\n        at oracle.toplink.essentials.internal.queryframework.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:228) \\n        at oracle.toplink.essentials.internal.queryframework.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:214) \\n        at oracle.toplink.essentials.internal.queryframework.DatasourceCallQueryMechanism.executeSelectCall(DatasourceCallQueryMechanism.java:285) \\n        at oracle.toplink.essentials.internal.queryframework.DatasourceCallQueryMechanism.executeSelect(DatasourceCallQueryMechanism.java:267) \\n        at oracle.toplink.essentials.queryframework.DataReadQuery.executeNonCursor(DataReadQuery.java:120) \\n        at oracle.toplink.essentials.queryframework.DataReadQuery.executeDatabaseQuery(DataReadQuery.java:112) \\n        at oracle.toplink.essentials.queryframework.DatabaseQuery.execute(DatabaseQuery.java:628) \\n        at oracle.toplink.essentials.queryframework.DatabaseQuery.executeInUnitOfWork(DatabaseQuery.java:555) \\n        at oracle.toplink.essentials.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2233) \\n        at oracle.toplink.essentials.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:952) \\n        at oracle.toplink.essentials.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:924) \\n        at oracle.toplink.essentials.internal.ejb.cmp3.base.EJBQueryImpl.executeReadQuery(EJBQueryImpl.java:367) \\n        at oracle.toplink.essentials.internal.ejb.cmp3.base.EJBQueryImpl.getResultList(EJBQueryImpl.java:478) \\n        at com.stratus.emergent.server.database.SupportDbQuery.nativeCdrQuery(SupportDbQuery.java:296) \\n        at com.stratus.emergent.server.database.SupportDbQuery.nativeFirstCdrQuery(SupportDbQuery.java:391) \\n        at com.stratus.emergent.server.database.SupportDbQuery.getCdrsClient(SupportDbQuery.java:512) \\n        at com.stratus.emergent.web.servlet.NewCdrServlet.queryCdrs(NewCdrServlet.java:109) \\n        at com.stratus.emergent.web.servlet.NewCdrServlet.processRequest(NewCdrServlet.java:86) \\n        at com.stratus.emergent.web.servlet.NewCdrServlet.doPost(NewCdrServlet.java:153) \\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:709) \\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802) \\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252) \\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173) \\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213) \\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178) \\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126) \\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105) \\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107) \\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148) \\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869) \\n        at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664) \\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527) \\n        at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80) \\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684) \\n        at java.lang.Thread.run(Thread.java:595) \\nCaused by: java.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored \\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.Util.seeNextException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) \\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source) \\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeQuery(Unknown Source) \\n        at oracle.toplink.essentials.internal.databaseaccess.DatabaseAccessor.executeSelect(DatabaseAccessor.java:726) \\n        at oracle.toplink.essentials.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:501) \\n        ... 37 more \\nCaused by: java.sql.SQLException: Java exception: \': java.io.EOFException\'. \\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.Util.javaException(Unknown Source) \\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) \\n        ... 46 more \\nCaused by: java.io.EOFException \\n        at java.io.DataInputStream.readBoolean(DataInputStream.java:222) \\n        at org.apache.derby.impl.sql.execute.MaxMinAggregator.readExternal(Unknown Source) \\n        at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source) \\n        at org.apache.derby.iapi.types.UserType.readExternal(Unknown Source) \\n        at org.apache.derby.impl.store.raw.data.StreamFileContainer.fetchNext(Unknown Source) \\n        at org.apache.derby.impl.store.raw.data.StreamFileContainerHandle.fetchNext(Unknown Source) \\n        at org.apache.derby.impl.store.access.sort.MergeScan.mergeARow(Unknown Source) \\n        at org.apache.derby.impl.store.access.sort.MergeScan.init(Unknown Source) \\n        at org.apache.derby.impl.store.access.sort.MergeSort.openSortScan(Unknown Source) \\n        at org.apache.derby.impl.store.access.RAMTransaction.openSortScan(Unknown Source) \\n        at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.loadSorter(Unknown Source) \\n        at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.openCore(Unknown Source) \\n        at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) \\n        at org.apache.derby.impl.sql.execute.SortResultSet.openCore(Unknown Source) \\n        at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) \\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) \\n        ... 42 more              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12595926\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12595926&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12595926\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12595926_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12595926_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/May\\/08 17:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-11T17:37:47+0000\'\u003e11\\/May\\/08 17:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIn a sane build of the current trunk, I see:\u003c\\/p\u003e\\n\\n\u003cp\u003eDEBUG DebugByteTeeOutputStream OUTPUT: FormatableError:read error    : java.io.EOFException\u003cbr\\/\u003e\\nFormatableError:class written : class org.apache.derby.impl.sql.execute.MaxMinAggregatorFormatableError:read back as nullFormatableError:write id      : 152\u003cbr\\/\u003e\\nException trace: \u003cbr\\/\u003e\\njava.io.EOFException\u003cbr\\/\u003e\\n    at java.io.DataInputStream.readBoolean(DataInputStream.java:222)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.sql.execute.MaxMinAggregator.readExternal(MaxMinAggregator.java:107)\u003cbr\\/\u003e\\n    at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:126)\u003cbr\\/\u003e\\n    at org.apache.derby.iapi.services.io.DebugByteTeeOutputStream.checkObject(DebugByteTeeOutputStream.java:61)\u003cbr\\/\u003e\\n    at org.apache.derby.iapi.services.io.FormatIdOutputStream.writeObject(FormatIdOutputStream.java:168)\u003cbr\\/\u003e\\n    at org.apache.derby.iapi.types.UserType.writeExternal(UserType.java:286)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.store.raw.data.StreamFileContainer.writeColumn(StreamFileContainer.java:758)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.store.raw.data.StreamFileContainer.load(StreamFileContainer.java:525)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.store.raw.data.BaseDataFileFactory.addAndLoadStreamContainer(BaseDataFileFactory.java:921)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.store.raw.xact.Xact.addAndLoadStreamContainer(Xact.java:1341)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.store.access.sort.MergeSort.createMergeRun(MergeSort.java:766)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.store.access.sort.MergeInserter.insert(MergeInserter.java:178)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.loadSorter(GroupedAggregateResultSet.java:308)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.openCore(GroupedAggregateResultSet.java:180)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(ProjectRestrictResultSet.java:168)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(BasicNoPutResultSetImpl.java:245)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:384)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1235)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:625)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:555)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:329)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:508)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:353)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:248)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.tools.ij.Main.go(Main.java:215)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:181)\u003cbr\\/\u003e\\n    at org.apache.derby.impl.tools.ij.Main.main(Main.java:73)\u003cbr\\/\u003e\\n    at org.apache.derby.tools.ij.main(ij.java:59)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12595926_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12595926_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/May\\/08 17:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-11T17:37:47+0000\'\u003e11\\/May\\/08 17:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    In a sane build of the current trunk, I see: \\n\\n DEBUG DebugByteTeeOutputStream OUTPUT: FormatableError:read error    : java.io.EOFException \\nFormatableError:class written : class org.apache.derby.impl.sql.execute.MaxMinAggregatorFormatableError:read back as nullFormatableError:write id      : 152 \\nException trace:  \\njava.io.EOFException \\n    at java.io.DataInputStream.readBoolean(DataInputStream.java:222) \\n    at org.apache.derby.impl.sql.execute.MaxMinAggregator.readExternal(MaxMinAggregator.java:107) \\n    at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:126) \\n    at org.apache.derby.iapi.services.io.DebugByteTeeOutputStream.checkObject(DebugByteTeeOutputStream.java:61) \\n    at org.apache.derby.iapi.services.io.FormatIdOutputStream.writeObject(FormatIdOutputStream.java:168) \\n    at org.apache.derby.iapi.types.UserType.writeExternal(UserType.java:286) \\n    at org.apache.derby.impl.store.raw.data.StreamFileContainer.writeColumn(StreamFileContainer.java:758) \\n    at org.apache.derby.impl.store.raw.data.StreamFileContainer.load(StreamFileContainer.java:525) \\n    at org.apache.derby.impl.store.raw.data.BaseDataFileFactory.addAndLoadStreamContainer(BaseDataFileFactory.java:921) \\n    at org.apache.derby.impl.store.raw.xact.Xact.addAndLoadStreamContainer(Xact.java:1341) \\n    at org.apache.derby.impl.store.access.sort.MergeSort.createMergeRun(MergeSort.java:766) \\n    at org.apache.derby.impl.store.access.sort.MergeInserter.insert(MergeInserter.java:178) \\n    at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.loadSorter(GroupedAggregateResultSet.java:308) \\n    at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.openCore(GroupedAggregateResultSet.java:180) \\n    at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(ProjectRestrictResultSet.java:168) \\n    at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(BasicNoPutResultSetImpl.java:245) \\n    at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:384) \\n    at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1235) \\n    at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:625) \\n    at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:555) \\n    at org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:329) \\n    at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:508) \\n    at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:353) \\n    at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:248) \\n    at org.apache.derby.impl.tools.ij.Main.go(Main.java:215) \\n    at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:181) \\n    at org.apache.derby.impl.tools.ij.Main.main(Main.java:73) \\n    at org.apache.derby.tools.ij.main(ij.java:59)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12595966\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12595966&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12595966\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12595966_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12595966_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/May\\/08 04:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-12T04:14:29+0000\'\u003e12\\/May\\/08 04:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI kind of wandered around in the debugger for a while, and I noticed the following:\u003c\\/p\u003e\\n\\n\u003cp\u003e1) The problem appears to occur when the \\\"max\\\" value in question is a SQLVarChar\u003cbr\\/\u003e\\n     whose value is \\\"\\\" (that is, a string of length 0).\u003cbr\\/\u003e\\n2) The underlying exception which causes the problem is a EOFException\u003cbr\\/\u003e\\n3) When reading a SQLVarchar whose value is \\\"\\\", we seem to normally\u003cbr\\/\u003e\\n     expect and handle an EOFException. See, in particular, this section of code\u003cbr\\/\u003e\\n     in SQLChar.readExternal:\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e            } catch (EOFException eof) \u003c\\/p\u003e\\n{\\n                if (utflen != 0)\\n                    throw new EOFException();\\n\\n                \\/\\/ This is the case for a 0 length string.\\n                \\/\\/ OR the string was originally streamed in\\n                \\/\\/ which puts a 0 for utflen but no trailing\\n                \\/\\/ E0,0,0 markers.\\n                break readingLoop;\\n            }\\n\\n\u003cp\u003e4) When the problem occurs, it seems that we don\'t get the expected EOFException,\u003cbr\\/\u003e\\n    but rather we proceed a bit farther and then get the EOFException at an\u003cbr\\/\u003e\\n    unexpected point.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m wondering whether the problem is that the readExternal\\/writeExternal\u003cbr\\/\u003e\\nimplementation for SQL\u003cspan class=\\\"error\\\"\u003e&#91;var&#93;\u003c\\/span\u003echar values of length 0 is flawed, because it\u003cbr\\/\u003e\\ncan only handle the case where the SQL\u003cspan class=\\\"error\\\"\u003e&#91;var&#93;\u003c\\/span\u003echar value is at the \u003cb\u003eend\u003c\\/b\u003e of\u003cbr\\/\u003e\\nthe buffer, but in the case of the MaxMinAggregator, the SQL\u003cspan class=\\\"error\\\"\u003e&#91;var&#93;\u003c\\/span\u003echar value\u003cbr\\/\u003e\\nis buried inside of a larger data structure (with boolean isNull and boolean isMax)\u003cbr\\/\u003e\\nbookends around the underlying value), and thus the EOFException occurs\u003cbr\\/\u003e\\nunexpectedly.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12595966_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12595966_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/May\\/08 04:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-12T04:14:29+0000\'\u003e12\\/May\\/08 04:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I kind of wandered around in the debugger for a while, and I noticed the following: \\n\\n 1) The problem appears to occur when the \\\"max\\\" value in question is a SQLVarChar \\n     whose value is \\\"\\\" (that is, a string of length 0). \\n2) The underlying exception which causes the problem is a EOFException \\n3) When reading a SQLVarchar whose value is \\\"\\\", we seem to normally \\n     expect and handle an EOFException. See, in particular, this section of code \\n     in SQLChar.readExternal: \\n\\n\\n             } catch (EOFException eof)  \\n{\\n                if (utflen != 0)\\n                    throw new EOFException();\\n\\n                \\/\\/ This is the case for a 0 length string.\\n                \\/\\/ OR the string was originally streamed in\\n                \\/\\/ which puts a 0 for utflen but no trailing\\n                \\/\\/ E0,0,0 markers.\\n                break readingLoop;\\n            }\\n\\n 4) When the problem occurs, it seems that we don\'t get the expected EOFException, \\n    but rather we proceed a bit farther and then get the EOFException at an \\n    unexpected point. \\n\\n I\'m wondering whether the problem is that the readExternal\\/writeExternal \\nimplementation for SQL &#91;var&#93; char values of length 0 is flawed, because it \\ncan only handle the case where the SQL &#91;var&#93; char value is at the  end  of \\nthe buffer, but in the case of the MaxMinAggregator, the SQL &#91;var&#93; char value \\nis buried inside of a larger data structure (with boolean isNull and boolean isMax) \\nbookends around the underlying value), and thus the EOFException occurs \\nunexpectedly.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12596257\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12596257&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12596257\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12596257_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596257_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 03:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T03:05:14+0000\'\u003e13\\/May\\/08 03:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m increasingly convinced that the problem lies in SQLChar.readExternal,\u003cbr\\/\u003e\\ndue to the fact that it can\'t tell the difference between a true string-of-length-0,\u003cbr\\/\u003e\\nand a string which is longer than 65536 bytes in length, and therefore is\u003cbr\\/\u003e\\nbeing \\\"streamed\\\" with a 0 length.\u003c\\/p\u003e\\n\\n\u003cp\u003eThat is, for a string with a length &lt; 65536, SQLChar.readExternal expects:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003e2 byte actual length of the string\u003c\\/li\u003e\\n\\t\u003cli\u003ethe string\'s bytes\u003cbr\\/\u003e\\nWhile for a string with a length &gt;= 65536, SQLChar.readExternal expects:\u003c\\/li\u003e\\n\\t\u003cli\u003e2 byte length code with a value of 0\u003c\\/li\u003e\\n\\t\u003cli\u003ethe string\'s bytes\u003c\\/li\u003e\\n\\t\u003cli\u003ea special 3-byte marker sequence that indicates that the string is complete\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eThe problem is that with a string-of-length-0, SQLChar.readExternal can\'t\u003cbr\\/\u003e\\ntell the difference. It sees the length of 0, and doesn\'t know whether it\u003cbr\\/\u003e\\nwill be followed by 0 bytes of actual data, or by at least 65536 bytes of\u003cbr\\/\u003e\\nactual data.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ve had two ideas:\u003c\\/p\u003e\\n\\n\u003cp\u003e1) If we are allowed to change the data format used by readExternal\\/writeExternal,\u003cbr\\/\u003e\\nwe could change the externalized representaiton of the string-of-length-0\u003cbr\\/\u003e\\nso that it was:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003etwo byte length code (0)\u003c\\/li\u003e\\n\\t\u003cli\u003e0 bytes of actual string data\u003c\\/li\u003e\\n\\t\u003cli\u003e3 byte EOF marker sequence\u003cbr\\/\u003e\\nThis way, if we ever saw the initial length code set to 0, we\'d know that\u003cbr\\/\u003e\\nwe\'d \u003cb\u003ealways\u003c\\/b\u003e read until we saw the 3-byte EOF marker sequence, and\u003cbr\\/\u003e\\nit would \u003cb\u003enever\u003c\\/b\u003e be acceptable to read until EOF\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003e2) If we are not allowed to change the SQL char external data format, then\u003cbr\\/\u003e\\nperhaps we could tell the difference after the fact by realizing that we hit an\u003cbr\\/\u003e\\nEOF exception after a non-zero number of bytes were read, but before 65536+\u003cbr\\/\u003e\\nbytes were read, and therefore we accidentally processed a string-of-length-0\u003cbr\\/\u003e\\nin such a way as to \\\"gobble\\\" data that wasn\'t ours, and perhaps we could\u003cbr\\/\u003e\\nthen use an algorithm which would \\\"mark\\\" the input stream and be able\u003cbr\\/\u003e\\nto push back the data we weren\'t supposed to have read, by restoring back\u003cbr\\/\u003e\\nto the mark.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnybody know if we\'re allowed to change the format used by SQLChar.read\\/writeExternal?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12596257_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596257_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 03:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T03:05:14+0000\'\u003e13\\/May\\/08 03:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m increasingly convinced that the problem lies in SQLChar.readExternal, \\ndue to the fact that it can\'t tell the difference between a true string-of-length-0, \\nand a string which is longer than 65536 bytes in length, and therefore is \\nbeing \\\"streamed\\\" with a 0 length. \\n\\n That is, for a string with a length &lt; 65536, SQLChar.readExternal expects: \\n \\n\\t 2 byte actual length of the string \\n\\t the string\'s bytes \\nWhile for a string with a length &gt;= 65536, SQLChar.readExternal expects: \\n\\t 2 byte length code with a value of 0 \\n\\t the string\'s bytes \\n\\t a special 3-byte marker sequence that indicates that the string is complete \\n \\n\\n\\n The problem is that with a string-of-length-0, SQLChar.readExternal can\'t \\ntell the difference. It sees the length of 0, and doesn\'t know whether it \\nwill be followed by 0 bytes of actual data, or by at least 65536 bytes of \\nactual data. \\n\\n I\'ve had two ideas: \\n\\n 1) If we are allowed to change the data format used by readExternal\\/writeExternal, \\nwe could change the externalized representaiton of the string-of-length-0 \\nso that it was: \\n \\n\\t two byte length code (0) \\n\\t 0 bytes of actual string data \\n\\t 3 byte EOF marker sequence \\nThis way, if we ever saw the initial length code set to 0, we\'d know that \\nwe\'d  always  read until we saw the 3-byte EOF marker sequence, and \\nit would  never  be acceptable to read until EOF \\n \\n\\n\\n 2) If we are not allowed to change the SQL char external data format, then \\nperhaps we could tell the difference after the fact by realizing that we hit an \\nEOF exception after a non-zero number of bytes were read, but before 65536+ \\nbytes were read, and therefore we accidentally processed a string-of-length-0 \\nin such a way as to \\\"gobble\\\" data that wasn\'t ours, and perhaps we could \\nthen use an algorithm which would \\\"mark\\\" the input stream and be able \\nto push back the data we weren\'t supposed to have read, by restoring back \\nto the mark. \\n\\n Anybody know if we\'re allowed to change the format used by SQLChar.read\\/writeExternal?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12596258\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12596258&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12596258\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12596258_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596258_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 03:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T03:13:36+0000\'\u003e13\\/May\\/08 03:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWell, this one line patch makes the repro script pass:\u003c\\/p\u003e\\n\\n\u003cp\u003eIndex: java\\/engine\\/org\\/apache\\/derby\\/iapi\\/types\\/SQLChar.java\u003cbr\\/\u003e\\n===================================================================\u003cbr\\/\u003e\\n&#8212; java\\/engine\\/org\\/apache\\/derby\\/iapi\\/types\\/SQLChar.java        (revision 649830)\u003cbr\\/\u003e\\n+++ java\\/engine\\/org\\/apache\\/derby\\/iapi\\/types\\/SQLChar.java        (working copy)\u003cbr\\/\u003e\\n@@ -551,7 +551,7 @@\u003c\\/p\u003e\\n\\n\u003cp\u003e                boolean isLongUTF = false;\u003cbr\\/\u003e\\n                \\/\\/ for length than 64K, see format description above\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eif (utflen &gt; 65535)\u003cbr\\/\u003e\\n+               if (utflen &gt; 65535 || utflen == 0)\u003cbr\\/\u003e\\n                {\u003cbr\\/\u003e\\n                        isLongUTF = true;\u003cbr\\/\u003e\\n                        utflen = 0;\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI\'ll have to do more testing to see if it breaks other parts of the system.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12596258_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596258_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 03:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T03:13:36+0000\'\u003e13\\/May\\/08 03:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Well, this one line patch makes the repro script pass: \\n\\n Index: java\\/engine\\/org\\/apache\\/derby\\/iapi\\/types\\/SQLChar.java \\n=================================================================== \\n&#8212; java\\/engine\\/org\\/apache\\/derby\\/iapi\\/types\\/SQLChar.java        (revision 649830) \\n+++ java\\/engine\\/org\\/apache\\/derby\\/iapi\\/types\\/SQLChar.java        (working copy) \\n@@ -551,7 +551,7 @@ \\n\\n                 boolean isLongUTF = false; \\n                \\/\\/ for length than 64K, see format description above \\n \\n\\t if (utflen &gt; 65535) \\n+               if (utflen &gt; 65535 || utflen == 0) \\n                { \\n                        isLongUTF = true; \\n                        utflen = 0; \\n \\n\\n\\n I\'ll have to do more testing to see if it breaks other parts of the system.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12596395\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12596395&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12596395\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12596395_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596395_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 13:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T13:46:42+0000\'\u003e13\\/May\\/08 13:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe full regression test run was successful with this change.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt would be nice to develop a standalone test case, but I\'m not\u003cbr\\/\u003e\\nsure of how to cause SQLChar.readExternal to be invoked in\u003cbr\\/\u003e\\na simple test case. The reproduction script is quite complicated,\u003cbr\\/\u003e\\nbecause it has to fetch a large number of intermediate results,\u003cbr\\/\u003e\\nenough to force the internal buffers to fill and the partial results\u003cbr\\/\u003e\\nto be written out to temp files.\u003c\\/p\u003e\\n\\n\u003cp\u003eAny suggestions for how to write a simple standalone test case\u003cbr\\/\u003e\\nwhich exercises SQLChar.readExternal\\/writeExternal?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12596395_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596395_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 13:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T13:46:42+0000\'\u003e13\\/May\\/08 13:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The full regression test run was successful with this change. \\n\\n It would be nice to develop a standalone test case, but I\'m not \\nsure of how to cause SQLChar.readExternal to be invoked in \\na simple test case. The reproduction script is quite complicated, \\nbecause it has to fetch a large number of intermediate results, \\nenough to force the internal buffers to fill and the partial results \\nto be written out to temp files. \\n\\n Any suggestions for how to write a simple standalone test case \\nwhich exercises SQLChar.readExternal\\/writeExternal?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12596435\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12596435&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12596435\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12596435_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596435_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 16:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T16:45:56+0000\'\u003e13\\/May\\/08 16:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have not been following this issue, so just commenting on the idea of changing the format understood by read\\/write external for SQLchar.  I believe while readExternal is not used to read data from store pages into returned user columns, the corresponding interface readExternalFromArray() depends on understanding the same exact format as readExternal and both are tied to the format output by writeExternal.\u003c\\/p\u003e\\n\\n\u003cp\u003eOriginally readExternal and writeExternal was the only way data was read\\/written to disk by the store.  So when changing\u003cbr\\/\u003e\\nthem you need to consider the upgrade of existing data on disk.  At some point, pre-derby new interfaces were added for store\u003cbr\\/\u003e\\nto use which could be highly optimized for reading and writing the data to the in memory array that represents the page whenever\u003cbr\\/\u003e\\nstore is interacting with the page - this was a huge performance win at the time, I have not idea given the advances in JIT technology\u003cbr\\/\u003e\\nwhether that is still the case. \u003c\\/p\u003e\\n\\n\u003cp\u003eSo there is no \\\"rule\\\" against changing the format, but if one does it they need to consider soft and hard upgrade dependencies for\u003cbr\\/\u003e\\nall system and user character based data.  Unfortunately  the current format does not include any type of version id in the data\u003cbr\\/\u003e\\nitself, so handling the formating has to be at a higher level.  For instance we could handle it at the column format id level by having\u003cbr\\/\u003e\\nand old char format id and new char format id.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12596435_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596435_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 16:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T16:45:56+0000\'\u003e13\\/May\\/08 16:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have not been following this issue, so just commenting on the idea of changing the format understood by read\\/write external for SQLchar.  I believe while readExternal is not used to read data from store pages into returned user columns, the corresponding interface readExternalFromArray() depends on understanding the same exact format as readExternal and both are tied to the format output by writeExternal. \\n\\n Originally readExternal and writeExternal was the only way data was read\\/written to disk by the store.  So when changing \\nthem you need to consider the upgrade of existing data on disk.  At some point, pre-derby new interfaces were added for store \\nto use which could be highly optimized for reading and writing the data to the in memory array that represents the page whenever \\nstore is interacting with the page - this was a huge performance win at the time, I have not idea given the advances in JIT technology \\nwhether that is still the case.  \\n\\n So there is no \\\"rule\\\" against changing the format, but if one does it they need to consider soft and hard upgrade dependencies for \\nall system and user character based data.  Unfortunately  the current format does not include any type of version id in the data \\nitself, so handling the formating has to be at a higher level.  For instance we could handle it at the column format id level by having \\nand old char format id and new char format id.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12596437\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12596437&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12596437\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12596437_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596437_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 16:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T16:49:30+0000\'\u003e13\\/May\\/08 16:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI notice that the stack trace printed involves the sorter, so it may be able to reproduce by just creating a test case with enough\u003cbr\\/\u003e\\nrows that also include the problem data item and then writing a simple query with an order by.  The trick is to add enough rows\u003cbr\\/\u003e\\nso the sort is not in memory.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12596437_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596437_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 16:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T16:49:30+0000\'\u003e13\\/May\\/08 16:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I notice that the stack trace printed involves the sorter, so it may be able to reproduce by just creating a test case with enough \\nrows that also include the problem data item and then writing a simple query with an order by.  The trick is to add enough rows \\nso the sort is not in memory.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12596446\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12596446&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12596446\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12596446_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596446_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 17:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T17:01:35+0000\'\u003e13\\/May\\/08 17:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Mike, thanks for the suggestions; I\'ll try to create a test case along those lines.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m actually proposing to change \u003cb\u003ewriteExternal\u003c\\/b\u003e but not \u003cb\u003ereadExternal\u003c\\/b\u003e, as\u003cbr\\/\u003e\\nreadExternal already understands the new format that I propose to use\u003cbr\\/\u003e\\nfor zero-length-strings.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhere would be a good place to set a breakpoint so I can step through\u003cbr\\/\u003e\\nthe code which writes a SQLChar onto a Store page and reads it from the page?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12596446_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596446_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 17:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T17:01:35+0000\'\u003e13\\/May\\/08 17:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Mike, thanks for the suggestions; I\'ll try to create a test case along those lines. \\n\\n I\'m actually proposing to change  writeExternal  but not  readExternal , as \\nreadExternal already understands the new format that I propose to use \\nfor zero-length-strings. \\n\\n Where would be a good place to set a breakpoint so I can step through \\nthe code which writes a SQLChar onto a Store page and reads it from the page?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12596472\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12596472&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12596472\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12596472_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596472_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 17:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T17:59:54+0000\'\u003e13\\/May\\/08 17:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe normal path through the code for getting a record off the page and putting it into a \\\"row\\\" is in\u003cbr\\/\u003e\\nopensource\\/java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/raw\\/data\\/StoredPage!readRecordFromArray()\u003cbr\\/\u003e\\nLook for readExternalFromArray calls in this routine.  There is one other call to readExternalFromArray\u003cbr\\/\u003e\\nwhich is used for qualifying rows in store - so depending on query it may also be called to read the\u003cbr\\/\u003e\\ndata.\u003c\\/p\u003e\\n\\n\u003cp\u003eWriting the data to the page is more complicated.  The data first gets written to a log record -\u003cbr\\/\u003e\\njust search for writeExternal in same file.  And then it makes it way to the page as part of \u003cbr\\/\u003e\\ncalling the doMe() method of the log record - for instance:\u003cbr\\/\u003e\\nopensource\\/java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/raw\\/data\\/InsertOperation.java!doMe()\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12596472_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596472_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 17:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T17:59:54+0000\'\u003e13\\/May\\/08 17:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The normal path through the code for getting a record off the page and putting it into a \\\"row\\\" is in \\nopensource\\/java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/raw\\/data\\/StoredPage!readRecordFromArray() \\nLook for readExternalFromArray calls in this routine.  There is one other call to readExternalFromArray \\nwhich is used for qualifying rows in store - so depending on query it may also be called to read the \\ndata. \\n\\n Writing the data to the page is more complicated.  The data first gets written to a log record - \\njust search for writeExternal in same file.  And then it makes it way to the page as part of  \\ncalling the doMe() method of the log record - for instance: \\nopensource\\/java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/raw\\/data\\/InsertOperation.java!doMe()              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12596480\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12596480&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12596480\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12596480_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596480_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 18:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T18:22:32+0000\'\u003e13\\/May\\/08 18:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOff hand I don\'t know if current derby code will ever read existing on disk character code using readExternal.  Definitlely that is\u003cbr\\/\u003e\\nnot the normal path.  If so then changing writeExternal to write new data in a format that is backward compatible readable would \u003cbr\\/\u003e\\nbe ok, though is a lot of overhead for a \\\"0\\\" length string.  I will try to think of a case where old db\'s may still have the old format for the empty string and thus would not be fixed by your writeExternal change.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12596480_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12596480_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/May\\/08 18:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-13T18:22:32+0000\'\u003e13\\/May\\/08 18:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Off hand I don\'t know if current derby code will ever read existing on disk character code using readExternal.  Definitlely that is \\nnot the normal path.  If so then changing writeExternal to write new data in a format that is backward compatible readable would  \\nbe ok, though is a lot of overhead for a \\\"0\\\" length string.  I will try to think of a case where old db\'s may still have the old format for the empty string and thus would not be fixed by your writeExternal change.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597740\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597740&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597740\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597740_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597740_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/May\\/08 17:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-17T17:13:14+0000\'\u003e17\\/May\\/08 17:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the pointers Mike. I stepped through the read\\/write code to try to\u003cbr\\/\u003e\\nunderstand it better. For completeness, the stack at the point of the\u003cbr\\/\u003e\\nwriteExternal call is:\u003c\\/p\u003e\\n\\n\u003cp\u003eBasePage.insert\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eStoredPage.insertAtSlot\u003c\\/li\u003e\\n\\t\u003cli\u003eBasePage.insertAtSlot\u003c\\/li\u003e\\n\\t\u003cli\u003eBasePage.insertNoOverflow\u003c\\/li\u003e\\n\\t\u003cli\u003eLoggableActions.actionInsert\u003c\\/li\u003e\\n\\t\u003cli\u003eInsertOperation.&lt;init&gt;\u003c\\/li\u003e\\n\\t\u003cli\u003eInsertOperation.writeOptionalDataToBuffer\u003c\\/li\u003e\\n\\t\u003cli\u003eStoredPage.logRow\u003c\\/li\u003e\\n\\t\u003cli\u003eStoredPage.logColumn\u003c\\/li\u003e\\n\\t\u003cli\u003eSQLChar.writeExternal\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597740_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597740_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/May\\/08 17:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-17T17:13:14+0000\'\u003e17\\/May\\/08 17:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the pointers Mike. I stepped through the read\\/write code to try to \\nunderstand it better. For completeness, the stack at the point of the \\nwriteExternal call is: \\n\\n BasePage.insert \\n \\n\\t StoredPage.insertAtSlot \\n\\t BasePage.insertAtSlot \\n\\t BasePage.insertNoOverflow \\n\\t LoggableActions.actionInsert \\n\\t InsertOperation.&lt;init&gt; \\n\\t InsertOperation.writeOptionalDataToBuffer \\n\\t StoredPage.logRow \\n\\t StoredPage.logColumn \\n\\t SQLChar.writeExternal \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597741\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597741&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597741\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597741_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597741_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/May\\/08 17:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-17T17:23:37+0000\'\u003e17\\/May\\/08 17:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSince (I believe) the essence of this problem is that if a SQLChar-based\u003cbr\\/\u003e\\ndata value is included in an externalized object, it must be the last\u003cbr\\/\u003e\\nitem in that object\'s stream (so that the expected EOFException occurs\u003cbr\\/\u003e\\nat the expected location in the stream), I tried an alternate technique\u003cbr\\/\u003e\\nfor patching this problem, which was to reverse the order of the items\u003cbr\\/\u003e\\nin the MaxMinAggregator\'s externalized format, so that the data value\u003cbr\\/\u003e\\ncomes last in the stream:\u003c\\/p\u003e\\n\\n\u003cp\u003eIndex: java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/MaxMinAggregator.java\u003cbr\\/\u003e\\n===================================================================\u003cbr\\/\u003e\\n&#8212; java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/MaxMinAggregator.java\\t(revision 656933)\u003cbr\\/\u003e\\n+++ java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/MaxMinAggregator.java\\t(working copy)\u003cbr\\/\u003e\\n@@ -91,8 +91,8 @@\u003cbr\\/\u003e\\n \\t\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\u003cbr\\/\u003e\\n \\tpublic void writeExternal(ObjectOutput out) throws IOException\u003c\\/p\u003e\\n \\t{\\n+\\t\\tout.writeBoolean(isMax);\\n \\t\\tsuper.writeExternal(out);\\n-\\t\\tout.writeBoolean(isMax);\\n \\t}\\n\\n\u003cp\u003e \\t\\/** \u003cbr\\/\u003e\\n@@ -103,8 +103,8 @@\u003cbr\\/\u003e\\n \\t *\\/\u003cbr\\/\u003e\\n \\tpublic void readExternal(ObjectInput in) \u003cbr\\/\u003e\\n \\t\\tthrows IOException, ClassNotFoundException \u003c\\/p\u003e\\n{\\n+\\t\\tisMax = in.readBoolean();\\n \\t\\tsuper.readExternal(in);\\n-\\t\\tisMax = in.readBoolean();\\n \\t}\\n\u003cp\u003e \\t\\/**\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eGet the formatID which corresponds to this class.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\\n\u003cp\u003eWith this patch, the repro script runs successfully. I haven\'t\u003cbr\\/\u003e\\nyet done any other testing to see whether this patch has\u003cbr\\/\u003e\\nany downsides.\u003c\\/p\u003e\\n\\n\u003cp\u003eAny feedback on whether this is a more promising approach\u003cbr\\/\u003e\\nwould be appreciated.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597741_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597741_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/May\\/08 17:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-17T17:23:37+0000\'\u003e17\\/May\\/08 17:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Since (I believe) the essence of this problem is that if a SQLChar-based \\ndata value is included in an externalized object, it must be the last \\nitem in that object\'s stream (so that the expected EOFException occurs \\nat the expected location in the stream), I tried an alternate technique \\nfor patching this problem, which was to reverse the order of the items \\nin the MaxMinAggregator\'s externalized format, so that the data value \\ncomes last in the stream: \\n\\n Index: java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/MaxMinAggregator.java \\n=================================================================== \\n&#8212; java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/MaxMinAggregator.java\\t(revision 656933) \\n+++ java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/MaxMinAggregator.java\\t(working copy) \\n@@ -91,8 +91,8 @@ \\n \\t\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/ \\n \\tpublic void writeExternal(ObjectOutput out) throws IOException \\n \\t{\\n+\\t\\tout.writeBoolean(isMax);\\n \\t\\tsuper.writeExternal(out);\\n-\\t\\tout.writeBoolean(isMax);\\n \\t}\\n\\n  \\t\\/**  \\n@@ -103,8 +103,8 @@ \\n \\t *\\/ \\n \\tpublic void readExternal(ObjectInput in)  \\n \\t\\tthrows IOException, ClassNotFoundException  \\n{\\n+\\t\\tisMax = in.readBoolean();\\n \\t\\tsuper.readExternal(in);\\n-\\t\\tisMax = in.readBoolean();\\n \\t}\\n  \\t\\/** \\n \\n\\t Get the formatID which corresponds to this class. \\n \\n\\n\\n\\n With this patch, the repro script runs successfully. I haven\'t \\nyet done any other testing to see whether this patch has \\nany downsides. \\n\\n Any feedback on whether this is a more promising approach \\nwould be appreciated.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597856\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597856&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597856\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597856_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597856_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/May\\/08 22:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-18T22:22:19+0000\'\u003e18\\/May\\/08 22:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe MaxMinAggregator change passes the regression tests.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt seems like it should be less risky to be changing MaxMinAggregator\'s\u003cbr\\/\u003e\\nexternal data format than SQLChar\'s external data format.\u003c\\/p\u003e\\n\\n\u003cp\u003eHow do we evaluate the risks (if there are any) of changing the\u003cbr\\/\u003e\\nexternal data format for MaxMinAggregator? That is, how can we tell\u003cbr\\/\u003e\\nif it affects any situations other than this particular issue (which is, when the\u003cbr\\/\u003e\\nintermediate results for a GROUP BY aggregation overflow and have to\u003cbr\\/\u003e\\nbe written to a temp file).\u003c\\/p\u003e\\n\\n\u003cp\u003eMeanwhile, I still need to attempt to write a standalone test case.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597856_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597856_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/May\\/08 22:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-18T22:22:19+0000\'\u003e18\\/May\\/08 22:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The MaxMinAggregator change passes the regression tests. \\n\\n It seems like it should be less risky to be changing MaxMinAggregator\'s \\nexternal data format than SQLChar\'s external data format. \\n\\n How do we evaluate the risks (if there are any) of changing the \\nexternal data format for MaxMinAggregator? That is, how can we tell \\nif it affects any situations other than this particular issue (which is, when the \\nintermediate results for a GROUP BY aggregation overflow and have to \\nbe written to a temp file). \\n\\n Meanwhile, I still need to attempt to write a standalone test case. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597864\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597864&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597864\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597864_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597864_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 03:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T03:45:16+0000\'\u003e19\\/May\\/08 03:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached is \'maxminPatch.diff\', the patch which was\u003cbr\\/\u003e\\npasted as a comment, and now is attached as a diff file.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso attached is \'repro.java\', a standalone program\u003cbr\\/\u003e\\nwhich reproduces the problem for me with the current\u003cbr\\/\u003e\\ntrunk. It would be great if somebody else could\u003cbr\\/\u003e\\nconfirm that \'repro.java\' reproduces the problem for them.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll try to convert repro.java into a form which is\u003cbr\\/\u003e\\nsuitable for inclusion as a new test case in one\u003cbr\\/\u003e\\nof our junit test suites, perhaps GroupByTest.java.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597864_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597864_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 03:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T03:45:16+0000\'\u003e19\\/May\\/08 03:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached is \'maxminPatch.diff\', the patch which was \\npasted as a comment, and now is attached as a diff file. \\n\\n Also attached is \'repro.java\', a standalone program \\nwhich reproduces the problem for me with the current \\ntrunk. It would be great if somebody else could \\nconfirm that \'repro.java\' reproduces the problem for them. \\n\\n I\'ll try to convert repro.java into a form which is \\nsuitable for inclusion as a new test case in one \\nof our junit test suites, perhaps GroupByTest.java.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597865\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597865&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597865\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597865_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597865_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 04:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T04:02:18+0000\'\u003e19\\/May\\/08 04:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached is \'patchWithTest.diff\', a patch proposal,\u003cbr\\/\u003e\\nwhich contains the code change from minmaxPatch.diff\u003cbr\\/\u003e\\nand the test program from repro.java converted to\u003cbr\\/\u003e\\nrun as a test case in GroupByTest.\u003c\\/p\u003e\\n\\n\u003cp\u003ePlease have a look and let me know what you think.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597865_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597865_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 04:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T04:02:18+0000\'\u003e19\\/May\\/08 04:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached is \'patchWithTest.diff\', a patch proposal, \\nwhich contains the code change from minmaxPatch.diff \\nand the test program from repro.java converted to \\nrun as a test case in GroupByTest. \\n\\n Please have a look and let me know what you think.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597879\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597879&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597879\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12597879_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597879_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 06:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T06:48:41+0000\'\u003e19\\/May\\/08 06:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI tried repro.java on a unpatched head of trunk on solaris x86, with multiple sun jdks (1.5.0_14, 1.6.0_04, 1.6.0_05), but it did not show any failures for me.\u003cbr\\/\u003e\\nCould this be platform or jvm related?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12597879_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597879_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 06:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T06:48:41+0000\'\u003e19\\/May\\/08 06:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I tried repro.java on a unpatched head of trunk on solaris x86, with multiple sun jdks (1.5.0_14, 1.6.0_04, 1.6.0_05), but it did not show any failures for me. \\nCould this be platform or jvm related?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597954\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597954&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597954\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597954_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597954_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 13:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T13:42:35+0000\'\u003e19\\/May\\/08 13:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for running the test, Thomas. The test is trying to force the intermediate sort\u003cbr\\/\u003e\\nresults to overflow and no longer fit in memory, so it could definitely be machine or\u003cbr\\/\u003e\\nJDK related. On my machine, I was fiddling with the \\\"number of rows\\\" setting in the\u003cbr\\/\u003e\\ntest to try to provoke the error, and 2000 rows achieved the error, but 1900 did not,\u003cbr\\/\u003e\\nbut perhaps on other configurations still more rows are needed.\u003c\\/p\u003e\\n\\n\u003cp\u003eCan you try increasing the number of rows (the \\\"for\\\" loop in repro.java) and see if you\u003cbr\\/\u003e\\ncan reproduce the problem by increasing the value?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597954_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597954_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 13:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T13:42:35+0000\'\u003e19\\/May\\/08 13:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for running the test, Thomas. The test is trying to force the intermediate sort \\nresults to overflow and no longer fit in memory, so it could definitely be machine or \\nJDK related. On my machine, I was fiddling with the \\\"number of rows\\\" setting in the \\ntest to try to provoke the error, and 2000 rows achieved the error, but 1900 did not, \\nbut perhaps on other configurations still more rows are needed. \\n\\n Can you try increasing the number of rows (the \\\"for\\\" loop in repro.java) and see if you \\ncan reproduce the problem by increasing the value?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597959\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597959&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597959\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12597959_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597959_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 14:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T14:03:22+0000\'\u003e19\\/May\\/08 14:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI managed to reproduce it if I turned down the heap size (-Xmx32M). I don\'t know how the sorters do this, but at least BackingStoreHashtable overflows to disk if it takes more than 1% of the total heap space (and the default size of the heap depends on JVM, OS and available RAM).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12597959_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597959_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 14:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T14:03:22+0000\'\u003e19\\/May\\/08 14:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I managed to reproduce it if I turned down the heap size (-Xmx32M). I don\'t know how the sorters do this, but at least BackingStoreHashtable overflows to disk if it takes more than 1% of the total heap space (and the default size of the heap depends on JVM, OS and available RAM).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597967\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597967&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597967\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597967_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597967_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 14:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T14:29:40+0000\'\u003e19\\/May\\/08 14:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Knut Anders, that makes sense. So perhaps I should do something like:\u003c\\/p\u003e\\n\\n\u003cp\u003e  ((Runtime.getRuntime().totalMemory()\\/100) \\/ 1000) * 1.2\u003c\\/p\u003e\\n\\n\u003cp\u003eto get the number of rows to load into the table, since my rows are each about 1000\u003cbr\\/\u003e\\ncharacters in length, and the 1.2 fudge should cause me to have slightly more rows\u003cbr\\/\u003e\\nthan will fit into the BackingStoreHashtable.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll give that a try, and see if it seems to make the test less sensitive to the heap size.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597967_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597967_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 14:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T14:29:40+0000\'\u003e19\\/May\\/08 14:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Knut Anders, that makes sense. So perhaps I should do something like: \\n\\n   ((Runtime.getRuntime().totalMemory()\\/100) \\/ 1000) * 1.2 \\n\\n to get the number of rows to load into the table, since my rows are each about 1000 \\ncharacters in length, and the 1.2 fudge should cause me to have slightly more rows \\nthan will fit into the BackingStoreHashtable. \\n\\n I\'ll give that a try, and see if it seems to make the test less sensitive to the heap size. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12597997\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12597997&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12597997\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597997_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597997_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 16:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T16:44:56+0000\'\u003e19\\/May\\/08 16:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHmmm. Well, trying to use Runtime.totalMemory() in a\u003cbr\\/\u003e\\nJUnit test did not have the behavior that I expected.\u003c\\/p\u003e\\n\\n\u003cp\u003eCan somebody please try taking the attached \'testWithMemControls.diff\'\u003cbr\\/\u003e\\nand apply it in your environment, and run it for me?\u003c\\/p\u003e\\n\\n\u003cp\u003eI tried 4 experiments:\u003c\\/p\u003e\\n\\n\u003cp\u003e1) java -Xmx32m junit.textui.TestRunner org.apache.derbyTesting.functionTests.tests.lang.GroupByTest | head\u003cbr\\/\u003e\\n2) -Xmx256m\u003cbr\\/\u003e\\n3) -Xmx1024m\u003cbr\\/\u003e\\n4) -Xmx2048m\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd I expected to see Runtime.totalMemory() reporting results\u003cbr\\/\u003e\\nthat were roughly in line with the -Xmx values that I was setting.\u003c\\/p\u003e\\n\\n\u003cp\u003eInstead, I saw these results:\u003cbr\\/\u003e\\n1) -Xmx32m: heap size is 5500928\u003cbr\\/\u003e\\n2) -Xmx256m: heap size is 10063872\u003cbr\\/\u003e\\n3) -Xmx1024m: heap size is 5177344\u003cbr\\/\u003e\\n4) -Xmx2048m: heap size is 5427200\u003cbr\\/\u003e\\nwhich doesn\'t make any sense to me at all.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is with the Sun JDK 1.5.0_05 on RedHat Linux.\u003c\\/p\u003e\\n\\n\u003cp\u003eAm I misunderstanding -Xmx? or misunderstanding\u003cbr\\/\u003e\\nRuntime.totalMemory()? Or is something in the JUnit\u003cbr\\/\u003e\\nharness interacting with my memory specifications?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12597997_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12597997_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 16:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T16:44:56+0000\'\u003e19\\/May\\/08 16:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hmmm. Well, trying to use Runtime.totalMemory() in a \\nJUnit test did not have the behavior that I expected. \\n\\n Can somebody please try taking the attached \'testWithMemControls.diff\' \\nand apply it in your environment, and run it for me? \\n\\n I tried 4 experiments: \\n\\n 1) java -Xmx32m junit.textui.TestRunner org.apache.derbyTesting.functionTests.tests.lang.GroupByTest | head \\n2) -Xmx256m \\n3) -Xmx1024m \\n4) -Xmx2048m \\n\\n And I expected to see Runtime.totalMemory() reporting results \\nthat were roughly in line with the -Xmx values that I was setting. \\n\\n Instead, I saw these results: \\n1) -Xmx32m: heap size is 5500928 \\n2) -Xmx256m: heap size is 10063872 \\n3) -Xmx1024m: heap size is 5177344 \\n4) -Xmx2048m: heap size is 5427200 \\nwhich doesn\'t make any sense to me at all. \\n\\n This is with the Sun JDK 1.5.0_05 on RedHat Linux. \\n\\n Am I misunderstanding -Xmx? or misunderstanding \\nRuntime.totalMemory()? Or is something in the JUnit \\nharness interacting with my memory specifications?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598120\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598120&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598120\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12598120_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598120_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 22:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T22:28:54+0000\'\u003e19\\/May\\/08 22:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eKnut Anders raised another good point, which is how the sorter \u003cbr\\/\u003e\\ndecides when to overflow from memory to disk, and whether\u003cbr\\/\u003e\\nit uses the same \'1% of memory\' test that BackingStoreHashtable does?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12598120_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598120_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 22:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T22:28:54+0000\'\u003e19\\/May\\/08 22:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Knut Anders raised another good point, which is how the sorter  \\ndecides when to overflow from memory to disk, and whether \\nit uses the same \'1% of memory\' test that BackingStoreHashtable does?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598131\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598131&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598131\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12598131_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598131_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 23:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T23:19:32+0000\'\u003e19\\/May\\/08 23:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis code from MergeInserter.java may be relevant to the question of when the\u003cbr\\/\u003e\\nsorter decides to transition from an in-memory sort to a disk-based sort:\u003c\\/p\u003e\\n\\n\u003cp\u003e                \\/\\/ we want to double the sort buffer size if that will result\u003cbr\\/\u003e\\n                \\/\\/ in the sort to use up no more than 1\\/2 of all the free\u003cbr\\/\u003e\\n                \\/\\/ memory (including the sort memory)\u003cbr\\/\u003e\\n                \\/\\/ or if GC is so effective we are now using less memory than before\u003cbr\\/\u003e\\n                \\/\\/ or if we are using less than 1Meg of memory and the jvm is\u003cbr\\/\u003e\\n                \\/\\/ using &lt; 5 meg of memory (this indicates that the JVM can\u003cbr\\/\u003e\\n                \\/\\/ afford to be more bloated ?)\u003cbr\\/\u003e\\n                if (estimatedMemoryUsed &lt; 0 ||\u003cbr\\/\u003e\\n                    ((2*estimatedMemoryUsed) &lt; (estimatedMemoryUsed+currentFreeMemory)\\/2) ||\u003cbr\\/\u003e\\n                    (2*estimatedMemoryUsed &lt; ExternalSortFactory.DEFAULT_MEM_USE &amp;&amp;\u003cbr\\/\u003e\\n                     currentTotalMemory &lt; (5*1024*1024)))\u003c\\/p\u003e\\n                {\\n                    \\/\\/ ok, double the sort buffer size\\n                    sortBuffer.grow(100);\\n\\n                    if (sortBuffer.insert(row) != SortBuffer.INSERT_FULL)\\n                        return;\\n                } \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12598131_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598131_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/May\\/08 23:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-19T23:19:32+0000\'\u003e19\\/May\\/08 23:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This code from MergeInserter.java may be relevant to the question of when the \\nsorter decides to transition from an in-memory sort to a disk-based sort: \\n\\n                 \\/\\/ we want to double the sort buffer size if that will result \\n                \\/\\/ in the sort to use up no more than 1\\/2 of all the free \\n                \\/\\/ memory (including the sort memory) \\n                \\/\\/ or if GC is so effective we are now using less memory than before \\n                \\/\\/ or if we are using less than 1Meg of memory and the jvm is \\n                \\/\\/ using &lt; 5 meg of memory (this indicates that the JVM can \\n                \\/\\/ afford to be more bloated ?) \\n                if (estimatedMemoryUsed &lt; 0 || \\n                    ((2*estimatedMemoryUsed) &lt; (estimatedMemoryUsed+currentFreeMemory)\\/2) || \\n                    (2*estimatedMemoryUsed &lt; ExternalSortFactory.DEFAULT_MEM_USE &amp;&amp; \\n                     currentTotalMemory &lt; (5*1024*1024))) \\n                {\\n                    \\/\\/ ok, double the sort buffer size\\n                    sortBuffer.grow(100);\\n\\n                    if (sortBuffer.insert(row) != SortBuffer.INSERT_FULL)\\n                        return;\\n                }             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598219\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598219&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598219\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12598219_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598219_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/May\\/08 08:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-20T08:16:37+0000\'\u003e20\\/May\\/08 08:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; Am I misunderstanding -Xmx? or misunderstanding\u003cbr\\/\u003e\\n&gt; Runtime.totalMemory()? Or is something in the JUnit\u003cbr\\/\u003e\\n&gt; harness interacting with my memory specifications?\u003c\\/p\u003e\\n\\n\u003cp\u003e-Xmx only specifies the maximum amount of memory for the heap, but\u003cbr\\/\u003e\\nit\'ll be smaller initially. I think you\'ll see totalMemory() returning\u003cbr\\/\u003e\\nthe expected values if you also specify -Xms.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12598219_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598219_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/May\\/08 08:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-20T08:16:37+0000\'\u003e20\\/May\\/08 08:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; Am I misunderstanding -Xmx? or misunderstanding \\n&gt; Runtime.totalMemory()? Or is something in the JUnit \\n&gt; harness interacting with my memory specifications? \\n\\n -Xmx only specifies the maximum amount of memory for the heap, but \\nit\'ll be smaller initially. I think you\'ll see totalMemory() returning \\nthe expected values if you also specify -Xms.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598223\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598223&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598223\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12598223_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598223_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/May\\/08 08:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-20T08:40:53+0000\'\u003e20\\/May\\/08 08:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think I was wrong about when BackingStoreHashtable would spill to disk. It wasn\'t when it used 1% of the heap, but when the number of rows in it exceeded 1% of the number of bytes on the heap. So hopefully each row is smaller than 100 bytes...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12598223_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598223_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/May\\/08 08:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-20T08:40:53+0000\'\u003e20\\/May\\/08 08:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think I was wrong about when BackingStoreHashtable would spill to disk. It wasn\'t when it used 1% of the heap, but when the number of rows in it exceeded 1% of the number of bytes on the heap. So hopefully each row is smaller than 100 bytes...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598541\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598541&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598541\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12598541_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598541_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 02:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T02:41:57+0000\'\u003e21\\/May\\/08 02:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Knut, Thomas, I\'m still confused as to why the repro test case that I\u003cbr\\/\u003e\\nwrote isn\'t reliably demonstrating the problem in your environment.\u003c\\/p\u003e\\n\\n\u003cp\u003eWould it be possible for you to run the \'repro.java\' test\u003cbr\\/\u003e\\nprogram with  -Dderby.debug.true=SortTuning and have a look in your derby.log\u003cbr\\/\u003e\\nto see if you are seeing the same sort of values I am seeing?\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the original repro (select * from pivotview), we encounter some\u003cbr\\/\u003e\\nmemory-overflow-sizing code in ExternalSortFactory.createSort:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \\/\\/ if we have some idea on row size, set sort approx 1 meg of\u003cbr\\/\u003e\\n    \\/\\/ memory sort.\u003cbr\\/\u003e\\n    if (estimatedRowSize &gt; 0)\u003c\\/p\u003e\\n    {\\n    \\t\\/\\/ \\n    \\t\\/\\/ for each column, there is a reference from the key array and\\n    \\t\\/\\/   the 4 bytes reference to the column object plus 12 bytes\\n    \\t\\/\\/   tax on the  column object  \\n    \\t\\/\\/ for each row, SORT_ROW_OVERHEAD is the Node and 4 bytes to\\n    \\t\\/\\/ point to the column array and 4 for alignment\\n    \\t\\/\\/\\n    \\testimatedRowSize += SORT_ROW_OVERHEAD +\\n\\t\\t\\t(template.length*(4+12)) + 8; \\n    \\tsortBufferMax = DEFAULT_MEM_USE\\/estimatedRowSize;\\n    }\\n\u003cp\u003e    else\u003c\\/p\u003e\\n    {\\n    \\tsortBufferMax = defaultSortBufferMax;\\n    }\\n\\n\u003cp\u003e    \\/\\/ if there are barely more rows than sortBufferMax, use 2\u003cbr\\/\u003e\\n    \\/\\/ smaller runs of similar size instead of one larger run\u003cbr\\/\u003e\\n    \\/\\/\u003cbr\\/\u003e\\n    \\/\\/ 10% slush is added to estimated Rows to catch the case where\u003cbr\\/\u003e\\n    \\/\\/ estimated rows underestimate the actual number of rows by 10%.\u003cbr\\/\u003e\\n    \\/\\/\u003cbr\\/\u003e\\n    if (estimatedRows &gt; sortBufferMax &amp;&amp;\u003cbr\\/\u003e\\n    \\t(estimatedRows*1.1) &lt; sortBufferMax*2)\u003cbr\\/\u003e\\n    \\tsortBufferMax = (int)(estimatedRows\\/2 + estimatedRows\\/10);\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the original reproduction case, the variables have the following values:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eestimatedRowSize: 0\u003c\\/li\u003e\\n\\t\u003cli\u003eestimatedRows: 1407\u003c\\/li\u003e\\n\\t\u003cli\u003edefaultSortBufferMax: 1024\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eWith these values, the last \\\"if\\\" statement above evalutes to TRUE, and\u003cbr\\/\u003e\\nthis causes us to compute a SortBuffer size of 843 rows, and since the\u003cbr\\/\u003e\\nactual result has 2065 rows, we overflow the in-memory sort buffer and\u003cbr\\/\u003e\\nwe externalize the MaxMinAggregator instances, leading to the problem.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the \'repro.java\' case that I attached to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3219\\\" title=\\\"Group by query with many aggregate columns and case statements fails with: ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3219\\\"\u003e\u003cdel\u003eDERBY-3219\u003c\\/del\u003e\u003c\\/a\u003e, when I get to\u003cbr\\/\u003e\\nExternalSortFactory.createSort, the variables have the values:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eestimatedRowSize: 0\u003c\\/li\u003e\\n\\t\u003cli\u003eestimatedRows: 30\u003c\\/li\u003e\\n\\t\u003cli\u003edefaultSortBufferMax: 1024\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eWith these values, the \\\"if\\\" statement is NOT true, and so we leave\u003cbr\\/\u003e\\nsortBufferMax set to 1024, and since the actual result has 2000 rows,\u003cbr\\/\u003e\\nwe again overflow the in-memory sort buffer and trigger the problem.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn a SANE build, I can observe this processing by running with\u003cbr\\/\u003e\\n-Dderby.debug.true=SortTuning, and then looking in derby.log for\u003cbr\\/\u003e\\nlines like:\u003c\\/p\u003e\\n\\n\u003cp\u003eDEBUG SortTuning OUTPUT: sortBufferMax = 1024 estimatedRows = 30 estimatedRowSize = 0 defaultSortBufferMax = 1024\u003cbr\\/\u003e\\nDEBUG SortTuning OUTPUT: Growing sortBuffer dynamically, current sortBuffer capacity= 1023 estimatedMemoryUsed = 8587736 currentTotalMemory = 23293952 currentFreeMemory = 10340912 numcolumn = 4 real per row memory = 8394\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12598541_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598541_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 02:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T02:41:57+0000\'\u003e21\\/May\\/08 02:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Knut, Thomas, I\'m still confused as to why the repro test case that I \\nwrote isn\'t reliably demonstrating the problem in your environment. \\n\\n Would it be possible for you to run the \'repro.java\' test \\nprogram with  -Dderby.debug.true=SortTuning and have a look in your derby.log \\nto see if you are seeing the same sort of values I am seeing? \\n\\n In the original repro (select * from pivotview), we encounter some \\nmemory-overflow-sizing code in ExternalSortFactory.createSort: \\n\\n     \\/\\/ if we have some idea on row size, set sort approx 1 meg of \\n    \\/\\/ memory sort. \\n    if (estimatedRowSize &gt; 0) \\n    {\\n    \\t\\/\\/ \\n    \\t\\/\\/ for each column, there is a reference from the key array and\\n    \\t\\/\\/   the 4 bytes reference to the column object plus 12 bytes\\n    \\t\\/\\/   tax on the  column object  \\n    \\t\\/\\/ for each row, SORT_ROW_OVERHEAD is the Node and 4 bytes to\\n    \\t\\/\\/ point to the column array and 4 for alignment\\n    \\t\\/\\/\\n    \\testimatedRowSize += SORT_ROW_OVERHEAD +\\n\\t\\t\\t(template.length*(4+12)) + 8; \\n    \\tsortBufferMax = DEFAULT_MEM_USE\\/estimatedRowSize;\\n    }\\n     else \\n    {\\n    \\tsortBufferMax = defaultSortBufferMax;\\n    }\\n\\n     \\/\\/ if there are barely more rows than sortBufferMax, use 2 \\n    \\/\\/ smaller runs of similar size instead of one larger run \\n    \\/\\/ \\n    \\/\\/ 10% slush is added to estimated Rows to catch the case where \\n    \\/\\/ estimated rows underestimate the actual number of rows by 10%. \\n    \\/\\/ \\n    if (estimatedRows &gt; sortBufferMax &amp;&amp; \\n    \\t(estimatedRows*1.1) &lt; sortBufferMax*2) \\n    \\tsortBufferMax = (int)(estimatedRows\\/2 + estimatedRows\\/10); \\n\\n In the original reproduction case, the variables have the following values: \\n \\n\\t estimatedRowSize: 0 \\n\\t estimatedRows: 1407 \\n\\t defaultSortBufferMax: 1024 \\n \\n\\n\\n With these values, the last \\\"if\\\" statement above evalutes to TRUE, and \\nthis causes us to compute a SortBuffer size of 843 rows, and since the \\nactual result has 2065 rows, we overflow the in-memory sort buffer and \\nwe externalize the MaxMinAggregator instances, leading to the problem. \\n\\n In the \'repro.java\' case that I attached to   DERBY-3219  , when I get to \\nExternalSortFactory.createSort, the variables have the values: \\n \\n\\t estimatedRowSize: 0 \\n\\t estimatedRows: 30 \\n\\t defaultSortBufferMax: 1024 \\n \\n\\n\\n With these values, the \\\"if\\\" statement is NOT true, and so we leave \\nsortBufferMax set to 1024, and since the actual result has 2000 rows, \\nwe again overflow the in-memory sort buffer and trigger the problem. \\n\\n In a SANE build, I can observe this processing by running with \\n-Dderby.debug.true=SortTuning, and then looking in derby.log for \\nlines like: \\n\\n DEBUG SortTuning OUTPUT: sortBufferMax = 1024 estimatedRows = 30 estimatedRowSize = 0 defaultSortBufferMax = 1024 \\nDEBUG SortTuning OUTPUT: Growing sortBuffer dynamically, current sortBuffer capacity= 1023 estimatedMemoryUsed = 8587736 currentTotalMemory = 23293952 currentFreeMemory = 10340912 numcolumn = 4 real per row memory = 8394 \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598579\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598579&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598579\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12598579_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598579_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 07:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T07:42:48+0000\'\u003e21\\/May\\/08 07:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Thomas Nielsen - 21\\/May\\/08 07:43\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRunning the repro on an unpatched head of trunk, on solaris10 x86 with sun jdk 1.6.0_04, with -Dderby.debug.true=SortTuning gives:\u003cbr\\/\u003e\\n&#8212;\u003cbr\\/\u003e\\nDEBUG SortTuning OUTPUT: sortBufferMax = 1024 estimatedRows = 30 estimatedRowSize = 0 defaultSortBufferMax = 1024\u003cbr\\/\u003e\\nDEBUG SortTuning OUTPUT: Growing sortBuffer dynamically, current sortBuffer capacity= 1023 estimatedMemoryUsed = 8264424 currentTotalMemory = 92667904 currentFreeMemory = 79419968 numcolumn = 4 real per row memory = 8078\u003cbr\\/\u003e\\n&#8212;\u003cbr\\/\u003e\\nSeems that the currentTotalMemory and currentFreeMemory are the only real differences from your platform.\u003c\\/p\u003e\\n\\n\u003cp\u003eLimiting the memory to 16M or 32M triggers the reported error on my machine too:\u003cbr\\/\u003e\\n   java -Dderby.debug.true=SortTuning -Xmx32M -Xms32M repro\u003c\\/p\u003e\\n\\n\u003cp\u003eThe SortTuning in this case is\u003cbr\\/\u003e\\n&#8212;\u003cbr\\/\u003e\\nDEBUG SortTuning OUTPUT: sortBufferMax = 1024 estimatedRows = 30 estimatedRowSize = 0 defaultSortBufferMax = 1024\u003cbr\\/\u003e\\nDEBUG SortTuning OUTPUT: Growing sortBuffer dynamically, current sortBuffer capacity= 1023 estimatedMemoryUsed = 7836080 currentTotalMemory = 32374784 currentFreeMemory = 19119984 numcolumn = 4 real per row memory = 7659\u003cbr\\/\u003e\\n&#8212;\u003c\\/p\u003e\\n\\n\u003cp\u003eLike Knut says -Xmx only specifies the maximum allowed but it will start out lower than that. Also -Xms defined the minimum, so with min=max and increasing \u003cb\u003eboth\u003c\\/b\u003e these values you should get the scenario I think you expect \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12598579_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598579_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 07:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T07:42:48+0000\'\u003e21\\/May\\/08 07:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Thomas Nielsen - 21\\/May\\/08 07:43\\\"\u003eedited\u003c\\/span\u003e                   Running the repro on an unpatched head of trunk, on solaris10 x86 with sun jdk 1.6.0_04, with -Dderby.debug.true=SortTuning gives: \\n&#8212; \\nDEBUG SortTuning OUTPUT: sortBufferMax = 1024 estimatedRows = 30 estimatedRowSize = 0 defaultSortBufferMax = 1024 \\nDEBUG SortTuning OUTPUT: Growing sortBuffer dynamically, current sortBuffer capacity= 1023 estimatedMemoryUsed = 8264424 currentTotalMemory = 92667904 currentFreeMemory = 79419968 numcolumn = 4 real per row memory = 8078 \\n&#8212; \\nSeems that the currentTotalMemory and currentFreeMemory are the only real differences from your platform. \\n\\n Limiting the memory to 16M or 32M triggers the reported error on my machine too: \\n   java -Dderby.debug.true=SortTuning -Xmx32M -Xms32M repro \\n\\n The SortTuning in this case is \\n&#8212; \\nDEBUG SortTuning OUTPUT: sortBufferMax = 1024 estimatedRows = 30 estimatedRowSize = 0 defaultSortBufferMax = 1024 \\nDEBUG SortTuning OUTPUT: Growing sortBuffer dynamically, current sortBuffer capacity= 1023 estimatedMemoryUsed = 7836080 currentTotalMemory = 32374784 currentFreeMemory = 19119984 numcolumn = 4 real per row memory = 7659 \\n&#8212; \\n\\n Like Knut says -Xmx only specifies the maximum allowed but it will start out lower than that. Also -Xms defined the minimum, so with min=max and increasing  both  these values you should get the scenario I think you expect                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598643\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598643&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598643\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12598643_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598643_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 13:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T13:40:11+0000\'\u003e21\\/May\\/08 13:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Bryan,\u003cbr\\/\u003e\\nI see the same numbers (more or less) as Thomas on my machine running Solaris Express.\u003cbr\\/\u003e\\nWhat\'s interesting is that the heuristics try to prevent that the heap grows, so if you want to give your queries more memory in order to improve the sort performance, you should always specify both -Xms and -Xmx. Otherwise, if you only specify -Xmx, they won\'t use the extra memory.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12598643_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598643_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 13:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T13:40:11+0000\'\u003e21\\/May\\/08 13:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Bryan, \\nI see the same numbers (more or less) as Thomas on my machine running Solaris Express. \\nWhat\'s interesting is that the heuristics try to prevent that the heap grows, so if you want to give your queries more memory in order to improve the sort performance, you should always specify both -Xms and -Xmx. Otherwise, if you only specify -Xmx, they won\'t use the extra memory.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598668\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598668&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598668\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12598668_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598668_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 14:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T14:35:45+0000\'\u003e21\\/May\\/08 14:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Thomas and Knut. I hear what you are saying about -Xmx and -Xms.\u003cbr\\/\u003e\\nAnd, if I run the repro script with:\u003c\\/p\u003e\\n\\n\u003cp\u003e   java -Xms1024m -Xmx1024m repro\u003c\\/p\u003e\\n\\n\u003cp\u003ethen the problem does NOT reproduce for me, either. So it\'s completely\u003cbr\\/\u003e\\nclear that the repro program is sensitive to the memory configuration.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhat I haven\'t yet managed to do is to make the program dynamically adjust\u003cbr\\/\u003e\\nthe size of the test case in such a way that it reliably reproduces the\u003cbr\\/\u003e\\nproblem, regardless of the memory settings.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut I think I\'m closer now, so I\'ll keep fiddling with the test program \u003cbr\\/\u003e\\nand see if I can solve that problem.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12598668_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598668_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 14:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T14:35:45+0000\'\u003e21\\/May\\/08 14:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Thomas and Knut. I hear what you are saying about -Xmx and -Xms. \\nAnd, if I run the repro script with: \\n\\n    java -Xms1024m -Xmx1024m repro \\n\\n then the problem does NOT reproduce for me, either. So it\'s completely \\nclear that the repro program is sensitive to the memory configuration. \\n\\n What I haven\'t yet managed to do is to make the program dynamically adjust \\nthe size of the test case in such a way that it reliably reproduces the \\nproblem, regardless of the memory settings. \\n\\n But I think I\'m closer now, so I\'ll keep fiddling with the test program  \\nand see if I can solve that problem.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12598760\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12598760&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12598760\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12598760_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598760_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 19:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T19:18:33+0000\'\u003e21\\/May\\/08 19:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have not used it for a very long time, but there use to be a debug\\/SANE version only hack\u003cbr\\/\u003e\\nthat would allow you to force an external sort - no matter what the memory.  I think\u003cbr\\/\u003e\\nif you set the folllowing, then it will go external as long as you have enough rows to\u003cbr\\/\u003e\\nexceed the buffer max that is also setable.:\u003cbr\\/\u003e\\nderby.debug.true=testSort\u003c\\/p\u003e\\n\\n\u003cp\u003eSee:\u003cbr\\/\u003e\\nopensource\\/java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/tests\\/unit\\/T_SortController__derby.properties\u003c\\/p\u003e\\n\\n\u003cp\u003eor\u003cbr\\/\u003e\\nopensource\\/java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/tests\\/store\\/streamingColumn_derby.properties\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eThe area of trying to auto configure sort into memory or not could use a good idea.  \u003c\\/p\u003e\\n\\n\u003cp\u003eThe question is how to provide a zero admin solution that makes everyone happy,\u003cbr\\/\u003e\\nfor a product that both might be used completely embedded as part of a lot of other\u003cbr\\/\u003e\\ncomponents so it probably should not take over all memory of the JVM vs use as\u003cbr\\/\u003e\\nthe single db server on the machine at that time so quite desirable to use all \u003cbr\\/\u003e\\navaliable resources as efficiently as possible.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe existing code is based on jvm features available many years ago and against assumed default configurations where 1 megabyte was ALOT of memory (some\u003cbr\\/\u003e\\nof the target devices didn\'t even have that much memory).\u003cbr\\/\u003e\\nThe code really wanted access to MX available memory but the jvm would\u003cbr\\/\u003e\\nnot give access to that number.  So it had to work off actual amount of memory free which may be 0 even if the MX has been set to allow for 100 megabytes more growth.  The current free number is VERY system dependent - depending on garbage collection, jvm implementation, OS, scheduling within and outside of the JVM, ...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12598760_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12598760_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/May\\/08 19:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-21T19:18:33+0000\'\u003e21\\/May\\/08 19:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have not used it for a very long time, but there use to be a debug\\/SANE version only hack \\nthat would allow you to force an external sort - no matter what the memory.  I think \\nif you set the folllowing, then it will go external as long as you have enough rows to \\nexceed the buffer max that is also setable.: \\nderby.debug.true=testSort \\n\\n See: \\nopensource\\/java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/tests\\/unit\\/T_SortController__derby.properties \\n\\n or \\nopensource\\/java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/tests\\/store\\/streamingColumn_derby.properties \\n\\n\\n The area of trying to auto configure sort into memory or not could use a good idea.   \\n\\n The question is how to provide a zero admin solution that makes everyone happy, \\nfor a product that both might be used completely embedded as part of a lot of other \\ncomponents so it probably should not take over all memory of the JVM vs use as \\nthe single db server on the machine at that time so quite desirable to use all  \\navaliable resources as efficiently as possible. \\n\\n The existing code is based on jvm features available many years ago and against assumed default configurations where 1 megabyte was ALOT of memory (some \\nof the target devices didn\'t even have that much memory). \\nThe code really wanted access to MX available memory but the jvm would \\nnot give access to that number.  So it had to work off actual amount of memory free which may be 0 even if the MX has been set to allow for 100 megabytes more growth.  The current free number is VERY system dependent - depending on garbage collection, jvm implementation, OS, scheduling within and outside of the JVM, ...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12600362\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12600362&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12600362\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12600362_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12600362_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/May\\/08 04:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-28T04:27:07+0000\'\u003e28\\/May\\/08 04:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Mike, thanks for the suggestion.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think that the testSort hook may be just the\u003cbr\\/\u003e\\nright thing for forcing the desired test conditions\u003cbr\\/\u003e\\nfor this issue.\u003c\\/p\u003e\\n\\n\u003cp\u003eAttached is \'sanityTest.diff\', which adjusts the\u003cbr\\/\u003e\\nprevious test case so that, if this is a sane debug\u003cbr\\/\u003e\\nbuild, we call SanityManager.DEBUG_SET(\\\"testSort\\\")\u003cbr\\/\u003e\\nto ensure that the sort is forced to be external.\u003c\\/p\u003e\\n\\n\u003cp\u003eWith this in place, using a sane debug build, the\u003cbr\\/\u003e\\nGroupByTest failed as I expected it to, even when\u003cbr\\/\u003e\\nI forced the memory setting to be artificially high\u003cbr\\/\u003e\\nusing -Xms and -Xmx.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlthough this means that the test only reproduces\u003cbr\\/\u003e\\nthe test conditions in debug sane builds, I think\u003cbr\\/\u003e\\nthat should be OK, because tests do get run in\u003cbr\\/\u003e\\nthose builds routinely (for example, I routinely run\u003cbr\\/\u003e\\ntests using sane debug builds).\u003c\\/p\u003e\\n\\n\u003cp\u003eI think this \'sanityTest.diff\' patch is starting to look\u003cbr\\/\u003e\\npretty good, and I\'d love to get additional feedback\u003cbr\\/\u003e\\non it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12600362_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12600362_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/May\\/08 04:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-28T04:27:07+0000\'\u003e28\\/May\\/08 04:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Mike, thanks for the suggestion. \\n\\n I think that the testSort hook may be just the \\nright thing for forcing the desired test conditions \\nfor this issue. \\n\\n Attached is \'sanityTest.diff\', which adjusts the \\nprevious test case so that, if this is a sane debug \\nbuild, we call SanityManager.DEBUG_SET(\\\"testSort\\\") \\nto ensure that the sort is forced to be external. \\n\\n With this in place, using a sane debug build, the \\nGroupByTest failed as I expected it to, even when \\nI forced the memory setting to be artificially high \\nusing -Xms and -Xmx. \\n\\n Although this means that the test only reproduces \\nthe test conditions in debug sane builds, I think \\nthat should be OK, because tests do get run in \\nthose builds routinely (for example, I routinely run \\ntests using sane debug builds). \\n\\n I think this \'sanityTest.diff\' patch is starting to look \\npretty good, and I\'d love to get additional feedback \\non it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12600363\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12600363&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12600363\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12600363_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12600363_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/May\\/08 04:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-28T04:28:30+0000\'\u003e28\\/May\\/08 04:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAlso, I was successful using the \'repro.java\' program and running\u003cbr\\/\u003e\\nit with -Dderby.debug.true=testSort, and in that case the repro\u003cbr\\/\u003e\\nprogram reliably reproduced the problem for me, with a variety of\u003cbr\\/\u003e\\nalternate -Xms and -Xmx memory settings. So that\'s more evidence\u003cbr\\/\u003e\\nthat this flag is useful to reproduce this problem.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12600363_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12600363_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/May\\/08 04:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-28T04:28:30+0000\'\u003e28\\/May\\/08 04:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Also, I was successful using the \'repro.java\' program and running \\nit with -Dderby.debug.true=testSort, and in that case the repro \\nprogram reliably reproduced the problem for me, with a variety of \\nalternate -Xms and -Xmx memory settings. So that\'s more evidence \\nthat this flag is useful to reproduce this problem.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12600381\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12600381&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12600381\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12600381_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12600381_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/May\\/08 06:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-28T06:29:03+0000\'\u003e28\\/May\\/08 06:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFWIW:\u003cbr\\/\u003e\\n-Dderby.debug.true=testSort makes it fail consistently for me too, even without the -Xmx and -Xms flags.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12600381_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12600381_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/May\\/08 06:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-28T06:29:03+0000\'\u003e28\\/May\\/08 06:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    FWIW: \\n-Dderby.debug.true=testSort makes it fail consistently for me too, even without the -Xmx and -Xms flags.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12600675\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12600675&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12600675\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12600675_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12600675_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/May\\/08 04:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-29T04:22:18+0000\'\u003e29\\/May\\/08 04:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted sanityTest.diff to the trunk as revision 661204.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll investigate merging this change back to 10.4.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12600675_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12600675_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/May\\/08 04:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-29T04:22:18+0000\'\u003e29\\/May\\/08 04:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed sanityTest.diff to the trunk as revision 661204. \\n\\n I\'ll investigate merging this change back to 10.4.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12601398\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12601398&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12601398\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12601398_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12601398_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/08 17:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-31T17:07:45+0000\'\u003e31\\/May\\/08 17:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached is ten_four_patch.diff, which I think is the correct patch\u003cbr\\/\u003e\\nfor the 10.4 branch.\u003c\\/p\u003e\\n\\n\u003cp\u003eMy 10.4  build environment doesn\'t seem to be working right\u003cbr\\/\u003e\\nnow; I\'m getting dozens of failures in the test suites. So I\'m\u003cbr\\/\u003e\\nnot going to commit this patch to the 10.4 branch now, but I\'m\u003cbr\\/\u003e\\nattaching it in case anybody gets the itch to move the patch to\u003cbr\\/\u003e\\nthe 10.4 branch later.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12601398_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12601398_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/08 17:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-31T17:07:45+0000\'\u003e31\\/May\\/08 17:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached is ten_four_patch.diff, which I think is the correct patch \\nfor the 10.4 branch. \\n\\n My 10.4  build environment doesn\'t seem to be working right \\nnow; I\'m getting dozens of failures in the test suites. So I\'m \\nnot going to commit this patch to the 10.4 branch now, but I\'m \\nattaching it in case anybody gets the itch to move the patch to \\nthe 10.4 branch later.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12601399\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12601399&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12601399\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12601399_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12601399_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/08 17:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-31T17:08:35+0000\'\u003e31\\/May\\/08 17:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe patch seems to be stable in the trunk, so for now I\'m resolving this issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12601399_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12601399_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/08 17:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-31T17:08:35+0000\'\u003e31\\/May\\/08 17:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The patch seems to be stable in the trunk, so for now I\'m resolving this issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12601402\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=12601402&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12601402\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12601402_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12601402_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/08 17:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-31T17:58:27+0000\'\u003e31\\/May\\/08 17:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLots of the errors you see in 10.4 are caused by \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3690\\\" title=\\\"EmbedPooledConnection doesn&#39;t reset schema when creating a new logical connection\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3690\\\"\u003e\u003cdel\u003eDERBY-3690\u003c\\/del\u003e\u003c\\/a\u003e (tracked by \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3692\\\" title=\\\"&#39;javax.transaction.xa.XAException&#39; ++  in  &#39;J2EEDataSourceTest&#39; \\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3692\\\"\u003e\u003cdel\u003eDERBY-3692\u003c\\/del\u003e\u003c\\/a\u003e).\u003cbr\\/\u003e\\nI agree waiting is a good idea, but if you want to test right away, you can apply the patch \'derby-3327-5a-extracted_initial_schema_patch.diff \' under \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3327\\\" title=\\\"SQL roles: Implement authorization stack (and SQL session context to hold it)\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3327\\\"\u003e\u003cdel\u003eDERBY-3327\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12601402_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12601402_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/May\\/08 17:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-05-31T17:58:27+0000\'\u003e31\\/May\\/08 17:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Lots of the errors you see in 10.4 are caused by   DERBY-3690   (tracked by   DERBY-3692  ). \\nI agree waiting is a good idea, but if you want to test right away, you can apply the patch \'derby-3327-5a-extracted_initial_schema_patch.diff \' under   DERBY-3327  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-16060086\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3219?focusedCommentId=16060086&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16060086\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"harshvardhan145\\\" id=\\\"commentauthor_16060086_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=harshvardhan145\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"harshvardhan145\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Harshvardhan Gupta\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_16060086_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Jun\\/17 22:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-06-22T22:05:29+0000\'\u003e22\\/Jun\\/17 22:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWhile examining the failed test cases as part of patch for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-6940\\\" title=\\\"Enhance derby statistics for more accurate selectivity estimates.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-6940\\\"\u003eDERBY-6940\u003c\\/a\u003e,I get this error because of exactly the same root cause. i.e  value I am trying to store is a SQLVarChar whose value is \\\"\\\" (that is, a string of length 0).\u003cbr\\/\u003e\\n]\u003cbr\\/\u003e\\nTo reproduce the error with the patch attached with \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-6940\\\" title=\\\"Enhance derby statistics for more accurate selectivity estimates.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-6940\\\"\u003eDERBY-6940\u003c\\/a\u003e, run \u003c\\/p\u003e\\n\\n\u003cp\u003eant -Dderby.junit.testclass=org.apache.derbyTesting.functionTests.tests.lang.OrderByAndSortAvoidance junit-single\u003c\\/p\u003e\\n\\n\u003cp\u003eSince I am trying to filter the min and max values from the database, a string of length 0 turns out to be min value for the test cases in OrderByAndSortAvoidance.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"harshvardhan145\\\" id=\\\"commentauthor_16060086_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=harshvardhan145\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"harshvardhan145\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Harshvardhan Gupta\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_16060086_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Jun\\/17 22:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-06-22T22:05:29+0000\'\u003e22\\/Jun\\/17 22:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    While examining the failed test cases as part of patch for  DERBY-6940 ,I get this error because of exactly the same root cause. i.e  value I am trying to store is a SQLVarChar whose value is \\\"\\\" (that is, a string of length 0). \\n] \\nTo reproduce the error with the patch attached with  DERBY-6940 , run  \\n\\n ant -Dderby.junit.testclass=org.apache.derbyTesting.functionTests.tests.lang.OrderByAndSortAvoidance junit-single \\n\\n Since I am trying to filter the min and max values from the database, a string of length 0 turns out to be min value for the test cases in OrderByAndSortAvoidance.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="10594";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=10594&amp;avatarId=10122\\\" alt=\\\"Derby\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\"\u003eDerby\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520239225435"> 
    <input type="hidden" title="jira.request.server.time" value="338"> 
    <input type="hidden" title="jira.request.id" value="520x94383138x4"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="3"> 
    <input type="hidden" title="db.reads.time.in.ms" value="57"> 
    <input type="hidden" title="db.conns.time.in.ms" value="64"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 520x94383138x4
	          REQUEST TIMESTAMP : [05/Mar/2018:08:40:25 +0000]
	               REQUEST TIME : 0.3380
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 3

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=26, elapsedTotal=57967636, elapsedMin=479255, elapsedMax=29207735, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=30, elapsedTotal=64124491, elapsedMin=511643, elapsedMax=29233273, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
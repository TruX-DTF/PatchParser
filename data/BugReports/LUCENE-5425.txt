<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|4a6c97f3bdfdcd57934788a489d4bcc381b57ca7|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"d9d2b4a8b37a6e\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-5425"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-5425] Make creation of FixedBitSet in FacetsCollector overridable - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-5425] Make creation of FixedBitSet in FacetsCollector overridable - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loadingâ€¦
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-5425">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-5425" href="/jira/browse/LUCENE-5425" id="key-val" rel="12692417">LUCENE-5425</a></li>
                </ol>
                <h1 id="summary-val">Make creation of FixedBitSet in FacetsCollector overridable</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-5425"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-5425/LUCENE-5425.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-5425/LUCENE-5425.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-5425/LUCENE-5425.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-5425/LUCENE-5425.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="4.6 Major release after 4.5">4.6</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+4.7" title="4.7 Major release after 4.6">4.7</a>, <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+6.0" title="6.0 Major release after 5.5">6.0</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22modules%2Ffacet%22" title="modules/facet Faceted Indexing &amp; Search module">modules/facet</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12692417-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310120" class="item"> 
                     <div class="wrap"> 
                      <strong title="Lucene Fields" class="name">Lucene Fields:</strong> 
                      <div id="customfield_12310120-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310120-field"> 
                        <span>New</span>, 
                        <span>Patch Available</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>In FacetsCollector, creation of bits in MatchingDocs are allocated per query. For large indexes where maxDocs are large creating a bitset of maxDoc bits will be expensive and would great a lot of garbage.</p> 
                  <p>Attached patch is to allow for this allocation customizable while maintaining current behavior.</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-5425?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-5425?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-5425?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-5425?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12626390" data-issue-id="12692417" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12626390/facetscollector.patch" draggable="true" data-downloadurl="text/plain:facetscollector.patch:https://issues.apache.org/jira/secure/attachment/12626390/facetscollector.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12626390/facetscollector.patch" title="Latest  31/Jan/14 22:14 - John Wang" draggable="true" data-downloadurl="text/plain:facetscollector.patch:https://issues.apache.org/jira/secure/attachment/12626390/facetscollector.patch">facetscollector.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2014-01-31T22:14:25.591Z">31/Jan/14 22:14</time>
                   </dd>
                   <dd class="attachment-size">
                    19 kB
                   </dd>
                   <dd class="attachment-author">
                    John Wang
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12626230" data-issue-id="12692417" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12626230/facetscollector.patch" draggable="true" data-downloadurl="text/plain:facetscollector.patch:https://issues.apache.org/jira/secure/attachment/12626230/facetscollector.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12626230/facetscollector.patch" title=" 31/Jan/14 00:35 - John Wang" draggable="true" data-downloadurl="text/plain:facetscollector.patch:https://issues.apache.org/jira/secure/attachment/12626230/facetscollector.patch">facetscollector.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2014-01-31T00:35:04.033Z">31/Jan/14 00:35</time>
                   </dd>
                   <dd class="attachment-size">
                    1 kB
                   </dd>
                   <dd class="attachment-author">
                    John Wang
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12626487" data-issue-id="12692417" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12626487/fixbitset.patch" draggable="true" data-downloadurl="text/plain:fixbitset.patch:https://issues.apache.org/jira/secure/attachment/12626487/fixbitset.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12626487/fixbitset.patch" title="Latest  01/Feb/14 19:13 - John Wang" draggable="true" data-downloadurl="text/plain:fixbitset.patch:https://issues.apache.org/jira/secure/attachment/12626487/fixbitset.patch">fixbitset.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2014-02-01T19:13:50.941Z">01/Feb/14 19:13</time>
                   </dd>
                   <dd class="attachment-size">
                    1 kB
                   </dd>
                   <dd class="attachment-author">
                    John Wang
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12627094" data-issue-id="12692417" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12627094/LUCENE-5425.patch" draggable="true" data-downloadurl="text/plain:LUCENE-5425.patch:https://issues.apache.org/jira/secure/attachment/12627094/LUCENE-5425.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12627094/LUCENE-5425.patch" title="Latest  05/Feb/14 08:44 - Shai Erera" draggable="true" data-downloadurl="text/plain:LUCENE-5425.patch:https://issues.apache.org/jira/secure/attachment/12627094/LUCENE-5425.patch">LUCENE-5425.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2014-02-05T08:44:17.377Z">05/Feb/14 08:44</time>
                   </dd>
                   <dd class="attachment-size">
                    21 kB
                   </dd>
                   <dd class="attachment-author">
                    Shai Erera
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12627910" data-issue-id="12692417" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12627910/openbitsetiter.patch" draggable="true" data-downloadurl="text/plain:openbitsetiter.patch:https://issues.apache.org/jira/secure/attachment/12627910/openbitsetiter.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12627910/openbitsetiter.patch" title="Latest  10/Feb/14 02:00 - Lei Wang" draggable="true" data-downloadurl="text/plain:openbitsetiter.patch:https://issues.apache.org/jira/secure/attachment/12627910/openbitsetiter.patch">openbitsetiter.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2014-02-10T02:00:37.596Z">10/Feb/14 02:00</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Lei Wang
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_shaie" rel="shaie" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Shai Erera&quot;,&quot;emailAddress&quot;:&quot;serera@gmail.com&quot;,&quot;username&quot;:&quot;shaie&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="shaie"></span></span> Shai Erera </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_john.wang@gmail.com" rel="john.wang@gmail.com" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;John Wang&quot;,&quot;emailAddress&quot;:&quot;john.wang@gmail.com&quot;,&quot;username&quot;:&quot;john.wang@gmail.com&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="john.wang@gmail.com"></span></span> John Wang </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">5</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="31/Jan/14 00:33"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2014-01-31T00:33:12+0000">31/Jan/14 00:33</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="09/May/16 18:37"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-05-09T18:37:18+0000">09/May/16 18:37</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="05/Feb/14 19:57"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2014-02-05T19:57:22+0000">05/Feb/14 19:57</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-5425?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-5425?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-13887340\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13887340&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13887340\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13887340_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13887340_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 01:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T01:12:53+0000\'\u003e31\\/Jan\\/14 01:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eBetter not to depend on the bitset, it\'s better to depend on a more general interface. In the user\'s application, it they can get rid of the memset part of that data structure, like us in twitter, it can get 4X + performance improvements than a simple caching of the bitset.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13887340_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13887340_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 01:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T01:12:53+0000\'\u003e31\\/Jan\\/14 01:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Better not to depend on the bitset, it\'s better to depend on a more general interface. In the user\'s application, it they can get rid of the memset part of that data structure, like us in twitter, it can get 4X + performance improvements than a simple caching of the bitset.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13887469\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13887469&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13887469\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13887469_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13887469_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 04:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T04:55:58+0000\'\u003e31\\/Jan\\/14 04:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe current patch\'s intention seems to allow the app to cache FixedBitSet, such that it can clear() it before each search? To save the long[] allocation? This looks fine to me. Can you please add javadocs to FC.createBitSet?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eBetter not to depend on the bitset, it\'s better to depend on a more general interface.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWe need to be careful here. Mike and I experimented with cutting the API over to a general DocIdSet, but it hurt the performance of faceted search, even with \\\"smarter\\\" bitsets. When we move to a DocIdSet, we add the DocIdSetIterator layer while iterating over the bits which slows down the search ... at least per luceneutil benchmarks. So if we want to do that, we should do it only after proving, by means of benchmarking, that it doesn\'t hurt performance severely. Would actually be good to show that more compressed bitsets maybe even improve performance, but I would go with the change if the performance-loss is marginal. And we should do it under a separate issue, to not block this one.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13887469_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13887469_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 04:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T04:55:58+0000\'\u003e31\\/Jan\\/14 04:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The current patch\'s intention seems to allow the app to cache FixedBitSet, such that it can clear() it before each search? To save the long[] allocation? This looks fine to me. Can you please add javadocs to FC.createBitSet? \\n\\n  Better not to depend on the bitset, it\'s better to depend on a more general interface.  \\n\\n We need to be careful here. Mike and I experimented with cutting the API over to a general DocIdSet, but it hurt the performance of faceted search, even with \\\"smarter\\\" bitsets. When we move to a DocIdSet, we add the DocIdSetIterator layer while iterating over the bits which slows down the search ... at least per luceneutil benchmarks. So if we want to do that, we should do it only after proving, by means of benchmarking, that it doesn\'t hurt performance severely. Would actually be good to show that more compressed bitsets maybe even improve performance, but I would go with the change if the performance-loss is marginal. And we should do it under a separate issue, to not block this one.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13887506\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13887506&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13887506\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13887506_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13887506_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 06:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T06:13:24+0000\'\u003e31\\/Jan\\/14 06:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eagree it can be a done in a separate issue. didn\'t know a wrapper will affect performance that much. it\'s just an additional method call to me. the default OpenBitSetIterator impl is different with nextSetBit, maybe that\'s the reason? anyway, start with this change won\'t hurt anything. and caching of the bitset should be able to get 20% down on the overhead of new a bitset each time (the other 80% is from the memset). After getting this in, i can do a separate test on the DocIdSet. See if we can get an acceptable performance for the default behavior without reusing the memory.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13887506_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13887506_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 06:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T06:13:24+0000\'\u003e31\\/Jan\\/14 06:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    agree it can be a done in a separate issue. didn\'t know a wrapper will affect performance that much. it\'s just an additional method call to me. the default OpenBitSetIterator impl is different with nextSetBit, maybe that\'s the reason? anyway, start with this change won\'t hurt anything. and caching of the bitset should be able to get 20% down on the overhead of new a bitset each time (the other 80% is from the memset). After getting this in, i can do a separate test on the DocIdSet. See if we can get an acceptable performance for the default behavior without reusing the memory.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13887548\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13887548&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13887548\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13887548_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13887548_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 07:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T07:32:49+0000\'\u003e31\\/Jan\\/14 07:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003edidn\'t know a wrapper will affect performance that much.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eMe neither! We were very surprised to see some of the performance implications of saving a method call or changing the order we iterate on results + facet requests. But it\'s hard to argue w\\/ consistent numbers, and IIRC they weren\'t in the 3-5% range, but 10+%. Could be though that we measured several changes at once .. so I think it\'s worthwhile to benchmark the move to DocIdSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd yes, it could be OpenBitSetIterator, I don\'t rule it out.\u003c\\/p\u003e\\n\\n\u003cp\u003e+1 to allow caching in this issue, we can investigate generalizing the APIs in a separate issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13887548_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13887548_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 07:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T07:32:49+0000\'\u003e31\\/Jan\\/14 07:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     didn\'t know a wrapper will affect performance that much.  \\n\\n Me neither! We were very surprised to see some of the performance implications of saving a method call or changing the order we iterate on results + facet requests. But it\'s hard to argue w\\/ consistent numbers, and IIRC they weren\'t in the 3-5% range, but 10+%. Could be though that we measured several changes at once .. so I think it\'s worthwhile to benchmark the move to DocIdSet. \\n\\n And yes, it could be OpenBitSetIterator, I don\'t rule it out. \\n\\n +1 to allow caching in this issue, we can investigate generalizing the APIs in a separate issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888135\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888135&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888135\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888135_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888135_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 20:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T20:38:18+0000\'\u003e31\\/Jan\\/14 20:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe API would be so much prettier if it returns a DocIdSetIterator.\u003cbr\\/\u003e\\nMaybe we find out if it is indeed OpenBitSetIterator that is slow and fix that, and avoid changing this api again?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888135_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888135_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 20:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T20:38:18+0000\'\u003e31\\/Jan\\/14 20:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The API would be so much prettier if it returns a DocIdSetIterator. \\nMaybe we find out if it is indeed OpenBitSetIterator that is slow and fix that, and avoid changing this api again?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888157\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888157&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888157\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13888157_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888157_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 20:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T20:58:36+0000\'\u003e31\\/Jan\\/14 20:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIf there is really concern, can the API be fixed and just changed to do instanceof?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13888157_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888157_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 20:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T20:58:36+0000\'\u003e31\\/Jan\\/14 20:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    If there is really concern, can the API be fixed and just changed to do instanceof?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888213\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888213&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888213\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888213_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888213_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 21:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T21:56:34+0000\'\u003e31\\/Jan\\/14 21:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI realize if we make getting the docs abstract, to be useful, the set side also needs to be abstract. e.g. line 127\u003cbr\\/\u003e\\nLet me add that to this patch.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888213_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888213_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 21:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T21:56:34+0000\'\u003e31\\/Jan\\/14 21:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I realize if we make getting the docs abstract, to be useful, the set side also needs to be abstract. e.g. line 127 \\nLet me add that to this patch. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888233\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888233&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888233\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888233_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888233_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 22:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T22:15:55+0000\'\u003e31\\/Jan\\/14 22:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003enew patch added:\u003cbr\\/\u003e\\n1) created a MutableDocIdSet class which extends DocIdSet class allows you to add to a docIdSet\u003cbr\\/\u003e\\n2) use this abstraction in both FacetsCollector as well as the counter\\/accumulator classes that use MatchDocs api\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888233_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888233_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/14 22:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-01-31T22:15:55+0000\'\u003e31\\/Jan\\/14 22:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    new patch added: \\n1) created a MutableDocIdSet class which extends DocIdSet class allows you to add to a docIdSet \\n2) use this abstraction in both FacetsCollector as well as the counter\\/accumulator classes that use MatchDocs api              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888445\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888445&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888445\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888445_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888445_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 04:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T04:07:43+0000\'\u003e01\\/Feb\\/14 04:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIf we need to make any change to the API, it has to be a DocIdSet and not Iterator, because the iterator takes away one layer that could be useful (such as a specialized implementation which uses instanceof FixedBitSet check, as what I think Rob suggests).\u003c\\/p\u003e\\n\\n\u003cp\u003eBut, John, didn\'t we say we should explore the move to a DocIdSet-based API in a separate issue where we also benchmark the implications of using all of those abstractions (both at collection and aggregation phases)? This issue was supposed to be about letting you cache the FBS instance.\u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t think we should commit this patch. This issue should allow you to reuse a FixedBitSet. A separate issue should benchmark the move to a more general API. I want to be sure that whatever abstractions that we add do not hurt faceted search, or at least note by how much and why they are worth it. For instance, if we move to a DocIdSet API where none of the Lucene sets improves faceted search over FixedBitSet, I don\'t think we should do it...\u003c\\/p\u003e\\n\\n\u003cp\u003eSo John, please revert back to the simple patch w\\/ the protected method on FacetsCollector (and on trunk-based code) so we can final review and commit it. And please open a separate issue to explore using a DocIdSet in MatchingDocs, instead of FixedBitSet. Thanks!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888445_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888445_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 04:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T04:07:43+0000\'\u003e01\\/Feb\\/14 04:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    If we need to make any change to the API, it has to be a DocIdSet and not Iterator, because the iterator takes away one layer that could be useful (such as a specialized implementation which uses instanceof FixedBitSet check, as what I think Rob suggests). \\n\\n But, John, didn\'t we say we should explore the move to a DocIdSet-based API in a separate issue where we also benchmark the implications of using all of those abstractions (both at collection and aggregation phases)? This issue was supposed to be about letting you cache the FBS instance. \\n\\n I don\'t think we should commit this patch. This issue should allow you to reuse a FixedBitSet. A separate issue should benchmark the move to a more general API. I want to be sure that whatever abstractions that we add do not hurt faceted search, or at least note by how much and why they are worth it. For instance, if we move to a DocIdSet API where none of the Lucene sets improves faceted search over FixedBitSet, I don\'t think we should do it... \\n\\n So John, please revert back to the simple patch w\\/ the protected method on FacetsCollector (and on trunk-based code) so we can final review and commit it. And please open a separate issue to explore using a DocIdSet in MatchingDocs, instead of FixedBitSet. Thanks!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888452\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888452&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888452\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888452_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888452_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 04:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T04:34:43+0000\'\u003e01\\/Feb\\/14 04:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eJust to make sure I don\'t come across wrong - when Mike and I started the facets package overhauling a year ago, the package was full of general and abstract APIs. Really, you could do both what this issue wants to achieve and even \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-5428\\\" title=\\\"Make Faceting counting array overridable\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-5428\\\"\u003eLUCENE-5428\u003c\\/a\u003e (IIRC). After Mike wrote a completely bypassing code-path for faceted search and noted some 250% improvements, we decided to eliminate \u003cb\u003eall\u003c\\/b\u003e abstractions from the API, and re-introduce them gradually. Eventually we settled on x4 speedups.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo I just want to make sure (both here and on \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-5428\\\" title=\\\"Make Faceting counting array overridable\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-5428\\\"\u003eLUCENE-5428\u003c\\/a\u003e) that the abstractions that we add don\'t impact faceted search badly, and if they do and we still want to introduce them, at least show that there\'s some code path where you actually improve things.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo please don\'t take my comments as objections, but just being cautious and this time prefer that whatever abstraction that we add, is measured from all sides.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888452_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888452_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 04:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T04:34:43+0000\'\u003e01\\/Feb\\/14 04:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Just to make sure I don\'t come across wrong - when Mike and I started the facets package overhauling a year ago, the package was full of general and abstract APIs. Really, you could do both what this issue wants to achieve and even  LUCENE-5428  (IIRC). After Mike wrote a completely bypassing code-path for faceted search and noted some 250% improvements, we decided to eliminate  all  abstractions from the API, and re-introduce them gradually. Eventually we settled on x4 speedups. \\n\\n So I just want to make sure (both here and on  LUCENE-5428 ) that the abstractions that we add don\'t impact faceted search badly, and if they do and we still want to introduce them, at least show that there\'s some code path where you actually improve things. \\n\\n So please don\'t take my comments as objections, but just being cautious and this time prefer that whatever abstraction that we add, is measured from all sides.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888463\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888463&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888463\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13888463_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888463_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 05:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T05:29:22+0000\'\u003e01\\/Feb\\/14 05:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m not exactly sure how to run the facets benchmarks. I did a run on ant run-task -Dtask.alg=conf\\/facets.alg, and changed \\\"SearchSameRdr\\\" Search &gt; : 40 to 40000, to get stable results.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m not sure how to read the results also..., but the numbers looks quite similar between trunk and the docidset on my box.\u003c\\/p\u003e\\n\\n\u003cp\u003etrunk:\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report sum by Prefix (Search) and Round (4 about 4 out of 42)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation           round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_40000     0   true        1        40000     7,155.64        5.59    31,610,096     51,212,288\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_40000 -   1  false -  -   1 -  -   40000 -   8,814.46 -  -   4.54 -  33,534,008 -   49,209,344\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_40000     2   true        1        40000     9,088.84        4.40    35,673,136     48,373,760\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_40000 -   3  false -  -   1 -  -   40000 -   9,045.68 -  -   4.42 -  35,279,544 -   47,661,056\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report sum by Prefix (Populate) and Round (4 about 4 out of 42)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation   round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate        0   true        1        21578     2,489.96        8.67    31,369,696     51,212,288\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate -  -   1  false -  -   1 -  -   21578 -   3,973.85 -  -   5.43 -  33,272,104 -   49,209,344\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate        2   true        1        21578     4,216.92        5.12    32,701,392     48,373,760\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate -  -   3  false -  -   1 -  -   21578 -   4,366.25 -  -   4.94 -  35,064,408 -   47,661,056\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report sum by Prefix (MAddDocs) and Round (4 about 4 out of 42)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation        round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_Exhaust     0   true        1        21578     3,469.13        6.22    24,536,720     51,212,288\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_Exhaust -   1  false -  -   1 -  -   21578 -   4,845.72 -  -   4.45 -  34,857,920 -   49,209,344\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_Exhaust     2   true        1        21578     5,129.07        4.21    29,209,256     48,373,760\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_Exhaust -   3  false -  -   1 -  -   21578 -   5,259.08 -  -   4.10 -  25,845,424 -   47,661,056\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eWith the patch, but I changed the OpenBitSet to FixedBitSet, and use bits.iterator() to return iterator (It\'s still an OpenBitSetIterator), the result:\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report sum by Prefix (Search) and Round (4 about 4 out of 42)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation           round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_40000     0   true        1        40000     7,280.67        5.49    25,424,104     51,113,984\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_40000 -   1  false -  -   1 -  -   40000 -   8,689.98 -  -   4.60 -  31,356,960 -   49,053,696\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_40000     2   true        1        40000     9,157.51        4.37    38,849,248     47,632,384\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e SearchSameRdr_40000 -   3  false -  -   1 -  -   40000 -   9,097.11 -  -   4.40 -  39,840,912 -   46,465,024\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report sum by Prefix (Populate) and Round (4 about 4 out of 42)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation   round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate        0   true        1        21578     2,465.21        8.75    25,187,152     51,113,984\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate -  -   1  false -  -   1 -  -   21578 -   2,651.19 -  -   8.14 -  30,985,904 -   49,053,696\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate        2   true        1        21578     4,247.64        5.08    38,656,320     47,632,384\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Populate -  -   3  false -  -   1 -  -   21578 -   4,298.41 -  -   5.02 -  39,355,912 -   46,465,024\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e ------------&gt; Report sum by Prefix (MAddDocs) and Round (4 about 4 out of 42)\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e Operation        round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_Exhaust     0   true        1        21578     3,404.01        6.34    34,015,968     51,113,984\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_Exhaust -   1  false -  -   1 -  -   21578 -   3,062.88 -  -   7.05 -  30,420,848 -   49,053,696\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_Exhaust     2   true        1        21578     5,147.42        4.19    28,833,976     47,632,384\u003cbr\\/\u003e\\n     \u003cspan class=\\\"error\\\"\u003e&#91;java&#93;\u003c\\/span\u003e MAddDocs_Exhaust -   3  false -  -   1 -  -   21578 -   5,129.07 -  -   4.21 -  37,117,288 -   46,465,024\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13888463_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888463_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 05:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T05:29:22+0000\'\u003e01\\/Feb\\/14 05:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m not exactly sure how to run the facets benchmarks. I did a run on ant run-task -Dtask.alg=conf\\/facets.alg, and changed \\\"SearchSameRdr\\\" Search &gt; : 40 to 40000, to get stable results. \\n\\n I\'m not sure how to read the results also..., but the numbers looks quite similar between trunk and the docidset on my box. \\n\\n trunk: \\n      &#91;java&#93;  ------------&gt; Report sum by Prefix (Search) and Round (4 about 4 out of 42) \\n      &#91;java&#93;  Operation           round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  SearchSameRdr_40000     0   true        1        40000     7,155.64        5.59    31,610,096     51,212,288 \\n      &#91;java&#93;  SearchSameRdr_40000 -   1  false -  -   1 -  -   40000 -   8,814.46 -  -   4.54 -  33,534,008 -   49,209,344 \\n      &#91;java&#93;  SearchSameRdr_40000     2   true        1        40000     9,088.84        4.40    35,673,136     48,373,760 \\n      &#91;java&#93;  SearchSameRdr_40000 -   3  false -  -   1 -  -   40000 -   9,045.68 -  -   4.42 -  35,279,544 -   47,661,056 \\n      &#91;java&#93;   \\n      &#91;java&#93;   \\n      &#91;java&#93;  ------------&gt; Report sum by Prefix (Populate) and Round (4 about 4 out of 42) \\n      &#91;java&#93;  Operation   round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  Populate        0   true        1        21578     2,489.96        8.67    31,369,696     51,212,288 \\n      &#91;java&#93;  Populate -  -   1  false -  -   1 -  -   21578 -   3,973.85 -  -   5.43 -  33,272,104 -   49,209,344 \\n      &#91;java&#93;  Populate        2   true        1        21578     4,216.92        5.12    32,701,392     48,373,760 \\n      &#91;java&#93;  Populate -  -   3  false -  -   1 -  -   21578 -   4,366.25 -  -   4.94 -  35,064,408 -   47,661,056 \\n      &#91;java&#93;   \\n      &#91;java&#93;   \\n      &#91;java&#93;  ------------&gt; Report sum by Prefix (MAddDocs) and Round (4 about 4 out of 42) \\n      &#91;java&#93;  Operation        round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  MAddDocs_Exhaust     0   true        1        21578     3,469.13        6.22    24,536,720     51,212,288 \\n      &#91;java&#93;  MAddDocs_Exhaust -   1  false -  -   1 -  -   21578 -   4,845.72 -  -   4.45 -  34,857,920 -   49,209,344 \\n      &#91;java&#93;  MAddDocs_Exhaust     2   true        1        21578     5,129.07        4.21    29,209,256     48,373,760 \\n      &#91;java&#93;  MAddDocs_Exhaust -   3  false -  -   1 -  -   21578 -   5,259.08 -  -   4.10 -  25,845,424 -   47,661,056 \\n\\n\\n With the patch, but I changed the OpenBitSet to FixedBitSet, and use bits.iterator() to return iterator (It\'s still an OpenBitSetIterator), the result: \\n      &#91;java&#93;  ------------&gt; Report sum by Prefix (Search) and Round (4 about 4 out of 42) \\n      &#91;java&#93;  Operation           round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  SearchSameRdr_40000     0   true        1        40000     7,280.67        5.49    25,424,104     51,113,984 \\n      &#91;java&#93;  SearchSameRdr_40000 -   1  false -  -   1 -  -   40000 -   8,689.98 -  -   4.60 -  31,356,960 -   49,053,696 \\n      &#91;java&#93;  SearchSameRdr_40000     2   true        1        40000     9,157.51        4.37    38,849,248     47,632,384 \\n      &#91;java&#93;  SearchSameRdr_40000 -   3  false -  -   1 -  -   40000 -   9,097.11 -  -   4.40 -  39,840,912 -   46,465,024 \\n      &#91;java&#93;   \\n      &#91;java&#93;   \\n      &#91;java&#93;  ------------&gt; Report sum by Prefix (Populate) and Round (4 about 4 out of 42) \\n      &#91;java&#93;  Operation   round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  Populate        0   true        1        21578     2,465.21        8.75    25,187,152     51,113,984 \\n      &#91;java&#93;  Populate -  -   1  false -  -   1 -  -   21578 -   2,651.19 -  -   8.14 -  30,985,904 -   49,053,696 \\n      &#91;java&#93;  Populate        2   true        1        21578     4,247.64        5.08    38,656,320     47,632,384 \\n      &#91;java&#93;  Populate -  -   3  false -  -   1 -  -   21578 -   4,298.41 -  -   5.02 -  39,355,912 -   46,465,024 \\n      &#91;java&#93;   \\n      &#91;java&#93;   \\n      &#91;java&#93;  ------------&gt; Report sum by Prefix (MAddDocs) and Round (4 about 4 out of 42) \\n      &#91;java&#93;  Operation        round facets   runCnt   recsPerRun        rec\\/s  elapsedSec    avgUsedMem    avgTotalMem \\n      &#91;java&#93;  MAddDocs_Exhaust     0   true        1        21578     3,404.01        6.34    34,015,968     51,113,984 \\n      &#91;java&#93;  MAddDocs_Exhaust -   1  false -  -   1 -  -   21578 -   3,062.88 -  -   7.05 -  30,420,848 -   49,053,696 \\n      &#91;java&#93;  MAddDocs_Exhaust     2   true        1        21578     5,147.42        4.19    28,833,976     47,632,384 \\n      &#91;java&#93;  MAddDocs_Exhaust -   3  false -  -   1 -  -   21578 -   5,129.07 -  -   4.21 -  37,117,288 -   46,465,024              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888464\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888464&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888464\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13888464_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888464_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 05:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T05:32:09+0000\'\u003e01\\/Feb\\/14 05:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnd, the idea of keep the DocIdSet a raw DocIdSet is quite good. For the collecting part, we can have a wrapper, which can return a DocIdSet after the collecting is done.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13888464_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888464_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 05:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T05:32:09+0000\'\u003e01\\/Feb\\/14 05:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    And, the idea of keep the DocIdSet a raw DocIdSet is quite good. For the collecting part, we can have a wrapper, which can return a DocIdSet after the collecting is done.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888673\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888673&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888673\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888673_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888673_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 18:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T18:59:14+0000\'\u003e01\\/Feb\\/14 18:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Lei!\u003c\\/p\u003e\\n\\n\u003cp\u003eShai, given that using OBS Iterator performance is the same as trunk, do you think we should move forward and change to the DocIdSet api or do you still think we should split up as 2 different issues.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks and please advise.\u003c\\/p\u003e\\n\\n\u003cp\u003e-John\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888673_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888673_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 18:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T18:59:14+0000\'\u003e01\\/Feb\\/14 18:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Lei! \\n\\n Shai, given that using OBS Iterator performance is the same as trunk, do you think we should move forward and change to the DocIdSet api or do you still think we should split up as 2 different issues. \\n\\n Thanks and please advise. \\n\\n -John              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888674\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888674&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888674\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888674_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888674_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:00:26+0000\'\u003e01\\/Feb\\/14 19:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe benchmarks that we ran were with luceneutil: \u003ca href=\\\"http:\\/\\/code.google.com\\/a\\/apache-extras.org\\/p\\/luceneutil\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/code.google.com\\/a\\/apache-extras.org\\/p\\/luceneutil\\/\u003c\\/a\u003e. Actually, Mike did all the running on his beast machine, so perhaps he can share the command to execute in order to run the benchmarks. The results that you get are more clear. Separately, would be good if we had a single benchmarking package, whether it\'s luceneutil or lucene\\/benchmark...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888674_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888674_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:00:26+0000\'\u003e01\\/Feb\\/14 19:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The benchmarks that we ran were with luceneutil:  http:\\/\\/code.google.com\\/a\\/apache-extras.org\\/p\\/luceneutil\\/ . Actually, Mike did all the running on his beast machine, so perhaps he can share the command to execute in order to run the benchmarks. The results that you get are more clear. Separately, would be good if we had a single benchmarking package, whether it\'s luceneutil or lucene\\/benchmark...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888676\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888676&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888676\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888676_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888676_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:04:25+0000\'\u003e01\\/Feb\\/14 19:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Shai Erera - 01\\/Feb\\/14 19:07\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eShai, given that using OBS Iterator performance is the same as trunk, do you think we should move forward and change to the DocIdSet api or do you still think we should split up as 2 different issues.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eHonestly, I don\'t think the lucene\\/benchmark package is as good as luceneutil, especially not when it comes to queries. luceneutil tries different queries, combining low\\/high freq terms, span queries and what not, and so the results that we get there are more stable and reflect the benefits\\/drawback of the change across a wider spectrum. Lei, I apologize for not mentioning that before, if it wasted your time. It seemed obvious to me \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut the cut to DocIdSet is bigger than just allowing to reuse FixedBitSet, so why not split the issue to two separate ones anyway? Like, if it turns out that DocIdSet as an abstraction is not bad, but the iterator is, we can always do an instanceof check and execute the more optimized code. So let\'s just explore all that in a separate issue? Or, if you prefer to do it all in one issue, then we should get luceneutil\'s blessing here \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888676_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888676_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:04:25+0000\'\u003e01\\/Feb\\/14 19:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Shai Erera - 01\\/Feb\\/14 19:07\\\"\u003eedited\u003c\\/span\u003e                    Shai, given that using OBS Iterator performance is the same as trunk, do you think we should move forward and change to the DocIdSet api or do you still think we should split up as 2 different issues.  \\n\\n Honestly, I don\'t think the lucene\\/benchmark package is as good as luceneutil, especially not when it comes to queries. luceneutil tries different queries, combining low\\/high freq terms, span queries and what not, and so the results that we get there are more stable and reflect the benefits\\/drawback of the change across a wider spectrum. Lei, I apologize for not mentioning that before, if it wasted your time. It seemed obvious to me  . \\n\\n But the cut to DocIdSet is bigger than just allowing to reuse FixedBitSet, so why not split the issue to two separate ones anyway? Like, if it turns out that DocIdSet as an abstraction is not bad, but the iterator is, we can always do an instanceof check and execute the more optimized code. So let\'s just explore all that in a separate issue? Or, if you prefer to do it all in one issue, then we should get luceneutil\'s blessing here  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888678\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888678&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888678\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888678_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888678_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:11:13+0000\'\u003e01\\/Feb\\/14 19:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOk. I will revert to the previous patch applied to trunk and we can create a separate issue to track cutting over to DocIdSet and reference this ticket.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888678_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888678_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:11:13+0000\'\u003e01\\/Feb\\/14 19:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Ok. I will revert to the previous patch applied to trunk and we can create a separate issue to track cutting over to DocIdSet and reference this ticket.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888679\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888679&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888679\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888679_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888679_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:14:10+0000\'\u003e01\\/Feb\\/14 19:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eReverted patch attached.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13888679_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888679_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:14:10+0000\'\u003e01\\/Feb\\/14 19:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Reverted patch attached.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13888680\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13888680&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13888680\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888680_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888680_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:16:53+0000\'\u003e01\\/Feb\\/14 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLooks good. BTW \\\"newHitSet\\\" &#8211; is that intentional or a typo (i.e. should have been newBitSet)? I like newHitSet \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13888680_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13888680_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/14 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-01T19:16:53+0000\'\u003e01\\/Feb\\/14 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Looks good. BTW \\\"newHitSet\\\" &#8211; is that intentional or a typo (i.e. should have been newBitSet)? I like newHitSet  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13889604\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13889604&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13889604\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13889604_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13889604_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Feb\\/14 16:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-03T16:35:57+0000\'\u003e03\\/Feb\\/14 16:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI named it to newHitSet in case we do decide to move to an abstract doc set, we wouldn\'t need to (and forget to) change the method name.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13889604_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13889604_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Feb\\/14 16:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-03T16:35:57+0000\'\u003e03\\/Feb\\/14 16:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I named it to newHitSet in case we do decide to move to an abstract doc set, we wouldn\'t need to (and forget to) change the method name.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13890040\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13890040&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13890040\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13890040_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890040_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Feb\\/14 22:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-03T22:44:09+0000\'\u003e03\\/Feb\\/14 22:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003etried with the lucenutil, but got some problem. I cannot get same numbers for two identical code of trunk. even if they are all trunks, i get different numbers:\u003cbr\\/\u003e\\nReport after iter 19:\u003cbr\\/\u003e\\n                    TaskQPS baseline      StdDevQPS my_modified_version      StdDev                Pct diff\u003cbr\\/\u003e\\n               OrHighMed       74.15      (7.1%)       71.24      (8.3%)   -3.9% ( -18% -   12%)\u003cbr\\/\u003e\\n                 LowTerm      515.68     (15.1%)      496.20     (12.3%)   -3.8% ( -27% -   27%)\u003cbr\\/\u003e\\n            OrNotHighLow       72.22      (8.2%)       70.36      (7.6%)   -2.6% ( -17% -   14%)\u003cbr\\/\u003e\\n            OrNotHighMed       79.01      (7.3%)       77.43      (8.4%)   -2.0% ( -16% -   14%)\u003cbr\\/\u003e\\n           OrHighNotHigh       38.66      (4.5%)       37.90      (6.4%)   -2.0% ( -12% -    9%)\u003cbr\\/\u003e\\n                 Respell       51.21      (7.1%)       50.23      (6.5%)   -1.9% ( -14% -   12%)\u003cbr\\/\u003e\\n               MedPhrase       69.67      (7.5%)       68.35      (7.4%)   -1.9% ( -15% -   14%)\u003cbr\\/\u003e\\n               OrHighLow       67.24      (7.8%)       66.00      (9.0%)   -1.8% ( -17% -   16%)\u003cbr\\/\u003e\\n                  Fuzzy1       27.37      (5.7%)       26.96      (5.5%)   -1.5% ( -11% -   10%)\u003cbr\\/\u003e\\n                  Fuzzy2       37.21      (3.8%)       36.71      (5.6%)   -1.3% ( -10% -    8%)\u003cbr\\/\u003e\\n         MedSloppyPhrase        9.94      (5.4%)        9.83      (3.9%)   -1.1% (  -9% -    8%)\u003cbr\\/\u003e\\n             LowSpanNear        8.60      (3.9%)        8.54      (3.8%)   -0.7% (  -8% -    7%)\u003cbr\\/\u003e\\n             AndHighHigh       40.23      (3.1%)       40.03      (2.5%)   -0.5% (  -5% -    5%)\u003cbr\\/\u003e\\n                HighTerm       76.07      (9.0%)       75.96      (9.1%)   -0.2% ( -16% -   19%)\u003cbr\\/\u003e\\n              OrHighHigh       11.62      (3.0%)       11.62      (4.8%)   -0.1% (  -7% -    7%)\u003cbr\\/\u003e\\n                  IntNRQ        9.51      (3.9%)        9.51      (8.3%)    0.0% ( -11% -   12%)\u003cbr\\/\u003e\\n              HighPhrase       25.61      (7.0%)       25.63      (7.7%)    0.1% ( -13% -   15%)\u003cbr\\/\u003e\\n         LowSloppyPhrase       30.21      (5.2%)       30.24      (4.3%)    0.1% (  -8% -   10%)\u003cbr\\/\u003e\\n                PKLookup      212.03      (9.0%)      212.25     (11.5%)    0.1% ( -18% -   22%)\u003cbr\\/\u003e\\n           OrNotHighHigh       27.75      (3.5%)       27.80      (6.5%)    0.2% (  -9% -   10%)\u003cbr\\/\u003e\\n            OrHighNotMed       58.14      (5.9%)       58.27      (8.3%)    0.2% ( -13% -   15%)\u003cbr\\/\u003e\\n             MedSpanNear       22.73      (3.7%)       22.80      (5.1%)    0.3% (  -8% -    9%)\u003cbr\\/\u003e\\n                Wildcard       42.84      (5.0%)       42.97      (5.4%)    0.3% (  -9% -   11%)\u003cbr\\/\u003e\\n        HighSloppyPhrase       23.99      (7.4%)       24.08      (6.3%)    0.4% ( -12% -   15%)\u003cbr\\/\u003e\\n              AndHighLow      625.62      (6.6%)      629.52     (10.5%)    0.6% ( -15% -   18%)\u003cbr\\/\u003e\\n                 Prefix3       77.68      (7.2%)       78.17      (6.2%)    0.6% ( -11% -   15%)\u003cbr\\/\u003e\\n               LowPhrase       14.58      (4.7%)       14.77      (5.0%)    1.3% (  -8% -   11%)\u003cbr\\/\u003e\\n            HighSpanNear       11.84      (4.3%)       11.99      (5.2%)    1.3% (  -7% -   11%)\u003cbr\\/\u003e\\n            OrHighNotLow       66.04      (8.4%)       67.28      (9.2%)    1.9% ( -14% -   21%)\u003cbr\\/\u003e\\n              AndHighMed       66.55      (4.3%)       67.91      (6.2%)    2.1% (  -8% -   13%)\u003cbr\\/\u003e\\n                 MedTerm      139.78      (9.5%)      145.63     (10.3%)    4.2% ( -14% -   26%)\u003c\\/p\u003e\\n\\n\u003cp\u003ewith the patch, the numbers are also different, but no bigger difference than the trunk-trunk numbers:\u003cbr\\/\u003e\\nReport after iter 19:\u003cbr\\/\u003e\\n                    TaskQPS baseline      StdDevQPS my_modified_version      StdDev                Pct diff\u003cbr\\/\u003e\\n              AndHighLow      730.30     (11.5%)      700.95     (10.6%)   -4.0% ( -23% -   20%)\u003cbr\\/\u003e\\n                 LowTerm      520.94     (10.6%)      504.25     (11.4%)   -3.2% ( -22% -   21%)\u003cbr\\/\u003e\\n                  Fuzzy1       57.55      (5.1%)       56.26      (4.8%)   -2.2% ( -11% -    8%)\u003cbr\\/\u003e\\n                 Respell       35.85      (4.7%)       35.18      (4.1%)   -1.9% ( -10% -    7%)\u003cbr\\/\u003e\\n           OrHighNotHigh       37.77      (7.3%)       37.19      (5.9%)   -1.5% ( -13% -   12%)\u003cbr\\/\u003e\\n        HighSloppyPhrase       12.30      (7.5%)       12.17      (7.7%)   -1.1% ( -15% -   15%)\u003cbr\\/\u003e\\n              HighPhrase       29.38      (5.2%)       29.06      (4.3%)   -1.1% ( -10% -    8%)\u003cbr\\/\u003e\\n            OrNotHighMed       25.93      (6.2%)       25.68      (5.5%)   -1.0% ( -11% -   11%)\u003cbr\\/\u003e\\n           OrNotHighHigh       19.72      (5.9%)       19.53      (4.9%)   -0.9% ( -11% -   10%)\u003cbr\\/\u003e\\n                  Fuzzy2       11.30      (3.6%)       11.24      (5.1%)   -0.6% (  -8% -    8%)\u003cbr\\/\u003e\\n                PKLookup      218.16      (8.6%)      217.53      (9.3%)   -0.3% ( -16% -   19%)\u003cbr\\/\u003e\\n         LowSloppyPhrase       43.09      (5.6%)       43.00      (3.5%)   -0.2% (  -8% -    9%)\u003cbr\\/\u003e\\n             MedSpanNear       30.65      (4.4%)       30.60      (3.2%)   -0.1% (  -7% -    7%)\u003cbr\\/\u003e\\n         MedSloppyPhrase       21.71      (5.7%)       21.70      (3.8%)   -0.0% (  -8% -    9%)\u003cbr\\/\u003e\\n                Wildcard       14.67      (3.3%)       14.67      (2.6%)   -0.0% (  -5% -    6%)\u003cbr\\/\u003e\\n            HighSpanNear        0.64      (4.6%)        0.64      (5.0%)    0.1% (  -9% -   10%)\u003cbr\\/\u003e\\n               LowPhrase       21.05      (5.6%)       21.09      (7.6%)    0.2% ( -12% -   14%)\u003cbr\\/\u003e\\n              AndHighMed      175.53      (7.2%)      176.00      (8.2%)    0.3% ( -14% -   16%)\u003cbr\\/\u003e\\n                 Prefix3       31.24      (3.3%)       31.37      (2.7%)    0.4% (  -5% -    6%)\u003cbr\\/\u003e\\n            OrNotHighLow       76.32      (6.3%)       76.80      (7.7%)    0.6% ( -12% -   15%)\u003cbr\\/\u003e\\n              OrHighHigh       33.43      (6.4%)       33.65      (7.6%)    0.7% ( -12% -   15%)\u003cbr\\/\u003e\\n             AndHighHigh       35.51      (3.1%)       35.76      (3.1%)    0.7% (  -5% -    7%)\u003cbr\\/\u003e\\n                  IntNRQ        9.36      (4.4%)        9.43      (3.7%)    0.7% (  -7% -    9%)\u003cbr\\/\u003e\\n                HighTerm       90.42      (7.0%)       91.40      (5.3%)    1.1% ( -10% -   14%)\u003cbr\\/\u003e\\n               OrHighLow       71.32      (8.6%)       72.13      (8.2%)    1.1% ( -14% -   19%)\u003cbr\\/\u003e\\n             LowSpanNear      107.82      (6.8%)      109.19      (5.9%)    1.3% ( -10% -   14%)\u003cbr\\/\u003e\\n               OrHighMed       45.43      (8.8%)       46.09      (8.8%)    1.5% ( -14% -   20%)\u003cbr\\/\u003e\\n                 MedTerm      139.24      (7.0%)      141.28      (8.4%)    1.5% ( -13% -   18%)\u003cbr\\/\u003e\\n               MedPhrase       96.51      (5.0%)       98.10      (6.8%)    1.6% (  -9% -   14%)\u003cbr\\/\u003e\\n            OrHighNotMed       50.88      (6.9%)       52.13      (8.3%)    2.5% ( -11% -   18%)\u003cbr\\/\u003e\\n            OrHighNotLow       65.31      (8.9%)       67.16      (8.8%)    2.8% ( -13% -   22%)\u003c\\/p\u003e\\n\\n\u003cp\u003eBtw, I copied the facet config from the nightly py, and the index looks like:\u003cbr\\/\u003e\\nindex = comp.newIndex(\'trunk\', WIKI_MEDIUM_10M, facets = ((\'Date\',),), facetDVFormat=\'Direct\')\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13890040_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890040_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Feb\\/14 22:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-03T22:44:09+0000\'\u003e03\\/Feb\\/14 22:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    tried with the lucenutil, but got some problem. I cannot get same numbers for two identical code of trunk. even if they are all trunks, i get different numbers: \\nReport after iter 19: \\n                    TaskQPS baseline      StdDevQPS my_modified_version      StdDev                Pct diff \\n               OrHighMed       74.15      (7.1%)       71.24      (8.3%)   -3.9% ( -18% -   12%) \\n                 LowTerm      515.68     (15.1%)      496.20     (12.3%)   -3.8% ( -27% -   27%) \\n            OrNotHighLow       72.22      (8.2%)       70.36      (7.6%)   -2.6% ( -17% -   14%) \\n            OrNotHighMed       79.01      (7.3%)       77.43      (8.4%)   -2.0% ( -16% -   14%) \\n           OrHighNotHigh       38.66      (4.5%)       37.90      (6.4%)   -2.0% ( -12% -    9%) \\n                 Respell       51.21      (7.1%)       50.23      (6.5%)   -1.9% ( -14% -   12%) \\n               MedPhrase       69.67      (7.5%)       68.35      (7.4%)   -1.9% ( -15% -   14%) \\n               OrHighLow       67.24      (7.8%)       66.00      (9.0%)   -1.8% ( -17% -   16%) \\n                  Fuzzy1       27.37      (5.7%)       26.96      (5.5%)   -1.5% ( -11% -   10%) \\n                  Fuzzy2       37.21      (3.8%)       36.71      (5.6%)   -1.3% ( -10% -    8%) \\n         MedSloppyPhrase        9.94      (5.4%)        9.83      (3.9%)   -1.1% (  -9% -    8%) \\n             LowSpanNear        8.60      (3.9%)        8.54      (3.8%)   -0.7% (  -8% -    7%) \\n             AndHighHigh       40.23      (3.1%)       40.03      (2.5%)   -0.5% (  -5% -    5%) \\n                HighTerm       76.07      (9.0%)       75.96      (9.1%)   -0.2% ( -16% -   19%) \\n              OrHighHigh       11.62      (3.0%)       11.62      (4.8%)   -0.1% (  -7% -    7%) \\n                  IntNRQ        9.51      (3.9%)        9.51      (8.3%)    0.0% ( -11% -   12%) \\n              HighPhrase       25.61      (7.0%)       25.63      (7.7%)    0.1% ( -13% -   15%) \\n         LowSloppyPhrase       30.21      (5.2%)       30.24      (4.3%)    0.1% (  -8% -   10%) \\n                PKLookup      212.03      (9.0%)      212.25     (11.5%)    0.1% ( -18% -   22%) \\n           OrNotHighHigh       27.75      (3.5%)       27.80      (6.5%)    0.2% (  -9% -   10%) \\n            OrHighNotMed       58.14      (5.9%)       58.27      (8.3%)    0.2% ( -13% -   15%) \\n             MedSpanNear       22.73      (3.7%)       22.80      (5.1%)    0.3% (  -8% -    9%) \\n                Wildcard       42.84      (5.0%)       42.97      (5.4%)    0.3% (  -9% -   11%) \\n        HighSloppyPhrase       23.99      (7.4%)       24.08      (6.3%)    0.4% ( -12% -   15%) \\n              AndHighLow      625.62      (6.6%)      629.52     (10.5%)    0.6% ( -15% -   18%) \\n                 Prefix3       77.68      (7.2%)       78.17      (6.2%)    0.6% ( -11% -   15%) \\n               LowPhrase       14.58      (4.7%)       14.77      (5.0%)    1.3% (  -8% -   11%) \\n            HighSpanNear       11.84      (4.3%)       11.99      (5.2%)    1.3% (  -7% -   11%) \\n            OrHighNotLow       66.04      (8.4%)       67.28      (9.2%)    1.9% ( -14% -   21%) \\n              AndHighMed       66.55      (4.3%)       67.91      (6.2%)    2.1% (  -8% -   13%) \\n                 MedTerm      139.78      (9.5%)      145.63     (10.3%)    4.2% ( -14% -   26%) \\n\\n with the patch, the numbers are also different, but no bigger difference than the trunk-trunk numbers: \\nReport after iter 19: \\n                    TaskQPS baseline      StdDevQPS my_modified_version      StdDev                Pct diff \\n              AndHighLow      730.30     (11.5%)      700.95     (10.6%)   -4.0% ( -23% -   20%) \\n                 LowTerm      520.94     (10.6%)      504.25     (11.4%)   -3.2% ( -22% -   21%) \\n                  Fuzzy1       57.55      (5.1%)       56.26      (4.8%)   -2.2% ( -11% -    8%) \\n                 Respell       35.85      (4.7%)       35.18      (4.1%)   -1.9% ( -10% -    7%) \\n           OrHighNotHigh       37.77      (7.3%)       37.19      (5.9%)   -1.5% ( -13% -   12%) \\n        HighSloppyPhrase       12.30      (7.5%)       12.17      (7.7%)   -1.1% ( -15% -   15%) \\n              HighPhrase       29.38      (5.2%)       29.06      (4.3%)   -1.1% ( -10% -    8%) \\n            OrNotHighMed       25.93      (6.2%)       25.68      (5.5%)   -1.0% ( -11% -   11%) \\n           OrNotHighHigh       19.72      (5.9%)       19.53      (4.9%)   -0.9% ( -11% -   10%) \\n                  Fuzzy2       11.30      (3.6%)       11.24      (5.1%)   -0.6% (  -8% -    8%) \\n                PKLookup      218.16      (8.6%)      217.53      (9.3%)   -0.3% ( -16% -   19%) \\n         LowSloppyPhrase       43.09      (5.6%)       43.00      (3.5%)   -0.2% (  -8% -    9%) \\n             MedSpanNear       30.65      (4.4%)       30.60      (3.2%)   -0.1% (  -7% -    7%) \\n         MedSloppyPhrase       21.71      (5.7%)       21.70      (3.8%)   -0.0% (  -8% -    9%) \\n                Wildcard       14.67      (3.3%)       14.67      (2.6%)   -0.0% (  -5% -    6%) \\n            HighSpanNear        0.64      (4.6%)        0.64      (5.0%)    0.1% (  -9% -   10%) \\n               LowPhrase       21.05      (5.6%)       21.09      (7.6%)    0.2% ( -12% -   14%) \\n              AndHighMed      175.53      (7.2%)      176.00      (8.2%)    0.3% ( -14% -   16%) \\n                 Prefix3       31.24      (3.3%)       31.37      (2.7%)    0.4% (  -5% -    6%) \\n            OrNotHighLow       76.32      (6.3%)       76.80      (7.7%)    0.6% ( -12% -   15%) \\n              OrHighHigh       33.43      (6.4%)       33.65      (7.6%)    0.7% ( -12% -   15%) \\n             AndHighHigh       35.51      (3.1%)       35.76      (3.1%)    0.7% (  -5% -    7%) \\n                  IntNRQ        9.36      (4.4%)        9.43      (3.7%)    0.7% (  -7% -    9%) \\n                HighTerm       90.42      (7.0%)       91.40      (5.3%)    1.1% ( -10% -   14%) \\n               OrHighLow       71.32      (8.6%)       72.13      (8.2%)    1.1% ( -14% -   19%) \\n             LowSpanNear      107.82      (6.8%)      109.19      (5.9%)    1.3% ( -10% -   14%) \\n               OrHighMed       45.43      (8.8%)       46.09      (8.8%)    1.5% ( -14% -   20%) \\n                 MedTerm      139.24      (7.0%)      141.28      (8.4%)    1.5% ( -13% -   18%) \\n               MedPhrase       96.51      (5.0%)       98.10      (6.8%)    1.6% (  -9% -   14%) \\n            OrHighNotMed       50.88      (6.9%)       52.13      (8.3%)    2.5% ( -11% -   18%) \\n            OrHighNotLow       65.31      (8.9%)       67.16      (8.8%)    2.8% ( -13% -   22%) \\n\\n Btw, I copied the facet config from the nightly py, and the index looks like: \\nindex = comp.newIndex(\'trunk\', WIKI_MEDIUM_10M, facets = ((\'Date\',),), facetDVFormat=\'Direct\') \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13890581\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13890581&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13890581\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13890581_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890581_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 11:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T11:20:54+0000\'\u003e04\\/Feb\\/14 11:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Lei,\u003c\\/p\u003e\\n\\n\u003cp\u003eThat\'s great that you managed to get luceneutil up and running ... it\'s not easy.\u003c\\/p\u003e\\n\\n\u003cp\u003eAre you passing a randomSeed=N to your Competition?  When you do that, it means the exact same queries are tested each time you run the perf test; if not, it randomly picks a query from the category, and e.g. a category like HighTerm actually has a wide range of queries in it ... so maybe this explains the absolute QPS diffs you see between runs?\u003c\\/p\u003e\\n\\n\u003cp\u003eSeparately, it\'s good to open the results files (e.g. \\/path\\/to\\/lucene\\/benchmark\\/comp.base.N) to confirm you actually see Date facet counts inside there.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll also test the 2nd to last patch w\\/ Date faceting.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13890581_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890581_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 11:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T11:20:54+0000\'\u003e04\\/Feb\\/14 11:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Lei, \\n\\n That\'s great that you managed to get luceneutil up and running ... it\'s not easy. \\n\\n Are you passing a randomSeed=N to your Competition?  When you do that, it means the exact same queries are tested each time you run the perf test; if not, it randomly picks a query from the category, and e.g. a category like HighTerm actually has a wide range of queries in it ... so maybe this explains the absolute QPS diffs you see between runs? \\n\\n Separately, it\'s good to open the results files (e.g. \\/path\\/to\\/lucene\\/benchmark\\/comp.base.N) to confirm you actually see Date facet counts inside there. \\n\\n I\'ll also test the 2nd to last patch w\\/ Date faceting.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13890878\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13890878&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13890878\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13890878_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890878_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 17:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T17:26:10+0000\'\u003e04\\/Feb\\/14 17:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAlso, one tip when posting the results: wrap them inside a {noformat} ... {noformat}, which preserves the monospace formatting.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13890878_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890878_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 17:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T17:26:10+0000\'\u003e04\\/Feb\\/14 17:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Also, one tip when posting the results: wrap them inside a {noformat} ... {noformat}, which preserves the monospace formatting.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13890880\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13890880&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13890880\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13890880_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890880_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 17:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T17:29:42+0000\'\u003e04\\/Feb\\/14 17:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI compared trunk to the 2nd patch here, on wikimediumall (33.3 M docs), Date faceting, using DirectDVFormat for facets:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e                    Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                HighTerm       21.28      (2.8%)       18.96      (1.2%)  -10.9% ( -14% -   -7%)\\n                 LowTerm       83.98      (3.6%)       75.31      (1.3%)  -10.3% ( -14% -   -5%)\\n                 MedTerm       30.96      (2.6%)       27.86      (1.2%)  -10.0% ( -13% -   -6%)\\n            OrHighNotLow       12.47      (3.8%)       11.23      (3.6%)  -10.0% ( -16% -   -2%)\\n               OrHighMed       13.39      (3.6%)       12.07      (3.4%)   -9.9% ( -16% -   -2%)\\n               OrHighLow        9.94      (4.0%)        8.97      (3.7%)   -9.8% ( -16% -   -2%)\\n            OrHighNotMed       15.52      (3.4%)       14.13      (3.3%)   -8.9% ( -15% -   -2%)\\n           OrHighNotHigh        7.16      (4.4%)        6.58      (3.8%)   -8.1% ( -15% -    0%)\\n              OrHighHigh        4.81      (4.3%)        4.42      (3.9%)   -8.1% ( -15% -    0%)\\n           OrNotHighHigh        5.83      (4.7%)        5.49      (4.3%)   -5.9% ( -14% -    3%)\\n              AndHighLow      292.07      (1.5%)      274.97      (2.2%)   -5.9% (  -9% -   -2%)\\n               MedPhrase      143.35      (4.7%)      135.01      (4.5%)   -5.8% ( -14% -    3%)\\n            HighSpanNear        6.52      (4.8%)        6.23      (4.2%)   -4.5% ( -12% -    4%)\\n              HighPhrase        3.57      (5.9%)        3.42      (5.8%)   -4.4% ( -15% -    7%)\\n             MedSpanNear       26.30      (3.1%)       25.55      (2.7%)   -2.8% (  -8% -    3%)\\n              AndHighMed       29.54      (1.6%)       28.81      (1.5%)   -2.5% (  -5% -    0%)\\n             AndHighHigh       23.98      (1.5%)       23.41      (1.4%)   -2.4% (  -5% -    0%)\\n            OrNotHighMed       18.00      (5.6%)       17.59      (4.5%)   -2.3% ( -11% -    8%)\\n         LowSloppyPhrase       37.65      (1.9%)       36.84      (1.6%)   -2.2% (  -5% -    1%)\\n               LowPhrase       11.98      (2.0%)       11.76      (2.3%)   -1.8% (  -6% -    2%)\\n             LowSpanNear        9.57      (3.0%)        9.39      (2.5%)   -1.8% (  -7% -    3%)\\n                 Prefix3       75.35      (1.4%)       74.68      (2.3%)   -0.9% (  -4% -    2%)\\n        HighSloppyPhrase        3.13      (6.9%)        3.11      (6.3%)   -0.9% ( -13% -   13%)\\n                  IntNRQ        4.12      (2.6%)        4.08      (4.2%)   -0.8% (  -7% -    6%)\\n         MedSloppyPhrase        3.25      (3.9%)        3.22      (3.7%)   -0.7% (  -8% -    7%)\\n                Wildcard       17.39      (2.8%)       17.39      (2.9%)    0.0% (  -5% -    5%)\\n            OrNotHighLow       23.17      (6.9%)       23.35      (5.8%)    0.8% ( -11% -   14%)\\n                  Fuzzy1       63.79      (1.8%)       64.51      (1.8%)    1.1% (  -2% -    4%)\\n                  Fuzzy2       44.03      (2.1%)       44.71      (2.1%)    1.5% (  -2% -    5%)\\n                 Respell       46.73      (2.9%)       47.46      (2.8%)    1.6% (  -3% -    7%)\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eLooks like there is some penalty for the added abstraction ... but I agree w\\/ Rob: we can just have the common-case Facets impl (FastTaxonomyFacetCounts) specialize for the normal case when it\'s a FixedBitSet we are iterating over ...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13890880_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890880_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 17:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T17:29:42+0000\'\u003e04\\/Feb\\/14 17:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I compared trunk to the 2nd patch here, on wikimediumall (33.3 M docs), Date faceting, using DirectDVFormat for facets: \\n\\n  \\n                     Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n                HighTerm       21.28      (2.8%)       18.96      (1.2%)  -10.9% ( -14% -   -7%)\\n                 LowTerm       83.98      (3.6%)       75.31      (1.3%)  -10.3% ( -14% -   -5%)\\n                 MedTerm       30.96      (2.6%)       27.86      (1.2%)  -10.0% ( -13% -   -6%)\\n            OrHighNotLow       12.47      (3.8%)       11.23      (3.6%)  -10.0% ( -16% -   -2%)\\n               OrHighMed       13.39      (3.6%)       12.07      (3.4%)   -9.9% ( -16% -   -2%)\\n               OrHighLow        9.94      (4.0%)        8.97      (3.7%)   -9.8% ( -16% -   -2%)\\n            OrHighNotMed       15.52      (3.4%)       14.13      (3.3%)   -8.9% ( -15% -   -2%)\\n           OrHighNotHigh        7.16      (4.4%)        6.58      (3.8%)   -8.1% ( -15% -    0%)\\n              OrHighHigh        4.81      (4.3%)        4.42      (3.9%)   -8.1% ( -15% -    0%)\\n           OrNotHighHigh        5.83      (4.7%)        5.49      (4.3%)   -5.9% ( -14% -    3%)\\n              AndHighLow      292.07      (1.5%)      274.97      (2.2%)   -5.9% (  -9% -   -2%)\\n               MedPhrase      143.35      (4.7%)      135.01      (4.5%)   -5.8% ( -14% -    3%)\\n            HighSpanNear        6.52      (4.8%)        6.23      (4.2%)   -4.5% ( -12% -    4%)\\n              HighPhrase        3.57      (5.9%)        3.42      (5.8%)   -4.4% ( -15% -    7%)\\n             MedSpanNear       26.30      (3.1%)       25.55      (2.7%)   -2.8% (  -8% -    3%)\\n              AndHighMed       29.54      (1.6%)       28.81      (1.5%)   -2.5% (  -5% -    0%)\\n             AndHighHigh       23.98      (1.5%)       23.41      (1.4%)   -2.4% (  -5% -    0%)\\n            OrNotHighMed       18.00      (5.6%)       17.59      (4.5%)   -2.3% ( -11% -    8%)\\n         LowSloppyPhrase       37.65      (1.9%)       36.84      (1.6%)   -2.2% (  -5% -    1%)\\n               LowPhrase       11.98      (2.0%)       11.76      (2.3%)   -1.8% (  -6% -    2%)\\n             LowSpanNear        9.57      (3.0%)        9.39      (2.5%)   -1.8% (  -7% -    3%)\\n                 Prefix3       75.35      (1.4%)       74.68      (2.3%)   -0.9% (  -4% -    2%)\\n        HighSloppyPhrase        3.13      (6.9%)        3.11      (6.3%)   -0.9% ( -13% -   13%)\\n                  IntNRQ        4.12      (2.6%)        4.08      (4.2%)   -0.8% (  -7% -    6%)\\n         MedSloppyPhrase        3.25      (3.9%)        3.22      (3.7%)   -0.7% (  -8% -    7%)\\n                Wildcard       17.39      (2.8%)       17.39      (2.9%)    0.0% (  -5% -    5%)\\n            OrNotHighLow       23.17      (6.9%)       23.35      (5.8%)    0.8% ( -11% -   14%)\\n                  Fuzzy1       63.79      (1.8%)       64.51      (1.8%)    1.1% (  -2% -    4%)\\n                  Fuzzy2       44.03      (2.1%)       44.71      (2.1%)    1.5% (  -2% -    5%)\\n                 Respell       46.73      (2.9%)       47.46      (2.8%)    1.6% (  -3% -    7%)\\n \\n  \\n\\n Looks like there is some penalty for the added abstraction ... but I agree w\\/ Rob: we can just have the common-case Facets impl (FastTaxonomyFacetCounts) specialize for the normal case when it\'s a FixedBitSet we are iterating over ...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13890892\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13890892&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13890892\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13890892_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890892_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 17:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T17:38:00+0000\'\u003e04\\/Feb\\/14 17:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think we shouldn\'t rush into changing this. Would be good if we can show that there\'s another DocIdSet which actually improves performance for some cases. Otherwise, we\'re generalizing the API for no good reason. That\'s also what we saw on \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-5316\\\" title=\\\"Taxonomy tree traversing improvement\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-5316\\\"\u003eLUCENE-5316\u003c\\/a\u003e: small degradation w\\/ generalization, but actually all data structures that we tried performed worse, so why generalize in the first place?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13890892_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890892_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 17:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T17:38:00+0000\'\u003e04\\/Feb\\/14 17:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think we shouldn\'t rush into changing this. Would be good if we can show that there\'s another DocIdSet which actually improves performance for some cases. Otherwise, we\'re generalizing the API for no good reason. That\'s also what we saw on  LUCENE-5316 : small degradation w\\/ generalization, but actually all data structures that we tried performed worse, so why generalize in the first place?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13890911\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13890911&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13890911\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13890911_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890911_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 17:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T17:48:54+0000\'\u003e04\\/Feb\\/14 17:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Shai:\u003c\\/p\u003e\\n\\n\u003cp\u003e    Our motivation for generalization also comes from performance: Large index size (e.g. large maxDoc) and very high query throughput. Creating a BitSet of maxDoc bits per query is not feasible. So being able to cache in a thread local would work better (num threads is low due to async nature of our system), which is what the first patch is about.\u003c\\/p\u003e\\n\\n\u003cp\u003e    If we were to reuse the bitset, we would have to zero out the bits before reuse. We found given our doc size, zeroing out the bitset is expensive, specifically, 4x that of creating the bits in the first place.\u003c\\/p\u003e\\n\\n\u003cp\u003e   So if we can abstract this out, we can plugin more optimized implementations. We can put together a diciest impl that would perform much better than FixedBitSet.\u003c\\/p\u003e\\n\\n\u003cp\u003e    Having said this, I am happy to break this into multiple patches\\/issues.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks\u003c\\/p\u003e\\n\\n\u003cp\u003e-John\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13890911_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13890911_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 17:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T17:48:54+0000\'\u003e04\\/Feb\\/14 17:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Shai: \\n\\n     Our motivation for generalization also comes from performance: Large index size (e.g. large maxDoc) and very high query throughput. Creating a BitSet of maxDoc bits per query is not feasible. So being able to cache in a thread local would work better (num threads is low due to async nature of our system), which is what the first patch is about. \\n\\n     If we were to reuse the bitset, we would have to zero out the bits before reuse. We found given our doc size, zeroing out the bitset is expensive, specifically, 4x that of creating the bits in the first place. \\n\\n    So if we can abstract this out, we can plugin more optimized implementations. We can put together a diciest impl that would perform much better than FixedBitSet. \\n\\n     Having said this, I am happy to break this into multiple patches\\/issues. \\n\\n Thanks \\n\\n -John              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13891022\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13891022&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13891022\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13891022_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13891022_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 18:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T18:59:46+0000\'\u003e04\\/Feb\\/14 18:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI understand John. I wonder, if you can use such a specialized DocIdSet, and are worried about performance, wouldn\'t you want to save the iterator() overhead too, and iterate on the structure directly? If so, generalizing the API won\'t help you right?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13891022_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13891022_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 18:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T18:59:46+0000\'\u003e04\\/Feb\\/14 18:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I understand John. I wonder, if you can use such a specialized DocIdSet, and are worried about performance, wouldn\'t you want to save the iterator() overhead too, and iterate on the structure directly? If so, generalizing the API won\'t help you right?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13891044\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13891044&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13891044\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13891044_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13891044_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 19:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T19:13:52+0000\'\u003e04\\/Feb\\/14 19:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe overhead may not from the additional method call, might be the openbitset, the impl in the fixedbitset is more friendly to branching predict and instructions prefetching.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut I think we can simply apply the reuse part now first. I will start run some more tests later on when i get time. I actually have an idea now to apply the optimization in general which I thought might only be applied in our case previously. will also test that out, see if we can improve this overall.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13891044_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13891044_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Feb\\/14 19:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-04T19:13:52+0000\'\u003e04\\/Feb\\/14 19:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The overhead may not from the additional method call, might be the openbitset, the impl in the fixedbitset is more friendly to branching predict and instructions prefetching. \\n\\n But I think we can simply apply the reuse part now first. I will start run some more tests later on when i get time. I actually have an idea now to apply the optimization in general which I thought might only be applied in our case previously. will also test that out, see if we can improve this overall.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13891918\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13891918&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13891918\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13891918_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13891918_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 08:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T08:44:17+0000\'\u003e05\\/Feb\\/14 08:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cul\u003e\\n\\t\u003cli\u003eI implemented FixedBitSet.iterator() to return what I think is a more optimized version, and not OpenBitSetIterator. I also saved nextSetBit two additions in nextSetBit (and the iterator). I think we may want to commit those two changes irrespective of whether we cut over to a general DocIdSet in MatchingDocs.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI then reviewed the patch more carefully and I noticed a couple of issues, all fixed in this patch:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eFacetsCollector.createHitSet() returned a MutableDocIdSet which uses OpenBitSet and not FixedBitSet internally. This affects .add() too, especially as it used set() and not fastSet(). So I modified it to use FixedBitSet, as the number of bits is known in advance.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eI moved MutableDocIdSet inside FacetsCollector and changed it to not extend DocIdSet, but rather expose two methods: add() and getDocs(). The latter returns a DocIdSet.\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eThat way, MatchingDocs doesn\'t need to declare MutableDocIdSet but DocIdSet, which makes more sense as we don\'t want the \\\"users\\\" of MatchingDocs to be able to modify the doc id set.\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eI noticed many places in the code still included a \u003ctt\u003e++doc\u003c\\/tt\u003e even though it\'s not needed anymore, so I removed them.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI wonder if the 10% loss that Mike saw was related to both the usage of OpenBitSet (which affects collection) and OpenBitSetIterator (which affects accumulation), and how will this patch perform vs trunk. I will try to setup my environment to run the facets benchmark, but Mike, if you can repeat the test w\\/ this patch and post the results, that would be great.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13891918_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13891918_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 08:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T08:44:17+0000\'\u003e05\\/Feb\\/14 08:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n\\t I implemented FixedBitSet.iterator() to return what I think is a more optimized version, and not OpenBitSetIterator. I also saved nextSetBit two additions in nextSetBit (and the iterator). I think we may want to commit those two changes irrespective of whether we cut over to a general DocIdSet in MatchingDocs. \\n \\n\\n\\n I then reviewed the patch more carefully and I noticed a couple of issues, all fixed in this patch: \\n\\n \\n\\t FacetsCollector.createHitSet() returned a MutableDocIdSet which uses OpenBitSet and not FixedBitSet internally. This affects .add() too, especially as it used set() and not fastSet(). So I modified it to use FixedBitSet, as the number of bits is known in advance. \\n \\n\\n\\n \\n\\t I moved MutableDocIdSet inside FacetsCollector and changed it to not extend DocIdSet, but rather expose two methods: add() and getDocs(). The latter returns a DocIdSet.\\n\\t \\n\\t\\t That way, MatchingDocs doesn\'t need to declare MutableDocIdSet but DocIdSet, which makes more sense as we don\'t want the \\\"users\\\" of MatchingDocs to be able to modify the doc id set. \\n\\t \\n\\t \\n \\n\\n\\n \\n\\t I noticed many places in the code still included a  ++doc  even though it\'s not needed anymore, so I removed them. \\n \\n\\n\\n I wonder if the 10% loss that Mike saw was related to both the usage of OpenBitSet (which affects collection) and OpenBitSetIterator (which affects accumulation), and how will this patch perform vs trunk. I will try to setup my environment to run the facets benchmark, but Mike, if you can repeat the test w\\/ this patch and post the results, that would be great.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13891972\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13891972&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13891972\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13891972_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13891972_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 10:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T10:21:25+0000\'\u003e05\\/Feb\\/14 10:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK I re-ran with the last patch:\u003c\\/p\u003e\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e                    Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n              HighPhrase        3.64      (5.0%)        3.56      (5.8%)   -2.2% ( -12% -    9%)\\n               MedPhrase      145.39      (4.2%)      142.65      (4.6%)   -1.9% ( -10% -    7%)\\n            OrNotHighLow       23.53      (5.4%)       23.30      (6.5%)   -1.0% ( -12% -   11%)\\n              AndHighLow      290.69      (1.9%)      289.32      (1.6%)   -0.5% (  -3% -    3%)\\n            OrNotHighMed       18.22      (4.5%)       18.16      (5.3%)   -0.3% (  -9% -    9%)\\n               LowPhrase       12.03      (2.0%)       12.02      (1.9%)   -0.1% (  -3% -    3%)\\n           OrNotHighHigh        5.88      (4.0%)        5.87      (4.3%)   -0.1% (  -8% -    8%)\\n              OrHighHigh        4.84      (3.8%)        4.84      (4.0%)   -0.1% (  -7% -    8%)\\n              AndHighMed       29.55      (1.8%)       29.53      (1.7%)   -0.1% (  -3% -    3%)\\n             AndHighHigh       24.03      (1.6%)       24.03      (1.5%)   -0.0% (  -3% -    3%)\\n           OrHighNotHigh        7.22      (3.7%)        7.22      (4.0%)    0.0% (  -7% -    7%)\\n               OrHighLow       10.01      (3.6%)       10.04      (3.8%)    0.2% (  -6% -    7%)\\n         LowSloppyPhrase       37.69      (1.8%)       37.78      (1.8%)    0.3% (  -3% -    3%)\\n             LowSpanNear        9.56      (3.2%)        9.60      (3.6%)    0.4% (  -6% -    7%)\\n                 LowTerm       84.44      (3.5%)       84.82      (3.4%)    0.5% (  -6% -    7%)\\n             MedSpanNear       26.26      (3.0%)       26.38      (3.0%)    0.5% (  -5% -    6%)\\n            HighSpanNear        6.49      (5.0%)        6.52      (4.5%)    0.5% (  -8% -   10%)\\n                  Fuzzy1       64.43      (2.1%)       64.78      (1.6%)    0.5% (  -3% -    4%)\\n            OrHighNotLow       12.56      (3.4%)       12.63      (3.5%)    0.5% (  -6% -    7%)\\n                  Fuzzy2       44.54      (2.2%)       44.80      (2.0%)    0.6% (  -3% -    4%)\\n               OrHighMed       13.49      (3.2%)       13.57      (3.6%)    0.6% (  -5% -    7%)\\n                 Respell       47.31      (3.1%)       47.60      (2.5%)    0.6% (  -4% -    6%)\\n         MedSloppyPhrase        3.26      (4.3%)        3.28      (5.0%)    0.7% (  -8% -   10%)\\n            OrHighNotMed       15.62      (2.9%)       15.78      (3.4%)    1.0% (  -5% -    7%)\\n        HighSloppyPhrase        3.15      (7.9%)        3.18     (11.1%)    1.0% ( -16% -   21%)\\n                HighTerm       21.55      (2.6%)       21.79      (2.6%)    1.1% (  -3% -    6%)\\n                 MedTerm       31.23      (2.3%)       31.67      (2.6%)    1.4% (  -3% -    6%)\\n                  IntNRQ        4.11      (2.8%)        4.30      (2.3%)    4.7% (   0% -    9%)\\n                Wildcard       17.39      (2.6%)       20.99      (3.9%)   20.7% (  13% -   27%)\\n                 Prefix3       75.17      (1.9%)       96.43      (3.3%)   28.3% (  22% -   34%)\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eI think the improved FixedBitSet iterator made a huge difference for the MTQs (wildcard, prefix), unrelated to facets I think, since those queries very likely used the filter rewrite method.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd then there\'s no more ~10% hit for fast queries, which is great: DISI is fine to use.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13891972_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13891972_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 10:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T10:21:25+0000\'\u003e05\\/Feb\\/14 10:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK I re-ran with the last patch: \\n  \\n                     Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n              HighPhrase        3.64      (5.0%)        3.56      (5.8%)   -2.2% ( -12% -    9%)\\n               MedPhrase      145.39      (4.2%)      142.65      (4.6%)   -1.9% ( -10% -    7%)\\n            OrNotHighLow       23.53      (5.4%)       23.30      (6.5%)   -1.0% ( -12% -   11%)\\n              AndHighLow      290.69      (1.9%)      289.32      (1.6%)   -0.5% (  -3% -    3%)\\n            OrNotHighMed       18.22      (4.5%)       18.16      (5.3%)   -0.3% (  -9% -    9%)\\n               LowPhrase       12.03      (2.0%)       12.02      (1.9%)   -0.1% (  -3% -    3%)\\n           OrNotHighHigh        5.88      (4.0%)        5.87      (4.3%)   -0.1% (  -8% -    8%)\\n              OrHighHigh        4.84      (3.8%)        4.84      (4.0%)   -0.1% (  -7% -    8%)\\n              AndHighMed       29.55      (1.8%)       29.53      (1.7%)   -0.1% (  -3% -    3%)\\n             AndHighHigh       24.03      (1.6%)       24.03      (1.5%)   -0.0% (  -3% -    3%)\\n           OrHighNotHigh        7.22      (3.7%)        7.22      (4.0%)    0.0% (  -7% -    7%)\\n               OrHighLow       10.01      (3.6%)       10.04      (3.8%)    0.2% (  -6% -    7%)\\n         LowSloppyPhrase       37.69      (1.8%)       37.78      (1.8%)    0.3% (  -3% -    3%)\\n             LowSpanNear        9.56      (3.2%)        9.60      (3.6%)    0.4% (  -6% -    7%)\\n                 LowTerm       84.44      (3.5%)       84.82      (3.4%)    0.5% (  -6% -    7%)\\n             MedSpanNear       26.26      (3.0%)       26.38      (3.0%)    0.5% (  -5% -    6%)\\n            HighSpanNear        6.49      (5.0%)        6.52      (4.5%)    0.5% (  -8% -   10%)\\n                  Fuzzy1       64.43      (2.1%)       64.78      (1.6%)    0.5% (  -3% -    4%)\\n            OrHighNotLow       12.56      (3.4%)       12.63      (3.5%)    0.5% (  -6% -    7%)\\n                  Fuzzy2       44.54      (2.2%)       44.80      (2.0%)    0.6% (  -3% -    4%)\\n               OrHighMed       13.49      (3.2%)       13.57      (3.6%)    0.6% (  -5% -    7%)\\n                 Respell       47.31      (3.1%)       47.60      (2.5%)    0.6% (  -4% -    6%)\\n         MedSloppyPhrase        3.26      (4.3%)        3.28      (5.0%)    0.7% (  -8% -   10%)\\n            OrHighNotMed       15.62      (2.9%)       15.78      (3.4%)    1.0% (  -5% -    7%)\\n        HighSloppyPhrase        3.15      (7.9%)        3.18     (11.1%)    1.0% ( -16% -   21%)\\n                HighTerm       21.55      (2.6%)       21.79      (2.6%)    1.1% (  -3% -    6%)\\n                 MedTerm       31.23      (2.3%)       31.67      (2.6%)    1.4% (  -3% -    6%)\\n                  IntNRQ        4.11      (2.8%)        4.30      (2.3%)    4.7% (   0% -    9%)\\n                Wildcard       17.39      (2.6%)       20.99      (3.9%)   20.7% (  13% -   27%)\\n                 Prefix3       75.17      (1.9%)       96.43      (3.3%)   28.3% (  22% -   34%)\\n \\n  \\n\\n I think the improved FixedBitSet iterator made a huge difference for the MTQs (wildcard, prefix), unrelated to facets I think, since those queries very likely used the filter rewrite method. \\n\\n And then there\'s no more ~10% hit for fast queries, which is great: DISI is fine to use.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892131\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892131&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892131\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13892131_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892131_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 14:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T14:10:56+0000\'\u003e05\\/Feb\\/14 14:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI ran this on a 2013 Wikipedia dump w\\/ 6.7M docs (full docs, not 1K) and Date facet:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e                   Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n       HighSloppyPhrase        1.80      (9.7%)        1.75      (6.1%)   -2.9% ( -16% -   14%)\\n              OrHighLow        5.53      (2.2%)        5.43      (2.7%)   -1.9% (  -6% -    3%)\\n             OrHighHigh        3.81      (2.2%)        3.74      (2.7%)   -1.8% (  -6% -    3%)\\n           OrHighNotLow        9.27      (2.1%)        9.13      (2.6%)   -1.5% (  -5% -    3%)\\n           HighSpanNear        3.77      (5.4%)        3.71      (6.2%)   -1.4% ( -12% -   10%)\\n           OrHighNotMed       14.84      (2.1%)       14.64      (2.5%)   -1.3% (  -5% -    3%)\\n          OrHighNotHigh        8.06      (2.4%)        7.96      (2.8%)   -1.2% (  -6% -    4%)\\n        MedSloppyPhrase        1.66      (7.2%)        1.64      (4.3%)   -1.2% ( -11% -   11%)\\n           OrNotHighLow       30.04      (4.6%)       29.71      (4.9%)   -1.1% ( -10% -    8%)\\n              OrHighMed       12.16      (2.2%)       12.04      (2.3%)   -1.0% (  -5% -    3%)\\n             HighPhrase        2.28     (10.2%)        2.26      (9.2%)   -0.7% ( -18% -   20%)\\n          OrNotHighHigh       13.08      (3.0%)       13.00      (3.1%)   -0.7% (  -6% -    5%)\\n                Respell       24.49      (3.3%)       24.33      (3.3%)   -0.6% (  -7% -    6%)\\n           OrNotHighMed       18.02      (4.1%)       17.99      (4.0%)   -0.2% (  -7% -    8%)\\n              LowPhrase        5.73      (7.0%)        5.72      (6.9%)   -0.2% ( -13% -   14%)\\n            MedSpanNear       14.97      (3.8%)       14.99      (4.3%)    0.1% (  -7% -    8%)\\n             AndHighLow      199.51      (2.9%)      200.05      (3.6%)    0.3% (  -6% -    6%)\\n            LowSpanNear        4.57      (4.0%)        4.59      (4.7%)    0.3% (  -8% -    9%)\\n              MedPhrase       79.00      (7.4%)       79.23      (6.3%)    0.3% ( -12% -   15%)\\n                 Fuzzy2       25.42      (3.0%)       25.56      (3.1%)    0.6% (  -5% -    6%)\\n                 Fuzzy1       35.84      (2.7%)       36.11      (3.7%)    0.7% (  -5% -    7%)\\n        LowSloppyPhrase       20.55      (2.7%)       20.73      (2.3%)    0.9% (  -4% -    6%)\\n               HighTerm       22.31      (3.7%)       22.59      (2.6%)    1.2% (  -4% -    7%)\\n             AndHighMed       16.17      (1.8%)       16.39      (2.3%)    1.3% (  -2% -    5%)\\n            AndHighHigh       15.85      (2.3%)       16.17      (1.7%)    2.1% (  -1% -    6%)\\n                MedTerm       26.51      (3.9%)       27.11      (4.0%)    2.3% (  -5% -   10%)\\n                LowTerm       98.07      (4.6%)      101.55      (5.5%)    3.5% (  -6% -   14%)\\n                 IntNRQ        8.61      (4.3%)        9.20      (4.6%)    6.9% (  -1% -   16%)\\n               Wildcard       12.96      (3.0%)       14.30      (3.6%)   10.3% (   3% -   17%)\\n                Prefix3       74.18      (2.7%)       96.70      (4.9%)   30.4% (  22% -   38%)\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eResults are consistent with yours. So should we proceed w\\/ the API change?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13892131_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892131_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 14:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T14:10:56+0000\'\u003e05\\/Feb\\/14 14:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I ran this on a 2013 Wikipedia dump w\\/ 6.7M docs (full docs, not 1K) and Date facet: \\n\\n  \\n                    Task    QPS base      StdDev    QPS comp      StdDev                Pct diff\\n       HighSloppyPhrase        1.80      (9.7%)        1.75      (6.1%)   -2.9% ( -16% -   14%)\\n              OrHighLow        5.53      (2.2%)        5.43      (2.7%)   -1.9% (  -6% -    3%)\\n             OrHighHigh        3.81      (2.2%)        3.74      (2.7%)   -1.8% (  -6% -    3%)\\n           OrHighNotLow        9.27      (2.1%)        9.13      (2.6%)   -1.5% (  -5% -    3%)\\n           HighSpanNear        3.77      (5.4%)        3.71      (6.2%)   -1.4% ( -12% -   10%)\\n           OrHighNotMed       14.84      (2.1%)       14.64      (2.5%)   -1.3% (  -5% -    3%)\\n          OrHighNotHigh        8.06      (2.4%)        7.96      (2.8%)   -1.2% (  -6% -    4%)\\n        MedSloppyPhrase        1.66      (7.2%)        1.64      (4.3%)   -1.2% ( -11% -   11%)\\n           OrNotHighLow       30.04      (4.6%)       29.71      (4.9%)   -1.1% ( -10% -    8%)\\n              OrHighMed       12.16      (2.2%)       12.04      (2.3%)   -1.0% (  -5% -    3%)\\n             HighPhrase        2.28     (10.2%)        2.26      (9.2%)   -0.7% ( -18% -   20%)\\n          OrNotHighHigh       13.08      (3.0%)       13.00      (3.1%)   -0.7% (  -6% -    5%)\\n                Respell       24.49      (3.3%)       24.33      (3.3%)   -0.6% (  -7% -    6%)\\n           OrNotHighMed       18.02      (4.1%)       17.99      (4.0%)   -0.2% (  -7% -    8%)\\n              LowPhrase        5.73      (7.0%)        5.72      (6.9%)   -0.2% ( -13% -   14%)\\n            MedSpanNear       14.97      (3.8%)       14.99      (4.3%)    0.1% (  -7% -    8%)\\n             AndHighLow      199.51      (2.9%)      200.05      (3.6%)    0.3% (  -6% -    6%)\\n            LowSpanNear        4.57      (4.0%)        4.59      (4.7%)    0.3% (  -8% -    9%)\\n              MedPhrase       79.00      (7.4%)       79.23      (6.3%)    0.3% ( -12% -   15%)\\n                 Fuzzy2       25.42      (3.0%)       25.56      (3.1%)    0.6% (  -5% -    6%)\\n                 Fuzzy1       35.84      (2.7%)       36.11      (3.7%)    0.7% (  -5% -    7%)\\n        LowSloppyPhrase       20.55      (2.7%)       20.73      (2.3%)    0.9% (  -4% -    6%)\\n               HighTerm       22.31      (3.7%)       22.59      (2.6%)    1.2% (  -4% -    7%)\\n             AndHighMed       16.17      (1.8%)       16.39      (2.3%)    1.3% (  -2% -    5%)\\n            AndHighHigh       15.85      (2.3%)       16.17      (1.7%)    2.1% (  -1% -    6%)\\n                MedTerm       26.51      (3.9%)       27.11      (4.0%)    2.3% (  -5% -   10%)\\n                LowTerm       98.07      (4.6%)      101.55      (5.5%)    3.5% (  -6% -   14%)\\n                 IntNRQ        8.61      (4.3%)        9.20      (4.6%)    6.9% (  -1% -   16%)\\n               Wildcard       12.96      (3.0%)       14.30      (3.6%)   10.3% (   3% -   17%)\\n                Prefix3       74.18      (2.7%)       96.70      (4.9%)   30.4% (  22% -   38%)\\n \\n  \\n\\n Results are consistent with yours. So should we proceed w\\/ the API change?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892144\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892144&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892144\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13892144_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892144_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 14:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T14:29:57+0000\'\u003e05\\/Feb\\/14 14:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eJohn\\/Lei, can you please review the new patch to confirm this API will work for you?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13892144_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892144_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 14:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T14:29:57+0000\'\u003e05\\/Feb\\/14 14:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    John\\/Lei, can you please review the new patch to confirm this API will work for you?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892204\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892204&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892204\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13892204_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892204_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 15:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T15:04:58+0000\'\u003e05\\/Feb\\/14 15:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYes, this works great for us!\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks Shai and Mike!\u003c\\/p\u003e\\n\\n\u003cp\u003e-John\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"john.wang@gmail.com\\\" id=\\\"commentauthor_13892204_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=john.wang%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"john.wang@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e John Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892204_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 15:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T15:04:58+0000\'\u003e05\\/Feb\\/14 15:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Yes, this works great for us! \\n\\n Thanks Shai and Mike! \\n\\n -John              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892338\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892338&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892338\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13892338_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892338_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 17:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T17:38:03+0000\'\u003e05\\/Feb\\/14 17:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYes! with this patch, we can write our own FacetCollector, and do customize.\u003c\\/p\u003e\\n\\n\u003cp\u003eOnly one small suggestions. The createHitsSet is marked as protected, but the class itself is final, no sub-class can override it other then creating a new FacetCollector. Can we remove the final modifier for the class, and add finals to the methods we don\'t want the user to override?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13892338_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892338_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 17:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T17:38:03+0000\'\u003e05\\/Feb\\/14 17:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Yes! with this patch, we can write our own FacetCollector, and do customize. \\n\\n Only one small suggestions. The createHitsSet is marked as protected, but the class itself is final, no sub-class can override it other then creating a new FacetCollector. Can we remove the final modifier for the class, and add finals to the methods we don\'t want the user to override?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892363\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892363&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892363\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13892363_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892363_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 17:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T17:57:01+0000\'\u003e05\\/Feb\\/14 17:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eThe createHitsSet is marked as protected, but the class itself is final\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eDuh, will remove final from class, thanks for noticing that! \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eI will run some tests and then commit the patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13892363_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892363_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 17:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T17:57:01+0000\'\u003e05\\/Feb\\/14 17:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     The createHitsSet is marked as protected, but the class itself is final  \\n\\n Duh, will remove final from class, thanks for noticing that!  . \\n\\n I will run some tests and then commit the patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892435\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892435&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892435\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13892435_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892435_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 19:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T19:06:50+0000\'\u003e05\\/Feb\\/14 19:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13892435_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892435_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 19:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T19:06:50+0000\'\u003e05\\/Feb\\/14 19:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892481\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892481&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892481\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13892481_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892481_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 19:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T19:45:47+0000\'\u003e05\\/Feb\\/14 19:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1564898 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\" class=\\\"user-hover\\\" rel=\\\"shaie\\\"\u003eShai Erera\u003c\\/a\u003e in branch \'dev\\/trunk\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1564898\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1564898\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-5425\\\" title=\\\"Make creation of FixedBitSet in FacetsCollector overridable\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-5425\\\"\u003e\u003cdel\u003eLUCENE-5425\u003c\\/del\u003e\u003c\\/a\u003e: Make creation of FixedBitSet in FacetsCollector overridable\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13892481_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892481_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 19:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T19:45:47+0000\'\u003e05\\/Feb\\/14 19:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1564898 from  Shai Erera  in branch \'dev\\/trunk\' \\n[  https:\\/\\/svn.apache.org\\/r1564898  ] \\n\\n   LUCENE-5425  : Make creation of FixedBitSet in FacetsCollector overridable              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892494\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892494&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892494\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13892494_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892494_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 19:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T19:56:24+0000\'\u003e05\\/Feb\\/14 19:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1564907 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\" class=\\\"user-hover\\\" rel=\\\"shaie\\\"\u003eShai Erera\u003c\\/a\u003e in branch \'dev\\/branches\\/branch_4x\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1564907\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1564907\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-5425\\\" title=\\\"Make creation of FixedBitSet in FacetsCollector overridable\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-5425\\\"\u003e\u003cdel\u003eLUCENE-5425\u003c\\/del\u003e\u003c\\/a\u003e: Make creation of FixedBitSet in FacetsCollector overridable\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13892494_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892494_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 19:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T19:56:24+0000\'\u003e05\\/Feb\\/14 19:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1564907 from  Shai Erera  in branch \'dev\\/branches\\/branch_4x\' \\n[  https:\\/\\/svn.apache.org\\/r1564907  ] \\n\\n   LUCENE-5425  : Make creation of FixedBitSet in FacetsCollector overridable              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13892495\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13892495&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13892495\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13892495_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892495_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 19:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T19:57:22+0000\'\u003e05\\/Feb\\/14 19:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted to trunk and 4x. I renamed MutableDocIdSet to Docs as it wasn\'t a DocIdSet anymore.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks John and Lei for your contribution!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13892495_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13892495_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/14 19:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-05T19:57:22+0000\'\u003e05\\/Feb\\/14 19:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed to trunk and 4x. I renamed MutableDocIdSet to Docs as it wasn\'t a DocIdSet anymore. \\n\\n Thanks John and Lei for your contribution!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13895977\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13895977&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13895977\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thetaphi\\\" id=\\\"commentauthor_13895977_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thetaphi\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thetaphi\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Uwe Schindler\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13895977_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Feb\\/14 18:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-09T18:41:22+0000\'\u003e09\\/Feb\\/14 18:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Uwe Schindler - 09\\/Feb\\/14 18:46\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi,\u003cbr\\/\u003e\\nunfortunately the methods FixedBitSet.or(DocIdSetIterator) now can no longer use the optimization. We should refactor the anaonymous iterator to be a pkg-private class and change the instanceof checks in the and\\/or\\/.... methods use that class.\u003cbr\\/\u003e\\nBooleanFilter and ChainedFilter make heavy use of this opto!!!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thetaphi\\\" id=\\\"commentauthor_13895977_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thetaphi\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thetaphi\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Uwe Schindler\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13895977_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Feb\\/14 18:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-09T18:41:22+0000\'\u003e09\\/Feb\\/14 18:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Uwe Schindler - 09\\/Feb\\/14 18:46\\\"\u003eedited\u003c\\/span\u003e                   Hi, \\nunfortunately the methods FixedBitSet.or(DocIdSetIterator) now can no longer use the optimization. We should refactor the anaonymous iterator to be a pkg-private class and change the instanceof checks in the and\\/or\\/.... methods use that class. \\nBooleanFilter and ChainedFilter make heavy use of this opto!!!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13896149\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13896149&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13896149\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13896149_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13896149_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Feb\\/14 01:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-10T01:38:14+0000\'\u003e10\\/Feb\\/14 01:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLooks like we should be able to replace the impl of OpenBitSetIterator with the one Shai added in the FixedBitSet. The only missing data is the numBits, but it\'s optional. And at the same time, any code that is using the will be benefit from this.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13896149_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13896149_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Feb\\/14 01:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-10T01:38:14+0000\'\u003e10\\/Feb\\/14 01:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Looks like we should be able to replace the impl of OpenBitSetIterator with the one Shai added in the FixedBitSet. The only missing data is the numBits, but it\'s optional. And at the same time, any code that is using the will be benefit from this.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13896159\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13896159&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13896159\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13896159_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13896159_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Feb\\/14 02:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-10T02:00:37+0000\'\u003e10\\/Feb\\/14 02:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFaster OpenBitSetIterator\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13896159_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13896159_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Feb\\/14 02:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-10T02:00:37+0000\'\u003e10\\/Feb\\/14 02:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Faster OpenBitSetIterator              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13896200\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13896200&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13896200\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13896200_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13896200_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Feb\\/14 04:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-10T04:06:59+0000\'\u003e10\\/Feb\\/14 04:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUwe, I added an explicit FixedBitSetIterator and the optimization in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-5440\\\" title=\\\"Add LongFixedBitSet and replace usage of OpenBitSet\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-5440\\\"\u003e\u003cdel\u003eLUCENE-5440\u003c\\/del\u003e\u003c\\/a\u003e. Lei, on \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-5440\\\" title=\\\"Add LongFixedBitSet and replace usage of OpenBitSet\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-5440\\\"\u003e\u003cdel\u003eLUCENE-5440\u003c\\/del\u003e\u003c\\/a\u003e I\'m moving all the code to use FixedBitSet instead of OpenBitSet and therefore it will use the new iterator by default. The intention is to get rid of OpenBitSet and accompanying classes.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13896200_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13896200_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Feb\\/14 04:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-10T04:06:59+0000\'\u003e10\\/Feb\\/14 04:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Uwe, I added an explicit FixedBitSetIterator and the optimization in   LUCENE-5440  . Lei, on   LUCENE-5440   I\'m moving all the code to use FixedBitSet instead of OpenBitSet and therefore it will use the new iterator by default. The intention is to get rid of OpenBitSet and accompanying classes.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13896217\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-5425?focusedCommentId=13896217&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13896217\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13896217_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13896217_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Feb\\/14 05:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-10T05:04:15+0000\'\u003e10\\/Feb\\/14 05:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eoh cool! that patch looks better!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"wonlay\\\" id=\\\"commentauthor_13896217_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=wonlay\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"wonlay\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lei Wang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13896217_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Feb\\/14 05:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-10T05:04:15+0000\'\u003e10\\/Feb\\/14 05:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    oh cool! that patch looks better!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516204951111"> 
    <input type="hidden" title="jira.request.server.time" value="325"> 
    <input type="hidden" title="jira.request.id" value="962x7779180x8"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="9"> 
    <input type="hidden" title="db.reads.time.in.ms" value="83"> 
    <input type="hidden" title="db.conns.time.in.ms" value="89"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 962x7779180x8
	          REQUEST TIMESTAMP : [17/Jan/2018:16:02:31 +0000]
	               REQUEST TIME : 0.3250
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 9

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=23, elapsedTotal=83390140, elapsedMin=497653, elapsedMax=48163192, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=27, elapsedTotal=89356837, elapsedMin=507314, elapsedMax=48233232, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>